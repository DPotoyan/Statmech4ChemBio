
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/02_Legendre.html">
     Legendre transform
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/ensemble_overview.html">
     Overview of ensembles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Gases
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/photons_phonons.html">
     Photons and Phonons
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/landauer.html">
     Information erasure and Landauer’s principle
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.885 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.20512821,  0.25641026,  0.41025641,  0.97435897,  1.84615385,
         2.71794872,  4.35897436,  8.20512821, 14.82051282, 17.48717949]),
 array([0.69  , 0.7095, 0.729 , 0.7485, 0.768 , 0.7875, 0.807 , 0.8265,
        0.846 , 0.8655, 0.885 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "a01ca788604b4b8b86293946beb2537e"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.001668846664706339
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "d126d1ff93d94bf9a01fd09439329c09"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f3a640fb110&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "9a26bbc563a444099d60496090e4b883"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"b24dd98c97984b5d94683713a4ed8e25": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a01ca788604b4b8b86293946beb2537e": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_120982db324242c8b1135c2e384c0244", "IPY_MODEL_0f3b3c9bcf65462ebca78cef4447c203"], "layout": "IPY_MODEL_b24dd98c97984b5d94683713a4ed8e25"}}, "406a2e394ec34fcaba7feb128007252b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ae129f4405534ca8a11e0ca671dd14ec": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "120982db324242c8b1135c2e384c0244": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_406a2e394ec34fcaba7feb128007252b", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_ae129f4405534ca8a11e0ca671dd14ec", "value": 1}}, "58175b4c8c9844fb9d41cabffb2128e2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0f3b3c9bcf65462ebca78cef4447c203": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_58175b4c8c9844fb9d41cabffb2128e2", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "28856625e69d4493bd725e591140d991": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d126d1ff93d94bf9a01fd09439329c09": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_99f7c8f3f5ed44d49f7cd3b006cae562", "IPY_MODEL_915de3d0e1894aad8a98f5ad2cad2e71"], "layout": "IPY_MODEL_28856625e69d4493bd725e591140d991"}}, "233c71bd8eb24635aa7c1388e5342294": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c40c3a425874447f9254a8029d9b41ae": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "99f7c8f3f5ed44d49f7cd3b006cae562": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_233c71bd8eb24635aa7c1388e5342294", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_c40c3a425874447f9254a8029d9b41ae", "value": 1}}, "5f66acb44f1543269a04cd0360e33822": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "915de3d0e1894aad8a98f5ad2cad2e71": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_5f66acb44f1543269a04cd0360e33822", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "14eef16a18214dfaa1eb33be9d47ad65": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9a26bbc563a444099d60496090e4b883": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_5f7e539bcb6345c2ae7d8fd36553bef8", "IPY_MODEL_245196a4c8f14bebb9a14bf8e26f0272"], "layout": "IPY_MODEL_14eef16a18214dfaa1eb33be9d47ad65"}}, "8909e9b23d264127ad003d0dacdca4cc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "711e5007b09b4b34aa0af506b24e1a4d": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "5f7e539bcb6345c2ae7d8fd36553bef8": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_8909e9b23d264127ad003d0dacdca4cc", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_711e5007b09b4b34aa0af506b24e1a4d", "value": 1}}, "8f7a2ec15ca84f6594eb92c9b69e0db9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "245196a4c8f14bebb9a14bf8e26f0272": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_8f7a2ec15ca84f6594eb92c9b69e0db9", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>