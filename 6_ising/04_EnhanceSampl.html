
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B2: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.92 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.1025641 ,  0.15384615,  0.51282051,  0.41025641,  1.38461538,
         2.76923077,  4.76923077,  8.41025641, 15.38461538, 17.38461538]),
 array([0.725 , 0.7445, 0.764 , 0.7835, 0.803 , 0.8225, 0.842 , 0.8615,
        0.881 , 0.9005, 0.92  ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "8b88f933170243299dbacfafa49e74c7"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0005246733150938508
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "d2902f150bbb44a788c8511ce5b5b63d"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe870ca7510&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "3f5537eb00074d489c7762354d54f4c7"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"4143e3e313a6476a9bf24c9a2a0e8c28": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8b88f933170243299dbacfafa49e74c7": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_f451eebe81854ca09a249221644ba43d", "IPY_MODEL_f0b0f16f712d4c5cb9e43f89d23c8e24"], "layout": "IPY_MODEL_4143e3e313a6476a9bf24c9a2a0e8c28"}}, "a060c308699f4e22997700fc12562757": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f48ae734401742d4b516108a1f92a59d": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "f451eebe81854ca09a249221644ba43d": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_a060c308699f4e22997700fc12562757", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_f48ae734401742d4b516108a1f92a59d", "value": 1}}, "50868165f26746f0a3951b5b22eb2d91": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f0b0f16f712d4c5cb9e43f89d23c8e24": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_50868165f26746f0a3951b5b22eb2d91", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "a62e787fa5ba4631a98356c40aca8b15": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d2902f150bbb44a788c8511ce5b5b63d": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_1bdbdc5f9d2e4ebfac05a1590da35050", "IPY_MODEL_4af840092ff245d3aa85f2d456e18f0d"], "layout": "IPY_MODEL_a62e787fa5ba4631a98356c40aca8b15"}}, "f873b4fde99d4b8fabf0d58f1ce94c82": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7cb7d0b821f14586bdeec1d78d69d078": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "1bdbdc5f9d2e4ebfac05a1590da35050": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_f873b4fde99d4b8fabf0d58f1ce94c82", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_7cb7d0b821f14586bdeec1d78d69d078", "value": 1}}, "3c059faaab7a4c649c8ff96a804468cc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4af840092ff245d3aa85f2d456e18f0d": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_3c059faaab7a4c649c8ff96a804468cc", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "8a4bf4e6c9d44042afaf3cb2f2dc4f54": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3f5537eb00074d489c7762354d54f4c7": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_2a6ec3e293514827a191afa21061b88c", "IPY_MODEL_b952afe3d5f44225b11b6bf33e170984"], "layout": "IPY_MODEL_8a4bf4e6c9d44042afaf3cb2f2dc4f54"}}, "7eebdc3be4dc448090bf4d3aea1edfbc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f6e2cbc6fb154fe699d137a638408ac9": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "2a6ec3e293514827a191afa21061b88c": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_7eebdc3be4dc448090bf4d3aea1edfbc", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_f6e2cbc6fb154fe699d137a638408ac9", "value": 1}}, "6f635b9be9954fe8934f9a6942688992": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b952afe3d5f44225b11b6bf33e170984": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_6f635b9be9954fe8934f9a6942688992", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>