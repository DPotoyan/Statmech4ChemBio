
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix A: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.865 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.15384615,  0.46153846,  1.02564103,  1.02564103,  1.43589744,
         2.05128205,  4.87179487,  8.20512821, 13.48717949, 18.56410256]),
 array([0.67  , 0.6895, 0.709 , 0.7285, 0.748 , 0.7675, 0.787 , 0.8065,
        0.826 , 0.8455, 0.865 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "c0a204b87f5141de83749647d31c7acf"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.00026396393632365693
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "8698d144bd044a2c891540078b882cff"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f84ba623850&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "4d40fb38dd8f4664b635a9d352c9433b"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"6ecb4501838d4d0ea5ba305afae327d2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c0a204b87f5141de83749647d31c7acf": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_2e4a4792a90a4b358a1065dfd835e912", "IPY_MODEL_e826139f60b446cb83772089e4084a58"], "layout": "IPY_MODEL_6ecb4501838d4d0ea5ba305afae327d2"}}, "d52fe8a0c0034bfbac071d49be3553af": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "54f909b22b634aeda7b7d45d6f40099c": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "2e4a4792a90a4b358a1065dfd835e912": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_d52fe8a0c0034bfbac071d49be3553af", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_54f909b22b634aeda7b7d45d6f40099c", "value": 1}}, "dc3562b536a44a28b58f2cce58c0f167": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e826139f60b446cb83772089e4084a58": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_dc3562b536a44a28b58f2cce58c0f167", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "4f5339ecdce84b539ccf7e1e3fa9b15b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8698d144bd044a2c891540078b882cff": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_59dca4c4b65a4ee78435cfb13650f8bb", "IPY_MODEL_02033b1ea59a44adb39382f6d55efa98"], "layout": "IPY_MODEL_4f5339ecdce84b539ccf7e1e3fa9b15b"}}, "96b264a45d5c49a9bc4b7f12b624d4d7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "15f08a054f64492692e16db6a7773622": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "59dca4c4b65a4ee78435cfb13650f8bb": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_96b264a45d5c49a9bc4b7f12b624d4d7", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_15f08a054f64492692e16db6a7773622", "value": 1}}, "1469bbdedc1a4e1ab6bcb39ae0fbf8d5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "02033b1ea59a44adb39382f6d55efa98": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_1469bbdedc1a4e1ab6bcb39ae0fbf8d5", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "d06cadb6fb844200aa6aa028c3089cdc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4d40fb38dd8f4664b635a9d352c9433b": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_fca875f894714794bcf739dca12c77bc", "IPY_MODEL_e883d3b4a8c04ccea88048dbbfb3be47"], "layout": "IPY_MODEL_d06cadb6fb844200aa6aa028c3089cdc"}}, "0d71b9729e98418da4a54bdadb0d21e7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1b91b2c8ad364c659073be0d6a73aa77": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "fca875f894714794bcf739dca12c77bc": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_0d71b9729e98418da4a54bdadb0d21e7", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_1b91b2c8ad364c659073be0d6a73aa77", "value": 1}}, "54c07661f6e14ba89cccea164f6e8121": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e883d3b4a8c04ccea88048dbbfb3be47": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_54c07661f6e14ba89cccea164f6e8121", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>