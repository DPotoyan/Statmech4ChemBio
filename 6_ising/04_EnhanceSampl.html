
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Dynamics in phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.955 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.31578947,  0.52631579,  1.15789474,  1.84210526,  1.94736842,
         4.63157895,  7.21052632, 12.47368421, 12.31578947, 10.21052632]),
 array([0.765, 0.784, 0.803, 0.822, 0.841, 0.86 , 0.879, 0.898, 0.917,
        0.936, 0.955]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "76e62df6d85c4bf79b6ccae8546b3fa5"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.0013659686397475342
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "2623a4391aae4a4699f5b90b09ebeeef"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fa6dd08ac50&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "1b3127bf6c124fe8aacb5535ae252223"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"54d5f4f2757c45099d85f9c4c58f7b7a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "76e62df6d85c4bf79b6ccae8546b3fa5": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_40849d81618e4aeaa1ea81b5560e743f", "IPY_MODEL_76d465e7b51a4b41b1797d787b6c327d"], "layout": "IPY_MODEL_54d5f4f2757c45099d85f9c4c58f7b7a"}}, "9226840e61844e66ae3640ab4b05c6ae": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e12879efa6934e00b8f50699be661e65": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "40849d81618e4aeaa1ea81b5560e743f": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_9226840e61844e66ae3640ab4b05c6ae", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_e12879efa6934e00b8f50699be661e65", "value": 1}}, "191bc29fe43942b5acbde80f05370dee": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "76d465e7b51a4b41b1797d787b6c327d": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_191bc29fe43942b5acbde80f05370dee", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "c9105987e48a425fa8e9f015c819c270": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2623a4391aae4a4699f5b90b09ebeeef": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_97db0e6d32b349e18dc1e4265a079fec", "IPY_MODEL_1fd170cc82a5413f954a7c832d3756ed"], "layout": "IPY_MODEL_c9105987e48a425fa8e9f015c819c270"}}, "1c9f0b620fe34d9f8a2c848a28b05fa7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "71607a9e4f8b40159f0440c31b298c74": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "97db0e6d32b349e18dc1e4265a079fec": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_1c9f0b620fe34d9f8a2c848a28b05fa7", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_71607a9e4f8b40159f0440c31b298c74", "value": 1}}, "3369dd3d5603461eb8cba66310d75a54": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1fd170cc82a5413f954a7c832d3756ed": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_3369dd3d5603461eb8cba66310d75a54", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "61d6310fc1ba40f7a5dd338514873b75": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1b3127bf6c124fe8aacb5535ae252223": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_93e34a493ce146569fd600a774304612", "IPY_MODEL_2dba8c98dbf44b41b4cee5798affde32"], "layout": "IPY_MODEL_61d6310fc1ba40f7a5dd338514873b75"}}, "551a521186ce4ad393ad29cf24f2c57a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "58bea11a2b1f4482a62fd3bcb7a4d68a": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "93e34a493ce146569fd600a774304612": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_551a521186ce4ad393ad29cf24f2c57a", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_58bea11a2b1f4482a62fd3bcb7a4d68a", "value": 1}}, "f10cb87638dc46a18963ddc95d5dfdcc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2dba8c98dbf44b41b4cee5798affde32": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_f10cb87638dc46a18963ddc95d5dfdcc", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>