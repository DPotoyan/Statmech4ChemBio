
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B2: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.91 0.81
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.20512821,  0.25641026,  0.35897436,  0.92307692,  1.79487179,
         3.07692308,  5.23076923,  8.25641026, 14.82051282, 16.35897436]),
 array([0.715 , 0.7345, 0.754 , 0.7735, 0.793 , 0.8125, 0.832 , 0.8515,
        0.871 , 0.8905, 0.91  ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "29412cf8d2974ea2a4cd276ef493180d"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.0004633721637570583
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "e13ed1c69ca14e34bf438c7143fd707f"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7ff158416750&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "62c1a4fdab1e45acb3a2242c8704e145"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"4419a93dc5cc4ecab9d2b759d2847ea4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "29412cf8d2974ea2a4cd276ef493180d": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_27017a5899ce4ba9bb84269c944df481", "IPY_MODEL_9cc5f45d7e174cfe87f64490d3ba515e"], "layout": "IPY_MODEL_4419a93dc5cc4ecab9d2b759d2847ea4"}}, "e4ed6bf9078c4fa980f929edcd50997a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ff51a2856b764827a98ddf8d8b51ba34": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "27017a5899ce4ba9bb84269c944df481": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_e4ed6bf9078c4fa980f929edcd50997a", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_ff51a2856b764827a98ddf8d8b51ba34", "value": 1}}, "f76890cce4dc43d0a47ca2c564c5f033": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9cc5f45d7e174cfe87f64490d3ba515e": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_f76890cce4dc43d0a47ca2c564c5f033", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "08d0a816d5c3459b9619c7a9a8799860": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e13ed1c69ca14e34bf438c7143fd707f": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_a146c6ae4eb14ca994e2589829652100", "IPY_MODEL_d0e5ba14b1fe40cc993df2eced4a79e8"], "layout": "IPY_MODEL_08d0a816d5c3459b9619c7a9a8799860"}}, "05b064be17ee4e19aa4cc375cc406b96": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c5e7b2d771054f33b8eab65ba78c2582": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "a146c6ae4eb14ca994e2589829652100": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_05b064be17ee4e19aa4cc375cc406b96", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_c5e7b2d771054f33b8eab65ba78c2582", "value": 1}}, "3fb1cc2c5ac440f7b152eb32f458fa17": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d0e5ba14b1fe40cc993df2eced4a79e8": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_3fb1cc2c5ac440f7b152eb32f458fa17", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "b17951b1f2404b4a9c439d3eba020b78": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "62c1a4fdab1e45acb3a2242c8704e145": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_79e7baa842aa4f0d8e78ed0df15d5616", "IPY_MODEL_b923fe5b36b34e2da83a7085ee6cd35b"], "layout": "IPY_MODEL_b17951b1f2404b4a9c439d3eba020b78"}}, "08c75261cf484a11adde3745fb2664f9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "32728a2e53f949ff80fad1f663695640": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "79e7baa842aa4f0d8e78ed0df15d5616": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_08c75261cf484a11adde3745fb2664f9", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_32728a2e53f949ff80fad1f663695640", "value": 1}}, "ca6da35f7afe469d963a2755fad6a94c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b923fe5b36b34e2da83a7085ee6cd35b": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_ca6da35f7afe469d963a2755fad6a94c", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>