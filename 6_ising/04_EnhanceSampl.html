
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix A: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.915 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.25641026,  0.56410256,  0.76923077,  1.17948718,  1.53846154,
         3.02564103,  4.51282051,  8.56410256, 15.48717949, 15.38461538]),
 array([0.72  , 0.7395, 0.759 , 0.7785, 0.798 , 0.8175, 0.837 , 0.8565,
        0.876 , 0.8955, 0.915 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "05213570d1c145cb993dfb0595992f6e"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0004729854820509484
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "766ce5c7730a4e339d5b2b9af750dadf"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fc557d27b50&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "846c9e5127a54bcbb57232d37a8cc56b"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"afc6e0f662c7498d90a63e607ae60ce6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "05213570d1c145cb993dfb0595992f6e": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_57ddaece0f1c44f9938926317a82194b", "IPY_MODEL_98407478e23b4c609399b805b923a9d9"], "layout": "IPY_MODEL_afc6e0f662c7498d90a63e607ae60ce6"}}, "4c55560c660e4a13b7336b81323bd881": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "38ec94847fbb4439855aa9a6e31b21e4": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "57ddaece0f1c44f9938926317a82194b": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_4c55560c660e4a13b7336b81323bd881", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_38ec94847fbb4439855aa9a6e31b21e4", "value": 1}}, "0ee5cd2291c84db997fba68cb7c772ac": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "98407478e23b4c609399b805b923a9d9": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_0ee5cd2291c84db997fba68cb7c772ac", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "a800b1c204e7423b8709d39cfc2166a0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "766ce5c7730a4e339d5b2b9af750dadf": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_a4f76196bdad4c7c84b58dbf8e3e4f78", "IPY_MODEL_e14b116d29c24a7aa8c902382852ca02"], "layout": "IPY_MODEL_a800b1c204e7423b8709d39cfc2166a0"}}, "e01e8a5bc4444f5488f92e40b256418d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d20b011c8a6c4f3296aab71de7399c64": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "a4f76196bdad4c7c84b58dbf8e3e4f78": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_e01e8a5bc4444f5488f92e40b256418d", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_d20b011c8a6c4f3296aab71de7399c64", "value": 1}}, "6756af72ccc645bfb6c32cb548cc5297": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e14b116d29c24a7aa8c902382852ca02": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_6756af72ccc645bfb6c32cb548cc5297", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "803523b6be114a49a84dc1a0d5a447f7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "846c9e5127a54bcbb57232d37a8cc56b": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_692cb5d32fcc4ce780e539077f5e689f", "IPY_MODEL_3fff90ecdbce42848336aed76a314cf5"], "layout": "IPY_MODEL_803523b6be114a49a84dc1a0d5a447f7"}}, "4e24ce9985bf447791c4736f50e4ea4f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "951e5b938b66496c9356b65297cc7f89": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "692cb5d32fcc4ce780e539077f5e689f": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_4e24ce9985bf447791c4736f50e4ea4f", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_951e5b938b66496c9356b65297cc7f89", "value": 1}}, "dd01f0c0220e414da25a0f4772fa7063": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3fff90ecdbce42848336aed76a314cf5": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_dd01f0c0220e414da25a0f4772fa7063", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>