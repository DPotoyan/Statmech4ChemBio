
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix A: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.955 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.46153846,  0.15384615,  1.02564103,  1.33333333,  2.76923077,
         4.30769231,  5.94871795, 11.94871795, 14.46153846,  8.87179487]),
 array([0.76  , 0.7795, 0.799 , 0.8185, 0.838 , 0.8575, 0.877 , 0.8965,
        0.916 , 0.9355, 0.955 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "9bc8de58bd4f4d299fa4e151202787c5"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0008022370203827257
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "9fc904a33ceb420c86c7af5039f71c92"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f7c70e77290&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "f7dc2dd580ee42e491062f9498b65914"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"70e07fdf4c2840f8aaad811c630cbbc8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9bc8de58bd4f4d299fa4e151202787c5": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_4fb9ae07c01142f294327cc46e8d34ab", "IPY_MODEL_45d52b02dbe941dbb633d1fd32c09daa"], "layout": "IPY_MODEL_70e07fdf4c2840f8aaad811c630cbbc8"}}, "e84066a4ae4f4dd092a26dcb886b9198": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4627ecbd24504c31a76e4c275bcfc494": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "4fb9ae07c01142f294327cc46e8d34ab": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_e84066a4ae4f4dd092a26dcb886b9198", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_4627ecbd24504c31a76e4c275bcfc494", "value": 1}}, "36246d47767945bc80b86713f7410d64": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "45d52b02dbe941dbb633d1fd32c09daa": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_36246d47767945bc80b86713f7410d64", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "b3bc5b556bcb46cebfea8be112f3b9b4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9fc904a33ceb420c86c7af5039f71c92": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_3045d461d7ea413d9dd0a353d0544939", "IPY_MODEL_8678e66d7423456cb445da16aefa1d92"], "layout": "IPY_MODEL_b3bc5b556bcb46cebfea8be112f3b9b4"}}, "800330bca3a445c7a9df4cf373995fe2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8f052c6cccda44b2b9d2c8f105b77833": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "3045d461d7ea413d9dd0a353d0544939": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_800330bca3a445c7a9df4cf373995fe2", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_8f052c6cccda44b2b9d2c8f105b77833", "value": 1}}, "e720f004f1ae40a593e582b4d01c39cb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8678e66d7423456cb445da16aefa1d92": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_e720f004f1ae40a593e582b4d01c39cb", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "225118831ae1478ab61b57542dd4a080": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f7dc2dd580ee42e491062f9498b65914": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_96e6045b30f8437796cb8fcf5ba9ca4f", "IPY_MODEL_9ceb0a50c2bf41c79ef07e2cd4daf21f"], "layout": "IPY_MODEL_225118831ae1478ab61b57542dd4a080"}}, "f271fbb364c44ce2adb0f31d96ccae67": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b92e321b94174bb786a07e1e20d76e04": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "96e6045b30f8437796cb8fcf5ba9ca4f": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_f271fbb364c44ce2adb0f31d96ccae67", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_b92e321b94174bb786a07e1e20d76e04", "value": 1}}, "d7d4f66b74274d51b8f85841141a5129": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9ceb0a50c2bf41c79ef07e2cd4daf21f": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_d7d4f66b74274d51b8f85841141a5129", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>