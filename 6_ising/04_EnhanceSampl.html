
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix A: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.945 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.42105263,  0.42105263,  0.68421053,  1.36842105,  1.73684211,
         3.73684211,  6.57894737, 10.94736842, 14.63157895, 12.10526316]),
 array([0.755, 0.774, 0.793, 0.812, 0.831, 0.85 , 0.869, 0.888, 0.907,
        0.926, 0.945]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "693b2fe2aeca4d808bf5675f15aef836"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0009934137511180014
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "e588f2f7744f479f8f2bf2701a1eda5b"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f60fe0a4f90&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "4900bce6144a4e8f9f80dd68c949a4ae"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"429113662d9a449085f466f51fb37048": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "693b2fe2aeca4d808bf5675f15aef836": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_322835bb414d4f51acfb01afe5289bce", "IPY_MODEL_8b23da8dc4964fd0a844c02c7860b69b"], "layout": "IPY_MODEL_429113662d9a449085f466f51fb37048"}}, "e9cfd7542668439fbb819fd41dc07433": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e4e50f89670d454bac79a0a76e7f052a": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "322835bb414d4f51acfb01afe5289bce": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_e9cfd7542668439fbb819fd41dc07433", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_e4e50f89670d454bac79a0a76e7f052a", "value": 1}}, "763b36ea14954781959a20ea46aadd5e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8b23da8dc4964fd0a844c02c7860b69b": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_763b36ea14954781959a20ea46aadd5e", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "e62bac904ada4bd2be882f584fc5e05a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e588f2f7744f479f8f2bf2701a1eda5b": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_3c5f58c42f92412aa64305f3204d6c03", "IPY_MODEL_af9042a3d99948c7b8818ff04ddcc16b"], "layout": "IPY_MODEL_e62bac904ada4bd2be882f584fc5e05a"}}, "18457784b8d94a4ea44f88db1803bd5c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7a247f364ef446e985ede4c616cc2353": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "3c5f58c42f92412aa64305f3204d6c03": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_18457784b8d94a4ea44f88db1803bd5c", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_7a247f364ef446e985ede4c616cc2353", "value": 1}}, "98ad27fe05814181892ac1ea577a2a70": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "af9042a3d99948c7b8818ff04ddcc16b": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_98ad27fe05814181892ac1ea577a2a70", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "321abdcdc8ef422b8896f04c84250ba7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4900bce6144a4e8f9f80dd68c949a4ae": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_0a9abe310fc843688b950817c1209092", "IPY_MODEL_4b1343a63fa94af6afa0bf54addeac32"], "layout": "IPY_MODEL_321abdcdc8ef422b8896f04c84250ba7"}}, "15f37ca987044949ac9501330fe386d3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b914888b613b44569adbdfafcdebf671": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "0a9abe310fc843688b950817c1209092": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_15f37ca987044949ac9501330fe386d3", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_b914888b613b44569adbdfafcdebf671", "value": 1}}, "be8569e57b784193bdca1d74754a3cce": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4b1343a63fa94af6afa0bf54addeac32": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_be8569e57b784193bdca1d74754a3cce", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>