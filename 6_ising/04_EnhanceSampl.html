
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix A: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.15384615,  0.1025641 ,  0.46153846,  0.66666667,  1.79487179,
         2.35897436,  4.        ,  8.92307692, 15.17948718, 17.64102564]),
 array([0.705 , 0.7245, 0.744 , 0.7635, 0.783 , 0.8025, 0.822 , 0.8415,
        0.861 , 0.8805, 0.9   ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "f2a7e7e9a3df461284b4a5959437cb3b"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0004763083518349206
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "79b2deeb2752486f96cccb8e162af106"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f947689e2d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "4df80714e9c649d4af47c72f89ce62d1"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"43faeb6620234b5bb9e9ce23e5260f82": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f2a7e7e9a3df461284b4a5959437cb3b": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_ca3d3abf2f3d44c4a310ba8f8447cc23", "IPY_MODEL_8f4887d50cad483bbb92927f259c3ebe"], "layout": "IPY_MODEL_43faeb6620234b5bb9e9ce23e5260f82"}}, "8c50dbb54bd14b31b63ef2fa2275558c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8c67602c25c048728cc2432496bb4d9a": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "ca3d3abf2f3d44c4a310ba8f8447cc23": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_8c50dbb54bd14b31b63ef2fa2275558c", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_8c67602c25c048728cc2432496bb4d9a", "value": 1}}, "75bbc43a323144f183d6a5e194d1bb2e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8f4887d50cad483bbb92927f259c3ebe": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_75bbc43a323144f183d6a5e194d1bb2e", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "47f0d7f7e2a84aafaa0e2a5bb002e774": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "79b2deeb2752486f96cccb8e162af106": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_1b2373ddd03d4086ba8b785ac5df74ce", "IPY_MODEL_0413f915b2d5481985ac453d0e97c3d8"], "layout": "IPY_MODEL_47f0d7f7e2a84aafaa0e2a5bb002e774"}}, "e98dccba21434b0085259f9461a85e00": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d6c827097341423891adabe3b85575b6": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "1b2373ddd03d4086ba8b785ac5df74ce": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_e98dccba21434b0085259f9461a85e00", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_d6c827097341423891adabe3b85575b6", "value": 1}}, "56e33781bebe4b969c2dab1e73807450": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0413f915b2d5481985ac453d0e97c3d8": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_56e33781bebe4b969c2dab1e73807450", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "991a037647cd4fbbbcf6ce7240c27baf": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4df80714e9c649d4af47c72f89ce62d1": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_80690054d71a44acb0c740a717e2f995", "IPY_MODEL_b7421296becf487c8e388a374ca59ea1"], "layout": "IPY_MODEL_991a037647cd4fbbbcf6ce7240c27baf"}}, "7e4cf817276f406bb5fcc6640bb95494": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cd061ce280474cc8a4919e528d785076": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "80690054d71a44acb0c740a717e2f995": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_7e4cf817276f406bb5fcc6640bb95494", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_cd061ce280474cc8a4919e528d785076", "value": 1}}, "267f3265e30c4047bf35f753b7d6f91c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b7421296becf487c8e388a374ca59ea1": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_267f3265e30c4047bf35f753b7d6f91c", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "iVBORw0KGgoAAAANSUhEUgAAAd4AAAHSCAYAAABCXKq4AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAaYklEQVR4nO3df4xl51kf8O9Tr5MowSH+EUzWdjBQEylByRJWa2gDCjV4HSvCgFJqCxUDqZZQUhGpFUqLFBD9pxQBKg0iNcRKQBCiAgYLHCauQTJIxMnGGjsOSWxjjOxdY4NNbYIJweHpH3O3nY7veMcz974zZ/bzka7m3PO+9z3P+TXfPWfuvVvdHQBgjH+y2wUAwJlE8ALAQIIXAAYSvAAwkOAFgIEELwAMdGC3C5jngvPO6ksvOXvh495794sXPuZXvfbphY+5TMvYBqxZ1rEwpX02tfNhSqZ0HCTTOhaWsW0/l7/N5/vva15b7cXP8R5+3Yv6oyuXLHzcowcPLXzMlZOrCx9zmZaxDVizrGNhSvtsaufDlEzpOEimdSwsY9ve0bflqX5ibvC61QwAAwleABhI8ALAQIIXAAYSvAAw0I6Ct6quqqrPVNX9VfXOOe0vrKoPztrvqKpLd7I8AJi6bQdvVZ2V5OeSvCnJq5NcV1Wv3tDtrUn+urv/aZKfSfIT210eAOwHO7niPZLk/u5+oLs/n+TXklyzoc81Sd4/m/71JFdU1dzPNQHAmWAnwXtRkofWPX94Nm9un+5+JsmTSc7fwTIBYNL2zJurqupYVR2vquN/+fgXdrscAFiKnQTviSTrv9fx4tm8uX2q6kCSL07y+LzBuvuG7j7c3Ydffv5ZOygLAPaunQTvx5JcVlVfXlUvSHJtkps39Lk5yfWz6bck+f3ei18ODQCDbPt/J+ruZ6rq7UlWkpyV5Mbu/mRV/XiS4919c5L3Jvnlqro/yRNZC2cAOGPt6L8F7O5bktyyYd671k1/Lsm/3MkyAGA/2TNvrgKAM4HgBYCBBC8ADCR4AWAgwQsAAwleABhoRx8nmpqVk6sLH/PowUMLH3OZlrENlmVq23ZKlnUcTG2fTel8WBbHwnK2wZGjT2/a5ooXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADHRgtwsY6ejBQwsfc+Xk6sLHTJZT6zLZtssbdxnbYUq1JtPbZ8swtW27DFPaBvf245u2ueIFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBth28VXVJVf1BVf1JVX2yqn5oTp83VtWTVbU6e7xrZ+UCwLQd2MFrn0ny77v7zqo6J8nHq+rW7v6TDf3+sLvfvIPlAMC+se0r3u5+pLvvnE3/TZJPJbloUYUBwH60kL/xVtWlSb4myR1zmr++qu6qqg9V1WsWsTwAmKqd3GpOklTVFyX5jSTv6O6nNjTfmeTLuvuzVXV1kt9Kctkm4xxLcixJXpQX5+jBQzstbYip1DlFtu30LGufrZxcXcq4y6h3WbUuy5S27X6xoyveqjo7a6H7K939mxvbu/up7v7sbPqWJGdX1QXzxuruG7r7cHcfPjsv3ElZALBn7eRdzZXkvUk+1d0/vUmfL531S1UdmS3v8e0uEwCmbie3mv95kn+d5BNVtTqb95+SvDJJuvs9Sd6S5Aeq6pkkf5fk2u7uHSwTACZt28Hb3X+UpE7T591J3r3dZQDAfuObqwBgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYKADu13APF/12qezsrK68HGPHjy08DGXZeXk6m6XsG8ta9tO6fhaFtt2ebVO7XfC1OodyRUvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAB3a7gJFWTq7udgk8D8vaX0cPHlrKuCyPY4FkeftrGcfXkaNPb9rmihcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAPtOHir6sGq+kRVrVbV8TntVVU/W1X3V9XdVfX6nS4TAKZqUZ/j/abu/qtN2t6U5LLZ4/IkPz/7CQBnnBG3mq9J8ku95iNJXlZVrxiwXADYcxYRvJ3kw1X18ao6Nqf9oiQPrXv+8GweAJxxFnGr+Q3dfaKqviTJrVX16e6+/fkOMgvtY0nyyovOqG+yBOAMsuMr3u4+Mfv5WJKbkhzZ0OVEkkvWPb94Nm/jODd09+HuPvzy88/aaVkAsCftKHir6iVVdc6p6SRXJrlnQ7ebk3z37N3NX5fkye5+ZCfLBYCp2uk93QuT3FRVp8b61e7+vap6W5J093uS3JLk6iT3J3k6yffucJkAMFk7Ct7ufiDJ6+bMf8+66U7ygztZDgDsF765CgAGErwAMJDgBYCBBC8ADCR4AWCgWnvT8d7y0jqvL68rFj7uysnVhY959OChhY+ZLKfWZHr1Tsmytu0yTG1/OW5JpnWO3dG35al+oua1ueIFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABiounu3a3iWl9Z5fXldsdtl7KqVk6u7XcLzcvTgod0ugX1sSufDss6FKW2DZDnbYUrb4MjRh3L8rs/VvDZXvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMNC2g7eqXlVVq+seT1XVOzb0eWNVPbmuz7t2XDEATNiB7b6wuz+T5FCSVNVZSU4kuWlO1z/s7jdvdzkAsJ8s6lbzFUn+tLv/fEHjAcC+tKjgvTbJBzZp+/qququqPlRVr1nQ8gBgkqq7dzZA1QuSnEzymu5+dEPbS5P8Y3d/tqquTvLfuvuyTcY5luRYkrzyogNf+2fHL91RXVN39OCh3S7heVk5ubrbJWyZbbs8y9q2U9oGyzK14/ZMd0fflqf6iZrXtogr3jcluXNj6CZJdz/V3Z+dTd+S5OyqumDeIN19Q3cf7u7DLz//rAWUBQB7zyKC97pscpu5qr60qmo2fWS2vMcXsEwAmKRtv6s5SarqJUm+Jcn3r5v3tiTp7vckeUuSH6iqZ5L8XZJre6f3tgFgwnYUvN39t0nO3zDvPeum353k3TtZBgDsJ765CgAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABqru3u0anuWldV5fXlfsdhlbsnJydbdL2BOOHjy08DGXtW2XUWsyvXqXYWrnw5SO22WZ2vmwDMvYBnf0bXmqn6h5ba54AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwEAHdruAeb7qtU9nZWV14eMePXho4WOyZuXk6sLHXNb+WkatieNrmaZ0LEyp1mWO63zYnCteABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYKAtBW9V3VhVj1XVPevmnVdVt1bVfbOf527y2utnfe6rqusXVTgATNFWr3jfl+SqDfPemeS27r4syW2z5/+fqjovyY8muTzJkSQ/ullAA8CZYEvB2923J3liw+xrkrx/Nv3+JN8256VHk9za3U90918nuTXPDnAAOGPs5G+8F3b3I7Ppv0hy4Zw+FyV5aN3zh2fznqWqjlXV8ao6/pePf2EHZQHA3rWQN1d1dyfpHY5xQ3cf7u7DLz//rEWUBQB7zk6C99GqekWSzH4+NqfPiSSXrHt+8WweAJyRdhK8Nyc59S7l65P89pw+K0murKpzZ2+qunI2DwDOSFv9ONEHkvxxkldV1cNV9dYk/yXJt1TVfUm+efY8VXW4qn4xSbr7iST/OcnHZo8fn80DgDPSlv4/3u6+bpOmK+b0PZ7k36x7fmOSG7dVHQDsM765CgAGErwAMJDgBYCBBC8ADCR4AWCgWvvSqb3lpXVeX17PesP0GWXl5OpSxj168NBSxl1WvSxnn01tfzlul7cNlmVK23YZjhx9KMfv+lzNa3PFCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAw0IHdLmCklZOru13Clh09eGi3S3heplbvMkzp+AL+n2X8/rq3H9+0zRUvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMdNrgraobq+qxqrpn3byfrKpPV9XdVXVTVb1sk9c+WFWfqKrVqjq+wLoBYJK2csX7viRXbZh3a5Kv7u7XJrk3yX98jtd/U3cf6u7D2ysRAPaP0wZvd9+e5IkN8z7c3c/Mnn4kycVLqA0A9p1F/I33+5J8aJO2TvLhqvp4VR1bwLIAYNKqu0/fqerSJL/T3V+9Yf6PJDmc5Dt6zkBVdVF3n6iqL8na7el/N7uCnreMY0mOJckrLzrwtX92/NLnuSrspqMHDy18zJWTqwsfkzXL2F8s19TOhykdY8vYtkeOPpTjd32u5rVt+4q3qr4nyZuTfNe80E2S7j4x+/lYkpuSHNlsvO6+obsPd/fhl59/1nbLAoA9bVvBW1VXJfnhJN/a3U9v0uclVXXOqekkVya5Z15fADhTbOXjRB9I8sdJXlVVD1fVW5O8O8k5SW6dfVToPbO+B6vqltlLL0zyR1V1V5KPJvnd7v69pawFAEzEgdN16O7r5sx+7yZ9Tya5ejb9QJLX7ag6ANhnfHMVAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEO7HYBIx09eGi3S9h1KydXd7uELZva/lrWtp3SdrANpnWOLdMytsOyjoNljHtvP75pmyteABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBDux2AfPce/eLc/TgoYWPu3JydeFjLqPOZDm1slxTOhaWVeuyLOt8mNJ2mFKtid9hz8UVLwAMJHgBYCDBCwADCV4AGEjwAsBAghcABjpt8FbVjVX1WFXds27ej1XViapanT2u3uS1V1XVZ6rq/qp65yILB4Ap2soV7/uSXDVn/s9096HZ45aNjVV1VpKfS/KmJK9Ocl1VvXonxQLA1J02eLv79iRPbGPsI0nu7+4HuvvzSX4tyTXbGAcA9o2d/I337VV19+xW9Llz2i9K8tC65w/P5gHAGWu7wfvzSb4yyaEkjyT5qZ0WUlXHqup4VR3/h/z9TocDgD1pW8Hb3Y929xe6+x+T/ELWbitvdCLJJeueXzybt9mYN3T34e4+fHZeuJ2yAGDP21bwVtUr1j399iT3zOn2sSSXVdWXV9ULklyb5ObtLA8A9ovT/u9EVfWBJG9MckFVPZzkR5O8saoOJekkDyb5/lnfg0l+sbuv7u5nqurtSVaSnJXkxu7+5DJWAgCm4rTB293XzZn93k36nkxy9brntyR51keNAOBM5ZurAGAgwQsAAwleABhI8ALAQIIXAAYSvAAwUHX3btfwLC+t8/ryumLh466cXF34mFNz9OCh3S5h31rW8WWfsUxTOm6n9Dv8yNGHcvyuz9W8Nle8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADHdjtAhhr5eTqbpewZUcPHlrKuFPaBsuyrG2wrH3G8kzpPJtSrc/FFS8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAx04HQdqurGJG9O8lh3f/Vs3geTvGrW5WVJ/nd3H5rz2geT/E2SLyR5prsPL6RqAJio0wZvkvcleXeSXzo1o7v/1anpqvqpJE8+x+u/qbv/arsFAsB+ctrg7e7bq+rSeW1VVUm+M8m/WHBdALAvbeWK97l8Q5JHu/u+Tdo7yYerqpP8j+6+YbOBqupYkmNJ8sqLDmTl+OoOS3u2owcPLXzMlZOrCx8zWU6tyfLqXYapbdtlsc+mt8+mZErH136x0+C9LskHnqP9Dd19oqq+JMmtVfXp7r59XsdZKN+QJIdf96LeYV0AsCdt+13NVXUgyXck+eBmfbr7xOznY0luSnJku8sDgP1gJx8n+uYkn+7uh+c1VtVLquqcU9NJrkxyzw6WBwCTd9rgraoPJPnjJK+qqoer6q2zpmuz4TZzVR2sqltmTy9M8kdVdVeSjyb53e7+vcWVDgDTs5V3NV+3yfzvmTPvZJKrZ9MPJHndDusDgH3FN1cBwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGOjAbhcwz713vzhHDx5a+LgrJ1cXPuayTKnWJEvZX8uyrG27rG1wpp8LybT22ZRqXaap1TuSK14AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIGqu3e7hmepqr9M8udb6HpBkr9acjm7Zb+u235dr2T/rpv1mp79um5TWq8v6+6Xz2vYk8G7VVV1vLsP73Ydy7Bf122/rleyf9fNek3Pfl23/bJebjUDwECCFwAGmnrw3rDbBSzRfl23/bpeyf5dN+s1Pft13fbFek36b7wAMDVTv+IFgEmZRPBW1VVV9Zmqur+q3jmn/YVV9cFZ+x1VdekulPm8VdUlVfUHVfUnVfXJqvqhOX3eWFVPVtXq7PGu3aj1+aqqB6vqE7Oaj89pr6r62dk+u7uqXr8bdT4fVfWqdfthtaqeqqp3bOgzmf1VVTdW1WNVdc+6eedV1a1Vdd/s57mbvPb6WZ/7qur6cVWf3ibr9ZNV9enZsXZTVb1sk9c+53G72zZZtx+rqhPrjrmrN3ntc/4e3U2brNcH163Tg1W1uslr9/Q+m6u79/QjyVlJ/jTJVyR5QZK7krx6Q59/m+Q9s+lrk3xwt+ve4rq9IsnrZ9PnJLl3zrq9Mcnv7Hat21i3B5Nc8BztVyf5UJJK8nVJ7tjtmp/n+p2V5C+y9lm9Se6vJN+Y5PVJ7lk3778meeds+p1JfmLO685L8sDs57mz6XN3e31Os15XJjkwm/6Jees1a3vO43a3H5us248l+Q+ned1pf4/utfXa0P5TSd41xX027zGFK94jSe7v7ge6+/NJfi3JNRv6XJPk/bPpX09yRVXVwBq3pbsf6e47Z9N/k+RTSS7a3aqGuSbJL/WajyR5WVW9YreLeh6uSPKn3b2VL3rZk7r79iRPbJi9/lx6f5Jvm/PSo0lu7e4nuvuvk9ya5Kpl1fl8zVuv7v5wdz8ze/qRJBcPL2wBNtlnW7GV36O75rnWa/a7/DuTfGBoUUs0heC9KMlD654/nGeH0//tMzu5nkxy/pDqFmR2e/xrktwxp/nrq+quqvpQVb1mbGXb1kk+XFUfr6pjc9q3sl/3smuz+S+CKe6vUy7s7kdm03+R5MI5faa+774va3db5jndcbtXvX12G/3GTf48MOV99g1JHu3u+zZpn9w+m0Lw7ntV9UVJfiPJO7r7qQ3Nd2btdubrkvz3JL81uLztekN3vz7Jm5L8YFV9424XtChV9YIk35rkf85pnur+epZeu4+3rz72UFU/kuSZJL+ySZcpHrc/n+QrkxxK8kjWbsvuJ9flua92J7fPphC8J5Jcsu75xbN5c/tU1YEkX5zk8SHV7VBVnZ210P2V7v7Nje3d/VR3f3Y2fUuSs6vqgsFlPm/dfWL287EkN2XtVtd6W9mve9WbktzZ3Y9ubJjq/lrn0VO3/Gc/H5vTZ5L7rqq+J8mbk3zX7B8Vz7KF43bP6e5Hu/sL3f2PSX4h82ue6j47kOQ7knxwsz5T3GdTCN6PJbmsqr58dqVxbZKbN/S5Ocmpd1a+Jcnvb3Zi7SWzv128N8mnuvunN+nzpaf+Xl1VR7K2z/b0Pyqq6iVVdc6p6ay9seWeDd1uTvLds3c3f12SJ9fd4tzrNv0X+BT31wbrz6Xrk/z2nD4rSa6sqnNntzWvnM3bs6rqqiQ/nORbu/vpTfps5bjdcza8N+LbM7/mrfwe3Yu+Ocmnu/vheY1T3We7/u6urTyy9g7Ye7P2rrwfmc378aydREnyoqzd9rs/yUeTfMVu17zF9XpD1m7l3Z1kdfa4Osnbkrxt1uftST6ZtXchfiTJP9vturewXl8xq/euWe2n9tn69aokPzfbp59Icni3697iur0ka0H6xevmTXJ/Ze0fD48k+Yes/c3vrVl7b8RtSe5L8r+SnDfrezjJL6577ffNzrf7k3zvbq/LFtbr/qz9jfPUeXbqUxAHk9zyXMftXnpssm6/PDuH7s5amL5i47rNnj/r9+heecxbr9n89506t9b1ndQ+m/fwzVUAMNAUbjUDwL4heAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCB/g8Uk8pMkn8TsAAAAABJRU5ErkJggg==\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>