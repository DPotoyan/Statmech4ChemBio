
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.36363636,  0.48484848,  0.60606061,  1.87878788,  1.57575758,
         4.12121212,  6.72727273,  9.15151515, 16.18181818, 19.51515152]),
 array([0.735 , 0.7515, 0.768 , 0.7845, 0.801 , 0.8175, 0.834 , 0.8505,
        0.867 , 0.8835, 0.9   ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "d42a41823c234446957cf1a186b84d52"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.0011728134586809539
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "9841500b134049248024387f3a75046d"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fb0eb5c4910&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "ccc0d7627f874a40b4018cedfeb14772"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"7f2b12ef9dbb471aa207b191a517f24c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d42a41823c234446957cf1a186b84d52": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_993717a551b94837a237abebb4529513", "IPY_MODEL_7efa9ceabad843c791e5d9cdc67d0fe2"], "layout": "IPY_MODEL_7f2b12ef9dbb471aa207b191a517f24c"}}, "1f49f36ff9f24bf3aae7398608213842": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "24cb867a7da643cfad99ae375865f959": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "993717a551b94837a237abebb4529513": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_1f49f36ff9f24bf3aae7398608213842", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_24cb867a7da643cfad99ae375865f959", "value": 1}}, "dc1d67f23de849228f7be56d4e5e5262": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7efa9ceabad843c791e5d9cdc67d0fe2": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_dc1d67f23de849228f7be56d4e5e5262", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "9d6f6b1115d3494c83f32693287e66d0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9841500b134049248024387f3a75046d": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_c972e3fac16a44678c81e02b52358bf7", "IPY_MODEL_f6e5e4a8d15148ba90c4556a609e70df"], "layout": "IPY_MODEL_9d6f6b1115d3494c83f32693287e66d0"}}, "519b32ad5b1e478b91510ffe1b453861": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "85094dabff114b9a92533a80778a517d": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "c972e3fac16a44678c81e02b52358bf7": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_519b32ad5b1e478b91510ffe1b453861", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_85094dabff114b9a92533a80778a517d", "value": 1}}, "f43c89898b184bfe818840aa85715255": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f6e5e4a8d15148ba90c4556a609e70df": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_f43c89898b184bfe818840aa85715255", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "e91fa0249aa04834b482c2bab4c9734f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ccc0d7627f874a40b4018cedfeb14772": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_89e51566f6cb4f3db6664dd6c2d8b238", "IPY_MODEL_9d74da65b2454823a745688aebe7d321"], "layout": "IPY_MODEL_e91fa0249aa04834b482c2bab4c9734f"}}, "175cc7c6d2934dd18590a1264beb5008": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "43e429dd9e54458c8a4bfb703715e494": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "89e51566f6cb4f3db6664dd6c2d8b238": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_175cc7c6d2934dd18590a1264beb5008", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_43e429dd9e54458c8a4bfb703715e494", "value": 1}}, "87d5c93b29bd47ba9549911e23cd4467": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9d74da65b2454823a745688aebe7d321": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_87d5c93b29bd47ba9549911e23cd4467", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "iVBORw0KGgoAAAANSUhEUgAAAd4AAAHSCAYAAABCXKq4AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAaA0lEQVR4nO3df4xl51kf8O9Tr2MrJiZxEkLWdghQJ1KCkiVdraENKNTgcawIA0qpLVQCpFpCiUSkVigtUkD0n1IEqDSI1BArAQVjFTBYxWHiBqSARH441thxiGMby8jeNXaJqU0wJhie/jF30XT2jnc8d+47c2Y/H+lqzj3ve9/znB/3fvec+2OruwMAjPFP9roAADibCF4AGEjwAsBAghcABhK8ADCQ4AWAgQ7tdQHzPK/O6/Nzwa6P+6rXPbXrY9571/N3fcxkObWyXMs6FpZhWcfXlLYB6xwLy/F0/jpf6r+teW21H7/He2Fd1JfXFbs+7urJtV0fc+XwkV0fM1lOrSzXso6FZVjW8TWlbcA6x8JyfKI/mif78bnB61IzAAwkeAFgIMELAAMJXgAYSPACwEALBW9VXVVVn6+q+6vq3XPaz6uqm2btn6iqVy6yPACYuh0Hb1Wdk+QXkrw5yWuSXFdVr9nU7e1J/rK7/2mSn0vyUztdHgAcBIuc8R5Lcn93P9DdX0ry60mu2dTnmiQfnE3/RpIrqmru95oA4GywSPBenOShDfcfns2b26e7n0nyRJIXL7BMAJi0ffOTkVV1PMnxJDk/Z/dPjQFwcC1yxnsiyaUb7l8ymze3T1UdSvLlSb4wb7Duvr67j3b30XNz3gJlAcD+tUjwfirJZVX11VX1vCTXJrllU59bkrxtNv3WJL/f+/HHoQFgkB1fau7uZ6rqnUlWk5yT5Ibu/mxV/WSS27v7liTvT/KrVXV/ksezHs4AcNZa6D3e7r41ya2b5r1nw/TTSf7VIssAgIPEL1cBwECCFwAGErwAMJDgBYCBBC8ADCR4AWCgffOTkSOsHD6y62Ounlzb9TGXaRnbgHVTOxaYlmUdX1N6TZjSc+zYylNbtjnjBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMd2usCRlo9ubbXJWzbyuEje13Cc7KMbbusbTCl42BqprZtl3GMTW0bTKneg/Ka4IwXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAG2nHwVtWlVfUHVfUnVfXZqvqROX3eVFVPVNXa7PaexcoFgGk7tMBjn0ny77v7jqp6QZJPV9Vt3f0nm/r9YXe/ZYHlAMCBseMz3u5+pLvvmE3/VZLPJbl4twoDgINoV97jrapXJvn6JJ+Y0/yNVXVnVX24ql67G8sDgKla5FJzkqSqvizJbyZ5V3c/uan5jiRf1d1frKqrk/x2ksu2GOd4kuNJ8oqLD2X19rVFSzvNyuEjuz4m65axbVdPru36mMn0joNlbIdlbYNl7TOmd9yytYXOeKvq3KyH7oe6+7c2t3f3k939xdn0rUnOraqXzBuru6/v7qPdffSlLz5nkbIAYN9a5FPNleT9ST7X3T+7RZ+vnPVLVR2bLe8LO10mAEzdIpea/0WSf5PkM1W1Npv3n5K8Ikm6+31J3prkh6rqmSR/k+Ta7u4FlgkAk7bj4O3uP0pSZ+jz3iTv3ekyAOCg8ctVADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwUHX3Xtdwmgvror68rtjrMvbU6sm1pYy7cvjIUsZlefuM5ZnS82Fqx9eUtu0yfKI/mif78ZrX5owXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWCgQ3tdwDyvet1TWV1d2+sy9tTK4SN7XcJzsnpybdfHnNo2gGQ5zwUOFme8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYaOHgraoHq+ozVbVWVbfPaa+q+vmqur+q7qqqNyy6TACYqt36Hu+3dPdfbNH25iSXzW6XJ/nF2V8AOOuMuNR8TZJf6XUfT/LCqnr5gOUCwL6zG8HbST5SVZ+uquNz2i9O8tCG+w/P5gHAWWc3LjW/sbtPVNVXJLmtqu7p7o8910FmoX08SV5x8b78JUsAWNjCZ7zdfWL297EkNyc5tqnLiSSXbrh/yWze5nGu7+6j3X30pS8+Z9GyAGBfWih4q+qCqnrBqekkVya5e1O3W5J87+zTzd+Q5InufmSR5QLAVC16TfdlSW6uqlNj/Vp3/15VvSNJuvt9SW5NcnWS+5M8leT7F1wmAEzWQsHb3Q8kef2c+e/bMN1JfniR5QDAQeGXqwBgIMELAAMJXgAYSPACwECCFwAGOqt+Imrl8JFdH3P15Nquj7lMy6p3Stt2GbUuc9xlmNq2ndLzbGrbYGr1TsWxlae2bHPGCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAw0KG9LmCee+96flYOH9nrMngOVk+u7XUJe25K22BZz69lbYMp1Tu1164p7bMp1Xpvf2HLNme8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAw0I6Dt6peXVVrG25PVtW7NvV5U1U9saHPexauGAAm7NBOH9jdn09yJEmq6pwkJ5LcPKfrH3b3W3a6HAA4SHbrUvMVSf60u/9sl8YDgANpt4L32iQ3btH2jVV1Z1V9uKpeu0vLA4BJqu5ebICq5yU5meS13f3oprYLk/xDd3+xqq5O8t+6+7Itxjme5HiSnJ/n/7M31tUL1cVYqyfXdn3MlcNHdn3MKbJtp2UZ+ytZ3j6bWr3LsIxtcGzlodx+59M1r203znjfnOSOzaGbJN39ZHd/cTZ9a5Jzq+ol8wbp7uu7+2h3Hz035+1CWQCw/+xG8F6XLS4zV9VXVlXNpo/NlveFXVgmAEzSjj/VnCRVdUGSb0vygxvmvSNJuvt9Sd6a5Ieq6pkkf5Pk2l702jYATNhCwdvdf53kxZvmvW/D9HuTvHeRZQDAQeKXqwBgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYKDq7r2u4TRHX39+f3L10l0fd+XwkV0fc/Xk2q6PuUzL2AbLsqxtu6xtMLVjYRmmdHxNjefDtBxbeSi33/l0zWtzxgsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGqu7e6xpOc2Fd1JfXFXtdxoG0enJtr0s4sFYOH9nrErZtWcfBlLbBsti207OMfXZs5aHcfufTNa/NGS8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAw0LaCt6puqKrHquruDfMuqqrbquq+2d8XbfHYt8363FdVb9utwgFgirZ7xvuBJFdtmvfuJB/t7suSfHR2//9TVRcl+fEklyc5luTHtwpoADgbbCt4u/tjSR7fNPuaJB+cTX8wyXfMeehKktu6+/Hu/sskt+X0AAeAs8ahBR77su5+ZDb950leNqfPxUke2nD/4dm801TV8STHk+T8PH+BsgBg/9qVD1f1+g8+L/Sjz919fXcf7e6j5+a83SgLAPadRYL30ap6eZLM/j42p8+JJJduuH/JbB4AnJUWCd5bkpz6lPLbkvzOnD6rSa6sqhfNPlR15WweAJyVtvt1ohuT/HGSV1fVw1X19iT/Jcm3VdV9Sb51dj9VdbSqfjlJuvvxJP85yadmt5+czQOAs9K2PlzV3ddt0XTaf5rb3bcn+bcb7t+Q5IYdVQcAB4xfrgKAgQQvAAwkeAFgIMELAAMJXgAYaJGfjIR/tHL4yK6PuXpybdfHXKZl1buMbbsstsG0ak2m9Tyb2rbdijNeABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBDu11AfO86nVPZXV1ba/L2FMrh49MalyWt21XT64tZdxlsA2Wx3P34HDGCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAA50xeKvqhqp6rKru3jDvp6vqnqq6q6purqoXbvHYB6vqM1W1VlW372LdADBJ2znj/UCSqzbNuy3J13X365Lcm+Q/Psvjv6W7j3T30Z2VCAAHxxmDt7s/luTxTfM+0t3PzO5+PMklS6gNAA6c3XiP9weSfHiLtk7ykar6dFUd34VlAcCkHVrkwVX1Y0meSfKhLbq8sbtPVNVXJLmtqu6ZnUHPG+t4kuNJ8oqLFyprSyuHjyxlXJLVk2t7XcK2OQ5YJsfX8izrdWYZ++ze/sKWbTs+462q70vyliTf0909r093n5j9fSzJzUmObTVed1/f3Ue7++hLX3zOTssCgH1tR8FbVVcl+dEk397dT23R54KqesGp6SRXJrl7Xl8AOFts5+tENyb54ySvrqqHq+rtSd6b5AVZv3y8VlXvm/U9XFW3zh76siR/VFV3Jvlkkt/t7t9byloAwESc8c3U7r5uzuz3b9H3ZJKrZ9MPJHn9QtUBwAHjl6sAYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADHRorwuArawcPrKUcVdPri1lXJa3bad0LEzt+FrWtl2GqW3brTjjBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYqLp7r2s4zYV1UV9eV+z6uKsn13Z9zGVZOXxkKeMuaxssq15IHLeJbbBMy9i2x1Yeyu13Pl3z2pzxAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgoDMGb1XdUFWPVdXdG+b9RFWdqKq12e3qLR57VVV9vqrur6p372bhADBF2znj/UCSq+bM/7nuPjK73bq5sarOSfILSd6c5DVJrquq1yxSLABM3RmDt7s/luTxHYx9LMn93f1Ad38pya8nuWYH4wDAgbHIe7zvrKq7ZpeiXzSn/eIkD224//BsHgCctXYavL+Y5GuTHEnySJKfWbSQqjpeVbdX1e1/l79ddDgA2Jd2FLzd/Wh3/313/0OSX8r6ZeXNTiS5dMP9S2bzthrz+u4+2t1Hz815OykLAPa9HQVvVb18w93vTHL3nG6fSnJZVX11VT0vybVJbtnJ8gDgoDh0pg5VdWOSNyV5SVU9nOTHk7ypqo4k6SQPJvnBWd/DSX65u6/u7meq6p1JVpOck+SG7v7sMlYCAKbijMHb3dfNmf3+LfqeTHL1hvu3Jjntq0YAcLbyy1UAMJDgBYCBBC8ADCR4AWAgwQsAAwleABjojF8n2guvet1TWV1d2/VxVw4f2fUxV0+u7fqYTNOUjoVlPBemyD6b1jY4KJzxAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMVN291zWc5sK6qC+vK3Z93NWTa7s+JsuzcvjIUsZ1HCzPsvbZsjgWpvU8m1Ktx1Yeyu13Pl3z2pzxAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIfO1KGqbkjyliSPdffXzebdlOTVsy4vTPJ/u/vInMc+mOSvkvx9kme6++iuVA0AE3XG4E3ygSTvTfIrp2Z0978+NV1VP5PkiWd5/Ld091/stEAAOEjOGLzd/bGqeuW8tqqqJN+d5F/ucl0AcCBt54z32XxTkke7+74t2jvJR6qqk/yP7r5+q4Gq6niS40lyfp6/YFmMtnL4yF6XsOeWtQ1WT64tZVwct8nyjq8pbdtl1Hpvf2HLtkWD97okNz5L+xu7+0RVfUWS26rqnu7+2LyOs1C+PkkurIt6wboAYF/a8aeaq+pQku9KctNWfbr7xOzvY0luTnJsp8sDgINgka8TfWuSe7r74XmNVXVBVb3g1HSSK5PcvcDyAGDyzhi8VXVjkj9O8uqqeriq3j5rujabLjNX1eGqunV292VJ/qiq7kzyySS/292/t3ulA8D0bOdTzddtMf/75sw7meTq2fQDSV6/YH0AcKD45SoAGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAx3a6wKmbuXwkaWMu3pybSnjTq3eZZjaNlhGvVPaX8m0tu3U2AbjOeMFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABiounuvazhNVf2fJH+2ja4vSfIXSy5nrxzUdTuo65Uc3HWzXtNzUNdtSuv1Vd390nkN+zJ4t6uqbu/uo3tdxzIc1HU7qOuVHNx1s17Tc1DX7aCsl0vNADCQ4AWAgaYevNfvdQFLdFDX7aCuV3Jw1816Tc9BXbcDsV6Tfo8XAKZm6me8ADApkwjeqrqqqj5fVfdX1bvntJ9XVTfN2j9RVa/cgzKfs6q6tKr+oKr+pKo+W1U/MqfPm6rqiapam93esxe1PldV9WBVfWZW8+1z2quqfn62z+6qqjfsRZ3PRVW9esN+WKuqJ6vqXZv6TGZ/VdUNVfVYVd29Yd5FVXVbVd03+/uiLR77tlmf+6rqbeOqPrMt1uunq+qe2bF2c1W9cIvHPutxu9e2WLefqKoTG465q7d47LO+ju6lLdbrpg3r9GBVrW3x2H29z+bq7n19S3JOkj9N8jVJnpfkziSv2dTn3yV532z62iQ37XXd21y3lyd5w2z6BUnunbNub0ryv/a61h2s24NJXvIs7Vcn+XCSSvINST6x1zU/x/U7J8mfZ/27epPcX0m+Ockbkty9Yd5/TfLu2fS7k/zUnMddlOSB2d8XzaZftNfrc4b1ujLJodn0T81br1nbsx63e33bYt1+Isl/OMPjzvg6ut/Wa1P7zyR5zxT32bzbFM54jyW5v7sf6O4vJfn1JNds6nNNkg/Opn8jyRVVVQNr3JHufqS775hN/1WSzyW5eG+rGuaaJL/S6z6e5IVV9fK9Luo5uCLJn3b3dn7oZV/q7o8leXzT7I3PpQ8m+Y45D11Jclt3P97df5nktiRXLavO52reenX3R7r7mdndjye5ZHhhu2CLfbYd23kd3TPPtl6z1/LvTnLj0KKWaArBe3GShzbcfzinh9M/9pk9uZ5I8uIh1e2S2eXxr0/yiTnN31hVd1bVh6vqtWMr27FO8pGq+nRVHZ/Tvp39up9dm61fCKa4v055WXc/Mpv+8yQvm9Nn6vvuB7J+tWWeMx23+9U7Z5fRb9ji7YEp77NvSvJod9+3Rfvk9tkUgvfAq6ovS/KbSd7V3U9uar4j65czX5/kvyf57cHl7dQbu/sNSd6c5Ier6pv3uqDdUlXPS/LtSf7nnOap7q/T9Pp1vAP1tYeq+rEkzyT50BZdpnjc/mKSr01yJMkjWb8se5Bcl2c/253cPptC8J5IcumG+5fM5s3tU1WHknx5ki8MqW5BVXVu1kP3Q939W5vbu/vJ7v7ibPrWJOdW1UsGl/mcdfeJ2d/Hktyc9UtdG21nv+5Xb05yR3c/urlhqvtrg0dPXfKf/X1sTp9J7ruq+r4kb0nyPbN/VJxmG8ftvtPdj3b333f3PyT5pcyvear77FCS70py01Z9prjPphC8n0pyWVV99exM49okt2zqc0uSU5+sfGuS39/qibWfzN67eH+Sz3X3z27R5ytPvV9dVceyvs/29T8qquqCqnrBqemsf7Dl7k3dbknyvbNPN39Dkic2XOLc77b8F/gU99cmG59Lb0vyO3P6rCa5sqpeNLuseeVs3r5VVVcl+dEk397dT23RZzvH7b6z6bMR35n5NW/ndXQ/+tYk93T3w/Map7rP9vzTXdu5Zf0TsPdm/VN5Pzab95NZfxIlyflZv+x3f5JPJvmava55m+v1xqxfyrsrydrsdnWSdyR5x6zPO5N8NuufQvx4kn++13VvY72+ZlbvnbPaT+2zjetVSX5htk8/k+ToXte9zXW7IOtB+uUb5k1yf2X9Hw+PJPm7rL/n9/asfzbio0nuS/K/k1w063s0yS9veOwPzJ5v9yf5/r1el22s1/1Zf4/z1PPs1LcgDie59dmO2/1022LdfnX2HLor62H68s3rNrt/2uvofrnNW6/Z/A+cem5t6DupfTbv5perAGCgKVxqBoADQ/ACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAA/0/OqKUZdYpmgEAAAAASUVORK5CYII=\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>