
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix A: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.845 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.41025641,  0.66666667,  0.61538462,  1.02564103,  2.25641026,
         2.97435897,  4.46153846,  8.92307692, 14.05128205, 15.8974359 ]),
 array([0.65  , 0.6695, 0.689 , 0.7085, 0.728 , 0.7475, 0.767 , 0.7865,
        0.806 , 0.8255, 0.845 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "c6a00c96c4bb4162a3208317cb1aa7dc"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.000782215634695348
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "1d36124e32df43119c573fc60891062e"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f940023d7d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "d445dfcb09db4db2a8c043fff0971bcb"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"d63dfd08d46b46bd8990059b687da3be": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c6a00c96c4bb4162a3208317cb1aa7dc": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_4e81488c2c684e898823fddc243d0bf2", "IPY_MODEL_946d95936bfa4ac09545c1e40a025a88"], "layout": "IPY_MODEL_d63dfd08d46b46bd8990059b687da3be"}}, "cd003b136c7d401cbed5c1850979504d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a2ce611dcb294b8cbfb36e148fdfbb2b": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "4e81488c2c684e898823fddc243d0bf2": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_cd003b136c7d401cbed5c1850979504d", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_a2ce611dcb294b8cbfb36e148fdfbb2b", "value": 1}}, "680c8aaa5b7a467d9b69ecc8ea874220": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "946d95936bfa4ac09545c1e40a025a88": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_680c8aaa5b7a467d9b69ecc8ea874220", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "eca8d39392f14acbafa10f8d48d7d4d7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1d36124e32df43119c573fc60891062e": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_70917d909206430bbec6547cd771d365", "IPY_MODEL_8d33ffb92e2941b6832f8ff8c67c3436"], "layout": "IPY_MODEL_eca8d39392f14acbafa10f8d48d7d4d7"}}, "f38c5c4845d8427e8699c127d807eb42": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a95eeb96b89b4ee28c8cbe7f590fb8f9": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "70917d909206430bbec6547cd771d365": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_f38c5c4845d8427e8699c127d807eb42", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_a95eeb96b89b4ee28c8cbe7f590fb8f9", "value": 1}}, "d179ca3e64c04fa69bf335ab353b9fbd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8d33ffb92e2941b6832f8ff8c67c3436": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_d179ca3e64c04fa69bf335ab353b9fbd", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "af7737fe408443079db6ee0f38c62161": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d445dfcb09db4db2a8c043fff0971bcb": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_10efdc0d912443bd8f2fcd4bfd60f7ef", "IPY_MODEL_0adac67217444827a56aa67dba2c4720"], "layout": "IPY_MODEL_af7737fe408443079db6ee0f38c62161"}}, "092045fe42f54be1a47e529d031fdda3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8465108f3838475f8516c0e52b765b54": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "10efdc0d912443bd8f2fcd4bfd60f7ef": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_092045fe42f54be1a47e529d031fdda3", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_8465108f3838475f8516c0e52b765b54", "value": 1}}, "dbb3026d99b94e909647fdef8162e984": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0adac67217444827a56aa67dba2c4720": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_dbb3026d99b94e909647fdef8162e984", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>