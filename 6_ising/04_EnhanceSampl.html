
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.92 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.15384615,  0.35897436,  0.46153846,  0.71794872,  1.48717949,
         3.12820513,  6.71794872,  8.71794872, 14.87179487, 14.66666667]),
 array([0.725 , 0.7445, 0.764 , 0.7835, 0.803 , 0.8225, 0.842 , 0.8615,
        0.881 , 0.9005, 0.92  ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "51ac7edf075d48e99a9087c01eaa4e6e"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.000356543702968835
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "1c0b45015b414cffa486c3f2cab4623c"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7ff967ba2210&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "119bbfb26a3d49fcbd92811e043d12cb"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"e80ed75421af446486f20a7489dd7519": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "51ac7edf075d48e99a9087c01eaa4e6e": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_eff9798a52384dca84867bef3cdb4421", "IPY_MODEL_199541dbd2ff44ba90b66ba7bf25d118"], "layout": "IPY_MODEL_e80ed75421af446486f20a7489dd7519"}}, "d5e3ba4cfb634d78a3c832a18b809f87": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9645ebe3d34e425d95d8374d16c93c7c": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "eff9798a52384dca84867bef3cdb4421": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_d5e3ba4cfb634d78a3c832a18b809f87", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_9645ebe3d34e425d95d8374d16c93c7c", "value": 1}}, "19d19e272d46495bbcf9a2f346edb475": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "199541dbd2ff44ba90b66ba7bf25d118": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_19d19e272d46495bbcf9a2f346edb475", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "580300809acf4348aff8d790abae9445": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1c0b45015b414cffa486c3f2cab4623c": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_05410e1d3c604898a9a39d432063dd37", "IPY_MODEL_60dab6c35ae443329af16e9324c0913a"], "layout": "IPY_MODEL_580300809acf4348aff8d790abae9445"}}, "ea1cbf93257949468d599f1705d73a44": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "44156cfcb4be44c38fd8e3f0d740100f": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "05410e1d3c604898a9a39d432063dd37": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_ea1cbf93257949468d599f1705d73a44", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_44156cfcb4be44c38fd8e3f0d740100f", "value": 1}}, "a1c58775b5e44b9e8342707a61291cf5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "60dab6c35ae443329af16e9324c0913a": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_a1c58775b5e44b9e8342707a61291cf5", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "2543b37a564e49178e479d49232fb8da": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "119bbfb26a3d49fcbd92811e043d12cb": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_fc1e807bfafc4f97864a2cd87fb382db", "IPY_MODEL_91d2b14876104e50abbcd7b8be14ca58"], "layout": "IPY_MODEL_2543b37a564e49178e479d49232fb8da"}}, "4e306d4af4924d78adf2cef6636c8c36": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1a3f2eb13dfa42ffb18e4ef3d414002e": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "fc1e807bfafc4f97864a2cd87fb382db": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_4e306d4af4924d78adf2cef6636c8c36", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_1a3f2eb13dfa42ffb18e4ef3d414002e", "value": 1}}, "131a9b07f786473ebce2b33696c2adb5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "91d2b14876104e50abbcd7b8be14ca58": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_131a9b07f786473ebce2b33696c2adb5", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>