
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/02_Legendre.html">
     Legendre transform
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/ensemble_overview.html">
     Overview of ensembles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Gases
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/photons_phonons.html">
     Photons and Phonons
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/landauer.html">
     Information erasure and Landauer’s principle
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.88 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.41025641,  0.61538462,  0.97435897,  1.33333333,  1.8974359 ,
         2.41025641,  4.35897436,  8.82051282, 14.66666667, 15.79487179]),
 array([0.685 , 0.7045, 0.724 , 0.7435, 0.763 , 0.7825, 0.802 , 0.8215,
        0.841 , 0.8605, 0.88  ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "0529561a30f045a581e27cf805a46e07"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0002913554039053263
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "252edcedb08844aabe6413105a268f6b"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f5c720fb1d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "b883ae07fa554e29843eaec021d5fa88"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"8e34234ebcc94acfa370bd31eb4a0d8a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0529561a30f045a581e27cf805a46e07": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_f4e0f9b718f24eb7a260974815ec6eb1", "IPY_MODEL_31e1360076594611abcd12d37ddec189"], "layout": "IPY_MODEL_8e34234ebcc94acfa370bd31eb4a0d8a"}}, "68b7271465d742309efb2a0f6bb8b9d2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cc6020ee7ce9446ea973e1df8f84cc0f": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "f4e0f9b718f24eb7a260974815ec6eb1": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_68b7271465d742309efb2a0f6bb8b9d2", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_cc6020ee7ce9446ea973e1df8f84cc0f", "value": 1}}, "6419c7f9c8c24c45bca972ff6ffbdda1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "31e1360076594611abcd12d37ddec189": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_6419c7f9c8c24c45bca972ff6ffbdda1", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "b4a709fed5404e01b56abe88564ddebe": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "252edcedb08844aabe6413105a268f6b": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_d82ab0e42ba94dd8b4d27e7e11a597aa", "IPY_MODEL_ff8bd372236f48aabe26cd34a94ba45d"], "layout": "IPY_MODEL_b4a709fed5404e01b56abe88564ddebe"}}, "d493abbaba964325860c8d5c40cc800a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1499bad857094ee1b92e214567c7ecac": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "d82ab0e42ba94dd8b4d27e7e11a597aa": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_d493abbaba964325860c8d5c40cc800a", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_1499bad857094ee1b92e214567c7ecac", "value": 1}}, "19cc5770f37b46c8bee90474368e7e80": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ff8bd372236f48aabe26cd34a94ba45d": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_19cc5770f37b46c8bee90474368e7e80", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "213becfc2b3b447cb989afc575b727ae": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b883ae07fa554e29843eaec021d5fa88": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_bae6c8fafa244169b5f300e4f7c6d82f", "IPY_MODEL_b25458a2a008479897d25f5f7ea1d15f"], "layout": "IPY_MODEL_213becfc2b3b447cb989afc575b727ae"}}, "09461e50537e4623ad26021a64c81c8c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b2f76cc3ad054f3d8b16ebd59db35177": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "bae6c8fafa244169b5f300e4f7c6d82f": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_09461e50537e4623ad26021a64c81c8c", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_b2f76cc3ad054f3d8b16ebd59db35177", "value": 1}}, "3ec776cc7cc343ba98e727a4ae479f4a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b25458a2a008479897d25f5f7ea1d15f": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_3ec776cc7cc343ba98e727a4ae479f4a", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>