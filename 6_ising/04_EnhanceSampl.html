
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.955 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.3 ,  0.45,  0.55,  1.15,  1.9 ,  3.45,  6.1 , 10.2 , 13.3 ,
        12.6 ]),
 array([0.755, 0.775, 0.795, 0.815, 0.835, 0.855, 0.875, 0.895, 0.915,
        0.935, 0.955]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "cd44338d1c5e4de69122fe397f29b535"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0004998125744123959
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "57c04d696b834b408c72b81928585f6c"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7ff194754c50&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "f7880b8f52094bebbbaaf8ae7409c827"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"284f178b5c0d41b4ba2c2bcdfac2c775": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cd44338d1c5e4de69122fe397f29b535": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_441c2819ecb24ec7bf5623d335172ace", "IPY_MODEL_5f482f60d872409ebb9c18cfff89ef74"], "layout": "IPY_MODEL_284f178b5c0d41b4ba2c2bcdfac2c775"}}, "bbb813b4380a4de3b18cd5fc1341cf41": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cf390387586144458745cc377b2887cc": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "441c2819ecb24ec7bf5623d335172ace": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_bbb813b4380a4de3b18cd5fc1341cf41", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_cf390387586144458745cc377b2887cc", "value": 1}}, "f09c261716f54202a4a276e16feb28e6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5f482f60d872409ebb9c18cfff89ef74": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_f09c261716f54202a4a276e16feb28e6", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "aad2db14871d4fc8bc4ea1556e63fdff": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "57c04d696b834b408c72b81928585f6c": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_3a44a979127740d2bdaa7bfc62951007", "IPY_MODEL_d782ce0f89ad4f30962c637318561290"], "layout": "IPY_MODEL_aad2db14871d4fc8bc4ea1556e63fdff"}}, "119c5cdad8b54a83b3284283a21a2ea4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c105385cde044877a90e91a7557f26ec": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "3a44a979127740d2bdaa7bfc62951007": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_119c5cdad8b54a83b3284283a21a2ea4", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_c105385cde044877a90e91a7557f26ec", "value": 1}}, "ce1a2dc6027f4881bc315a37714fc5d0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d782ce0f89ad4f30962c637318561290": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_ce1a2dc6027f4881bc315a37714fc5d0", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "ec31fb4544924ccb8d7a042e6d792188": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f7880b8f52094bebbbaaf8ae7409c827": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_000c222727704158a452847d6901005a", "IPY_MODEL_2b0cbdd8d171454e970d20252c85df39"], "layout": "IPY_MODEL_ec31fb4544924ccb8d7a042e6d792188"}}, "2b59e4b06f29446c8db38ff039c4240f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d0bd0bfcf7dc4f45845ea3b6655d159f": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "000c222727704158a452847d6901005a": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_2b59e4b06f29446c8db38ff039c4240f", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_d0bd0bfcf7dc4f45845ea3b6655d159f", "value": 1}}, "90967864b9ea4e2ebd0bab38c4bee941": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2b0cbdd8d171454e970d20252c85df39": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_90967864b9ea4e2ebd0bab38c4bee941", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>