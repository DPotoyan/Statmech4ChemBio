
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/02_Legendre.html">
     Legendre transform
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/ensemble_overview.html">
     Overview of ensembles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Gases
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/photons_phonons.html">
     Photons and Phonons
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/landauer.html">
     Information erasure and Landauer’s principle
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.93 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.35897436,  0.15384615,  0.71794872,  1.07692308,  1.28205128,
         2.35897436,  6.35897436, 10.1025641 , 14.15384615, 14.71794872]),
 array([0.735 , 0.7545, 0.774 , 0.7935, 0.813 , 0.8325, 0.852 , 0.8715,
        0.891 , 0.9105, 0.93  ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "544b393b0aaf4dd680fac09fbfb74677"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0010034077791287732
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "e925ff8ebfc34eba9b7ab03d631bc0b4"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7ff5db410710&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "6c365e7ad6bf438a849b3d419bd3be9c"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"afd7fe2d4c7b40fd99b769364547812d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "544b393b0aaf4dd680fac09fbfb74677": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_bb6f0ea5dbe74cecb890c9b36e0075ae", "IPY_MODEL_6748d3b67aa64ce885425ff490bf9585"], "layout": "IPY_MODEL_afd7fe2d4c7b40fd99b769364547812d"}}, "0271e7ffc9ec4fe590c0b303c4f75c77": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5d87580fa4f6401f9a8b187477dad400": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "bb6f0ea5dbe74cecb890c9b36e0075ae": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_0271e7ffc9ec4fe590c0b303c4f75c77", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_5d87580fa4f6401f9a8b187477dad400", "value": 1}}, "74e5fd1854d04389b1f33f932ceabbfe": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6748d3b67aa64ce885425ff490bf9585": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_74e5fd1854d04389b1f33f932ceabbfe", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "723aaaedf7bd47d3b006e59737a24c4c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e925ff8ebfc34eba9b7ab03d631bc0b4": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_852847c0b3cc4299bcf677d23caad7f9", "IPY_MODEL_601d6ef1de0447a5a32a649aacf9921e"], "layout": "IPY_MODEL_723aaaedf7bd47d3b006e59737a24c4c"}}, "7cd7b1c776704e509433c9abe1f2ec4b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1fded58929604aa3a2ba633f985980be": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "852847c0b3cc4299bcf677d23caad7f9": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_7cd7b1c776704e509433c9abe1f2ec4b", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_1fded58929604aa3a2ba633f985980be", "value": 1}}, "954f21bb46284f48b1b818fd31fb3b6b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "601d6ef1de0447a5a32a649aacf9921e": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_954f21bb46284f48b1b818fd31fb3b6b", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "f0b9af91287d4fab8147e684da7c4e74": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6c365e7ad6bf438a849b3d419bd3be9c": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_7d0f69f5908f458797dfa56ad8d801e4", "IPY_MODEL_975cee67a36348a585a2a0873107af55"], "layout": "IPY_MODEL_f0b9af91287d4fab8147e684da7c4e74"}}, "d8d4e1377cc7490594e99036489f585a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1db8b2ef7c73441b82f173b42b7d679f": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "7d0f69f5908f458797dfa56ad8d801e4": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_d8d4e1377cc7490594e99036489f585a", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_1db8b2ef7c73441b82f173b42b7d679f", "value": 1}}, "1d6deb76d36844d586e5b0371f48ad18": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "975cee67a36348a585a2a0873107af55": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_1d6deb76d36844d586e5b0371f48ad18", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>