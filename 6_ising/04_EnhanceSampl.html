
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/02_Legendre.html">
     Legendre transform
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/ensemble_overview.html">
     Overview of ensembles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Gases
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/photons_phonons.html">
     Photons and Phonons
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/landauer.html">
     Information erasure and Landauer’s principle
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-in-a-nutshell">
     Simulated annealing in a nutshell
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#challanges">
       Challanges
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-in-a-nutshell">
     Simulated annealing in a nutshell
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#challanges">
       Challanges
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d_umbrella</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span> 
                <span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                <span class="n">U_k</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">U_m</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="n">n_steps</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> 
                <span class="n">out_freq</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                <span class="n">wall</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Metropolis Monte Carlo simulator of 2D Ising model with harmonic potentials for umbrella sampling</span>
<span class="sd">    ---</span>
<span class="sd">    spins:    (int, int), 2D numpy array</span>
<span class="sd">    T, J, B:  (floats), corresponding to temperature, coupling and field variables</span>
<span class="sd">    n_steps:  (int), simulation steeps</span>
<span class="sd">    out_freq: (int), How often to compute and save data</span>
<span class="sd">    U_k, U_m: (floats), spring constant and minima defining harmonic potential U_k*(M-U_m)**2</span>
<span class="sd">    wall: can alos resrict sampling by imposing walls with infinitely high energies</span>
<span class="sd">    ---</span>
<span class="sd">    Returns:</span>
<span class="sd">    E/N: per-spin energy over n steps  </span>
<span class="sd">    M/N: per-spin magnetization over n steps </span>
<span class="sd">    S:   2D spin configurations over n steps </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="c1">#### Initialize simulation</span>
    <span class="n">N</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    <span class="n">n</span>   <span class="o">=</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span>
    
    <span class="n">M_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    <span class="n">E_t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> 
            <span class="n">z</span>    <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i,(j+1)%N] + spins[i,(j-1)%N]
            <span class="n">E_t</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="n">z</span>

    <span class="c1">#### Run MC Simulation</span>
    <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
        
        <span class="c1"># Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Neighbours of spin i,j</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 

        <span class="c1">#Change in Energy of the lattice</span>
        <span class="n">dE</span>    <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="n">U_k</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">M_t</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="n">U_m</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">M_t</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="n">U_m</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>

        <span class="c1"># Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">():</span>
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            <span class="n">E_t</span>        <span class="o">+=</span> <span class="n">dE</span> 
            <span class="n">M_t</span>        <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>

        <span class="c1"># Save Thermo data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
            <span class="n">E</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
            <span class="n">S</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_US</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;N steps&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$E$&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;N steps&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$m$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;$\langle m \rangle=$</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">1000</span><span class="p">:])</span><span class="si">:</span><span class="s1">.02f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$P(m)$&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Vary umbrella potential from 0 to 1000. Study how Tc affects the U_k and U_m </span>

<span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d_umbrella</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span> 
                <span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                <span class="n">U_k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">U_m</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> 
                <span class="n">n_steps</span><span class="o">=</span><span class="mi">2000000</span><span class="p">,</span> 
                <span class="n">out_freq</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plot_US</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">E</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_13_0.png" src="../_images/04_EnhanceSampl_13_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Is a widely used Monte Carlo technique used for <strong>numerical optimization</strong> In chemical and biological applications simulated annealing is used for finding global minima of a complex multidimensional energy functions&gt;</p>
<p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p>
<div class="section" id="simulated-annealing-in-a-nutshell">
<h3>Simulated annealing in a nutshell<a class="headerlink" href="#simulated-annealing-in-a-nutshell" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Sample with metropolis algorithm where the acceptance probability takes the form <span class="math notranslate nohighlight">\(min (1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For finding maximum simply change the sign: <span class="math notranslate nohighlight">\(min (1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
<li><p><strong>“Slow cooling” is the main idea of simulated annealing</strong></p></li>
</ul>
</div>
<div class="section" id="id2">
<h3><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_19_0.png" src="../_images/04_EnhanceSampl_19_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.00048260483474811425
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_23_1.png" src="../_images/04_EnhanceSampl_23_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "3b00a79c3163495d8d4fa0f185173496"}
</script></div>
</div>
</div>
<div class="section" id="challanges">
<h4>Challanges<a class="headerlink" href="#challanges" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.</p></li>
</ul>
</li>
<li><p><strong>Parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.</p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+PT ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>    
    
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="c1">#T[i], T[j] = T[j], T[i]</span>
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">T</span><span class="p">]</span>
    
    <span class="c1"># Exchange attemps</span>
    <span class="k">for</span> <span class="n">swap_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> 
    
        <span class="n">configs</span>  <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    
        <span class="c1">#mcmc in between exchange attemp</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)):</span> 
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>        <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c1"># magnetic field</span>

<span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span>   <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span>  <span class="o">=</span> <span class="mi">10000</span>
<span class="n">out_freq</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">E2</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="n">E3</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f738b398250&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_33_1.png" src="../_images/04_EnhanceSampl_33_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "cf9d08ee356846bcb11d4ad79f2c32b3"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhance the sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancement of sampling with respect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"225fe2d138a0458b940fc0039f19db14": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3b00a79c3163495d8d4fa0f185173496": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_1dd17bb8392346ada0eb4ebea01544fd", "IPY_MODEL_d91bb5c0a94d47da96f9d5500d1fe769"], "layout": "IPY_MODEL_225fe2d138a0458b940fc0039f19db14"}}, "0a961962aa584327b3092edfa2cb3bab": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ae12fe1a32b947188eed16ca178ed4bb": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "1dd17bb8392346ada0eb4ebea01544fd": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_0a961962aa584327b3092edfa2cb3bab", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_ae12fe1a32b947188eed16ca178ed4bb", "value": 1}}, "847720649df149af99535eda45b121e6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d91bb5c0a94d47da96f9d5500d1fe769": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_847720649df149af99535eda45b121e6", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "e8e85bfb832641c690d73d2d09ca8e6b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cf9d08ee356846bcb11d4ad79f2c32b3": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_eb62eed8e97649298c2e0a5c5919d51c", "IPY_MODEL_b9390b9d7ba144348b67d57bbc7185b5"], "layout": "IPY_MODEL_e8e85bfb832641c690d73d2d09ca8e6b"}}, "113335189fde402282b13587ee063b56": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8120396c052b469e8a98ff2be3f7af0e": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "eb62eed8e97649298c2e0a5c5919d51c": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_113335189fde402282b13587ee063b56", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_8120396c052b469e8a98ff2be3f7af0e", "value": 1}}, "2b66c0a03aa94301935774c7b7e6e240": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b9390b9d7ba144348b67d57bbc7185b5": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_2b66c0a03aa94301935774c7b7e6e240", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>