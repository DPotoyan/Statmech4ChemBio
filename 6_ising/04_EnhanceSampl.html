
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.945 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.25,  0.55,  0.5 ,  1.05,  1.8 ,  2.5 ,  5.75,  8.05, 14.45,
        15.1 ]),
 array([0.745, 0.765, 0.785, 0.805, 0.825, 0.845, 0.865, 0.885, 0.905,
        0.925, 0.945]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "c8dbfc21113d45a1bd63ff662c89c2d0"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.00028657274272048995
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "84eeeb1244664440bfd2ad08605fcd6e"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f47dd86e3d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "02f96efdfe5246cba0712262cc390700"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"5703503dc34d4b4db3b7759ca03b2a5e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c8dbfc21113d45a1bd63ff662c89c2d0": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_9ced6266c8944bb9a691770c7d0c0431", "IPY_MODEL_d7f08f03a2c24dd3a0c537158b8cdc5d"], "layout": "IPY_MODEL_5703503dc34d4b4db3b7759ca03b2a5e"}}, "a700eeb74c014985bf34ceb828d66102": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "95955a0316d54e41af9802547bee1017": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "9ced6266c8944bb9a691770c7d0c0431": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_a700eeb74c014985bf34ceb828d66102", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_95955a0316d54e41af9802547bee1017", "value": 1}}, "de2dae9b2444477caf74dce442c6151a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d7f08f03a2c24dd3a0c537158b8cdc5d": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_de2dae9b2444477caf74dce442c6151a", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "ee360cb4ac274f4589e5d9bed3bf4e0f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "84eeeb1244664440bfd2ad08605fcd6e": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_98ce2eee696249078e40faa6bffc15df", "IPY_MODEL_762a6bd63244418e9b0b40ff79ebe45f"], "layout": "IPY_MODEL_ee360cb4ac274f4589e5d9bed3bf4e0f"}}, "ff5d08ebc23f4f49afb3ffc957ab2911": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2219febac41f41b784d6b5ec172e584e": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "98ce2eee696249078e40faa6bffc15df": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_ff5d08ebc23f4f49afb3ffc957ab2911", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_2219febac41f41b784d6b5ec172e584e", "value": 1}}, "6cc827c56c1249f49fad0164f1da26cf": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "762a6bd63244418e9b0b40ff79ebe45f": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_6cc827c56c1249f49fad0164f1da26cf", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "1777baa24f1940c5a876e80ee89af50f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "02f96efdfe5246cba0712262cc390700": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_6165e778ce004231afebbda0c936db2a", "IPY_MODEL_18cd63a0353d48c9a61ad2f938b8e83b"], "layout": "IPY_MODEL_1777baa24f1940c5a876e80ee89af50f"}}, "7798542d0fe24011ae5469127367c3d5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "eb3ad453c5564c7ea82834a3348fd392": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "6165e778ce004231afebbda0c936db2a": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_7798542d0fe24011ae5469127367c3d5", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_eb3ad453c5564c7ea82834a3348fd392", "value": 1}}, "1df4fbe75b464606918b700779a4298e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "18cd63a0353d48c9a61ad2f938b8e83b": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_1df4fbe75b464606918b700779a4298e", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>