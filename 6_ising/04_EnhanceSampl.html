
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Statistical Mechanics for Chemistry and Biology
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Why Python?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B2: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.935 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.26315789,  0.42105263,  0.63157895,  1.        ,  1.68421053,
         2.78947368,  4.84210526,  9.10526316, 14.68421053, 17.21052632]),
 array([0.74 , 0.759, 0.778, 0.797, 0.816, 0.835, 0.854, 0.873, 0.892,
        0.911, 0.93 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "df4bc1b3f73b4810b96e022ceab78a98"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.0006723331711205986
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "1f96035f7705495ab76a57e82c27e4cd"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f15e43270d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "e85946de07e3470db46e4bf936c0995e"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"2a70892cef984bf591163c036c5a13dd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "df4bc1b3f73b4810b96e022ceab78a98": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_2188c53eb01b4a8e989672aae88da50f", "IPY_MODEL_4238c73362eb420aba93c6e2fbfb543c"], "layout": "IPY_MODEL_2a70892cef984bf591163c036c5a13dd"}}, "9fbc9d5681dd42109b0140572712c385": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fa4e0b90041a4a36a5faf662c0f7ba94": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "2188c53eb01b4a8e989672aae88da50f": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_9fbc9d5681dd42109b0140572712c385", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_fa4e0b90041a4a36a5faf662c0f7ba94", "value": 1}}, "7308b9afff0745a4882d97947fd7c64b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4238c73362eb420aba93c6e2fbfb543c": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_7308b9afff0745a4882d97947fd7c64b", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "93a7561063094500b3e2aa35e6d0b48f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1f96035f7705495ab76a57e82c27e4cd": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_08417718e3ce4a8a9348baa99d7108f7", "IPY_MODEL_3f0a04e5e27e4706944947b0ee109a91"], "layout": "IPY_MODEL_93a7561063094500b3e2aa35e6d0b48f"}}, "bf9726c390f24455a3558466d917e842": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6acf018cd81c47b4af9635695cb81723": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "08417718e3ce4a8a9348baa99d7108f7": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_bf9726c390f24455a3558466d917e842", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_6acf018cd81c47b4af9635695cb81723", "value": 1}}, "ef44fa79c7554bc5a499cb017b319a59": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3f0a04e5e27e4706944947b0ee109a91": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_ef44fa79c7554bc5a499cb017b319a59", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "074d5ed364e045bbabe8ad7ad8056d67": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e85946de07e3470db46e4bf936c0995e": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_4db62c2b541a450682acbe7ed7cf98ac", "IPY_MODEL_91378830a378488bb8a4116ccccddca6"], "layout": "IPY_MODEL_074d5ed364e045bbabe8ad7ad8056d67"}}, "4a399d27997f45dab62c38d905fa8a0e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "912b7fa0783843ed822934af1623e815": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "4db62c2b541a450682acbe7ed7cf98ac": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_4a399d27997f45dab62c38d905fa8a0e", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_912b7fa0783843ed822934af1623e815", "value": 1}}, "79b0eb5488ef46d7b1a60e6a6d1361d5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "91378830a378488bb8a4116ccccddca6": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_79b0eb5488ef46d7b1a60e6a6d1361d5", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "iVBORw0KGgoAAAANSUhEUgAAAd4AAAHSCAYAAABCXKq4AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAaBklEQVR4nO3dcYyt5V0n8O9vuRQCthbair2AVl1sUo1cm5tb3a2mLspQ0hQ1XRdiVtRurnVtYpPdmLom1bj/rGvUxK2xi5a0mopkVZSs1ClbTdDE0lIyUGopIMHAvQgWXLBbG6X+9o85dzM7nOEOM3OeM+/czyc5mfe8z3Oe83ve9z3zve97zpxb3R0AYIx/tuwCAOBMIngBYCDBCwADCV4AGEjwAsBAghcABjq07ALmeUmd0+fm/GWXsVRf/01fWMi4D9x73kLGXUS9i6oVx9cpUzrGFrUNpmRKx9cjj/5jPvf0l2peW+3Hv+N9WV3Yb6grll3GUq2eXFvIuCuHjyxk3EXUu6hacXydMqVjbFHbYEqmdHwdW3k0d93zxbnB61IzAAwkeAFgIMELAAMJXgAYSPACwEC7Ct6quqqqPltVD1XVu+e0n1NVN8/a76yq1+zm+QBg6nYcvFV1VpJfSfLmJK9Lcl1VvW5Tt7cn+dvu/udJfinJz+30+QDgINjNGe+xJA9198Pd/Q9JfjvJNZv6XJPkg7Pl30lyRVXN/bsmADgT7CZ4L07y6Ib7j83Wze3T3c8leSbJK3bxnAAwafvmKyOr6niS40lybqbzNW4A8GLs5oz3RJJLN9y/ZLZubp+qOpTky5M8NW+w7r6hu49299Gzc84uygKA/Ws3wfuJJJdV1ddU1UuSXJvk1k19bk1y/Wz5bUn+uPfjl0MDwCA7vtTc3c9V1TuTrCY5K8mN3f3pqvrZJHd1961J3p/kN6vqoSRPZz2cAeCMtav3eLv7tiS3bVr3ng3LX0zyr3fzHABwkPjmKgAYSPACwECCFwAGErwAMJDgBYCBBC8ADFT78fssjl5+bn989dLTd3yRVg4f2fMxV0+u7fmYyWJqZZ19tjiL2raLYp9Ny5Reu3f2R/NsPz33PwVyxgsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGqu5edg3P87K6sN9QV+z5uKsn1/Z8zKlZOXxk2SVs26L216K2wZTqnVKtybReu7YBSXJs5dHcdc8Xa16bM14AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhox8FbVZdW1Z9U1V9U1aer6sfn9HlTVT1TVWuz23t2Vy4ATNuhXTz2uST/obvvrqqXJvlkVd3e3X+xqd+fdvdbdvE8AHBg7PiMt7sf7+67Z8t/l+QzSS7eq8IA4CDak/d4q+o1Sb45yZ1zmr+1qu6pqg9X1TfsxfMBwFTt5lJzkqSqvizJ7yZ5V3c/u6n57iRf3d2fr6qrk/x+ksu2GOd4kuNJ8lUXH8rqXWu7LW2IlcNHFjLu6sm1hYy7KIuo17adnqlt20UdY4swpVoXZVHH1yK27QP91JZtuzrjraqzsx66H+ru39vc3t3PdvfnZ8u3JTm7ql45b6zuvqG7j3b30Ve94qzdlAUA+9ZuPtVcSd6f5DPd/Ytb9PnKWb9U1bHZ8239zwAAOOB2c6n5Xyb5t0k+VVVrs3X/KclXJUl3vy/J25L8aFU9l+Tvk1zb3b2L5wSASdtx8Hb3nyWp0/R5b5L37vQ5AOCg8c1VADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAw0KFlF8BYqyfXll3Ctk2p1iRZOXxkIeMuYjssqtZFmdKxMKVak+kdCweBM14AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEOLbuAeR6497ysHD6y5+Ounlzb8zEXZRHzTxa3Dc70/ZVMr14WY1Gv3UWZ0u+Eg8IZLwAMJHgBYCDBCwADCV4AGEjwAsBAghcABtp18FbVI1X1qapaq6q75rRXVf1yVT1UVfdW1et3+5wAMFV79Xe839Hdn9ui7c1JLpvd3pDkV2c/AeCMM+JS8zVJfqPXfSzJy6vq1QOeFwD2nb0I3k7ykar6ZFUdn9N+cZJHN9x/bLYOAM44e3Gp+Y3dfaKqviLJ7VV1f3ff8WIHmYX28SQ5N+ftQVkAsP/s+oy3u0/Mfj6Z5JYkxzZ1OZHk0g33L5mt2zzODd19tLuPnp1zdlsWAOxLuwreqjq/ql56ajnJlUnu29Tt1iQ/MPt087ckeaa7H9/N8wLAVO32UvNFSW6pqlNj/VZ3/1FVvSNJuvt9SW5LcnWSh5J8IckP7fI5AWCydhW83f1wksvnrH/fhuVO8mO7eR4AOCh8cxUADCR4AWAgwQsAAwleABhI8ALAQHv1nyRMwsrhI8suYekWtQ1WT64tZNwpcXxN7zhYRL2Og8U5KNvWGS8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwEDV3cuu4XmOXn5uf3z10j0fd+XwkT0fc/Xk2p6PuUiL2AZMz9SO20WZ0uvBPlucRRwHd/ZH82w/XfPanPECwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAOw7eqnptVa1tuD1bVe/a1OdNVfXMhj7v2XXFADBhh3b6wO7+bJIjSVJVZyU5keSWOV3/tLvfstPnAYCDZK8uNV+R5C+7+6/2aDwAOJD2KnivTXLTFm3fWlX3VNWHq+ob9uj5AGCSdnyp+ZSqekmStyb5yTnNdyf56u7+fFVdneT3k1y2xTjHkxxPkq+6eNdlTd7K4SMLGXf15NpCxl1UvSxuny3C1I6DRWzbqW0DFnMcHFv5wpZte3HG++Ykd3f3E5sbuvvZ7v78bPm2JGdX1SvnDdLdN3T30e4++qpXnLUHZQHA/rMXwXtdtrjMXFVfWVU1Wz42e76n9uA5AWCSdnVNt6rOT/JdSX5kw7p3JEl3vy/J25L8aFU9l+Tvk1zb3b2b5wSAKdtV8Hb3/0nyik3r3rdh+b1J3rub5wCAg8Q3VwHAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECHll3ASKsn15ZdwtKtHD6y7BKWznHAKVN6PSyqVq+HxWzbB/qpLduc8QLAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBDi27gHkeuPe8rBw+suwylmr15NpCxl3Udl1UvVNyph+zi+T4WhzH7WKOr2MrX9iyzRkvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMNC2greqbqyqJ6vqvg3rLqyq26vqwdnPC7Z47PWzPg9W1fV7VTgATNF2z3g/kOSqTeveneSj3X1Zko/O7v9/qurCJD+d5A1JjiX56a0CGgDOBNsK3u6+I8nTm1Zfk+SDs+UPJvnuOQ9dSXJ7dz/d3X+b5PY8P8AB4Iyxm6+MvKi7H58t/3WSi+b0uTjJoxvuPzZb9zxVdTzJ8SQ5N+ftoiwA2L/25MNV3d1Jepdj3NDdR7v76Nk5Zy/KAoB9ZzfB+0RVvTpJZj+fnNPnRJJLN9y/ZLYOAM5IuwneW5Oc+pTy9Un+YE6f1SRXVtUFsw9VXTlbBwBnpO3+OdFNSf48yWur6rGqenuS/5Lku6rqwSTfObufqjpaVb+eJN39dJL/nOQTs9vPztYBwBlpWx+u6u7rtmi6Yk7fu5L8uw33b0xy446qA4ADxjdXAcBAghcABhK8ADCQ4AWAgQQvAAy0m6+MXJiv/6YvZHV1bdllbMvK4SOTGndKprYNVk+uLbuEpZvaPptavYuwqON2Edt2SrU+0E9t2eaMFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgoOruZdfwPC+rC/sNdcWej7t6cm3Px5yalcNHFjKubbu4bTslUzsO7LNpmdLxdWzl0dx1zxdrXpszXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGOi0wVtVN1bVk1V134Z1P19V91fVvVV1S1W9fIvHPlJVn6qqtaq6aw/rBoBJ2s4Z7weSXLVp3e1JvrG7vynJA0l+8gUe/x3dfaS7j+6sRAA4OE4bvN19R5KnN637SHc/N7v7sSSXLKA2ADhw9uI93h9O8uEt2jrJR6rqk1V1fA+eCwAm7dBuHlxVP5XkuSQf2qLLG7v7RFV9RZLbq+r+2Rn0vLGOJzmeJOfmvN2UtaWVw0f2fMzVk2t7PmaymFqnZlHbYFH7bFHjLsKitq19tjhT27aLcFC2wY7PeKvqB5O8Jcn3d3fP69PdJ2Y/n0xyS5JjW43X3Td099HuPnp2ztlpWQCwr+0oeKvqqiQ/keSt3f2FLfqcX1UvPbWc5Mok983rCwBniu38OdFNSf48yWur6rGqenuS9yZ5adYvH69V1ftmfQ9X1W2zh16U5M+q6p4kH0/yh939RwuZBQBMxGnf4+3u6+asfv8WfU8muXq2/HCSy3dVHQAcML65CgAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBA1d3LruF5jl5+bn989dI9H3fl8JE9H3P15Nqej7lIi9gGizK1bcu0jq+pmdrr4Uw/Fu7sj+bZfrrmtTnjBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAY6NCyC5i6lcNHFjLu6sm1hYy7KIuo17ZdnEVt20Wxz6a3z9iaM14AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAx02uCtqhur6smqum/Dup+pqhNVtTa7Xb3FY6+qqs9W1UNV9e69LBwApmg7Z7wfSHLVnPW/1N1HZrfbNjdW1VlJfiXJm5O8Lsl1VfW63RQLAFN32uDt7juSPL2DsY8leai7H+7uf0jy20mu2cE4AHBg7OY93ndW1b2zS9EXzGm/OMmjG+4/NlsHAGesnQbvryb5uiRHkjye5Bd2W0hVHa+qu6rqrr956ku7HQ4A9qUdBW93P9HdX+ruf0rya1m/rLzZiSSXbrh/yWzdVmPe0N1Hu/voq15x1k7KAoB9b0fBW1Wv3nD3e5LcN6fbJ5JcVlVfU1UvSXJtklt38nwAcFCc9n8nqqqbkrwpySur6rEkP53kTVV1JEkneSTJj8z6Hk7y6919dXc/V1XvTLKa5KwkN3b3pxcxCQCYitMGb3dfN2f1+7foezLJ1Rvu35bkeX9qBABnKt9cBQADCV4AGEjwAsBAghcABhK8ADCQ4AWAgaq7l13D87ysLuw31BXLLuNAWj25tpBxVw4fWci4UzKlbTulWpmmRR1jU3Fs5dHcdc8Xa16bM14AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEOLbsA2MrqybVll8A+MaVjYeXwkYWMu6htsKh6FzXuIow+vpzxAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIdO16GqbkzyliRPdvc3ztbdnOS1sy4vT/K/u/vInMc+kuTvknwpyXPdfXRPqgaAiTpt8Cb5QJL3JvmNUyu6+9+cWq6qX0jyzAs8/ju6+3M7LRAADpLTBm9331FVr5nXVlWV5PuS/Ks9rgsADqTtnPG+kG9L8kR3P7hFeyf5SFV1kv/e3TdsNVBVHU9yPEnOzXm7LGuc1ZNryy5hX1jEdlg5fGTPx2Tdorbtol4PjoXpbQO/G7e22+C9LslNL9D+xu4+UVVfkeT2qrq/u++Y13EWyjckycvqwt5lXQCwL+34U81VdSjJ9ya5eas+3X1i9vPJJLckObbT5wOAg2A3f070nUnu7+7H5jVW1flV9dJTy0muTHLfLp4PACbvtMFbVTcl+fMkr62qx6rq7bOma7PpMnNVHa6q22Z3L0ryZ1V1T5KPJ/nD7v6jvSsdAKZnO59qvm6L9T84Z93JJFfPlh9Ocvku6wOAA8U3VwHAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAY6NCyC4CtrJ5cW8i4K4ePLGTcRdXL9I6FRXB8HRzOeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABqruXnYNz1NVf5Pkr7bR9ZVJPrfgcpbloM7toM4rObhzM6/pOahzm9K8vrq7XzWvYV8G73ZV1V3dfXTZdSzCQZ3bQZ1XcnDnZl7Tc1DndlDm5VIzAAwkeAFgoKkH7w3LLmCBDurcDuq8koM7N/OanoM6twMxr0m/xwsAUzP1M14AmJRJBG9VXVVVn62qh6rq3XPaz6mqm2ftd1bVa5ZQ5otWVZdW1Z9U1V9U1aer6sfn9HlTVT1TVWuz23uWUeuLVVWPVNWnZjXfNae9quqXZ/vs3qp6/TLqfDGq6rUb9sNaVT1bVe/a1Gcy+6uqbqyqJ6vqvg3rLqyq26vqwdnPC7Z47PWzPg9W1fXjqj69Leb181V1/+xYu6WqXr7FY1/wuF22Leb2M1V1YsMxd/UWj33B36PLtMW8bt4wp0eqam2Lx+7rfTZXd+/rW5Kzkvxlkq9N8pIk9yR53aY+/z7J+2bL1ya5edl1b3Nur07y+tnyS5M8MGdub0ryP5dd6w7m9kiSV75A+9VJPpykknxLkjuXXfOLnN9ZSf4663+rN8n9leTbk7w+yX0b1v3XJO+eLb87yc/NedyFSR6e/bxgtnzBsudzmnldmeTQbPnn5s1r1vaCx+2yb1vM7WeS/MfTPO60v0f327w2tf9CkvdMcZ/Nu03hjPdYkoe6++Hu/ockv53kmk19rknywdny7yS5oqpqYI070t2Pd/fds+W/S/KZJBcvt6phrknyG73uY0leXlWvXnZRL8IVSf6yu7fzRS/7UnffkeTpTas3vpY+mOS75zx0Jcnt3f10d/9tktuTXLWoOl+sefPq7o9093Ozux9LcsnwwvbAFvtsO7bze3RpXmhes9/l35fkpqFFLdAUgvfiJI9uuP9Ynh9O/6/P7MX1TJJXDKluj8wuj39zkjvnNH9rVd1TVR+uqm8YW9mOdZKPVNUnq+r4nPbt7Nf97Nps/YtgivvrlIu6+/HZ8l8nuWhOn6nvux/O+tWWeU533O5X75xdRr9xi7cHprzPvi3JE9394Bbtk9tnUwjeA6+qvizJ7yZ5V3c/u6n57qxfzrw8yX9L8vuDy9upN3b365O8OcmPVdW3L7ugvVJVL0ny1iT/Y07zVPfX8/T6dbwD9WcPVfVTSZ5L8qEtukzxuP3VJF+X5EiSx7N+WfYguS4vfLY7uX02heA9keTSDfcvma2b26eqDiX58iRPDalul6rq7KyH7oe6+/c2t3f3s939+dnybUnOrqpXDi7zRevuE7OfTya5JeuXujbazn7dr96c5O7ufmJzw1T31wZPnLrkP/v55Jw+k9x3VfWDSd6S5Ptn/6h4nm0ct/tOdz/R3V/q7n9K8muZX/NU99mhJN+b5Oat+kxxn00heD+R5LKq+prZmca1SW7d1OfWJKc+Wfm2JH+81QtrP5m9d/H+JJ/p7l/cos9Xnnq/uqqOZX2f7et/VFTV+VX10lPLWf9gy32but2a5Admn27+liTPbLjEud9t+S/wKe6vTTa+lq5P8gdz+qwmubKqLphd1rxytm7fqqqrkvxEkrd29xe26LOd43bf2fTZiO/J/Jq383t0P/rOJPd392PzGqe6z5b+6a7t3LL+CdgHsv6pvJ+arfvZrL+IkuTcrF/2eyjJx5N87bJr3ua83pj1S3n3Jlmb3a5O8o4k75j1eWeST2f9U4gfS/Ivll33Nub1tbN675nVfmqfbZxXJfmV2T79VJKjy657m3M7P+tB+uUb1k1yf2X9Hw+PJ/nHrL/n9/asfzbio0keTPK/klw463s0ya9veOwPz15vDyX5oWXPZRvzeijr73Geep2d+iuIw0lue6Hjdj/dtpjbb85eQ/dmPUxfvXlus/vP+z26X27z5jVb/4FTr60NfSe1z+bdfHMVAAw0hUvNAHBgCF4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgoP8L4YWVt1WKorQAAAAASUVORK5CYII=\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Davit Potoyan<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>