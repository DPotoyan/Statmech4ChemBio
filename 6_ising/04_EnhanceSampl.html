
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.95 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.36842105,  0.68421053,  0.42105263,  1.26315789,  1.63157895,
         3.68421053,  5.52631579, 11.57894737, 15.73684211, 11.73684211]),
 array([0.76 , 0.779, 0.798, 0.817, 0.836, 0.855, 0.874, 0.893, 0.912,
        0.931, 0.95 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "ba021959514f4404a2e3f8f560d5e5ec"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0006675487491144294
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "c725fba148c141a6acb80f80406340ae"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f025400bc10&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "b374504ff98b47b886b4a5a9f10d7814"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"ee4f3890882b4cbc80eec7f5f5a0174a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ba021959514f4404a2e3f8f560d5e5ec": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_16d46c7ef8294ecc9bada363f77d4b5a", "IPY_MODEL_9f6c14f1abc349eea4c3bc488f583200"], "layout": "IPY_MODEL_ee4f3890882b4cbc80eec7f5f5a0174a"}}, "60f44094a2b9434c9abae51283a46ee2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "eff29d77761647ffbd5af46a78364c29": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "16d46c7ef8294ecc9bada363f77d4b5a": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_60f44094a2b9434c9abae51283a46ee2", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_eff29d77761647ffbd5af46a78364c29", "value": 1}}, "1142186dd7404e0c852901d1f093fabb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9f6c14f1abc349eea4c3bc488f583200": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_1142186dd7404e0c852901d1f093fabb", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "iVBORw0KGgoAAAANSUhEUgAAAQUAAAD4CAYAAADl7fPiAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAANz0lEQVR4nO3df4xlZX3H8fenC5aEkvLTFZYFjCUk1HS3ZrLWlDZQlV8hog21kKbFlmatkaQmbRraJmLsPzaNNakYddUN2CjSX6skboENbYIkKixkEVAsW7KGHZDlhwWtNnbXb/+Ys3ae4d7d8Z57594Z369kcs+P557znEz2k3PmPPt8U1VI0mE/M+0OSJothoKkhqEgqWEoSGoYCpIax0y7A4OcevK6OmfjsdPuhrRm7Xvyf3nuhUMZtG8mQ+Gcjcdy350bp90Nac3acsmTQ/f5+CCpYShIahgKkhqGgqSGoSCpYShIahgKkhqGgqSGoSCpYShIahgKkhqGgqSGoSCpYShIahgKkhqGgqSGoSCpcdSZl5JsB64ADlTVa7tttwHndU1OBP6rqjYP+O4+4LvAIeBgVc2NpdeSJmY507HdDNwEfPrwhqr67cPLST4IvHiE719UVc+N2kFJK+uooVBV9yQ5Z9C+JAHeDvzGmPslaUr6Ttz6a8AzVfX4kP0F3JWkgI9X1bZhB0qyFdgKcNaG5XfrkjM2L7vtnU/tWXZb6adV31C4Brj1CPsvqKr5JK8EdiV5rKruGdSwC4xtAHObjrPqrTQlI799SHIM8JvAbcPaVNV893kA2AFsGfV8klZGn1eSbwIeq6r9g3YmOT7JCYeXgYuBR3qcT9IKOGooJLkV+DJwXpL9Sa7rdl3NkkeHJGck2dmtrgfuTfIQcB/wxaq6Y3xdlzQJy3n7cM2Q7e8YsO0p4PJu+QlgU8/+SVphjmiU1DAUJDUMBUkNQ0FSw1CQ1Og7onHqHLosjZd3CpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqWEoSGosZ47G7UkOJHlk0bb3JZlPsqf7uXzIdy9N8s0ke5PcMM6OS5qM5dwp3AxcOmD7h6pqc/ezc+nOJOuAjwCXAecD1yQ5v09nJU3eUUOhK97ywgjH3gLsraonquqHwOeAK0c4jqQV1OdvCtcn+Vr3eHHSgP0bgCcXre/vtg2UZGuS3Ul2P/v8oR7dktTHqKHwUeA1wGbgaeCDfTtSVduqaq6q5k47ZV3fw0ka0UihUFXPVNWhqvoR8AkGl4ObBzYuWj+z2yZpho0UCklOX7T6NgaXg7sfODfJq5O8goWKUrePcj5JK+eoczR2ZeMuBE5Nsh+4EbgwyWYWSs3vA97ZtT0D+GRVXV5VB5NcD9wJrAO2V9Wjk7gISeMzatm4Tw1p++Oycd36TuBlryslza5VP5uz4JIzNi+7rbNf62gc5iypYShIahgKkhqGgqSGoSCpYShIahgKkhqGgqSGoSCp4YjGnzKOftTReKcgqWEoSGoYCpIahoKkhqEgqWEoSGoYCpIao5aN+5skj3V1H3YkOXHId/clebgrLbd7jP2WNCGjlo3bBby2qn4J+A/gz4/w/Yu60nJzo3VR0koaqWxcVd1VVQe71a+wUNNB0howjmHOfwDcNmRfAXclKeDjVbVt2EGSbAW2Apy1wdHXPwmHI2ucev3rS/KXwEHgM0OaXFBV80leCexK8lh35/EyXWBsA5jbdFz16Zek0Y389iHJO4ArgN+pqoH/iKtqvvs8AOxgcHk5STNk1LJxlwJ/Brylqr4/pM3xSU44vAxczODycpJmyHJeSd4KfBk4L8n+JNcBNwEnsPBIsCfJx7q2ZyQ5XBFqPXBvkoeA+4AvVtUdE7kKSWMzsbJxVfUEsKlX7yStOEc0SmoYCpIahoKkhqEgqWEoSGo4nngNcIZmjZN3CpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqWEoSGoYCpIahoKkhsOc1wCHLmucvFOQ1FhWKAwpHXdykl1JHu8+Txry3Wu7No8nuXZcHZc0Gcu9U7iZl5eOuwG4u6rOBe7u1htJTgZuBF7PwvTuNw4LD0mzYVmhMKh0HHAlcEu3fAvw1gFfvQTYVVUvVNV3WKhBuTRcJM2QPn9TWF9VT3fL32ZhSvelNgBPLlrf322TNKPG8ofGrkJUr1JvSbYm2Z1k97PPHxpHtySNoE8oPJPkdIDu88CANvPAxkXrZ3bbXqaqtlXVXFXNnXbKuh7dktRHn1C4HTj8NuFa4AsD2twJXJzkpO4PjBd32yTNqOW+khxUOu4DwJuTPA68qVsnyVySTwJU1QvAXwH3dz/v77ZJmlHLGtE4pHQcwBsHtN0N/OGi9e3A9pF6J2nFOaJRUsNQkNQwFCQ1DAVJDUNBUsNQkNQwFCQ1DAVJDUNBUsNQkNQwFCQ1DAVJDUNBUsNQkNQwFCQ1DAVJDUNBUsNQkNQwFCQ1Rg6FJOcl2bPo56Uk71nS5sIkLy5q897ePZY0USOXoq+qbwKbAZKsY6Gew44BTb9UVVeMeh5JK2tcjw9vBP6zqr41puNJmpJxhcLVwK1D9r0hyUNJ/jXJLw47gGXjpNnQOxSSvAJ4C/CPA3Y/CJxdVZuADwOfH3Ycy8ZJs2EcdwqXAQ9W1TNLd1TVS1X1vW55J3BsklPHcE5JEzKOULiGIY8OSV6VJN3ylu58z4/hnJImZOS3DwBJjgfeDLxz0bY/AqiqjwFXAe9KchD4AXB1V7Ze0ozqFQpV9d/AKUu2fWzR8k3ATX3OIWllOaJRUsNQkNQwFCQ1DAVJDUNBUsNQkNQwFCQ1DAVJDUNBUsNQkNQwFCQ1DAVJDUNBUsNQkNQwFCQ1DAVJjV6TrEj6f5ecsXnZbe98as/E+tGXdwqSGuOY4n1fkoe7snC7B+xPkr9LsjfJ15K8ru85JU3OuB4fLqqq54bsuww4t/t5PfDR7lPSDFqJx4crgU/Xgq8AJyY5fQXOK2kE4wiFAu5K8kCSrQP2bwCeXLS+v9vWsGycNBvG8fhwQVXNJ3klsCvJY1V1z096kKraBmwDmNt0nLUhpCnpfadQVfPd5wEWStFvWdJkHti4aP3MbpukGdQrFJIcn+SEw8vAxcAjS5rdDvxe9xbiV4AXq+rpPueVNDl9Hx/WAzu6cpHHAJ+tqjuWlI7bCVwO7AW+D/x+z3NKmqC+ZeOeADYN2L64dFwB7+5zHkkrx2HO0hH8JEOXJ3XclR4S7TBnSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1HNEpHMMsTrE6KdwqSGoaCpIahIKlhKEhqGAqSGoaCpIahIKkxcigk2Zjk35N8PcmjSf54QJsLk7zYlZTbk+S9/boradL6DF46CPxJVT3Yzej8QJJdVfX1Je2+VFVX9DiPpBU08p1CVT1dVQ92y98FvsGAyk+SVpexDHNOcg7wy8BXB+x+Q5KHgKeAP62qR4ccYyuwFeCsDY6+1mQtd+JUhzmPIMnPAf8MvKeqXlqy+0Hg7KraBHwY+Pyw41TVtqqaq6q5005Z17dbkkbUt0LUsSwEwmeq6l+W7q+ql6rqe93yTuDYJKf2Oaekyerz9iHAp4BvVNXfDmnzqq4dSbZ053t+1HNKmrw+D++/Cvwu8HCSPd22vwDOgh9XiboKeFeSg8APgKu7ilGSZtTIoVBV9wI5SpubgJtGPYekleeIRkkNQ0FSw1CQ1DAUJDUMBUkNxxPPqOUOw52ktTzEdy1fW1/eKUhqGAqSGoaCpIahIKlhKEhqGAqSGoaCpIahIKlhKEhqGAqSGg5znlEOw9W0eKcgqdF3NudLk3wzyd4kNwzY/7NJbuv2f7WrDyFphvWZzXkd8BHgMuB84Jok5y9pdh3wnar6BeBDwF+Pej5JK6PPncIWYG9VPVFVPwQ+B1y5pM2VwC3d8j8Bbzw85buk2dQnFDYATy5a38/La0n+uE1VHQReBE4ZdLAkW5PsTrL72ecP9eiWpD5m5g+Nlo2TZkOfUJgHNi5aP7PbNrBNkmOAn8cKUdJM6xMK9wPnJnl1klcAVwO3L2lzO3Btt3wV8G9WiJJmW58KUQeTXA/cCawDtlfVo0neD+yuqttZqDX590n2Ai+wEBySZlivEY1dJemdS7a9d9Hy/wC/1eccklZWZvFuPsmzwLeWbD4VeG4K3Zm0tXpdsHavbS1c19lVddqgHTMZCoMk2V1Vc9Pux7it1euCtXtta/W6DpuZV5KSZoOhIKmxmkJh27Q7MCFr9bpg7V7bWr0uYBX9TUHSylhNdwqSVoChIKmxKkLhaJO5rFZJ9iV5OMmeJLun3Z8+kmxPciDJI4u2nZxkV5LHu8+TptnHUQy5rvclme9+b3uSXD7NPo7bzIfCMidzWc0uqqrNa+C9983ApUu23QDcXVXnAnd366vNzbz8ugA+1P3eNncje9eMmQ8FljeZi6asqu5h4f+3LLZ4kp1bgLeuZJ/GYch1rWmrIRSWM5nLalXAXUkeSLJ12p2ZgPVV9XS3/G1g/TQ7M2bXJ/la93ix6h6LjmQ1hMJadkFVvY6FR6N3J/n1aXdoUrr/Mr9W3n9/FHgNsBl4GvjgVHszZqshFJYzmcuqVFXz3ecBYAcLj0pryTNJTgfoPg9MuT9jUVXPVNWhqvoR8AnW2O9tNYTCciZzWXWSHJ/khMPLwMXAI0f+1qqzeJKda4EvTLEvY3M46DpvY4393ma+QtSwyVym3K1xWA/s6Ca3Pgb4bFXdMd0ujS7JrcCFwKlJ9gM3Ah8A/iHJdSz8V/i3T6+HoxlyXRcm2czC49A+4J3T6t8kOMxZUmM1PD5IWkGGgqSGoSCpYShIahgKkhqGgqSGoSCp8X+SNQDjVMZgiQAAAABJRU5ErkJggg==\n"}}]}}, "819d253c10f842bf968e976295097f49": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c725fba148c141a6acb80f80406340ae": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_648c6c1e2f8c4e66bfb897003f9a87ba", "IPY_MODEL_2507f589b9b6432a914d0accb32b56db"], "layout": "IPY_MODEL_819d253c10f842bf968e976295097f49"}}, "d6843f9795134e45aa5e0f42bab6eaab": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6e536a7f9b6142188fb67854b0bddc40": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "648c6c1e2f8c4e66bfb897003f9a87ba": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_d6843f9795134e45aa5e0f42bab6eaab", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_6e536a7f9b6142188fb67854b0bddc40", "value": 1}}, "0a09adb367da41fe99b5a1afdb8abdca": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2507f589b9b6432a914d0accb32b56db": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_0a09adb367da41fe99b5a1afdb8abdca", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "8a51fbaddf284c36a984c8e581af17d6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b374504ff98b47b886b4a5a9f10d7814": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_0c1fb8f0d0694ad384a83c9d286b6f15", "IPY_MODEL_2779b67ab3564c7c84fd0577b32f03e8"], "layout": "IPY_MODEL_8a51fbaddf284c36a984c8e581af17d6"}}, "fddee9c7d19d4aa0bea421953ebcf21f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "baac4fd141964f2a9f043e67c21c50f7": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "0c1fb8f0d0694ad384a83c9d286b6f15": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_fddee9c7d19d4aa0bea421953ebcf21f", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_baac4fd141964f2a9f043e67c21c50f7", "value": 1}}, "88e3e57bb84144ec9fd24ef4a47841c3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2779b67ab3564c7c84fd0577b32f03e8": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_88e3e57bb84144ec9fd24ef4a47841c3", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>