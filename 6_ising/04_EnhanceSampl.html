
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B2: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.855 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.16216216,  0.54054054,  0.81081081,  0.7027027 ,  2.16216216,
         2.64864865,  3.78378378,  8.86486486, 15.13513514, 19.24324324]),
 array([0.67  , 0.6885, 0.707 , 0.7255, 0.744 , 0.7625, 0.781 , 0.7995,
        0.818 , 0.8365, 0.855 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "06a03c14b20947549a4e73fc4bcc22c6"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.0012221770816899236
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "45021b1d4d104a81b734d4321b0e8bb4"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe86316a290&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "bfa841a9e30641628875850456920d4d"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"784eac1ece424105b9b33ff3bf0bd1b3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "06a03c14b20947549a4e73fc4bcc22c6": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_63052801763e47d6b60425e6e40b5042", "IPY_MODEL_4abb06e5da064623b061eafcb7fdb4fd"], "layout": "IPY_MODEL_784eac1ece424105b9b33ff3bf0bd1b3"}}, "a8283806bce84213b37965f881cc3735": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ecbacdcee2b24176ae8241f05f157060": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "63052801763e47d6b60425e6e40b5042": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_a8283806bce84213b37965f881cc3735", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_ecbacdcee2b24176ae8241f05f157060", "value": 1}}, "05aa8e88b6014f2fa657b4eeb5bb39ac": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4abb06e5da064623b061eafcb7fdb4fd": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_05aa8e88b6014f2fa657b4eeb5bb39ac", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "e9efb32d90fc4d4eb5ced07492ce4daa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "45021b1d4d104a81b734d4321b0e8bb4": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_b171bd32a7194213bc9590d704704954", "IPY_MODEL_ca994c5576b043b09c62108ddbd8db95"], "layout": "IPY_MODEL_e9efb32d90fc4d4eb5ced07492ce4daa"}}, "8da2130357e64642bced11abe72dddfa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4b6b66c2745445959e3f9233a6d2aa97": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "b171bd32a7194213bc9590d704704954": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_8da2130357e64642bced11abe72dddfa", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_4b6b66c2745445959e3f9233a6d2aa97", "value": 1}}, "4436dff672c34538a28cc9b76df07a98": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ca994c5576b043b09c62108ddbd8db95": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_4436dff672c34538a28cc9b76df07a98", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "fec6185a2202460d84d220fec1433a6f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bfa841a9e30641628875850456920d4d": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_901b7238b6ee4a78bd24fa49d8521530", "IPY_MODEL_9e4aa8a246d84cf093536c6f3405f1e4"], "layout": "IPY_MODEL_fec6185a2202460d84d220fec1433a6f"}}, "c57a536bf98345a88335b0cd95b9c0cc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0bb771f0d0aa4fc8a35c84d7b73ca3f2": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "901b7238b6ee4a78bd24fa49d8521530": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_c57a536bf98345a88335b0cd95b9c0cc", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_0bb771f0d0aa4fc8a35c84d7b73ca3f2", "value": 1}}, "49fd232fb6aa4f03ac9502662c8c0e1b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9e4aa8a246d84cf093536c6f3405f1e4": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_49fd232fb6aa4f03ac9502662c8c0e1b", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>