
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix A: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.925 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.26315789,  0.21052632,  0.94736842,  0.94736842,  1.57894737,
         1.73684211,  4.42105263, 10.05263158, 15.68421053, 16.78947368]),
 array([0.735, 0.754, 0.773, 0.792, 0.811, 0.83 , 0.849, 0.868, 0.887,
        0.906, 0.925]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "97e279bde65d4cbc881d92994dad237f"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0003435965631506714
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "3a542c54677d40f59d397c126e829460"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f81939f19d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "1ddc2449688046789e621f9c89145f5c"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"ca03372f93084b2b990a3ca8163f88fd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "97e279bde65d4cbc881d92994dad237f": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_ffd4d353072544a78d424b02eda17fc7", "IPY_MODEL_104a4e32c107405cbb70fe3d86d0bf46"], "layout": "IPY_MODEL_ca03372f93084b2b990a3ca8163f88fd"}}, "8f0e2afa8b594a769288e91206d908e4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4f6f4572702e4cb8859e0d83d18ba557": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "ffd4d353072544a78d424b02eda17fc7": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_8f0e2afa8b594a769288e91206d908e4", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_4f6f4572702e4cb8859e0d83d18ba557", "value": 1}}, "1d44923906964fe6b03367c377a5e65b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "104a4e32c107405cbb70fe3d86d0bf46": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_1d44923906964fe6b03367c377a5e65b", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "47c9302577034b85aeefe9978f0b907b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3a542c54677d40f59d397c126e829460": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_4b56949ff8d64d39aa2a7048fc1b404f", "IPY_MODEL_90305395910541b0b4bb16299afff07b"], "layout": "IPY_MODEL_47c9302577034b85aeefe9978f0b907b"}}, "edb1256df4f14a4bb9add287a3307278": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "31a4a5abbf544aa7bcb7f706ef30ac1f": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "4b56949ff8d64d39aa2a7048fc1b404f": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_edb1256df4f14a4bb9add287a3307278", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_31a4a5abbf544aa7bcb7f706ef30ac1f", "value": 1}}, "dbef0289dcd747489bfd15eb3cf0667d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "90305395910541b0b4bb16299afff07b": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_dbef0289dcd747489bfd15eb3cf0667d", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "6f27318078ae4e41b88cc05aca2dd2dc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1ddc2449688046789e621f9c89145f5c": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_b04bf3e5eef4489cafe1eb252244edef", "IPY_MODEL_5bbd3f2df52d450aa681e8f108b72608"], "layout": "IPY_MODEL_6f27318078ae4e41b88cc05aca2dd2dc"}}, "1f627ed0c2e845969c41230347de6c58": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0d74c9e221e64e63a25a8a5d723f90d2": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "b04bf3e5eef4489cafe1eb252244edef": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_1f627ed0c2e845969c41230347de6c58", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_0d74c9e221e64e63a25a8a5d723f90d2", "value": 1}}, "3fa6ec72155640509621c461cc831ec8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5bbd3f2df52d450aa681e8f108b72608": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_3fa6ec72155640509621c461cc831ec8", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "iVBORw0KGgoAAAANSUhEUgAAAd4AAAHSCAYAAABCXKq4AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAZ3klEQVR4nO3df4xl51kf8O9Tr2PLxhDnByZrGwI0RAooXqLVAm1AoQGvY0UxoJTaQsVAqiWUSERqhUKRAqL/lCJAokG4hlgJKBirgMEqDhM3IAUk4sSxxo5DHNtYRvGuscGmNsGkqcPTP+ZuOx3f8Y5n5rwzZ/z5SFdz7jnvfc/znnPu/e4598dWdwcAGOOf7HUBAPBCIngBYCDBCwADCV4AGEjwAsBAghcABjq01wUs86I6p8/N+Xtdxp76utc+PUm/99193iT9zoltOx3bdrptMBXbdppt8Pn8fb7Q/6uWLav9+D3eL62X9DfVG/e6jD21cmp1kn6PHz4ySb9zYttOx7adbhtMxbadZhvc3h/OU/3E0uB1qRkABhK8ADCQ4AWAgQQvAAwkeAFgoB0Fb1VdUVWfqaoHqupdS5afU1U3LZbfXlWv3Mn6AGDuth28VXVWkl9O8qYkr0lyTVW9ZkOztyX52+7+p0l+McnPbnd9AHAQ7OSM91iSB7r7we7+QpLfSnLVhjZXJXn/Yvq3k7yxqpZ+rwkAXgh2ErwXJ/nsuvsPL+YtbdPdzyR5MslLd7BOAJi1ffOTkVV1IsmJJDk38/kJMwB4PnZyxnsyyaXr7l+ymLe0TVUdSvJlSR5f1ll3X9/dR7v76Nk5ZwdlAcD+tZPg/XiSV1XVV1fVi5JcneSWDW1uSXLtYvqtSf6o9+OPQwPAINu+1Nzdz1TVO5KsJDkryQ3d/amq+pkkd3T3LUnem+Q3quqBJE9kLZwB4AVrR+/xdvetSW7dMO/d66Y/n+Rf7mQdAHCQ+OUqABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMtG9+MnKuVk6tTtLv8cNHJumX+ZniGHN8rZnTtp3qtWaqfudkim1w7PjTmy5zxgsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGqu7e6xqe5ehl5/bHVi7d6zLYY8cPH5mk35VTq5P0OydTbdupTLXPptgOc6p1SnN6nk2xbW/vD+epfqKWLXPGCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAA207eKvq0qr646r686r6VFX92JI2b6iqJ6tqdXF7987KBYB5O7SDxz6T5N91951VdUGST1TVbd395xva/Ul3v3kH6wGAA2PbZ7zd/Uh337mY/rskn05y8W4VBgAH0a68x1tVr0zyjUluX7L4W6rqrqr6YFV9/W6sDwDmaieXmpMkVfUlSX4nyTu7+6kNi+9M8lXd/bmqujLJ7yV51Sb9nEhyIknOzXk5fvjITksbYuXU6l6X8LzMZbvy/9hntkEy3WvNnLbtnGp9Ljs6462qs7MWuh/o7t/duLy7n+ruzy2mb01ydlW9bFlf3X19dx/t7qNn55ydlAUA+9ZOPtVcSd6b5NPd/QubtPmKRbtU1bHF+h7f7joBYO52cqn5nyf510k+WVWri3n/IclXJkl3X5fkrUl+pKqeSfIPSa7u7t7BOgFg1rYdvN39p0nqDG3ek+Q9210HABw0frkKAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGOrTXBYy0cmp1r0vYsuOHj0zS75y2AdOZ6jiY6ridk7k9d+f0mnBQjltnvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAx3a6wJYbuXU6iT9Hj98ZJJ+pzDVNpjKnLbtVLU6buHMnPECwECCFwAGErwAMJDgBYCBBC8ADCR4AWCgHQdvVT1UVZ+sqtWqumPJ8qqqX6qqB6rq7qp63U7XCQBztVvf4/327v6bTZa9KcmrFrdvSvIri78A8IIz4lLzVUl+vdd8NMmLq+oVA9YLAPvObgRvJ/lQVX2iqk4sWX5xks+uu//wYh4AvODsxqXm13f3yar68iS3VdW93f2R59vJIrRPJMm5OW8XygKA/WfHZ7zdfXLx97EkNyc5tqHJySSXrrt/yWLexn6u7+6j3X307Jyz07IAYF/aUfBW1flVdcHp6SSXJ7lnQ7Nbknz/4tPN35zkye5+ZCfrBYC52uml5ouS3FxVp/v6ze7+w6p6e5J093VJbk1yZZIHkjyd5Ad3uE4AmK0dBW93P5jksiXzr1s33Ul+dCfrAYCDwi9XAcBAghcABhK8ADCQ4AWAgQQvAAy0W/9Jwq76utc+nZWV1b0uY08dP3xkr0t4XlZOre56n1NtgylqnbLfKbbDVLXCHE3xfDh2/OlNlznjBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAY6NBeF8BYK6dWJ+n3+OEju97nnGpNpqt3CrYBU5vqGJvC6OPWGS8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAy07eCtqldX1eq621NV9c4Nbd5QVU+ua/PuHVcMADN2aLsP7O7PJDmSJFV1VpKTSW5e0vRPuvvN210PABwku3Wp+Y1J/qK7/3KX+gOAA2m3gvfqJDdusuxbququqvpgVX39Lq0PAGZp25eaT6uqFyV5S5KfWLL4ziRf1d2fq6ork/xekldt0s+JJCeS5Csv3nFZwxw/fGSSfldOrU7S75zMbdtOVS+eD3Nkn21uN85435Tkzu5+dOOC7n6quz+3mL41ydlV9bJlnXT39d19tLuPvvylZ+1CWQCw/+xG8F6TTS4zV9VXVFUtpo8t1vf4LqwTAGZpR9d0q+r8JN+Z5IfXzXt7knT3dUnemuRHquqZJP+Q5Oru7p2sEwDmbEfB291/n+SlG+Zdt276PUnes5N1AMBB4perAGAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgoEN7XcAy9919Xo4fPrLXZWzJyqnVSfqdavxT1TtVv1OY27adwlyeX1Ob03bwWjOvWp+LM14AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAw0KG9LmCZr3vt01lZWd31fo8fPrLrfU5l5dTqJP1OtQ2mqHdO+4tpzem4hTNxxgsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMtKXgraobquqxqrpn3byXVNVtVXX/4u+Fmzz22kWb+6vq2t0qHADmaKtnvO9LcsWGee9K8uHuflWSDy/u/3+q6iVJfirJNyU5luSnNgtoAHgh2FLwdvdHkjyxYfZVSd6/mH5/ku9a8tDjSW7r7ie6+2+T3JZnBzgAvGDs5D3ei7r7kcX0XyW5aEmbi5N8dt39hxfznqWqTlTVHVV1x18//sUdlAUA+9eufLiquztJ77CP67v7aHcffflLz9qNsgBg39lJ8D5aVa9IksXfx5a0OZnk0nX3L1nMA4AXpJ0E7y1JTn9K+dokv7+kzUqSy6vqwsWHqi5fzAOAF6Stfp3oxiR/luTVVfVwVb0tyX9K8p1VdX+S71jcT1UdrapfS5LufiLJf0zy8cXtZxbzAOAFaUv/H293X7PJojcuaXtHkn+z7v4NSW7YVnUAcMD45SoAGEjwAsBAghcABhK8ADCQ4AWAgbb0qeaDYuXU6q73efzwkV3vE9ZzjM3LVPtritevKfudwlS1TrHP7uvHN13mjBcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYKBDe13AMvfdfV6OHz6y6/2unFrd9T6nMqdap2IbrJliO0zx/IL15nSMTfEcO3b86U2XOeMFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBzhi8VXVDVT1WVfesm/dzVXVvVd1dVTdX1Ys3eexDVfXJqlqtqjt2sW4AmKWtnPG+L8kVG+bdluQbuvu1Se5L8hPP8fhv7+4j3X10eyUCwMFxxuDt7o8keWLDvA919zOLux9NcskEtQHAgbMb7/H+UJIPbrKsk3yoqj5RVSd2YV0AMGuHdvLgqvrJJM8k+cAmTV7f3Ser6suT3FZV9y7OoJf1dSLJiSQ5N+ftpKxNHT98ZJJ+pzCnWpnWyqnVWfSZOG6T6bbtVOa0z+a2bTez7TPeqvqBJG9O8n3d3cvadPfJxd/Hktyc5Nhm/XX39d19tLuPnp1ztlsWAOxr2wreqroiyY8neUt3P71Jm/Or6oLT00kuT3LPsrYA8EKxla8T3Zjkz5K8uqoerqq3JXlPkguydvl4taquW7Q9XFW3Lh56UZI/raq7knwsyR909x9OMgoAmIkzvsfb3dcsmf3eTdqeSnLlYvrBJJftqDoAOGD8chUADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQ7tdQEjrZxa3fU+jx8+sut9smaK/ZXMb59NUe9U23aqfqcyp207N3N6vR29z5zxAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMVN291zU8y9HLzu2PrVy612XsqeOHj+x1Cc/LyqnVvS5hz021z6bYtnM7vqYyp+PWPpvX/jp2/LO5467P17JlzngBYCDBCwADCV4AGEjwAsBAghcABhK8ADDQGYO3qm6oqseq6p518366qk5W1eriduUmj72iqj5TVQ9U1bt2s3AAmKOtnPG+L8kVS+b/YncfWdxu3biwqs5K8stJ3pTkNUmuqarX7KRYAJi7MwZvd38kyRPb6PtYkge6+8Hu/kKS30py1Tb6AYADYyfv8b6jqu5eXIq+cMnyi5N8dt39hxfzAOAFa7vB+ytJvjbJkSSPJPn5nRZSVSeq6o6quuOvH//iTrsDgH1pW8Hb3Y929xe7+x+T/GrWLitvdDLJ+h9cvmQxb7M+r+/uo9199OUvPWs7ZQHAvret4K2qV6y7+91J7lnS7ONJXlVVX11VL0pydZJbtrM+ADgoDp2pQVXdmOQNSV5WVQ8n+akkb6iqI0k6yUNJfnjR9nCSX+vuK7v7map6R5KVJGcluaG7PzXFIABgLs4YvN19zZLZ792k7akkV667f2uSZ33VCABeqPxyFQAMJHgBYCDBCwADCV4AGEjwAsBAghcABjrj14n2wn13n5fjh4/ser8rp1Z3vc+5mWobTLG/WDOnbev4mletrJlin93Xj2+6zBkvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBA1d17XcOzHL3s3P7YyqW73u/xw0d2vc+prJxanaTfqbbBFPXOqda5mdNzIbHP5miKY2xOx8Gx45/NHXd9vpYtc8YLAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADHTpTg6q6IcmbkzzW3d+wmHdTklcvmrw4yf/s7iNLHvtQkr9L8sUkz3T30V2pGgBm6ozBm+R9Sd6T5NdPz+juf3V6uqp+PsmTz/H4b+/uv9lugQBwkJwxeLv7I1X1ymXLqqqSfG+Sf7HLdQHAgbSVM97n8q1JHu3u+zdZ3kk+VFWd5L929/WbdVRVJ5KcSJJzc16OHz6yw9JgOcdWsnJqda9L2BccC9MdC46xze00eK9JcuNzLH99d5+sqi9PcltV3dvdH1nWcBHK1yfJl9ZLeod1AcC+tO1PNVfVoSTfk+Smzdp098nF38eS3Jzk2HbXBwAHwU6+TvQdSe7t7oeXLayq86vqgtPTSS5Pcs8O1gcAs3fG4K2qG5P8WZJXV9XDVfW2xaKrs+Eyc1UdrqpbF3cvSvKnVXVXko8l+YPu/sPdKx0A5mcrn2q+ZpP5P7Bk3qkkVy6mH0xy2Q7rA4ADxS9XAcBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABjo0F4XMNLKqdVd7/P44SO73ueU/U6xDaYyVa1TbdupzGmfTcXzYX7H7ZzqHX0cOOMFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABiounuva3iWqvrrJH+5haYvS/I3E5ezVw7q2A7quJKDOzbjmp+DOrY5jeuruvvlyxbsy+Ddqqq6o7uP7nUdUzioYzuo40oO7tiMa34O6tgOyrhcagaAgQQvAAw09+C9fq8LmNBBHdtBHVdycMdmXPNzUMd2IMY16/d4AWBu5n7GCwCzMovgraorquozVfVAVb1ryfJzquqmxfLbq+qVe1Dm81ZVl1bVH1fVn1fVp6rqx5a0eUNVPVlVq4vbu/ei1uerqh6qqk8uar5jyfKqql9a7LO7q+p1e1Hn81FVr163H1ar6qmqeueGNrPZX1V1Q1U9VlX3rJv3kqq6raruX/y9cJPHXrtoc39VXTuu6jPbZFw/V1X3Lo61m6vqxZs89jmP2722ydh+uqpOrjvmrtzksc/5OrqXNhnXTevG9FBVrW7y2H29z5bq7n19S3JWkr9I8jVJXpTkriSv2dDm3ya5bjF9dZKb9rruLY7tFUlet5i+IMl9S8b2hiT/fa9r3cbYHkrysudYfmWSDyapJN+c5Pa9rvl5ju+sJH+Vte/qzXJ/Jfm2JK9Lcs+6ef85ybsW0+9K8rNLHveSJA8u/l64mL5wr8dzhnFdnuTQYvpnl41rsew5j9u9vm0ytp9O8u/P8Lgzvo7ut3FtWP7zSd49x3227DaHM95jSR7o7ge7+wtJfivJVRvaXJXk/Yvp307yxqqqgTVuS3c/0t13Lqb/Lsmnk1y8t1UNc1WSX+81H03y4qp6xV4X9Ty8MclfdPdWfuhlX+rujyR5YsPs9c+l9yf5riUPPZ7ktu5+orv/NsltSa6Yqs7na9m4uvtD3f3M4u5Hk1wyvLBdsMk+24qtvI7umeca1+K1/HuT3Di0qAnNIXgvTvLZdfcfzrPD6f+2WTy5nkzy0iHV7ZLF5fFvTHL7ksXfUlV3VdUHq+rrx1a2bZ3kQ1X1iao6sWT5VvbrfnZ1Nn8hmOP+Ou2i7n5kMf1XSS5a0mbu++6Hsna1ZZkzHbf71TsWl9Fv2OTtgTnvs29N8mh337/J8tntszkE74FXVV+S5HeSvLO7n9qw+M6sXc68LMl/SfJ7g8vbrtd39+uSvCnJj1bVt+11Qbulql6U5C1J/tuSxXPdX8/Sa9fxDtTXHqrqJ5M8k+QDmzSZ43H7K0m+NsmRJI9k7bLsQXJNnvtsd3b7bA7BezLJpevuX7KYt7RNVR1K8mVJHh9S3Q5V1dlZC90PdPfvblze3U919+cW07cmObuqXja4zOetu08u/j6W5OasXepabyv7db96U5I7u/vRjQvmur/WefT0Jf/F38eWtJnlvquqH0jy5iTft/hHxbNs4bjdd7r70e7+Ynf/Y5JfzfKa57rPDiX5niQ3bdZmjvtsDsH78SSvqqqvXpxpXJ3klg1tbkly+pOVb03yR5s9sfaTxXsX703y6e7+hU3afMXp96ur6ljW9tm+/kdFVZ1fVRecns7aB1vu2dDsliTfv/h08zcneXLdJc79btN/gc9xf22w/rl0bZLfX9JmJcnlVXXh4rLm5Yt5+1ZVXZHkx5O8pbuf3qTNVo7bfWfDZyO+O8tr3srr6H70HUnu7e6Hly2c6z7b8093beWWtU/A3pe1T+X95GLez2TtSZQk52btst8DST6W5Gv2uuYtjuv1WbuUd3eS1cXtyiRvT/L2RZt3JPlU1j6F+NEk/2yv697CuL5mUe9di9pP77P146okv7zYp59McnSv697i2M7PWpB+2bp5s9xfWfvHwyNJ/nfW3vN7W9Y+G/HhJPcn+R9JXrJoezTJr6177A8tnm8PJPnBvR7LFsb1QNbe4zz9PDv9LYjDSW59ruN2P902GdtvLJ5Dd2ctTF+xcWyL+896Hd0vt2XjWsx/3+nn1rq2s9pny25+uQoABprDpWYAODAELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADDQ/wFB5Y3LkcBmPAAAAABJRU5ErkJggg==\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>