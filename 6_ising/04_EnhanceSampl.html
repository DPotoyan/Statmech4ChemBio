
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B2: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.93 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.26315789,  0.05263158,  0.47368421,  1.15789474,  1.84210526,
         3.57894737,  5.68421053, 10.        , 14.89473684, 14.68421053]),
 array([0.74 , 0.759, 0.778, 0.797, 0.816, 0.835, 0.854, 0.873, 0.892,
        0.911, 0.93 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "b738b02f6a8144528111117d5d6054ac"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0008218708630143019
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "acfbb94384f440399090169af7f8ece8"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7ff1c9dbbb10&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "8851dd53b6a249a9b81a69fc6792812c"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"0f4f5222f225481b9909c4a2f88b28ae": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b738b02f6a8144528111117d5d6054ac": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_40ced4f25e95440892972f07f694e211", "IPY_MODEL_253c18ff1fd047b9a7146fd247e14f58"], "layout": "IPY_MODEL_0f4f5222f225481b9909c4a2f88b28ae"}}, "81bd082b07ab4b4da583f6d6c5caaf31": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2243889c54024dd8a5a78610d483cf27": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "40ced4f25e95440892972f07f694e211": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_81bd082b07ab4b4da583f6d6c5caaf31", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_2243889c54024dd8a5a78610d483cf27", "value": 1}}, "fdb2834fabd84fa2916f722e566ae88a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "253c18ff1fd047b9a7146fd247e14f58": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_fdb2834fabd84fa2916f722e566ae88a", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "7206528a7bf44a96b22a44d16321606c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "acfbb94384f440399090169af7f8ece8": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_666792a3256e49479fdfa979d4e541e5", "IPY_MODEL_7d5013c5a9f44fdb90a62d644c2bb6ac"], "layout": "IPY_MODEL_7206528a7bf44a96b22a44d16321606c"}}, "b546c76acc534512b95af12b44a03e38": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d30e5f33de634ea98dfff522e109fdd6": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "666792a3256e49479fdfa979d4e541e5": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_b546c76acc534512b95af12b44a03e38", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_d30e5f33de634ea98dfff522e109fdd6", "value": 1}}, "8d9f104a9ec14fa48ba7e2765bc2db50": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7d5013c5a9f44fdb90a62d644c2bb6ac": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_8d9f104a9ec14fa48ba7e2765bc2db50", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "405825268bd0442aaaa3d40b2ddf6b0b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8851dd53b6a249a9b81a69fc6792812c": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_2aca549d5480404a9eba8a38ad66a934", "IPY_MODEL_884851ca2333411d8cc334c87ea236b0"], "layout": "IPY_MODEL_405825268bd0442aaaa3d40b2ddf6b0b"}}, "f7ec01d2ffd0459aa9de5b6dc1630f25": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5c33342e89dd4460b009c29a2e7ebfbe": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "2aca549d5480404a9eba8a38ad66a934": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_f7ec01d2ffd0459aa9de5b6dc1630f25", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_5c33342e89dd4460b009c29a2e7ebfbe", "value": 1}}, "55bbba46004848169652ddd89413c8ba": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "884851ca2333411d8cc334c87ea236b0": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_55bbba46004848169652ddd89413c8ba", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>