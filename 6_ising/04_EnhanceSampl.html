
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.10810811,  0.32432432,  0.21621622,  0.91891892,  1.67567568,
         2.91891892,  3.78378378, 11.02702703, 15.72972973, 17.35135135]),
 array([0.715 , 0.7335, 0.752 , 0.7705, 0.789 , 0.8075, 0.826 , 0.8445,
        0.863 , 0.8815, 0.9   ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "fa488c5f1f224e3bacf51570aca913db"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.00020701180522578462
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "e0d493cca11c4749bc1f8ee4e4803990"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f9e6a9b97d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "36fb03fc82f743648ef461b06469acca"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"01d911d35dc645ae9865729e274cef5f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fa488c5f1f224e3bacf51570aca913db": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_9302943dedf347c29d0fdc74d70f4940", "IPY_MODEL_817c951a41fa4dff9aff5189b99d1d85"], "layout": "IPY_MODEL_01d911d35dc645ae9865729e274cef5f"}}, "30f3f7d480244ac98b3139d253cd945f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "af68a18b859646f3afc37ba28ca0b2cd": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "9302943dedf347c29d0fdc74d70f4940": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_30f3f7d480244ac98b3139d253cd945f", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_af68a18b859646f3afc37ba28ca0b2cd", "value": 1}}, "a81f691a19454e5f8db3e0b4526f2fcb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "817c951a41fa4dff9aff5189b99d1d85": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_a81f691a19454e5f8db3e0b4526f2fcb", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "dc6fecabcccd46ed87d8caf51dd00a67": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e0d493cca11c4749bc1f8ee4e4803990": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_64dba988cccc4ab5820bdd106aab1412", "IPY_MODEL_203213484f974c999de82b407da52168"], "layout": "IPY_MODEL_dc6fecabcccd46ed87d8caf51dd00a67"}}, "03c01a5a4f3f441ba6fec2c820026282": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2029109e74fa4263b8d225cbf0f4e71a": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "64dba988cccc4ab5820bdd106aab1412": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_03c01a5a4f3f441ba6fec2c820026282", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_2029109e74fa4263b8d225cbf0f4e71a", "value": 1}}, "307e3b98ae8c42bda59777f8d1aceda4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "203213484f974c999de82b407da52168": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_307e3b98ae8c42bda59777f8d1aceda4", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "1a4d15a02d1b4b56bff8918685ff99e5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "36fb03fc82f743648ef461b06469acca": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_085a42f4f1f1495d9d2725797f02c850", "IPY_MODEL_882ae43c8380481d81f27b96385d2706"], "layout": "IPY_MODEL_1a4d15a02d1b4b56bff8918685ff99e5"}}, "7b8a00f987b6433597e406862743ed90": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ca59ad93a0d64b4193f2ec3740acdbd2": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "085a42f4f1f1495d9d2725797f02c850": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_7b8a00f987b6433597e406862743ed90", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_ca59ad93a0d64b4193f2ec3740acdbd2", "value": 1}}, "a998928c9a894e43b993aebafa13ced7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "882ae43c8380481d81f27b96385d2706": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_a998928c9a894e43b993aebafa13ced7", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "iVBORw0KGgoAAAANSUhEUgAAAd4AAAHSCAYAAABCXKq4AAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAZ+ElEQVR4nO3df4xl51kf8O9Tr2PLwZBfYLK22wANkRKULGG1QBtQaMDrWBEGlFJbqBhItYQSCaRWKC1SQFSVShEgaBCuIVYCSo1VwMUqDhM3oAYk4sSJxo5DHNtYQfGuscGmNsHQ1MnTP+ZuNR3f2Z2dO/e9c2Y/H+lqzj3ve9/znB/3fvec+2OruwMAjPH3Vl0AAJxPBC8ADCR4AWAgwQsAAwleABhI8ALAQIdWXcA8L3nRBf2yKy/c83EfuPeSPR/zq1/9zJ6POUW27fLYtsvZBkzPso7bZRxff5e/yef6f9e8ttqP3+M9+pqL+8NrV+75uMcPH9nzMddOre/5mFNk2y6PbbucbcD0LOu4XcbxdVd/IE/3k3OD16VmABhI8ALAQIIXAAYSvAAwkOAFgIEWCt6qurqqPlVVD1XV2+e0X1RVt87a76qqly2yPACYul0Hb1VdkOSXkrwxySuTXF9Vr9zS7S1J/qq7/2GSn0/y07tdHgAcBIuc8R5L8lB3P9zdn0vyG0mu3dLn2iTvmU3/ZpI3VNXc7zUBwPlgkeC9PMlnNt1/ZDZvbp/ufjbJU0levMAyAWDS9s2Hq6rqRFXdXVV3/8UTn191OQCwFIsE78kkm3/X8YrZvLl9qupQki9J8sS8wbr7pu4+2t1Hv/TFFyxQFgDsX4sE70eSvLyqvqKqnpfkuiS3b+lze5IbZtNvTvL7vR9/HBoABtn1/07U3c9W1duSrCW5IMnN3f2JqvqpJHd39+1J3pXk16vqoSRPZiOcAeC8tdB/C9jddyS5Y8u8d2ya/rsk/3SRZQDAQbJvPlwFAOcDwQsAAwleABhI8ALAQIIXAAYSvAAw0EJfJ2J5jh8+suoSVm5Z22Dt1PpSxl2WKdVrny2PbTutbXDs+DPbtjnjBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMdWnUBU3f88JFVl3BO1k6tr7qEHVvWtp3aPmN5HAvL2wZTeq0ZzRkvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMtOvgraorq+oPqupPquoTVfUjc/q8vqqeqqr12e0di5ULANN2aIHHPpvkX3X3x6rq0iQfrao7u/tPtvT7w+5+0wLLAYADY9dnvN39aHd/bDb910k+meTyvSoMAA6iPXmPt6peluRrk9w1p/kbq+qeqnpfVb1qL5YHAFNV3b3YAFVflOR/Jvn33f3bW9q+OMkXuvuzVXVNkl/o7pdvM86JJCeS5OJc8nWvq2sWqmuetVPrez7m8cNH9nzMZDm1slzLOhaWYVnH15S2QeJ5xoZlHLd39QfydD9Z89oWOuOtqguT/FaS924N3STp7qe7+7Oz6TuSXFhVL5k3Vnff1N1Hu/vohblokbIAYN9a5FPNleRdST7Z3T+3TZ8vn/VLVR2bLe+J3S4TAKZukU81/+Mk/zzJx6tqfTbv3yb5+0nS3TcmeXOSH6qqZ5P8bZLretFr2wAwYbsO3u7+oyRzr19v6vPOJO/c7TIA4KDxy1UAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADBQdfeqa3iOo6+5uD+8duWqyziQjh8+suoSdmzt1PpSxl3WNphSvcuqdWo8H6ZlSvvrrv5Anu4na16bM14AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEOrbqAeR6495IcP3xk1WVwQK2dWl91CedkSvUu63m7rG2wjHG9dk3PMo6DY8ef2bbNGS8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAZaOHir6tNV9fGqWq+qu+e0V1X9YlU9VFX3VtVrF10mAEzVXn2P91u6+y+3aXtjkpfPbl+f5JdnfwHgvDPiUvO1SX6tN3woyQuq6qUDlgsA+85eBG8neX9VfbSqTsxpvzzJZzbdf2Q2DwDOO3txqfl13X2yqr4syZ1VdX93f/BcB5mF9okkuTiX7EFZALD/LHzG290nZ38fT3JbkmNbupxMcuWm+1fM5m0d56buPtrdRy/MRYuWBQD70kLBW1XPr6pLT08nuSrJfVu63Z7ke2efbv6GJE9196OLLBcApmrRS82XJbmtqk6P9V+6+/eq6q1J0t03JrkjyTVJHkryTJLvX3CZADBZCwVvdz+c5DVz5t+4abqT/PAiywGAg8IvVwHAQIIXAAYSvAAwkOAFgIEELwAMVBsfOt5fjr7m4v7w2pVn73iAHT98ZNUlwDlbO7W+lHGX9XxYVr1TYtsux7Hjn8nd9/xdzWtzxgsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMNChVRcwzwP3XpLjh4+suowdWTu1vuoSzsmy6l3G/ppSrWyY2radWr0cDM54AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgoF0Hb1W9oqrWN92erqof3dLn9VX11KY+71i4YgCYsEO7fWB3fyrJkSSpqguSnExy25yuf9jdb9rtcgDgINmrS81vSPKn3f1nezQeABxIexW81yW5ZZu2b6yqe6rqfVX1qj1aHgBMUnX3YgNUPS/JqSSv6u7HtrR9cZIvdPdnq+qaJL/Q3S/fZpwTSU4kycW55OteV9csVNc8a6fW93xMluf44SOrLuHAmtpzYUrHwtS27bIsY58ta9suo9a7+gN5up+seW17ccb7xiQf2xq6SdLdT3f3Z2fTdyS5sKpeMm+Q7r6pu49299ELc9EelAUA+89eBO/12eYyc1V9eVXVbPrYbHlP7MEyAWCSdv2p5iSpqucn+bYkP7hp3luTpLtvTPLmJD9UVc8m+dsk1/Wi17YBYMIWCt7u/pskL94y78ZN0+9M8s5FlgEAB4lfrgKAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEOrbqAkY4fPrLqEnZs7dT6qks4J8vYtsvaBss6Dqa2z2CZlvF8mNJr+Jk44wWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADHVp1ASOtnVrf8zGPHz6y52OyYWrbdkr1LuO5MEVTek2Y2j47358Px44/s22bM14AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgoB0Fb1XdXFWPV9V9m+a9qKrurKoHZ39fuM1jb5j1ebCqbtirwgFginZ6xvvuJFdvmff2JB/o7pcn+cDs/v+nql6U5CeSfH2SY0l+YruABoDzwY6Ct7s/mOTJLbOvTfKe2fR7knzHnIceT3Jndz/Z3X+V5M48N8AB4LyxyE9GXtbdj86m/zzJZXP6XJ7kM5vuPzKb9xxVdSLJiSS5OJcsUBYA7F978uGq7u4kveAYN3X30e4+emEu2ouyAGDfWSR4H6uqlybJ7O/jc/qcTHLlpvtXzOYBwHlpkeC9PcnpTynfkOR35vRZS3JVVb1w9qGqq2bzAOC8tNOvE92S5I+TvKKqHqmqtyT5D0m+raoeTPKts/upqqNV9atJ0t1PJvl3ST4yu/3UbB4AnJd29OGq7r5+m6Y3zOl7d5J/sen+zUlu3lV1AHDA+OUqABhI8ALAQIIXAAYSvAAwkOAFgIEW+clIkqydWl91CZyjZe2z44ePLGXcZdS7rFqXZUr7bEq1Jsurd0rH7TLGfaCf2LbNGS8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECHVl3A1B0/fGTVJbBPrJ1aX8q4yzjGplTrMi1jO0xtG7Cc4+DY8We2bXPGCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAA501eKvq5qp6vKru2zTvZ6rq/qq6t6puq6oXbPPYT1fVx6tqvaru3sO6AWCSdnLG++4kV2+Zd2eSr+nuVyd5IMm/OcPjv6W7j3T30d2VCAAHx1mDt7s/mOTJLfPe393Pzu5+KMkVS6gNAA6cvXiP9weSvG+btk7y/qr6aFWd2INlAcCkHVrkwVX140meTfLebbq8rrtPVtWXJbmzqu6fnUHPG+tEkhNJcnEuWaSsbR0/fGTPx1w7tb7nYzJNyzi+EsfYMk3pNWFZx9eynO/b9oF+Ytu2XZ/xVtX3JXlTku/p7p7Xp7tPzv4+nuS2JMe2G6+7b+ruo9199MJctNuyAGBf21XwVtXVSX4sybd39zPb9Hl+VV16ejrJVUnum9cXAM4XO/k60S1J/jjJK6rqkap6S5J3Jrk0G5eP16vqxlnfw1V1x+yhlyX5o6q6J8mHk/xud//eUtYCACbirO/xdvf1c2a/a5u+p5JcM5t+OMlrFqoOAA4Yv1wFAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYKBDqy5g6o4fPrKUcddOrS9l3GVZxnZY1jawz6a3DaZU77JqnZopbdtl1Hrs+DPbtjnjBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAY6NCqC5jnq1/9TNbW1lddxkodP3xkKeOunVpfyrjLMLVtsKx6p2Rq+4xpHbcH5ThwxgsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIHOGrxVdXNVPV5V922a95NVdbKq1me3a7Z57NVV9amqeqiq3r6XhQPAFO3kjPfdSa6eM//nu/vI7HbH1saquiDJLyV5Y5JXJrm+ql65SLEAMHVnDd7u/mCSJ3cx9rEkD3X3w939uSS/keTaXYwDAAfGIu/xvq2q7p1din7hnPbLk3xm0/1HZvMA4Ly12+D95SRfleRIkkeT/OyihVTViaq6u6ru/osnPr/ocACwL+0qeLv7se7+fHd/IcmvZOOy8lYnk1y56f4Vs3nbjXlTdx/t7qNf+uILdlMWAOx7uwreqnrpprvfmeS+Od0+kuTlVfUVVfW8JNcluX03ywOAg+Ks/ztRVd2S5PVJXlJVjyT5iSSvr6ojSTrJp5P84Kzv4SS/2t3XdPezVfW2JGtJLkhyc3d/YhkrAQBTcdbg7e7r58x+1zZ9TyW5ZtP9O5I856tGAHC+8stVADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAY6KxfJ1qFB+69JMcPH1l1GTuydmp9UuMua7suo96pHAOnLWufTcnU9tky6p3ac3dKpvT6dSbOeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABjq06gJGWju1vudjHj98ZM/HTJZT6zItaztMyZS2wdSOr2WxHWyDVXDGCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAx06W4equjnJm5I83t1fM5t3a5JXzLq8IMn/6u4jcx776SR/neTzSZ7t7qN7UjUATNRZgzfJu5O8M8mvnZ7R3f/s9HRV/WySp87w+G/p7r/cbYEAcJCcNXi7+4NV9bJ5bVVVSb47yT/Z47oA4EDayRnvmXxTkse6+8Ft2jvJ+6uqk/zn7r5pu4Gq6kSSE0lycS5ZsCy2s3ZqfSnjHj98ZM/HXFatLGd/LdOy6p3SMTalWhOvCWeyaPBen+SWM7S/rrtPVtWXJbmzqu7v7g/O6zgL5ZuS5IvrRb1gXQCwL+36U81VdSjJdyW5dbs+3X1y9vfxJLclObbb5QHAQbDI14m+Ncn93f3IvMaqen5VXXp6OslVSe5bYHkAMHlnDd6quiXJHyd5RVU9UlVvmTVdly2XmavqcFXdMbt7WZI/qqp7knw4ye929+/tXekAMD07+VTz9dvM/745804luWY2/XCS1yxYHwAcKH65CgAGErwAMJDgBYCBBC8ADCR4AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAh1ZdwDxf/epnsra2vuoyVur44SOrLuHAWta2XTu1vpRxp3Qs2AbTqjVZ3j5je854AWAgwQsAAwleABhI8ALAQIIXAAYSvAAwkOAFgIEELwAMJHgBYCDBCwADCV4AGEjwAsBAghcABhK8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwECCFwAGqu5edQ3PUVV/keTPdtD1JUn+csnlrMpBXbeDul7JwV036zU9B3XdprRe/6C7v3Rew74M3p2qqru7++iq61iGg7puB3W9koO7btZreg7quh2U9XKpGQAGErwAMNDUg/emVRewRAd13Q7qeiUHd92s1/Qc1HU7EOs16fd4AWBqpn7GCwCTMongraqrq+pTVfVQVb19TvtFVXXrrP2uqnrZCso8Z1V1ZVX9QVX9SVV9oqp+ZE6f11fVU1W1Pru9YxW1nquq+nRVfXxW891z2quqfnG2z+6tqteuos5zUVWv2LQf1qvq6ar60S19JrO/qurmqnq8qu7bNO9FVXVnVT04+/vCbR57w6zPg1V1w7iqz26b9fqZqrp/dqzdVlUv2OaxZzxuV22bdfvJqjq56Zi7ZpvHnvF1dJW2Wa9bN63Tp6tqfZvH7ut9Nld37+tbkguS/GmSr0zyvCT3JHnllj7/MsmNs+nrkty66rp3uG4vTfLa2fSlSR6Ys26vT/LfV13rLtbt00lecob2a5K8L0kl+YYkd6265nNcvwuS/Hk2vqs3yf2V5JuTvDbJfZvm/cckb59Nvz3JT8953IuSPDz7+8LZ9AtXvT5nWa+rkhyaTf/0vPWatZ3xuF31bZt1+8kk//osjzvr6+h+W68t7T+b5B1T3GfzblM44z2W5KHufri7P5fkN5Jcu6XPtUneM5v+zSRvqKoaWOOudPej3f2x2fRfJ/lkkstXW9Uw1yb5td7woSQvqKqXrrqoc/CGJH/a3Tv5oZd9qbs/mOTJLbM3P5fek+Q75jz0eJI7u/vJ7v6rJHcmuXpZdZ6reevV3e/v7mdndz+U5Irhhe2BbfbZTuzkdXRlzrRes9fy705yy9CilmgKwXt5ks9suv9InhtO/6/P7Mn1VJIXD6luj8wuj39tkrvmNH9jVd1TVe+rqleNrWzXOsn7q+qjVXViTvtO9ut+dl22fyGY4v467bLufnQ2/edJLpvTZ+r77geycbVlnrMdt/vV22aX0W/e5u2BKe+zb0ryWHc/uE375PbZFIL3wKuqL0ryW0l+tLuf3tL8sWxcznxNkv+U5L8NLm+3Xtfdr03yxiQ/XFXfvOqC9kpVPS/Jtyf5r3Oap7q/nqM3ruMdqK89VNWPJ3k2yXu36TLF4/aXk3xVkiNJHs3GZdmD5Pqc+Wx3cvtsCsF7MsmVm+5fMZs3t09VHUryJUmeGFLdgqrqwmyE7nu7+7e3tnf309392dn0HUkurKqXDC7znHX3ydnfx5Pclo1LXZvtZL/uV29M8rHufmxrw1T31yaPnb7kP/v7+Jw+k9x3VfV9Sd6U5Htm/6h4jh0ct/tOdz/W3Z/v7i8k+ZXMr3mq++xQku9Kcut2faa4z6YQvB9J8vKq+orZmcZ1SW7f0uf2JKc/WfnmJL+/3RNrP5m9d/GuJJ/s7p/bps+Xn36/uqqOZWOf7et/VFTV86vq0tPT2fhgy31but2e5Htnn27+hiRPbbrEud9t+y/wKe6vLTY/l25I8jtz+qwluaqqXji7rHnVbN6+VVVXJ/mxJN/e3c9s02cnx+2+s+WzEd+Z+TXv5HV0P/rWJPd39yPzGqe6z1b+6a6d3LLxCdgHsvGpvB+fzfupbDyJkuTibFz2eyjJh5N85apr3uF6vS4bl/LuTbI+u12T5K1J3jrr87Ykn8jGpxA/lOQfrbruHazXV87qvWdW++l9tnm9Kskvzfbpx5McXXXdO1y352cjSL9k07xJ7q9s/OPh0ST/Jxvv+b0lG5+N+ECSB5P8jyQvmvU9muRXNz32B2bPt4eSfP+q12UH6/VQNt7jPP08O/0tiMNJ7jjTcbufbtus26/PnkP3ZiNMX7p13Wb3n/M6ul9u89ZrNv/dp59bm/pOap/Nu/nlKgAYaAqXmgHgwBC8ADCQ4AWAgQQvAAwkeAFgIMELAAMJXgAYSPACwED/F0VBn80houokAAAAAElFTkSuQmCC\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>