
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix A: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.97 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.30769231,  0.56410256,  0.92307692,  1.79487179,  3.48717949,
         6.51282051,  8.20512821, 11.74358974, 12.30769231,  5.43589744]),
 array([0.775 , 0.7945, 0.814 , 0.8335, 0.853 , 0.8725, 0.892 , 0.9115,
        0.931 , 0.9505, 0.97  ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "6dc600dbfb0f42b78a4dffc3d474fcda"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.0016423896576542598
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "6321e10074704f00a7af2db80f170277"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f68f45c9210&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "5a6a5b0dfb8c4ef4bf72e0fc7644d69a"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"c83050838ae541ed80dcb5a6268f72e5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6dc600dbfb0f42b78a4dffc3d474fcda": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_02d35fe44e0e483283632de4a697a133", "IPY_MODEL_ad15d743a9ff4dccb17a785341151b7d"], "layout": "IPY_MODEL_c83050838ae541ed80dcb5a6268f72e5"}}, "fe7c580444584c338a26ebd626c308cc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "08252e8b1adb45e680512bd81fd51d58": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "02d35fe44e0e483283632de4a697a133": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_fe7c580444584c338a26ebd626c308cc", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_08252e8b1adb45e680512bd81fd51d58", "value": 1}}, "2e6c167a804b4339819c2d368eba03ee": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ad15d743a9ff4dccb17a785341151b7d": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_2e6c167a804b4339819c2d368eba03ee", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "iVBORw0KGgoAAAANSUhEUgAAAQUAAAD4CAYAAADl7fPiAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAANw0lEQVR4nO3df4xlZX3H8fenC9aEksrPlR8LGEtIqOluzWStKW2gKAuEiDbWQpoWW5q1RpKatGlom4ix/9g0lqRioKtuwEZR+2OVxJVlQ5sgiYoLWX4pP7ZkDTsgK2BBq41d/PaPOWvmGe5lp/fcO/fO+H4lk3vOeZ57z3Myu5+cc88z55uqQpIO+7lpD0DSbDEUJDUMBUkNQ0FSw1CQ1Dhq2gMY5MTj19VZG46e9jCkNWv/k//Ls8+/lEFtMxkKZ204mnt2bZj2MKQ1a/OWJ4e2efkgqWEoSGoYCpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqTGTMxqlWbHl1E3L7rvrqb1rYgyeKUhqGAqSGoaCpIahIKlhKEhqGAqSGoaCpMYR5ykk2Q5cBhysqjd02z4HnNN1eQ3wX1W1acB79wPfB14CDlXV3FhGLWliljN56WbgBuBThzdU1e8eXk7yEeCFV3j/BVX17KgDlLSyjhgKVXVXkrMGtSUJ8C7gt8Y8LklT0nea828Az1TV40PaC7gjSQH/WFXbhn1Qkq3AVoAzTnP2tWbDLExdXml9//ddCdz6Cu3nVdV8kpOB3Ukeqaq7BnXsAmMbwNzGV1v1VpqSke8+JDkK+G3gc8P6VNV893oQ2AFsHnV/klZGn1uSbwEeqaoDgxqTHJPk2MPLwEXAQz32J2kFHDEUktwKfBU4J8mBJFd3TVew5NIhyalJdnar64G7k9wP3AN8qapuH9/QJU3Ccu4+XDlk+7sHbHsKuLRbfgLY2HN8klaYMxolNQwFSQ1DQVLDUJDUMBQkNZxPLE3BpKZPj4NnCpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqWEoSGos5xmN25McTPLQom0fTDKfZG/3c+mQ916c5NEk+5JcO86BS5qM5Zwp3AxcPGD79VW1qfvZubQxyTrgY8AlwLnAlUnO7TNYSZN3xFDoirc8P8Jnbwb2VdUTVfVj4LPA5SN8jqQV1Oc7hWuSPNBdXhw3oP004MlF6we6bQMl2ZpkT5I9333upR7DktTHqKFwI/B6YBPwNPCRvgOpqm1VNVdVcyedsK7vx0ka0UihUFXPVNVLVfUT4OMMLgc3D2xYtH56t03SDBspFJKcsmj1HQwuB/cN4Owkr0vyKhYqSt02yv4krZwjPqOxKxt3PnBikgPAdcD5STaxUGp+P/Ceru+pwCeq6tKqOpTkGmAXsA7YXlUPT+IgJI3PqGXjPjmk70/LxnXrO4GX3a6UNLt8mrO0hmw5ddOy+j1Wzw1tc5qzpIahIKlhKEhqGAqSGoaCpIahIKlhKEhqGAqSGoaCpIYzGqU1ZNdTe5fVb/OWHw5t80xBUsNQkNQwFCQ1DAVJDUNBUsNQkNQwFCQ1Ri0b93dJHunqPuxI8poh792f5MGutNyeMY5b0oSMWjZuN/CGqvoV4DHgL1/h/Rd0peXmRhuipJU0Utm4qrqjqg51q19joaaDpDVgHN8p/BHw5SFtBdyR5N4kW1/pQywbJ82GXn/7kOSvgUPAp4d0Oa+q5pOcDOxO8kh35vEyVbUN2AYwt/HV1WdckkY38plCkncDlwG/V1UD/xNX1Xz3ehDYweDycpJmyKhl4y4G/gJ4W1UN/HOrJMckOfbwMnARg8vLSZohy7kleSvwVeCcJAeSXA3cABzLwiXB3iQ3dX1PTXK4ItR64O4k9wP3AF+qqtsnchSSxmZiZeOq6glgY6/RSVpxzmiU1DAUJDUMBUkNQ0FSw1CQ1DAUJDUMBUkNQ0FSw1CQ1DAUJDUMBUkNQ0FSw1CQ1DAUJDUMBUkNQ0FSw1CQ1DAUJDWWFQpDSscdn2R3kse71+OGvPeqrs/jSa4a18AlTcZyzxRu5uWl464F7qyqs4E7u/VGkuOB64A3sfB49+uGhYek2bCsUBhUOg64HLilW74FePuAt24BdlfV81X1PRZqUC4NF0kzpM93Cuur6ulu+TssPNJ9qdOAJxetH+i2SZpRY/misasQ1avUm7UkpdnQJxSeSXIKQPd6cECfeWDDovXTu20vU1XbqmququZOOmFdj2FJ6qNPKNwGHL6bcBXwxQF9dgEXJTmu+4Lxom6bpBm13FuSg0rHfRh4a5LHgbd06ySZS/IJgKp6Hvgb4Bvdz4e6bZJm1LJK0Q8pHQdw4YC+e4A/XrS+Hdg+0ugkrThnNEpqGAqSGoaCpIahIKlhKEhqGAqSGoaCpIahIKlhKEhqGAqSGoaCpIahIKlhKEhqGAqSGoaCpIahIKlhKEhqGAqSGoaCpMbIoZDknCR7F/28mOT9S/qcn+SFRX0+0HvEkiZqWQ9uHaSqHgU2ASRZx0I9hx0Dun6lqi4bdT+SVta4Lh8uBP6zqr49ps+TNCXjCoUrgFuHtL05yf1Jvpzkl4d9gGXjpNnQOxSSvAp4G/DPA5rvA86sqo3AR4EvDPscy8ZJs2EcZwqXAPdV1TNLG6rqxar6Qbe8Ezg6yYlj2KekCRlHKFzJkEuHJK9Nkm55c7e/58awT0kTMvLdB4AkxwBvBd6zaNufAFTVTcA7gfcmOQT8CLiiK1svaUb1CoWq+m/ghCXbblq0fANwQ599SFpZzmiU1DAUJDUMBUkNQ0FSw1CQ1DAUJDUMBUkNQ0FSw1CQ1DAUJDUMBUkNQ0FSw1CQ1DAUJDUMBUkNQ0FSw1CQ1DAUJDXG8Yj3/Uke7MrC7RnQniT/kGRfkgeSvLHvPiVNTq9nNC5yQVU9O6TtEuDs7udNwI3dq6QZtBKXD5cDn6oFXwNek+SUFdivpBGMIxQKuCPJvUm2Dmg/DXhy0fqBblvDsnHSbBjH5cN5VTWf5GRgd5JHququ/++HVNU2YBvA3MZXWxtCmpLeZwpVNd+9HmShFP3mJV3mgQ2L1k/vtkmaQb1CIckxSY49vAxcBDy0pNttwB90dyF+DXihqp7us19Jk9P38mE9sKMrF3kU8Jmqun1J6bidwKXAPuCHwB/23KekCepbNu4JYOOA7YtLxxXwvj77kbRyxjVPYVXYcuqmZffd9dTeiY1DmmVOc5bUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDU+Jma0egsRenIPFOQ1DAUJDUMBUkNQ0FSw1CQ1DAUJDUMBUmNkUMhyYYk/5Hkm0keTvKnA/qcn+SFrqTc3iQf6DdcSZPWZ/LSIeDPquq+7onO9ybZXVXfXNLvK1V1WY/9SFpBI58pVNXTVXVft/x94FsMqPwkaXUZyzTnJGcBvwp8fUDzm5PcDzwF/HlVPTzkM7YCWwHOOO1nava1NDbLfTjxY/Xc0LZxlKL/BeBfgfdX1YtLmu8DzqyqjcBHgS8M+5yq2lZVc1U1d9IJ6/oOS9KI+laIOpqFQPh0Vf3b0vaqerGqftAt7wSOTnJin31Kmqw+dx8CfBL4VlX9/ZA+r+36kWRzt7/h5y2Spq7PxfuvA78PPJhkb7ftr4Az4KdVot4JvDfJIeBHwBVdxShJM2rkUKiqu4Ecoc8NwA2j7kPSynNGo6SGoSCpYShIahgKkhqGgqSG84mHWO500UnxydOaFs8UJDUMBUkNQ0FSw1CQ1DAUJDUMBUkNQ0FSw1CQ1DAUJDUMBUkNpzkP4TRjrUbL/Xe7ecsPh7Z5piCp0fdpzhcneTTJviTXDmj/+SSf69q/3tWHkDTD+jzNeR3wMeAS4FzgyiTnLul2NfC9qvol4Hrgb0fdn6SV0edMYTOwr6qeqKofA58FLl/S53Lglm75X4ALDz/yXdJs6hMKpwFPLlo/wMtrSf60T1UdAl4AThj0YUm2JtmTZM93n3upx7Ak9TEzXzRaNk6aDX1CYR7YsGj99G7bwD5JjgJ+EStESTOtTyh8Azg7yeuSvAq4ArhtSZ/bgKu65XcC/26FKGm29akQdSjJNcAuYB2wvaoeTvIhYE9V3cZCrcl/SrIPeJ6F4JA0w3rNaOwqSe9csu0Di5b/B/idPvuQtLIyi2fzSb4LfHvJ5hOBZ6cwnElbq8cFa/fY1sJxnVlVJw1qmMlQGCTJnqqam/Y4xm2tHhes3WNbq8d12MzckpQ0GwwFSY3VFArbpj2ACVmrxwVr99jW6nEBq+g7BUkrYzWdKUhaAYaCpMaqCIUjPcxltUqyP8mDSfYm2TPt8fSRZHuSg0keWrTt+CS7kzzevR43zTGOYshxfTDJfPd725vk0mmOcdxmPhSW+TCX1eyCqtq0Bu573wxcvGTbtcCdVXU2cGe3vtrczMuPC+D67ve2qZvZu2bMfCiwvIe5aMqq6i4W/r5lscUP2bkFePtKjmkchhzXmrYaQmE5D3NZrQq4I8m9SbZOezATsL6qnu6WvwOsn+ZgxuyaJA90lxer7rLolayGUFjLzquqN7JwafS+JL857QFNSvcn82vl/veNwOuBTcDTwEemOpoxWw2hsJyHuaxKVTXfvR4EdrBwqbSWPJPkFIDu9eCUxzMWVfVMVb1UVT8BPs4a+72thlBYzsNcVp0kxyQ59vAycBHw0Cu/a9VZ/JCdq4AvTnEsY3M46DrvYI393ma+QtSwh7lMeVjjsB7Y0T3c+ijgM1V1+3SHNLoktwLnAycmOQBcB3wY+HySq1n4U/h3TW+EoxlyXOcn2cTC5dB+4D3TGt8kOM1ZUmM1XD5IWkGGgqSGoSCpYShIahgKkhqGgqSGoSCp8X/QTv5HSPgaaAAAAABJRU5ErkJggg==\n"}}]}}, "0d95c43968234d9d857e431ee3ef4bd5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6321e10074704f00a7af2db80f170277": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_71c71a25afb444ae964e82a428bc5da7", "IPY_MODEL_05bcb1f17cfe44f4bc647ab36318de96"], "layout": "IPY_MODEL_0d95c43968234d9d857e431ee3ef4bd5"}}, "97811b9c115a4d12b93350602c0ad9a0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d7688add97744bfcbb328c713aa41da2": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "71c71a25afb444ae964e82a428bc5da7": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_97811b9c115a4d12b93350602c0ad9a0", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_d7688add97744bfcbb328c713aa41da2", "value": 1}}, "f8b83e8449994daf959fb3e7f5aaa372": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "05bcb1f17cfe44f4bc647ab36318de96": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_f8b83e8449994daf959fb3e7f5aaa372", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "2930c6a6705b46709e7012ea10884ff5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5a6a5b0dfb8c4ef4bf72e0fc7644d69a": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_fb90922a85fa4b6dac1ccc4814cfe12f", "IPY_MODEL_b57b9d118bb148b1b8826a1cde3025b7"], "layout": "IPY_MODEL_2930c6a6705b46709e7012ea10884ff5"}}, "5399fc68efbb47a88fff7ecb5bd02879": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "225e47fe8a8c4ca0b281f29c5094ace2": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "fb90922a85fa4b6dac1ccc4814cfe12f": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_5399fc68efbb47a88fff7ecb5bd02879", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_225e47fe8a8c4ca0b281f29c5094ace2", "value": 1}}, "ede9e74d34aa41ffb45c10b077e35bb7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b57b9d118bb148b1b8826a1cde3025b7": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_ede9e74d34aa41ffb45c10b077e35bb7", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>