
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B2: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.865 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.20512821,  0.25641026,  0.97435897,  1.17948718,  1.43589744,
         2.25641026,  5.43589744,  7.84615385, 14.1025641 , 17.58974359]),
 array([0.67  , 0.6895, 0.709 , 0.7285, 0.748 , 0.7675, 0.787 , 0.8065,
        0.826 , 0.8455, 0.865 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "9a9802bd413b448f8a7558933cd48d82"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.00020962014115508026
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "72d5abd00bff45b7b4f039c2a1160c47"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fbf04b491d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "92ae69322ab24bdb8332abb286bdca48"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"90a189ca875e4b628e706f19707b2a31": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9a9802bd413b448f8a7558933cd48d82": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_29c26206cdab462aaeb492ce4c6cb559", "IPY_MODEL_6af04dfd89684da283d221c9403b1d32"], "layout": "IPY_MODEL_90a189ca875e4b628e706f19707b2a31"}}, "d47b183744ad4e05b482a2fb91c7ca99": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4511996cb7f146f4bdd43884f67d9093": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "29c26206cdab462aaeb492ce4c6cb559": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_d47b183744ad4e05b482a2fb91c7ca99", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_4511996cb7f146f4bdd43884f67d9093", "value": 1}}, "57c6239db69c4d4280233f27af73fa8f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6af04dfd89684da283d221c9403b1d32": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_57c6239db69c4d4280233f27af73fa8f", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "25dbcc7adb594be9a52cb2da6d926b54": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "72d5abd00bff45b7b4f039c2a1160c47": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_a2e131b412994cebbd8044ad705aec96", "IPY_MODEL_130e65a1a86045d59570aec67ae799d6"], "layout": "IPY_MODEL_25dbcc7adb594be9a52cb2da6d926b54"}}, "0bb11df2af7a46d9a675c28971778591": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8fe142e572c1441f876f35ce67bbc2e3": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "a2e131b412994cebbd8044ad705aec96": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_0bb11df2af7a46d9a675c28971778591", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_8fe142e572c1441f876f35ce67bbc2e3", "value": 1}}, "00a70050754a4e518f93c99b9942d2a2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "130e65a1a86045d59570aec67ae799d6": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_00a70050754a4e518f93c99b9942d2a2", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "d0b8cf90b29b4b1bb105e5f30bd5183b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "92ae69322ab24bdb8332abb286bdca48": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_342d643a9cf14ea090aa6fc387fc4a34", "IPY_MODEL_4263778d48524016a7435eb676058e29"], "layout": "IPY_MODEL_d0b8cf90b29b4b1bb105e5f30bd5183b"}}, "472d98fd1f334cf8bd734c19ffc134e9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f24a42a7379140e89309dab245ddd854": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "342d643a9cf14ea090aa6fc387fc4a34": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_472d98fd1f334cf8bd734c19ffc134e9", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_f24a42a7379140e89309dab245ddd854", "value": 1}}, "414df27e747c432f8fa2905701c7b292": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4263778d48524016a7435eb676058e29": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_414df27e747c432f8fa2905701c7b292", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>