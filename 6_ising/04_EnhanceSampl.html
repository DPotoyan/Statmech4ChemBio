
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/02_Legendre.html">
     Legendre transform
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/ensemble_overview.html">
     Overview of ensembles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Gases
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/photons_phonons.html">
     Photons and Phonons
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.895 0.81
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.1025641 ,  0.05128205,  0.05128205,  0.82051282,  1.38461538,
         2.15384615,  4.        ,  8.30769231, 15.58974359, 18.82051282]),
 array([0.7   , 0.7195, 0.739 , 0.7585, 0.778 , 0.7975, 0.817 , 0.8365,
        0.856 , 0.8755, 0.895 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "14c40d786c014c719e2f0b9ee0c824b1"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0001396686290429171
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "8d451a99081b471cafd64901be542f10"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f0b25e5f890&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "34584a80f9394927909376d0e51e2323"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"6840502e4016467fa6a11ac33794c2b2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "14c40d786c014c719e2f0b9ee0c824b1": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_be9045a4aea243c9bc7da61e20a09439", "IPY_MODEL_5bbf702b75ff4c97be79af0454a12364"], "layout": "IPY_MODEL_6840502e4016467fa6a11ac33794c2b2"}}, "80f4bcee42f44ba88a1596422445d222": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "462724cda106476399bef0196bbfddf6": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "be9045a4aea243c9bc7da61e20a09439": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_80f4bcee42f44ba88a1596422445d222", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_462724cda106476399bef0196bbfddf6", "value": 1}}, "e4c38bd71a19459686b2cebe8f50ddb8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5bbf702b75ff4c97be79af0454a12364": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_e4c38bd71a19459686b2cebe8f50ddb8", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "d661a1774d4e43ec91d869d06734f4e0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8d451a99081b471cafd64901be542f10": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_051fc62d0c5e45cca808b15f4a2c73d6", "IPY_MODEL_f28a1128a1d24aa9aa875c7d8c7f4f28"], "layout": "IPY_MODEL_d661a1774d4e43ec91d869d06734f4e0"}}, "b34d59517c8b431bb62fa091b40b3a91": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5826b9a2d64748cdac01c1f8051fea66": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "051fc62d0c5e45cca808b15f4a2c73d6": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_b34d59517c8b431bb62fa091b40b3a91", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_5826b9a2d64748cdac01c1f8051fea66", "value": 1}}, "aa5c148db42746a0a37abec2276eb30b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f28a1128a1d24aa9aa875c7d8c7f4f28": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_aa5c148db42746a0a37abec2276eb30b", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "556d08fc733b4c99b03e55177478fe2a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "34584a80f9394927909376d0e51e2323": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_6cd8ad258c3d47b1acb14d104e9c3093", "IPY_MODEL_af56f0bb041b4c63b528ece775098d66"], "layout": "IPY_MODEL_556d08fc733b4c99b03e55177478fe2a"}}, "7c45c4d3bd1e4f2e8bf97a810ed056c7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d2a11398339042f1aa13f3105179450b": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "6cd8ad258c3d47b1acb14d104e9c3093": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_7c45c4d3bd1e4f2e8bf97a810ed056c7", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_d2a11398339042f1aa13f3105179450b", "value": 1}}, "280bfb2848f244dfbc43605eca88cc3a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "af56f0bb041b4c63b528ece775098d66": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_280bfb2848f244dfbc43605eca88cc3a", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>