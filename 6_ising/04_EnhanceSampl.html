
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/02_Legendre.html">
     Legendre transform
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/ensemble_overview.html">
     Overview of ensembles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Gases
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/photons_phonons.html">
     Photons and Phonons
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/landauer.html">
     Information erasure and Landauer’s principle
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-in-a-nutshell">
     Simulated annealing in a nutshell
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#challanges">
       Challanges
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-in-a-nutshell">
     Simulated annealing in a nutshell
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#challanges">
       Challanges
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d_umbrella</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span> 
                <span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                <span class="n">U_k</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">U_m</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="n">n_steps</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> 
                <span class="n">out_freq</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                <span class="n">wall</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Metropolis Monte Carlo simulator of 2D Ising model with harmonic potentials for umbrella sampling</span>
<span class="sd">    ---</span>
<span class="sd">    spins:    (int, int), 2D numpy array</span>
<span class="sd">    T, J, B:  (floats), corresponding to temperature, coupling and field variables</span>
<span class="sd">    n_steps:  (int), simulation steeps</span>
<span class="sd">    out_freq: (int), How often to compute and save data</span>
<span class="sd">    U_k, U_m: (floats), spring constant and minima defining harmonic potential U_k*(M-U_m)**2</span>
<span class="sd">    wall: can alos resrict sampling by imposing walls with infinitely high energies</span>
<span class="sd">    ---</span>
<span class="sd">    Returns:</span>
<span class="sd">    E/N: per-spin energy over n steps  </span>
<span class="sd">    M/N: per-spin magnetization over n steps </span>
<span class="sd">    S:   2D spin configurations over n steps </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="c1">#### Initialize simulation</span>
    <span class="n">N</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    <span class="n">n</span>   <span class="o">=</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span>
    
    <span class="n">M_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    <span class="n">E_t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> 
            <span class="n">z</span>    <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i,(j+1)%N] + spins[i,(j-1)%N]
            <span class="n">E_t</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="n">z</span>

    <span class="c1">#### Run MC Simulation</span>
    <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
        
        <span class="c1"># Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Neighbours of spin i,j</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 

        <span class="c1">#Change in Energy of the lattice</span>
        <span class="n">dE</span>    <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="n">U_k</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">M_t</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="n">U_m</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">M_t</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="n">U_m</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>

        <span class="c1"># Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">():</span>
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            <span class="n">E_t</span>        <span class="o">+=</span> <span class="n">dE</span> 
            <span class="n">M_t</span>        <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>

        <span class="c1"># Save Thermo data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
            <span class="n">E</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
            <span class="n">S</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_US</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;N steps&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$E$&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;N steps&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$m$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;$\langle m \rangle=$</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">1000</span><span class="p">:])</span><span class="si">:</span><span class="s1">.02f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$P(m)$&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Vary umbrella potential from 0 to 1000. Study how Tc affects the U_k and U_m </span>

<span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d_umbrella</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span> 
                <span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                <span class="n">U_k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">U_m</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> 
                <span class="n">n_steps</span><span class="o">=</span><span class="mi">2000000</span><span class="p">,</span> 
                <span class="n">out_freq</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plot_US</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">E</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_13_0.png" src="../_images/04_EnhanceSampl_13_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Is a widely used Monte Carlo technique used for <strong>numerical optimization</strong> In chemical and biological applications simulated annealing is used for finding global minima of a complex multidimensional energy functions&gt;</p>
<p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p>
<div class="section" id="simulated-annealing-in-a-nutshell">
<h3>Simulated annealing in a nutshell<a class="headerlink" href="#simulated-annealing-in-a-nutshell" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Sample with metropolis algorithm where the acceptance probability takes the form <span class="math notranslate nohighlight">\(min (1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For finding maximum simply change the sign: <span class="math notranslate nohighlight">\(min (1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
<li><p><strong>“Slow cooling” is the main idea of simulated annealing</strong></p></li>
</ul>
</div>
<div class="section" id="id2">
<h3><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_19_0.png" src="../_images/04_EnhanceSampl_19_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.001007914813843765
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_23_1.png" src="../_images/04_EnhanceSampl_23_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "f87a7263cd324e37b6c130a10b885f51"}
</script></div>
</div>
</div>
<div class="section" id="challanges">
<h4>Challanges<a class="headerlink" href="#challanges" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.</p></li>
</ul>
</li>
<li><p><strong>Parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.</p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+PT ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>    
    
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="c1">#T[i], T[j] = T[j], T[i]</span>
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">T</span><span class="p">]</span>
    
    <span class="c1"># Exchange attemps</span>
    <span class="k">for</span> <span class="n">swap_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> 
    
        <span class="n">configs</span>  <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    
        <span class="c1">#mcmc in between exchange attemp</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)):</span> 
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>        <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c1"># magnetic field</span>

<span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span>   <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span>  <span class="o">=</span> <span class="mi">10000</span>
<span class="n">out_freq</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">E2</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="n">E3</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7faf3da4e4d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_33_1.png" src="../_images/04_EnhanceSampl_33_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "0f057e0f06c44679afaa9e4c489b211b"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhance the sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancement of sampling with respect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"101f3c8f19ea40d688befca925c3c2bb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f87a7263cd324e37b6c130a10b885f51": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_edb0954890264ab4b61cc6348f619b62", "IPY_MODEL_248a0c63e38948df97aabd43bc4677f8"], "layout": "IPY_MODEL_101f3c8f19ea40d688befca925c3c2bb"}}, "21adc46c09fe447aabdbf31bd53534ef": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "029fc339668b47fe9aeee8ca3bc5bbcd": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "edb0954890264ab4b61cc6348f619b62": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_21adc46c09fe447aabdbf31bd53534ef", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_029fc339668b47fe9aeee8ca3bc5bbcd", "value": 1}}, "6f88db27d3024ffd83b36fccf4d5cfeb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "248a0c63e38948df97aabd43bc4677f8": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_6f88db27d3024ffd83b36fccf4d5cfeb", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "efd87c9ab4184bea94915084a226bd12": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0f057e0f06c44679afaa9e4c489b211b": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_fa225e5b8f5f4ede932c7aadefdd3c13", "IPY_MODEL_93b6ca9899af404caa9906e13aa30777"], "layout": "IPY_MODEL_efd87c9ab4184bea94915084a226bd12"}}, "3fd2e41859774b6fb8cdca149d78dd05": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c5a2488a6ce74ec9b0af1b59818ee254": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "fa225e5b8f5f4ede932c7aadefdd3c13": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_3fd2e41859774b6fb8cdca149d78dd05", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_c5a2488a6ce74ec9b0af1b59818ee254", "value": 1}}, "ab76f87432de4f7c99f4eaec0b0f3503": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "93b6ca9899af404caa9906e13aa30777": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_ab76f87432de4f7c99f4eaec0b0f3503", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>