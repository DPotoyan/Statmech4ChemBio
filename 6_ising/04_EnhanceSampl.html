
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B2: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.93 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.15384615,  0.35897436,  0.92307692,  1.38461538,  1.69230769,
         2.56410256,  7.07692308,  8.76923077, 14.76923077, 13.58974359]),
 array([0.735 , 0.7545, 0.774 , 0.7935, 0.813 , 0.8325, 0.852 , 0.8715,
        0.891 , 0.9105, 0.93  ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "fcf00ba22c73414cafeebc5aa021afdf"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0009633712663158142
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "d2557106b34a43eea3d6d4b8f313f2ec"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7ff96df81950&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "e622edffeaaa476fb27816386f00a908"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"442e63935475449bac79190e06ce26ee": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fcf00ba22c73414cafeebc5aa021afdf": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_425a07e6df294ae9a45f4e87c4108af2", "IPY_MODEL_c720b1c24e6640ad84e64359cfa930c8"], "layout": "IPY_MODEL_442e63935475449bac79190e06ce26ee"}}, "ac30f28fb7a845aea0129d802e8a8123": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0a55a6cf93284e8d823c80ede8ca7fbd": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "425a07e6df294ae9a45f4e87c4108af2": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_ac30f28fb7a845aea0129d802e8a8123", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_0a55a6cf93284e8d823c80ede8ca7fbd", "value": 1}}, "f0181d4c69bf45338c5f070e4beb54a4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c720b1c24e6640ad84e64359cfa930c8": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_f0181d4c69bf45338c5f070e4beb54a4", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "19fd3b705b044eb1b2ab41f1b98ae331": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d2557106b34a43eea3d6d4b8f313f2ec": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_1bf4e0c2650845768185f101267f989d", "IPY_MODEL_776ca4cdebdc44c9b4acb14a8f494519"], "layout": "IPY_MODEL_19fd3b705b044eb1b2ab41f1b98ae331"}}, "3badca33d9224259812790cc93b6e47e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cbdcaf2b756043718ae79279e8e1c40b": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "1bf4e0c2650845768185f101267f989d": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_3badca33d9224259812790cc93b6e47e", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_cbdcaf2b756043718ae79279e8e1c40b", "value": 1}}, "f3d9cb2b4df14f9bbefb449fd749b937": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "776ca4cdebdc44c9b4acb14a8f494519": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_f3d9cb2b4df14f9bbefb449fd749b937", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "22448dd61c774649b992e2e54fb59379": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e622edffeaaa476fb27816386f00a908": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_ec9b678658644e6086249d6fc3d7dc5b", "IPY_MODEL_8ca3ba22baec4fbda47a7208f2fabb61"], "layout": "IPY_MODEL_22448dd61c774649b992e2e54fb59379"}}, "59b38e7b1df94d97b008c39b5f71b1fa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0e448f516dfd4b76b298cb8301ba350f": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "ec9b678658644e6086249d6fc3d7dc5b": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_59b38e7b1df94d97b008c39b5f71b1fa", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_0e448f516dfd4b76b298cb8301ba350f", "value": 1}}, "fdc42f5fc7c0424baf6c3bd33d131ff0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8ca3ba22baec4fbda47a7208f2fabb61": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_fdc42f5fc7c0424baf6c3bd33d131ff0", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>