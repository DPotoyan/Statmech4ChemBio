
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Statistical Mechanics for Chemistry and Biology
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python refresher
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Why Python?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Probability and randomness
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B2: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics refresher
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.895 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.1025641 ,  0.15384615,  0.35897436,  0.76923077,  1.48717949,
         2.46153846,  4.35897436,  8.35897436, 15.28205128, 17.94871795]),
 array([0.7   , 0.7195, 0.739 , 0.7585, 0.778 , 0.7975, 0.817 , 0.8365,
        0.856 , 0.8755, 0.895 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "405275d951e842baa7d50355d9331467"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.0007527528727535933
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "b98c7bc066e94cd8a8ae842c982b7e1a"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7ff9e6fb86d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "477358fdb24944e39f336f7d4fc5388a"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"304956e28c624317a213d7cc265d7387": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "405275d951e842baa7d50355d9331467": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_dde81f43f15147c99cd55e1a11fde440", "IPY_MODEL_e6002959305849a6bedbbf8bfd7f1726"], "layout": "IPY_MODEL_304956e28c624317a213d7cc265d7387"}}, "dc4906d6da1c40e883a8742ead32381d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8df2b86ab0704650bbc2ee1c02d7d83d": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "dde81f43f15147c99cd55e1a11fde440": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_dc4906d6da1c40e883a8742ead32381d", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_8df2b86ab0704650bbc2ee1c02d7d83d", "value": 1}}, "a69b7fe5521f4456970320d5b6f9ac5a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e6002959305849a6bedbbf8bfd7f1726": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_a69b7fe5521f4456970320d5b6f9ac5a", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "255cd80fec5d4213bcddb456d42917e4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b98c7bc066e94cd8a8ae842c982b7e1a": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_f97b794d0cf24d2cb3a91512828f80ee", "IPY_MODEL_d1e95da12e3c4eb2a80a0ea0150d6c86"], "layout": "IPY_MODEL_255cd80fec5d4213bcddb456d42917e4"}}, "adc874eeda2944beba5d91232d3c46d5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2d2d24e7fc7949b89d0af0a3080d37ef": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "f97b794d0cf24d2cb3a91512828f80ee": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_adc874eeda2944beba5d91232d3c46d5", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_2d2d24e7fc7949b89d0af0a3080d37ef", "value": 1}}, "27172fb4be214c53a1dfb78a5f497fa3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d1e95da12e3c4eb2a80a0ea0150d6c86": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_27172fb4be214c53a1dfb78a5f497fa3", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "e817033acd1d4942be0717f61fb5d5ca": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "477358fdb24944e39f336f7d4fc5388a": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_9bbd07aee7134e0299506852c1281736", "IPY_MODEL_92a8d7db891c4c7093cbf7755a485b42"], "layout": "IPY_MODEL_e817033acd1d4942be0717f61fb5d5ca"}}, "b298ef5db9304dbfaae8847b226daf24": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "76636f35f72f4a23954f1da5ef34822d": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "9bbd07aee7134e0299506852c1281736": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_b298ef5db9304dbfaae8847b226daf24", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_76636f35f72f4a23954f1da5ef34822d", "value": 1}}, "b66de1b643e049aaada93f5cb23cc9d3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "92a8d7db891c4c7093cbf7755a485b42": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_b66de1b643e049aaada93f5cb23cc9d3", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Davit Potoyan<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>