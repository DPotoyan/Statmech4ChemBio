
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/02_Legendre.html">
     Legendre transform
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/ensemble_overview.html">
     Overview of ensembles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Gases
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/photons_phonons.html">
     Photons and Phonons
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.91 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.21052632,  0.68421053,  1.        ,  1.05263158,  1.36842105,
         3.73684211,  5.84210526,  9.        , 14.15789474, 15.57894737]),
 array([0.72 , 0.739, 0.758, 0.777, 0.796, 0.815, 0.834, 0.853, 0.872,
        0.891, 0.91 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "cc4eeadaf2d04b2db36809bcf4f8eacd"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0010452985024052724
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "560adb285e364dc6bd1aa63e132fefef"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f96542c5910&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "447a671b934c4b86a8b7eb84fa4f7815"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"84ebc434dc0e46fd9fb16e339adb9203": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cc4eeadaf2d04b2db36809bcf4f8eacd": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_dbbaa6a6ef53482994cb8bd3a763667c", "IPY_MODEL_3fd016aa3dcb4f909a65b9ba2e04b800"], "layout": "IPY_MODEL_84ebc434dc0e46fd9fb16e339adb9203"}}, "760d32a5f91347a58449a48f3a1cf3eb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2fa24e49725a47dab805f7b2b2eb05e4": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "dbbaa6a6ef53482994cb8bd3a763667c": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_760d32a5f91347a58449a48f3a1cf3eb", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_2fa24e49725a47dab805f7b2b2eb05e4", "value": 1}}, "958b6b6720ff4c9196ad1073312ce4d7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3fd016aa3dcb4f909a65b9ba2e04b800": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_958b6b6720ff4c9196ad1073312ce4d7", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "2f79c52471e44c93ad3092ceddba49c3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "560adb285e364dc6bd1aa63e132fefef": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_00726676d1b0441c899362e7fe46e032", "IPY_MODEL_7a50627cde3145a88099389e5026c2aa"], "layout": "IPY_MODEL_2f79c52471e44c93ad3092ceddba49c3"}}, "6cfa29454d4f4034ae60e7586d6cdc42": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1444a53061854744be03e4a364bb9426": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "00726676d1b0441c899362e7fe46e032": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_6cfa29454d4f4034ae60e7586d6cdc42", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_1444a53061854744be03e4a364bb9426", "value": 1}}, "b589daef779749e591b8fcc8a0b58568": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7a50627cde3145a88099389e5026c2aa": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_b589daef779749e591b8fcc8a0b58568", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "a9a88bbabfaf450b8e75c924f120a346": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "447a671b934c4b86a8b7eb84fa4f7815": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_e07e6ed0ee7f4121a5b61e6a46e3206b", "IPY_MODEL_1477ebd5e80147539ad2c485165c5482"], "layout": "IPY_MODEL_a9a88bbabfaf450b8e75c924f120a346"}}, "836ba07cc2694cd68ec91f23ae95da4e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6912fa2f5b4d4e8e942b80e5c0c5f5ef": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "e07e6ed0ee7f4121a5b61e6a46e3206b": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_836ba07cc2694cd68ec91f23ae95da4e", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_6912fa2f5b4d4e8e942b80e5c0c5f5ef", "value": 1}}, "48e9dbdb285d4de3a0c708e3861fd68e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1477ebd5e80147539ad2c485165c5482": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_48e9dbdb285d4de3a0c708e3861fd68e", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>