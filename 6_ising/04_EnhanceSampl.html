
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix A: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.945 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.05128205,  0.30769231,  0.35897436,  0.87179487,  2.51282051,
         4.20512821,  6.87179487, 10.41025641, 14.20512821, 11.48717949]),
 array([0.75  , 0.7695, 0.789 , 0.8085, 0.828 , 0.8475, 0.867 , 0.8865,
        0.906 , 0.9255, 0.945 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "b5afd2e04a754f589393d5e0d09e2344"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.00022283636277043226
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "7de64fafe6374918ac058feb29b04287"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7ff34f2c71d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "884fe52e40074261a053e7173e4eeafa"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"c24600bffb0440c08c02482f6f2872e0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b5afd2e04a754f589393d5e0d09e2344": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_9bc3efd4148e44ab9498d42aa536baf2", "IPY_MODEL_814b92f749e241ae99caf7b27b63de21"], "layout": "IPY_MODEL_c24600bffb0440c08c02482f6f2872e0"}}, "de7ce5f0132b4e9d9dc2096dee1f3647": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e3d8b09397094bf1bef5c4873deb722e": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "9bc3efd4148e44ab9498d42aa536baf2": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_de7ce5f0132b4e9d9dc2096dee1f3647", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_e3d8b09397094bf1bef5c4873deb722e", "value": 1}}, "536902324af14c31bc9dee0998be6a0b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "814b92f749e241ae99caf7b27b63de21": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_536902324af14c31bc9dee0998be6a0b", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "iVBORw0KGgoAAAANSUhEUgAAAQUAAAD4CAYAAADl7fPiAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAANkklEQVR4nO3df6wlZX3H8fenC9aEkgosrPxYxVhCgqa7NTdrTWmzVOVXiGhDLaRpsaVZaySpSZOGtokY+49NY00qRrvqBmwUsT9WN3Fl2dAmaKLCQhYBRdmSNewFWQELWm3s4rd/3Flzn7vn7N6eOeeec2/er+TkzMzznJlncnI/mTkzd76pKiTpqF+Y9gAkzRZDQVLDUJDUMBQkNQwFSY2Tpj2AQdafvq7O33jytIchrVkHn/hfnnnuxQxqm8lQOH/jydy7Z+O0hyGtWVsue2Jom6cPkhqGgqSGoSCpYShIahgKkhqGgqSGoSCpYShIahgKkhozeUejVp/Lztk8kfXueXL/RNa7Vi33e/hOPTu0zSMFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUOOF9Ckl2AFcBh6vqtd2yO4ALuy4vA/6rqjYP+OxB4IfAi8CRqpoby6glTcxybl66FbgF+NTRBVX1e0enk3wQeP44n7+kqp4ZdYCSVtYJQ6Gq7kly/qC2JAHeDvz2mMclaUr63ub8m8DTVfXYkPYC7kpSwD9W1fZhK0qyDdgG8Ipzvft6tfF25Nmw3O9hy2U/HtrW96/vOuD247RfXFXzSc4C9iZ5tKruGdSxC4ztAHObXmrVW2lKRr76kOQk4HeAO4b1qar57v0wsBPYMur2JK2MPpck3wQ8WlWHBjUmOSXJqUengUuBh3tsT9IKOGEoJLkd+CpwYZJDSW7omq5lyalDknOS7O5mNwBfSfIgcC/wxaq6c3xDlzQJy7n6cN2Q5e8YsOxJ4Mpu+nFgU8/xSVph3tEoqWEoSGoYCpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqWEoSGos5xmNO5IcTvLwomXvSzKfZH/3unLIZy9P8u0kB5LcNM6BS5qM5Rwp3ApcPmD5h6pqc/favbQxyTrgI8AVwEXAdUku6jNYSZN3wlDoirc8N8K6twAHqurxqvop8Fng6hHWI2kF9flN4cYk3+hOL04b0H4u8MSi+UPdsoGSbEuyL8m+7z/7Yo9hSepj1FD4KPBqYDPwFPDBvgOpqu1VNVdVc2eesa7v6iSNaKRQqKqnq+rFqvoZ8HEGl4ObBzYumj+vWyZpho0UCknOXjT7NgaXg7sPuCDJq5K8hIWKUrtG2Z6klXPCClFd2bitwPokh4Cbga1JNrNQav4g8M6u7znAJ6rqyqo6kuRGYA+wDthRVY9MYickjc+oZeM+OaTvz8vGdfO7gWMuV0qaXd7RKKlhKEhqGAqSGoaCpIahIKlhKEhqGAqSGoaCpIahIKlhKEhqGAqSGoaCpIahIKlhKEhqGAqSGoaCpIahIKlhKEhqjFo27u+SPNrVfdiZ5GVDPnswyUNdabl9Yxy3pAkZtWzcXuC1VfWrwHeAvzzO5y/pSsvNjTZESStppLJxVXVXVR3pZr/GQk0HSWvAOH5T+GPgS0PaCrgryf1Jth1vJZaNk2bDCR/xfjxJ/ho4Anx6SJeLq2o+yVnA3iSPdkcex6iq7cB2gLlNL60+45I0upGPFJK8A7gK+P2qGvhHXFXz3fthYCeDy8tJmiGjlo27HPgL4C1V9eMhfU5JcurRaeBSBpeXkzRDlnNJ8nbgq8CFSQ4luQG4BTiVhVOC/Uk+1vU9J8nRilAbgK8keRC4F/hiVd05kb2QNDYTKxtXVY8Dm3qNTtKK845GSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNXo9uHUWXHbO5mX33fPk/omNQ1orPFKQ1FhWKAwpHXd6kr1JHuveTxvy2eu7Po8luX5cA5c0Gcs9UriVY0vH3QTcXVUXAHd3840kpwM3A69n4fHuNw8LD0mzYVmhMKh0HHA1cFs3fRvw1gEfvQzYW1XPVdUPWKhBuTRcJM2QPr8pbKiqp7rp77HwSPelzgWeWDR/qFsmaUaN5YfGrkJUr1Jv1pKUZkOfUHg6ydkA3fvhAX3mgY2L5s/rlh2jqrZX1VxVzZ15xroew5LUR59Q2AUcvZpwPfCFAX32AJcmOa37gfHSbpmkGbXcS5KDSsd9AHhzkseAN3XzJJlL8gmAqnoO+Bvgvu71/m6ZpBm1rDsah5SOA3jjgL77gD9ZNL8D2DHS6CStuFV/m7O3Lkvj5W3OkhqGgqSGoSCpYShIahgKkhqGgqSGoSCpYShIahgKkhqGgqSGoSCpYShIahgKkhqGgqSGoSCpYShIahgKkhqGgqTGyKGQ5MIk+xe9XkjyniV9tiZ5flGf9/YesaSJGvkZjVX1bWAzQJJ1LNRz2Dmg65er6qpRtyNpZY3r9OGNwH9W1XfHtD5JUzKuULgWuH1I2xuSPJjkS0leM2wFlo2TZkPvUEjyEuAtwD8PaH4AeGVVbQI+DHx+2HosGyfNhnEcKVwBPFBVTy9tqKoXqupH3fRu4OQk68ewTUkTMo5QuI4hpw5JXp4k3fSWbnvPjmGbkiakV4WoJKcAbwbeuWjZnwJU1ceAa4B3JTkC/AS4titbL2lG9QqFqvpv4Iwlyz62aPoW4JY+25C0sryjUVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUGMcj3g8meagrC7dvQHuS/EOSA0m+keR1fbcpaXJ6PaNxkUuq6pkhbVcAF3Sv1wMf7d4lzaCVOH24GvhULfga8LIkZ6/AdiWNYByhUMBdSe5Psm1A+7nAE4vmD3XLGpaNk2bDOE4fLq6q+SRnAXuTPFpV9/x/V1JV24HtAHObXmptCGlKeh8pVNV8936YhVL0W5Z0mQc2Lpo/r1smaQb1CoUkpyQ59eg0cCnw8JJuu4A/7K5C/DrwfFU91We7kian7+nDBmBnVy7yJOAzVXXnktJxu4ErgQPAj4E/6rlNSRPUt2zc48CmAcsXl44r4N19tiNp5XhHo6SGoSCpYShIahgKkhqGgqSGoSCpYShIahgKkhqGgqSGoSCpYShIahgKkhqGgqSGoSCpYShIahgKkhqGgqSGoSCpMXIoJNmY5D+SfDPJI0n+bECfrUme70rK7U/y3n7DlTRpfZ7ReAT486p6oHui8/1J9lbVN5f0+3JVXdVjO5JW0MhHClX1VFU90E3/EPgWAyo/SVpdxvKbQpLzgV8Dvj6g+Q1JHkzypSSvOc46LBsnzYBxlKL/JeBfgfdU1QtLmh8AXllVm4APA58ftp6q2l5Vc1U1d+YZ6/oOS9KI+laIOpmFQPh0Vf3b0vaqeqGqftRN7wZOTrK+zzYlTVafqw8BPgl8q6r+fkifl3f9SLKl296zo25T0uT1ufrwG8AfAA8l2d8t+yvgFfDzKlHXAO9KcgT4CXBtVzFK0owaORSq6itATtDnFuCWUbchaeV5R6OkhqEgqWEoSGoYCpIahoKkRp9LktJILjtn87L77nly/8TGocE8UpDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNbzNWSvOW5dnm0cKkhp9n+Z8eZJvJzmQ5KYB7b+Y5I6u/etdfQhJM6zP05zXAR8BrgAuAq5LctGSbjcAP6iqXwE+BPztqNuTtDL6HClsAQ5U1eNV9VPgs8DVS/pcDdzWTf8L8Majj3yXNJv6hMK5wBOL5g9xbC3Jn/epqiPA88AZg1Zm2ThpNszMD42WjZNmQ59QmAc2Lpo/r1s2sE+Sk4BfxgpR0kzrEwr3ARckeVWSlwDXAruW9NkFXN9NXwP8uxWipNnWp0LUkSQ3AnuAdcCOqnokyfuBfVW1i4Vak/+U5ADwHAvBIWmG9bqjsaskvXvJsvcumv4f4Hf7bEPSysosHs0n+T7w3SWL1wPPTGE4k7ZW9wvW7r6thf16ZVWdOahhJkNhkCT7qmpu2uMYt7W6X7B2922t7tdRM3NJUtJsMBQkNVZTKGyf9gAmZK3uF6zdfVur+wWsot8UJK2M1XSkIGkFGAqSGqsiFE70MJfVKsnBJA8l2Z9k37TH00eSHUkOJ3l40bLTk+xN8lj3fto0xziKIfv1viTz3fe2P8mV0xzjuM18KCzzYS6r2SVVtXkNXPe+Fbh8ybKbgLur6gLg7m5+tbmVY/cL4EPd97a5u7N3zZj5UGB5D3PRlFXVPSz8f8tiix+ycxvw1pUc0zgM2a81bTWEwnIe5rJaFXBXkvuTbJv2YCZgQ1U91U1/D9gwzcGM2Y1JvtGdXqy606LjWQ2hsJZdXFWvY+HU6N1JfmvaA5qU7l/m18r1748CrwY2A08BH5zqaMZsNYTCch7msipV1Xz3fhjYycKp0lrydJKzAbr3w1Mez1hU1dNV9WJV/Qz4OGvse1sNobCch7msOklOSXLq0WngUuDh439q1Vn8kJ3rgS9McSxjczToOm9jjX1vM18hatjDXKY8rHHYAOzsHm59EvCZqrpzukMaXZLbga3A+iSHgJuBDwCfS3IDC/8K//bpjXA0Q/Zra5LNLJwOHQTeOa3xTYK3OUtqrIbTB0kryFCQ1DAUJDUMBUkNQ0FSw1CQ1DAUJDX+D5SM8JJi7Bf6AAAAAElFTkSuQmCC\n"}}]}}, "0c393b457d2a46e3a6b74629560d8f7d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7de64fafe6374918ac058feb29b04287": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_5f367c8f338f48d39665f51dd8bde082", "IPY_MODEL_537a2e069c3645a69e20490b330c8465"], "layout": "IPY_MODEL_0c393b457d2a46e3a6b74629560d8f7d"}}, "a2a624a504b8455384a0422a53186366": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "53fa6c0882a54069982b5772b61d7c73": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "5f367c8f338f48d39665f51dd8bde082": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_a2a624a504b8455384a0422a53186366", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_53fa6c0882a54069982b5772b61d7c73", "value": 1}}, "d5a60eb9f1024292835388b50cf61221": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "537a2e069c3645a69e20490b330c8465": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_d5a60eb9f1024292835388b50cf61221", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "6c9ac6204b33448b9cb4bade8ef5f33a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "884fe52e40074261a053e7173e4eeafa": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_d2cf8c9a5f854e9c94397a4cb702b796", "IPY_MODEL_d1075456f3674ceabf624a7831882bbc"], "layout": "IPY_MODEL_6c9ac6204b33448b9cb4bade8ef5f33a"}}, "e97f912588e7497ab9a265cd51c9dd72": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "45f27fedc5db4c86bd08e9906782a894": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "d2cf8c9a5f854e9c94397a4cb702b796": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_e97f912588e7497ab9a265cd51c9dd72", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_45f27fedc5db4c86bd08e9906782a894", "value": 1}}, "5e92944ddcab4009ade77fefb9f51262": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d1075456f3674ceabf624a7831882bbc": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_5e92944ddcab4009ade77fefb9f51262", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>