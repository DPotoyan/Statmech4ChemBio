
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/02_Legendre.html">
     Legendre transform
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/ensemble_overview.html">
     Overview of ensembles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Gases
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/photons_phonons.html">
     Photons and Phonons
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/landauer.html">
     Information erasure and Landauer’s principle
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.94 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.75675676,  0.37837838,  1.02702703,  0.86486486,  2.21621622,
         3.83783784,  4.37837838,  9.62162162, 13.83783784, 17.13513514]),
 array([0.75  , 0.7685, 0.787 , 0.8055, 0.824 , 0.8425, 0.861 , 0.8795,
        0.898 , 0.9165, 0.935 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "045ec8ec32cc45fc942d9c1caa32fb70"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0007949805073709694
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "13a70538dd2f4cc7ae388976f572c196"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f426c619ed0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "f7106b46f8584b7da735b65503bbd9c1"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"02aedd5993d64337ab22bebdd92b865c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "045ec8ec32cc45fc942d9c1caa32fb70": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_3591c7f1002e4787acb6fe1fcfa71400", "IPY_MODEL_1c8a2853fd9d459ab5729488aa9f8190"], "layout": "IPY_MODEL_02aedd5993d64337ab22bebdd92b865c"}}, "440609a56e774fea96a0f00cce73b432": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "540bc6fd061344a8b131bfe9c553a7c1": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "3591c7f1002e4787acb6fe1fcfa71400": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_440609a56e774fea96a0f00cce73b432", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_540bc6fd061344a8b131bfe9c553a7c1", "value": 1}}, "1da4d7291d664dd08f748f422f60471a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1c8a2853fd9d459ab5729488aa9f8190": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_1da4d7291d664dd08f748f422f60471a", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "iVBORw0KGgoAAAANSUhEUgAAAQUAAAD4CAYAAADl7fPiAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAANf0lEQVR4nO3df6xkZX3H8fenC5SEkvLTlR9bMJaQoOluzc1aU9pAUX6FiDbWQpoWWxqokaQmTRraJmLsPzYNJakYyKobsFGkv1ZJXFk2tAmSqLCQRVCxbMka9oK7Aha02tjFb/+4Z819LjO7lzkzd+bevl/JZM55zjNznpOb/eScOWefb6oKSTrk56Y9AEmzxVCQ1DAUJDUMBUkNQ0FS46hpD2CQU05aV2dvOHraw5DWrL3P/C/Pv/hKBm2byVA4e8PRPLRjw7SHIa1Zmy95Zug2Lx8kNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNY4481KSrcAVwIGqenPXdjdwbtflBOC/qmrTgM/uBX4AvAIcrKq5sYxa0sQsZzq2O4BbgU8faqiq3z20nORm4KXDfP7Cqnp+1AFKWllHDIWqeiDJ2YO2JQnwXuC3xjwuSVPS9zeF3wD2V9VTQ7YXcF+SR5Jcd7gvSnJdkl1Jdn3vhVd6DkvSqPrO5nw1cNdhtp9fVfNJXgfsTPJkVT0wqGNVbQG2AMxtPNaqt9KUjHymkOQo4LeBu4f1qar57v0AsA3YPOr+JK2MPpcPbweerKp9gzYmOS7J8YeWgYuBJ3rsT9IKOGIoJLkL+ApwbpJ9Sa7tNl3FkkuHJKcn2d6trgceTPIY8BDwxaq6d3xDlzQJy7n7cPWQ9vcNaHsWuLxbfhrY2HN8klaYTzRKahgKkhqGgqSGoSCpYShIavR9onHqLjl907L77nh298TGIa0VnilIahgKkhqGgqSGoSCpYShIahgKkhqGgqSGoSCpYShIahgKkhqr/jHn1/Loso9ES0fmmYKkxnLmaNya5ECSJxa1fTjJfJLd3evyIZ+9NMm3k+xJcuM4By5pMpZzpnAHcOmA9luqalP32r50Y5J1wMeBy4DzgKuTnNdnsJIm74ih0BVveXGE794M7Kmqp6vqJ8DngCtH+B5JK6jPbwo3JPl6d3lx4oDtZwDPLFrf17UNZNk4aTaMGgq3AW8ENgHPATf3HUhVbamquaqaO/XkdX2/TtKIRgqFqtpfVa9U1U+BTzC4HNw8sGHR+pldm6QZNlIoJDlt0eq7GVwO7mHgnCRvSHIMCxWl7hllf5JWzhEfXurKxl0AnJJkH3ATcEGSTSyUmt8LXN/1PR34ZFVdXlUHk9wA7ADWAVur6huTOAhJ4zNq2bhPDen7s7Jx3fp24FW3KyXNrlX/mPNr4aPL0pH5mLOkhqEgqWEoSGoYCpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqWEoSGoYCpIahoKkxqhl4/42yZNd3YdtSU4Y8tm9SR7vSsvtGuO4JU3IqGXjdgJvrqpfAf4D+IvDfP7CrrTc3GhDlLSSRiobV1X3VdXBbvWrLNR0kLQGjOM3hT8CvjRkWwH3JXkkyXWH+xLLxkmzoddszkn+CjgIfGZIl/Oraj7J64CdSZ7szjxepaq2AFsA5jYeW33GJWl0I58pJHkfcAXwe1U18B9xVc137weAbQwuLydphoxaNu5S4M+Bd1bVj4b0OS7J8YeWgYsZXF5O0gxZzi3Ju4CvAOcm2ZfkWuBW4HgWLgl2J7m963t6kkMVodYDDyZ5DHgI+GJV3TuRo5A0NhMrG1dVTwMbe41O0orziUZJDUNBUsNQkNQwFCQ1DAVJDUNBUsNQkNQwFCQ1DAVJDUNBUsNQkNQwFCQ1DAVJDUNBUsNQkNQwFCQ1DAVJDUNBUmNZoTCkdNxJSXYmeap7P3HIZ6/p+jyV5JpxDVzSZCz3TOEOXl067kbg/qo6B7i/W28kOQm4CXgrC9O73zQsPCTNhmWFwqDSccCVwJ3d8p3AuwZ89BJgZ1W9WFXfZ6EG5dJwkTRD+vymsL6qnuuWv8vClO5LnQE8s2h9X9cmaUaN5YfGrkJUr1Jv1pKUZkOfUNif5DSA7v3AgD7zwIZF62d2ba9SVVuqaq6q5k49eV2PYUnqo08o3AMcuptwDfCFAX12ABcnObH7gfHirk3SjFruLclBpeM+CrwjyVPA27t1kswl+SRAVb0I/DXwcPf6SNcmaUYtqxT9kNJxABcN6LsL+ONF61uBrSONTtKK84lGSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUGDkUkpybZPei18tJPrikzwVJXlrU50O9RyxpopY1cesgVfVtYBNAknUs1HPYNqDrl6vqilH3I2lljevy4SLgP6vqO2P6PklTMq5QuAq4a8i2tyV5LMmXkrxp2BdYNk6aDb1DIckxwDuBfxqw+VHgrKraCHwM+Pyw77FsnDQbxnGmcBnwaFXtX7qhql6uqh92y9uBo5OcMoZ9SpqQcYTC1Qy5dEjy+iTpljd3+3thDPuUNCEj330ASHIc8A7g+kVtfwJQVbcD7wHen+Qg8GPgqq5svaQZ1SsUquq/gZOXtN2+aPlW4NY++5C0snyiUVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUMBQkNQwFSQ1DQVLDUJDUGMcU73uTPN6Vhds1YHuS/H2SPUm+nuQtffcpaXJ6zdG4yIVV9fyQbZcB53SvtwK3de+SZtBKXD5cCXy6FnwVOCHJaSuwX0kjGEcoFHBfkkeSXDdg+xnAM4vW93VtDcvGSbNhHJcP51fVfJLXATuTPFlVD7zWL6mqLcAWgLmNx1obQpqS3mcKVTXfvR9goRT95iVd5oENi9bP7NokzaBeoZDkuCTHH1oGLgaeWNLtHuAPursQvwa8VFXP9dmvpMnpe/mwHtjWlYs8CvhsVd27pHTcduByYA/wI+APe+5T0gT1LRv3NLBxQPvi0nEFfKDPfiStnHE9p7AqXHL6pmX33fHs7omNQ5plPuYsqWEoSGoYCpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqfH/6olGn1KUjswzBUkNQ0FSw1CQ1DAUJDUMBUkNQ0FSw1CQ1Bg5FJJsSPLvSb6Z5BtJ/nRAnwuSvNSVlNud5EP9hitp0vo8vHQQ+LOqerSb0fmRJDur6ptL+n25qq7osR9JK2jkM4Wqeq6qHu2WfwB8iwGVnyStLmP5TSHJ2cCvAl8bsPltSR5L8qUkbzrMd1g2TpoB4yhF/wvAvwAfrKqXl2x+FDirqjYCHwM+P+x7qmpLVc1V1dypJ6/rOyxJI+pbIepoFgLhM1X1r0u3V9XLVfXDbnk7cHSSU/rsU9Jk9bn7EOBTwLeq6u+G9Hl9148km7v9vTDqPiVNXp+7D78O/D7weJLdXdtfAr8EP6sS9R7g/UkOAj8GruoqRkmaUSOHQlU9COQIfW4Fbh11H5JWnk80SmoYCpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqWEoSGoYCpIahoKkhqEgqdFn5iW9RpecvmnZfXc8u3ti45AOxzMFSY2+szlfmuTbSfYkuXHA9p9Pcne3/WtdfQhJM6zPbM7rgI8DlwHnAVcnOW9Jt2uB71fVLwO3AH8z6v4krYw+ZwqbgT1V9XRV/QT4HHDlkj5XAnd2y/8MXHRoyndJs6lPKJwBPLNofR+vriX5sz5VdRB4CTh50JdZNk6aDTPzQ6Nl46TZ0CcU5oENi9bP7NoG9klyFPCLWCFKmml9QuFh4Jwkb0hyDHAVcM+SPvcA13TL7wH+zQpR0mzrUyHqYJIbgB3AOmBrVX0jyUeAXVV1Dwu1Jv8hyR7gRRaCQ9IM6/VEY1dJevuStg8tWv4f4Hf67EPSysosns0n+R7wnSXNpwDPT2E4k7ZWjwvW7rGtheM6q6pOHbRhJkNhkCS7qmpu2uMYt7V6XLB2j22tHtchM3NLUtJsMBQkNVZTKGyZ9gAmZK0eF6zdY1urxwWsot8UJK2M1XSmIGkFGAqSGqsiFI40mctqlWRvkseT7E6ya9rj6SPJ1iQHkjyxqO2kJDuTPNW9nzjNMY5iyHF9OMl893fbneTyaY5x3GY+FJY5mctqdmFVbVoD973vAC5d0nYjcH9VnQPc362vNnfw6uMCuKX7u23qnuxdM2Y+FFjeZC6asqp6gIX/37LY4kl27gTetZJjGochx7WmrYZQWM5kLqtVAfcleSTJddMezASsr6rnuuXvAuunOZgxuyHJ17vLi1V3WXQ4qyEU1rLzq+otLFwafSDJb057QJPS/Zf5tXL/+zbgjcAm4Dng5qmOZsxWQygsZzKXVamq5rv3A8A2Fi6V1pL9SU4D6N4PTHk8Y1FV+6vqlar6KfAJ1tjfbTWEwnImc1l1khyX5PhDy8DFwBOH/9Sqs3iSnWuAL0xxLGNzKOg672aN/d1mvkLUsMlcpjyscVgPbOsmtz4K+GxV3TvdIY0uyV3ABcApSfYBNwEfBf4xybUs/Ff4905vhKMZclwXJNnEwuXQXuD6aY1vEnzMWVJjNVw+SFpBhoKkhqEgqWEoSGoYCpIahoKkhqEgqfF/iJjsMIYQhTMAAAAASUVORK5CYII=\n"}}]}}, "9bff779892e24553978a9ea8e5bde314": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "13a70538dd2f4cc7ae388976f572c196": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_d8ca39609d104f0fbb5090356d21cad6", "IPY_MODEL_51b8379b54264d5d944d72ca587aaebc"], "layout": "IPY_MODEL_9bff779892e24553978a9ea8e5bde314"}}, "284d0fa758a2435fac31868ae4dace69": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f5492fb2f203448abc0a2471048c872f": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "d8ca39609d104f0fbb5090356d21cad6": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_284d0fa758a2435fac31868ae4dace69", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_f5492fb2f203448abc0a2471048c872f", "value": 1}}, "bf3f7295b74b4ebc8c3607c48cafcfc8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "51b8379b54264d5d944d72ca587aaebc": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_bf3f7295b74b4ebc8c3607c48cafcfc8", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "421961691f5d4beeaabb70539eafbc81": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f7106b46f8584b7da735b65503bbd9c1": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_c831a0153e884386b71153f099eff41d", "IPY_MODEL_e42136ce7a1e420d9db704e4d4b4145e"], "layout": "IPY_MODEL_421961691f5d4beeaabb70539eafbc81"}}, "3ba89975dd4c4e52a49adf351db21a45": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7e056ec5c18747f5a431bcaf4f2bfce8": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "c831a0153e884386b71153f099eff41d": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_3ba89975dd4c4e52a49adf351db21a45", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_7e056ec5c18747f5a431bcaf4f2bfce8", "value": 1}}, "cb26be6ccbf74066aa1bfc5b2b8f168c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e42136ce7a1e420d9db704e4d4b4145e": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_cb26be6ccbf74066aa1bfc5b2b8f168c", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>