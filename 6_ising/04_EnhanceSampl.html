
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/02_Legendre.html">
     Legendre transform
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/ensemble_overview.html">
     Overview of ensembles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.965 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.45,  0.15,  0.65,  1.45,  2.6 ,  5.25,  8.35, 10.15, 11.5 ,
         9.45]),
 array([0.765, 0.785, 0.805, 0.825, 0.845, 0.865, 0.885, 0.905, 0.925,
        0.945, 0.965]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "4486f58e478142148f321b99eddfea46"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0008010468328184154
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "99729df073de4b16a9cff57ff7f91bc5"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f2c5633e910&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "c7ae54e413904f1f94b80d865fc9b0e7"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"65603de4e28b4e619222a4ef8f742f8a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4486f58e478142148f321b99eddfea46": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_8ad4c71e59404655a1d8282c7a415868", "IPY_MODEL_924881bceae64245bfc1708573468e62"], "layout": "IPY_MODEL_65603de4e28b4e619222a4ef8f742f8a"}}, "f8b4d139838649a6af8a4ce2eb300b03": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a48dbca9769a429cac5f8db5f7dbd43c": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "8ad4c71e59404655a1d8282c7a415868": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_f8b4d139838649a6af8a4ce2eb300b03", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_a48dbca9769a429cac5f8db5f7dbd43c", "value": 1}}, "24d0a8a96e0049feb989993fdc59a9ea": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "924881bceae64245bfc1708573468e62": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_24d0a8a96e0049feb989993fdc59a9ea", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "e5fa0759c72a46c3a2f2b5b7c1bfa183": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "99729df073de4b16a9cff57ff7f91bc5": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_ccbedc99ce22419f99a4994074b6294f", "IPY_MODEL_46b6e8de39d643369c0f5e9ce01698f3"], "layout": "IPY_MODEL_e5fa0759c72a46c3a2f2b5b7c1bfa183"}}, "e825a669750c4f79859cb359b2054879": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a519db749e864d56af04f413130dc6bc": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "ccbedc99ce22419f99a4994074b6294f": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_e825a669750c4f79859cb359b2054879", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_a519db749e864d56af04f413130dc6bc", "value": 1}}, "24c05c66e872454f96b32d03a3b02e2f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "46b6e8de39d643369c0f5e9ce01698f3": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_24c05c66e872454f96b32d03a3b02e2f", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "iVBORw0KGgoAAAANSUhEUgAAAY8AAAETCAYAAADOPorfAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAABHfUlEQVR4nO3deXhVV7n48e/KRCYgBBIgYQoEwjwUSgcKhEIptVJaq7ZqrbZX61jrdazDrcNVr16rP7VWLVar3k7WznOhLSkylhnCDJkJZIBABsh41u+Pnazsk5ycnCk5Q97P8/B07bP3WWftJtnvWbPSWiOEEEJ4IyrYBRBCCBF+JHgIIYTwmgQPIYQQXpPgIYQQwmsSPIQQQnhNgocQQgivhU3wUEr9p1LqoFIqXyn1lFIqPthlEkKIgSosgodSKhP4CrBAaz0TiAZuD26phBBi4AqL4NEuBkhQSsUAiUB5kMsjhBADVkywC+AJrfUppdSDQAlwCVintV7X9Tql1D3APQAkMH9w2mCGxg6l7GJZx3mykrKIUe5v+3zLeSobKwEYEjuEUfGjAnk7AeFwOIiKCqfY751Ivr9IvjeQ+wuGk/UnadNtAGQlZxGrYt1ef6HlAhWNFQBER0UzIXECJRdLcGgHbeVt1VrrtN4+U4XD8iRKqWHAc8BtwHngX8CzWuvHe3xPhtJ8zvm1Lyz4An+48Q+9fl5eUR7L/r4MgAUZC9jx2R2+Fr3P5OXlkZubG+xi9JlIvr9IvjeQ++tvZy+eZcQvRwCQGJtI3XfqiFLug9ullktkP5RNeZ2LBpwfsktrvaC3zw2t8NmzFUCh1rpKa90CPA9c7U0Gg+MG851rvuPRtdPTppv0oapDOLTDm48SQoh+c7j6sEnnDM/pNXAAJMQm8PPlP/frc8MleJQAVyqlEpVSClgOHHb3hpioGKf0Y2seY+zQsR59WHpSOiMSrUh+seUiJRdKfC23EEL0qcNVnY/CaWnTPH7fHbPv4DPzPuP02uopqz1+f7j0eWxXSj0L7AZagT3AWnfvGZ84njtz76S+uZ7bZ97OZaMv8+ozp6dNZ2PxRsCqfUxImeBT2YUQoi/Zax7TRngePJRSrF29lhUTV7C5dDNzRs7hzjl3EvfxOI/eHxbBA0Br/QPgB55eH62ieWDpAz5/3tThU03wOH72OEz2OSshhOgzvgYPsALIbTNv47aZt3n9ueHSbNXvslOzTfrEuRNBLIkQQvTM3mw1dcTUfvtcCR49cAoeNRI8hBChp6G5geILxYDV2jJ5eP81kUjw6IH9hyA1DyFEKLI/myYOm0hctGf9FYEgwaMHE4dNNOnCmkJa2lqCWBohhOiuoKbApPuz1gESPHqUGJtI5uBMANp0m6kaCiFEqDhZc9KkJ6ZMdHNl4EnwcEOaroQQocxe87C3lvQHCR5uZA/r7DQ/fvZ4EEsihBDdSfAIUTJcVwgRyiR4hCinZisZriuECCFtjjaKzheZ46xhWf36+RI83JCahxAiVJ2qO0WLwxoFmp6UTnJccr9+vgQPNyYNm2TSBTUFtDpag1gaIYToFMwmK5Dg4VZSXBKjkq2NoFodrZTVlgW5REIIYbEHD/sX3f4iwaMX9h/KyXMn3VwphBD9x/48kppHCJqUagseNRI8hBChoeC8NFuFNPusTXs1UQghgkn6PDyglMpRSu21/atVSn21Pz5bah5CiFAU7OARFptBaa2PAnMBlFLRwCnghf74bOnzEEKEmtqmWqovVgMQFx1HxuCMfi9DWNQ8ulgOnNRa98tKhfaIfrLmJFrr/vhYIYToUWFNoUlnpWQRpfr/UR6OweN24Kn++rD0pHSSYpMAK9qfu3Suvz5aCCFcCnaTFYRJs1UHpVQccBPwnR7O3wPcA5CWlkZeXl5APndk3EgKWqwf1jNvP8O0Id7tE9wX6uvrA3Z/oSiS7y+S7w3k/vrD+tL1Jh1/MT4o5Qmr4AHcAOzWWle4Oqm1XgusBcjJydG5ubkB+dDZFbMpOGIFj2ETh5E7MzD5+iMvL49A3V8oiuT7i+R7A7m//vDMa89Ae+Vj8czF5F7V/+UJt2arj9GPTVYdpNNcCBFKQqHZKmyCh1IqCbgOeL6/P9speMhwXSFEkIVC8AibZiutdQMwPBifbf/hyERBIUQwBXsp9g5hU/MIJpkoKIQIFcFeir2DBA8PjB863oyjPlV7isbWxiCXSAgxUIVCkxVI8PBIbHQs44aOA0CjnaqMQgjRnyR4hBkZcSWECAVOS7GnSPAIeTLiSggRCuzPH3t/bH+T4OEhGXElhAgFTsEjCDsIdpDg4SEZcSWECAX2ZiupeYQB6fMQQgTbuUvnqGmsASAhJoHRyaODVhYJHh6yN1sVni/EoR1BLI0QYiDqWutQSgWtLBI8PDQ0fijDE6wJ7o2tjZyuOx3kEgkhBppQ6e8ACR5ekX4PIUQwOdU8JHiEDxlxJYQIplAZpgsSPLwineZCiGA6ce6ESWenZgexJBI8vCITBYUQwSR9HmEqEM1W60+u5+q/XM3MP8zkwS0PorUOVPGEECHq3KVz3PXSXUx5aAoffubDlFwo8TqPSy2XKK8rByBaRZv19oIlbPbzCAX+dpi/XfA2NzxxA226DYBvrv8mdU11/GjZjwJWRiFEaGlpa2HV46vYUb4DgOPnjrOjfAd7PreH1IRUj/Oxf2EdnzKe2OjYgJfVG2FT81BKpSilnlVKHVFKHVZKXdXfZcgYnMGg6EEAVF+sprap1uP3NrY2cvdLd5vA0eFnm37G8bPHA1pOIUTo+NPOP5nA0aHkQgnfXv9tr/I5evaoSU8ZPiUgZfNH2AQP4LfAm1rrqcAc4HB/FyBKRTnt2uVN09Wfd/2Z0tpSAAbHDSZzcCYArY5WfrPtNwEtpxAiNLQ52vjV1l+Z4+lp00367/v+zqnaUx7ndaT6iElPHT41MAX0Q1gED6XUUGAJ8BcArXWz1vp8MMriy4grrTV/3PlHc/yTa3/CP275hzl+4sATNLU2Ba6QQoiQsKFoA8UXigEYnjCcnZ/dyaKxiwBocbTw2+2/9Tgvp+AxIvjBI1z6PLKAKuAxpdQcYBdwX/u+5oZS6h7gHoC0tDTy8vICXpBBFweZ9Js732R4Ze/bqudfyOdwtVVRSohOYHL9ZNRFxaj4UZxpPMOFpgv8+qVfc9Vwz1vi6uvr++T+QkUk318k3xvI/dn99lhncFiaupTtm7dzw5Ab2MxmAB55/xFWRq8kJqr3R/GOws6mr0tll8ir96wMfSVcgkcMcBlwr9Z6u1Lqt8D9wH/ZL9JarwXWAuTk5Ojc3NyAF+RI8hGeP/U8AI2DG/HkMx5/+XGT/sTsT3DD8hsAuKPlDh7c+iAAZxLPeJRXh7y8PK+uDzeRfH+RfG8g92d31767TPq+6+5jyfglLNFLeKT0EUprS6ltraVlbAsrJq9wm4/WmlNbO5u4PrbiY4xMHulT+QMlLJqtgDKgTGu9vf34Waxg0u9mpM0w6fzK/F6vb3O08dLRl8zxXfM6f5lWTOz8hXm36N0AlVAIEQoKawrNltVJsUlcNcZqWYhSUdw24zZz3VP5T/Wa1+n609Q11wGQEp9CelJ64AvspbAIHlrrM0CpUiqn/aXlwKFglGVGemfwOFJ9hDZHm5urYUvpFqovVgMwOnk0V4650pxbNG6Rqa7mV+ZT1VDVByUWQgTDhqINJn3NuGuchtbePvN2k37xyIu99nkeruocHzR1xNSgrqbbISyCR7t7gSeUUvuBucDPglGI1IRURiWPAqzht72NuLLXOlZPWU2U6vxfnhyXzBWZV5jjvKK8wBZWCBE09uBxbda1TucuG32ZGXxT11zHO4XvuM3rQOUBk54+YrqbK/tP2AQPrfVerfUCrfVsrfXNWuuaYJVlZvpMkz5YdbDH67TWTsFjzdQ13a5ZNmGZSW8q2RSgEgohgs3+95w7IdfpnFKKW6beYo5fOPyC27z2ntlr0nNGzQlI+fwVNsEjlHja73G4+rBZyCwpNqnbtw+AK8Z01jx2n9kdwFIKIYLl3KVzpr8jLjqOuaPmdrvmlmmdweOloy+5bQLfV7HPpF3lFQwSPHwwK32WSe8+3fMD/6UjnbWOVdmriI+J73bNZaM7+/33nN4jOxQKEQH2nN5j0rPSZxEXHdftmivHXGmawKsuVrGldIvLvJrbmjlY2dnCMXvk7ACX1jcSPHxweeblJt112QE7pyarnO5NVmB1oo9MsobcNbQ0cOzssQCVUggRLLtO7zJp+xdEuygV5fRceOGI66arI9VHaHG0ADB+6HhS4lMCV1A/SPDwwfS06STEJABQVlvGmfoz3a4prytn+ylrZHG0iubGKTe6zEspxfyM+ebYXU1GCBEe7H/H80fP7/E6p36PIy+4XGXbXosJlSYrkODhk5ioGKdvEztOda992Jusloxf4nb1zMtGdea1q3xXj9cJIcKDPXj0VPMAWJa1jKGDhgJQdL7IqW+jg705y11e/U2Ch48uz3DfdGWvgtq/Xbgyb/Q8k86v6n3ioRAidF1suWgGykSpKGaNnNXjtXHRcU6tEs8ffr7bNf8u+bdJLx63OIAl9Y8EDx8tzFxo0vYfLkDNpRqnMd43T73ZbV720Vv2jjEhRPg5Un0EjdX8lJ2a7XKgjF3Xpiu76ovVZl282KhYp9GZwSbBw0f2cdubSjZR11Rnjl87/hqtjlYAFmQsYOzQsW7zmpQ6idgoa/bpqbpTXGi8EPgCCyH6xaGqzsUv7Euw92RV9iqzT1B+Zb7TPuX2uSLzM+aTGJsYwJL6R4KHj0YPHm06r1odrU4zRO1r1fTWZAVWH0rOiBxz3PFNQwgRfpyChwezwZPjklk5aaU5tk8YfKeg87myZNySAJUwMCR4+OGG7BtM+o3jbwBQfL7YpAGnBdDcsX9Dsf/yCSHCi7c1D3D+kvnMoWfQWndboeK6SdcFrpABIMHDD6uyV5n0c4efo6m1iT/v/rNp77xu4nVO+567Y+/3kOAhRPiy//3aF1J156acm0zT9c7ynWws3sh7xe+Z3UdT4lNYOn5p4AvrBwkeflg0dhHjho4D4Oyls/xi8y946P2HzPnPzf+cx3nZv6G4Wy9LCBG6GlsbOVlj7TCqUOQMz+nlHZbhicP51JxPmeMfvvdDHtzyoDn++MyPO63KGwokePghOiqaLy74ojn+Qd4PqG2qBSBneI7LhRB7Yt9WUmaZCxGeCmoKzBJD41PGkxCb4PF777/mfrPqdl5RHq8dfw2wgtAXLv9C4AvrJwkefrr3inuZkDLB6TWF4uEPPOzR1pId7HujF50vormtOVBFFEL0E/tIqcmpk71676TUSdx3xX3dXr973t1OK3mHCgkefkqMTeTVj71Kdmo2YK2e++hNj7J84nKv8kmITWDsEGtIr0M7KKwpDHhZhRB9yx48Op4J3vj5ip9z19zO3UbX5KzhoRsecvOO4AmXPcxRShUBdUAb0Kq1XhDcEnWakT6Dw186TNH5IkYljyI5LtmnfCYPn2w6yI6fO+40fFcIEfr8DR5x0XH8dc1f+em1P0WjyRicEcjiBVTYBI92y7TW1cEuhCsxUTE+/bLYTU6dzLuF1l7mx88eD0SxhBD9yJ9mK7vRg0cHojh9SpqtQoj9l+34OQkeQoQb+9+tv18mQ1041Tw0sE4ppYFHtNZru16glLoHuAcgLS2NvLy8/i2hn5qqm0z6/RPvuy1/fX192N2fNyL5/iL53mDg3l+zo5mS8yWANWim9EApFVEV/Vy6/qNcrR8fipRSmVrrU0qpdGA9cK/WemNP1+fk5OijR4/2XwED4Ej1EaY9PA2wNn0p+mpRj9fm5eWRm5vbPwULgki+v0i+Nxi493e0+ihTH7aG3I8bOo7irxb3c8kCQym1y5M+5bBpttJan2r/byXwArDQ/TvCz8RhE80475ILJTS2Nga5REIIT/nbWR5uwiJ4KKWSlFKDO9LASiDiNr6Ii45j/NDxAGg0J8+dDHKJhBCecurvGCbBI1SMBDYppfYB7wOvaa3fDHKZ+sTk4dJpLkQ4chppNdz3kVbhIiw6zLXWBcCcYJejP0xOncy6k+sAGa4rRDiRZisRVPbhuvZfRiFEaJPgIYLK/kt3okaChxDhoKWthaLzReZ44rCJwStMP5HgEWKc+jyk2UqIsFB0vog23QZA5uDMkNoutq9I8AgxE1ImmOG6pbWlXGq5FOQSCSF6M9A6y0GCR8ixD9cFKDwvq+sKEeqc+jsGwDBdkOARkqTpSojwMtA6y0GCR0iyf3OREVdChD774BYJHiJonEZcSfAQIuTZWwgkeIigkVnmQoSPVkerU9/kpNRJbq6OHBI8QpDUPIQIHyUXSmh1tAIwOnm0zzuJhhsJHiEoKyXLaXXdptamXt4hhAiWgdhZDhI8QtKgmEGMGzoOsFbXLagpCHKJhBA9sfd3DJQmK5DgEbKk6UqI8GDvl5ySOiWIJelfEjxClCyQKER4OHb2mEkPlNnlIMEjZNlrHv6MuDp29hjXP349Gb/K4PZnb6eqoSoQxRMirG0t3cqivy4i89eZ3Pv6vVxsuehzXk41j+EDp+YRFvt5dFBKRQM7gVNa6w8Guzx9KRDNVpUNleT+LZfT9acB+OfBf1JQU8DmuzcTGx0bkHIKEW4OVx1m5eMrqW+uB+D3O35PWV0Zz3/0eZRSXuXV0tZCYU3nMF3pMHdDKXWdUup/lVLblFLlSqlmpdQFpdRxpdS/lFJfUEpl9kVhgfuAw32Ud0gJRLPVt9/+tgkcHXaU7+DR3Y/6VTYhwtnX133dBI4OLx55kRePvOh1XoXnC81qumOGjBkQq+l28Ch4KKUSlVL3K6UKgTeBbwALgRSgEmgFJgK3Ag8DhUqp55RSVwWqoEqpMcCNwIB48mUNy0JhfQsqvlBMc1uzV+8vPl/MP/b9wxxfNvoyk/7V1l/h0I7AFFSIMHL87HHeOPEGAArF3FFzzbn/3vjfPuXXwf6FbyDotdlKKXU38N/AaOAI8CNgM7BDa11ru04BOcCVwPXAGuBmpdSzwDe11iV+lvU3wLeAwW7Keg9wD0BaWhp5eXl+fmRwpQ9Kp6KpAod28PRbTzMucZw5V19f7/b+/l70dxMg5qXM46eTfsqHKz9MQ1sDJ2tO8tBLDzEnJXR39u3t/sJZJN8bhPb9/b3o7yZ91fCr+NbEb/HRyo/S7Ghmz5k9/PmVPzN5sPsgYL+/N8reMK8nNyWH7H33BU/6PB4FXgT+R2u9o6eLtNYaK7gcAf6mlBoCfAq4H/g08GNfC6mU+iBQqbXepZTKdVOGtcBagJycHJ2b2+OlYWFmyUwqCisASM1OJXdKrjmXl5dHT/fn0A4+vffT5vj+FfezasYq7rh0B4/segSAU0mnuC/3vr4qut/c3V+4i+R7g9C9P601n8//vDm+b9l9rJmxho/Wf5TH9z8OwP7o/Xw297Nu87Hf3zOvPWNeXzpzKblX5wa83KHKk2arBVrrD7kLHK5orWu11g8Bk4Bneru+F4uAm5RSRcDTwLVKqcf9zDPk+dppvrlkM8UXigFITUhlTc4aAD44pXOMQUfVXYiB4lDVIY6ePQpAclyy+Xu4e+7d5pon8580S414YqCOtAIPgofWerc/H6C1btRaH/Ezj+9orcdorScAtwPvaq3v8CfPcOBr8LAHhlun3cqgmEEALJuwjLjoOADyK/MpvVAaoJIKEfreK37PpFdOWmk6t5dOWMqYIWMAOHfpHFtKt3icp1OfxwCa4wG+jbb6WV8URHRn74DzZq7HWyffMulV2atMOikuidwJuS6vEyLS2YPH0vFLTTpKRfHByZ218pePvuxRfo2tjZRcKDF5TBw2MUAlDQ++TBK8Xyn1h4CXxENa67xIn+PRwV4NPlzl2QjlyoZKdp+2KovRKprlWcudztuPt5VtC0AphQh9Wms2Fm80x0vGL3E6f1POTSb9yrFXPMrzaPVRNBqwFjPtqNUPFL4Ej38An1dKPamUctnhrpRapJTyvO4nXMpOzSY2yprMV1pbSm1TbS/vgPUn15v0lWOuZGj8UKfzV2ReYdLbT20PUEmFCG0nzp3gTP0ZAFLiU5iVPsvp/LKsZSTFJgHWqgyeNBMfrDpo0jPSZwSwtOHB6+Chtf408P+w+h5eUkrFd5xTSk1WSj0PbASucJ2D8FRsdKzXtY91BetM+vpJ13c7Pz9jvlnu/WDlQeqa6gJQUiFCm72WvWjsIqKjop3Ox8fEc23Wteb4rRO9N+keqjpk0jPSJHh4RGv9deD7wA3AOqXUFKXUw0A+cDOwC1gZqEIOZNPTppu0/ZuOK1pr1p20BY/s7sEjOS6ZmekzrevR7CzfGaCSChG69pzZY9ILMha4vMb+ZcuT/kD736P973Sg8HlhRK31z4B7gWuwlgz5PFAAfERrvVBr/U5gijiw2b/RHKx0Hzz2V+w3VfPUhFTmj57v8jppuhIDTUc/IMC8UfNcXmP/svVu4bu9rupg/3uUmoeHlOVO4GsdLwFngGu01s8FqnDCuS21t5qH/dvSdROv61Y172D/5rX3zF7/CihEiHNoh1PNw75Uj112arYZMdXQ0sDmks095tnY2sjJmpOANdJq6oipASxxePBlqO4twAHgMawlS34OfB0YBbytlEoPaAkHOPs3mgOVB9xeaw8ervo7OsweOdvjPIUId4U1hWawyfCE4WZOhyueNl0drjpslv+ZOGwiCbEJASpt+PCl5vEcMBVr1NUUrfV3tdb/D/gkMB3YrJSaELgiDmyTh08mIcb6xSyvK6eivsLldQ3NDWwq2WSOV07qucupo88DrOGGske6iGT2Wse80fPcLrvuafDYdXqXSc8ZGbprxPUlX4LHeuAyrfVdWuuyjhe11k8CtwAZwCal1MBrBOwDMVExTit/2n9p7fKK8kwb7cz0mWQO6XlV/OS4ZFM9b9NtHK4eEKvciwHKPiqqtwf9tVnXEhNlzUDYe2av6UPsald5599hTx3wkc6XobrXa63393DudawVdZOB91xdI7xn7/juaXSU0ygrN01WHZyariqk6UpEriPVnasj9dY3MXjQYBaNXWSO7X9XdjtPd/4d9jQwJdIFfBtarfUmIBdoCXTeA5X9m01PNQ9P+zs62CdJ7a9w+V1AiIjQsRgiQM7wnF6v763pqtnRzL4z+8zx/AwJHi4ppbzuCdJa78UawutzHqKT/ZfTVc2j6HyR+QNJiElg8fjFveZpDx69jeISIlxprTl29pg5zhnhQfCwDdldd3Jdt43TChsKaXFY342zUrJITUgNUGnDiyc1j0Kl1H1KqUHeZKy1PqmUmqOUeglr50Hho6kjppqlE8rryimoKXA6b1/ILXdCLvEx8fRmWto0k7Z/MxMikpTXlZstZ1PiU0hLTOv1PXNHzTXXVV+sdpojAnDgQmcz70Dt7wDPgsdbwK+B00qpPyqllrmrSSilJrbvY74V2A3MATYEprgDU0xUjNNCbm8XvO10/qWjL5l0x94dvclOzTbb3BbWFNLY2hiAkgoRWro2WbkbadUhSkU5jVbsulTJrprOpmP7kiYDjSf7eXwKa2vZnVhbvL4NXFBK7VNKvamUekop9YJSaqNSqgI4jrWPeRbwPSCnvR9E+OG6ideZtD141Fyq4b2izrEJq3NWe5RffEw8WcOyAGuZEm/2CxEiXByttgUPD5qsOti3MrD3e7S0tbD3/F5zvGLiCv8KGMY86fP4FlCntV6JNb/jl8B+rDkdK4HbsPYr7+jjeB74ODBWa/1zrbVMIggA+y/pO4XvmHbYZw89S5tuA+DyjMvJGJzhcZ72zkP7iBQhIoW95jF1uOezwO01j82lmymrtWYlbD+1nUaHVUufkDKBScMmBaik4ceTZqufAx8F0Fofx5pZvhAYCuQAVwPzgEyt9Uit9Ue01k9rrQM22kopFa+Uer+9tnNQKfWjQOUdLmamz2Rk0kjA2u1s/wVrhNTa3WvNNR+f9XGv8rQPW5TgISKR/ffam5pHelI6yyYsA6zlTR7b8xgALx550VyzPGu5R81gkcqT4NEC2PftOAR8V2t9UWt9XGu9TWu9T2t9um+KCEATcK3Weg4wF1illLqyDz8v5Cil+NC0D5njN868wa7yXWb01aDoQXxy9ie9ytMePKTTXEQib4fp2t0z/x6TfnTPozQ0N/DEgSfMa7dOu9X/AoYxT4JHOVbNooPy8H0Boy317Yex7f90f5YhFHxqzqdMel3FOlb8X2dT1q3Tb2V44nCv8pNmKxHJLrVcovh8MWB1gmenZnv1/lum3sKIxBEAlFwoIfPXmWbG+ejk0Vw36Tp3b494LncC7OIV4MtKqdew+jMgCA9upVQ01j4h2cDDWutua4krpe7B6tQnLS2NvLy8fi1jf5g9dLZpsjrfeB6AKKJYMWiF1/d7rvmcSR+qOMSGDRtCphpeX18fkT8/iOx7g9C5v4L6ArNN7KhBo9i6aavXeXxo5IdYW2g1DV9oumBevzn9ZjZtHNjjgJTW7uOAUmow8CRwI1bQUFhNWYexhuLuBvYAe7XWDX1aWqs8KcALwL1a6/yersvJydFHj0ZeU0x+ZT4L/7yQS62XzGv/teS/+PGyH3udl9aa1P9NNUHo1NdOedXh3pfy8vLIzc0NdjH6RCTfG4TO/T176Fk+8q+PAHBD9g28/onXvc6jqbWJpX9b6rTvzeTkyRy47wCDYrya+hY2lFK7tNa9TmDpteahta4DViulcoDlwO+B88BkYDbwaaygopVSx7ECyW5gt9b6XV9vwE15ziulNgCrsHYuHFBmps8k79N53PvcvegEzR2z7+Dehff6lJdSipzhOeYP40j1kZAJHkL4y2mYrpf9HR0GxQzijU+8wfff/T7/Lvk3V465khvjb4zYwOENT5qtANBaHwWOKqV+jzWP4ydYw3Uvs/2bgzUC63asgOJ6NyIvKaXSgJb2wJEAXAf8IhB5h6OFmQv5xexfBOTbXc6IzuBxtProgJ70JCKLU2e5FyOtuhqWMIyHb3zYHIdCk1wo8Dh42HwYKNdaO7C++edj7e0BgFJqCjAf5052f40G/t7e7xEFPKO1fjWA+Q9Y9m9kMuJKRBJvVtMV3vM6eGitn+/l/DHgGPCUr4Vyked+AhuMRDt78LAvICdEONNa+zVMV/SuX4fcitBjr85LzUNEioqGCrP17OC4wYxKHhXkEkUeCR4D3KRhk8wCiUXni2RLWhERuq5pFSpD0COJBI8BLiE2gfEp4wFrGYaTNSf9zrOlrYX9Ffs5e/Gs33mJgePkuZMU1BTQ2/QBT0iTVd+T4CGcO82r/Wu6OlR1iKkPT2XOn+Yw+lej+e223/pbPBHhGlsb+dA/P0T2Q9lM+t0kbv7nzVxqudT7G90IxDBd4Z4EDxGwEVcXWy6y+qnVZrOqFkcLX33rq6w/ud7vMorI9e313+aFIy+Y45ePvsx9b97nV56BGqYreibBQzBl+BST9mfE1W+2/abbLocA31z/zYA0RYjIU1BTwMM7Hu72+qO7H2V/xX6f83VaTVdqHn1CgocIyIir5rZmfrf9d+b4x7k/JiHG2nByX8U+NhZv9K+QIiL9YccfzH40uRNyuXHyjYC1Qdkfd/zRpzybWpsoPF8IgEIxefjkwBRWOJHgIQLS5/HG8TeoaKgAIHNwJvdfc7/TKsCP73/cv0KKiNPmaHNa4vybV3+Tby36ljl+Mv9JLrZc9DrfkzUnzWZp44aOIzE20f/Cim58mWEuIkzmkEwSYhK41HqJs5fOcvbiWa+Xd3/28LMmfeecO4mNjuWTcz7Jn3b9CYBXj7+K1lqGTApj9+ndZonz9KR0Vk5aSbSKZnLqZI6fO05tUy3PHXqOT87xYJ+aigrYvh0OHiRhbx5/PQpNMRA3MRYmvgxXXAEjR/bxHQ0sUvMQRKkov/o9mlqbePnoy+b4I9OtlUyvyLyC1IRUAM7UnyG/csCtYyncWHdynUmvyl5FTFQMSinumnuXef2loy+5z6SmBh5+GO6/H158ESoqKB/UTPFQqE6EiU1J1uv3329dV1PTNzczAEnwEIB//R7vFr5rZvNOHDaRuaPmAhAdFe2097r9YSHEuoLO34eVEzv3DF8zdU3nNSfX0dzW7DqD/Hz47ndh714YN876l5JCVXMNKGiNgsT0DOv1sWOt6777Xet9wm8SPATgX7/Hu4WdK++vyVnj1DRlfyi8dfItP0ooIkldUx1bSreYY/uXjGkjpjEhZYJ1XXMdm0s2d88gPx9+9StISoLMTLD9ztknp3bsBEhUlHVdUpL1PgkgfpPgIYAuw3XPeddslVecZ9Jdl3S3b9W5pXQLbY423wooIsr2U9tpdbQCMHvkbEYmd/ZHKKX4QPYHzPHrx7ts4tTRVDV8OCQnO53SWlN9sdocD0/o0neXnGy9T5qw/CbBQwC+1zxqm2rZfXo3YA2LvGbcNU7nxw0dZzaYamhp4HD14QCUVoS790+9b9JXj7m62/lV2atMekPRBueTTz4Jra3dAgdYv2OXWhsBGBQdx5BBQ7p/eHIytLRY+QifSfAQgHOfx4lzJzyuIWwq2WSGRc4dNZeU+JRu1yzMXGjS9oeGGLjsvwf2348Oi8cvNgt27jmzhwuN7fuHV1TAzp2Q4XrHy6qGKpNOS0rreXRfZibs2GHlJ3wSFsFDKTVWKbVBKXVIKXVQKeXf2gWimyGDhphlq5vamii5UOLR+94res+kl45f6vKahRkSPEQnrbXTnuCugkdKfIoZeOHQDjaXtvd7bN9u9W/0EBSqLnYGD9Pf4YpSVj/I+/L76KuwCB5AK/B1rfV04ErgS0qp6UEuU8Sx93t4OuLqveLO4JE7IdflNVLzEHan6k6Z+R3Jcck97vJn/zJivqQcPAhDXDRFtXOqeSSmuS/IkCHSce6HsAgeWuvTWuvd7ek64DCQGdxSRR5v+z3qmurYWb4TsPo7Fo9f7PK6BRkLTHp/xX4a29ukxcDU8TsDMH/0fKKjol1et3SCLXh0fEkpLnbZ19HBXvNIS+oleCQnW/kJn4TdDHOl1ASsLWm3uzh3D3APQFpaWkRvVF9fXx/w+4s53/nrsOHABuY0znF7/fvn3jfrEmUlZbF/e88L2WXEZ1DeWE6bbuPxNx8nOznbbd59cX+hIpLvDXq/v1eLXzXpEa0jerxWtXQ2Te04tYM33nmDuUVFNF261GOz1Zm6MybddK6JorqinguqNYMqKjjq5c8i0n9+ngqr4KGUSgaeA76qta7tel5rvRZYC5CTk6Nzc3P7t4D9KC8vj0DfX/2xev5YYC1Gdz72fK/5r3unc5LXjTNudHv9gjMLzCz0+HHx5M52n3df3F+oiOR7g97v79HnHzXplfNWkju/52tnnZjFgcoDOHAQPSGa0RMmwIgRENP90XWx5SKNRdZOmLFRMczMnul+OZzWVkhIYLSXP4tI//l5KiyarQCUUrFYgeMJrfXzwS5PJJo9crZJ76/Y3+sy6nlFeSbdU39Hh1nps0z6QMUBn8onIsOhqkMmPW3ENLfXduv3GD8e6utdXmvv7xiRNKL3ddTq6638hE/CIngo67fgL8BhrfWvg12eSDV2yFiGDhoKQE1jDafqTvV4bUNzAzvKd5jjJeOXuM17ZvpMk86vkk7KgcqhHU57bUxPcz/uxd7vsbFkI8yYAbXdGh2ALv0dvXWWg5XPzJm9XydcCovgASwCPglcq5Ta2/7vA729SXhHKdWt9tGTrWVbzQzhGWkz3A+LRGoewlJ8vphLrdYWs+lJ6b2u3rx4XOcgjPdPvc+ly2aD1uBwdLu2sqHSpHsNHg6H9W9h92HCwjNhETy01pu01kprPVtrPbf93+u9v1N4yx489p3Z1+N13jRZgTUMODYqFoDS2tLOSV9iQLE3WfVW6wAYmTzSDOVtbmtmW0shLFgAp093u/Z0XedrHXOWelReDpdfLsu0+yEsgofoP3NGdo6w2l/Zc83DPr+jp8mBdrHRsU7j+WV59oHJKXiM8Gyqlv33a2PxRvj4x60Oc1vfh0M7zNwRgNGDR/ecYX09xMZa+QifSfAQTuw1j13lu1xec7HlotNkv976OzrMGtnZdCXBY2A6VO1dzQOcf7/eK34Phg2DL30Jzp41AaT6YjUt7c2oQwYNJjmuh7kg9fXW+770JSsf4TMJHsLJnFFzTPPS8XPHnZa37rC1dKvZY2HqiKlOK6K6MzOts3PyQKX0ewxE3jZbgXPw2Fq2labWJquj++tfh4YGKCvjdG25ucZlrcPhgLIy6/qvf106ygNAgodwEh8Tz7zR88yxfQ2iDusL1pv0tROu7Xa+J/YRVwerDvpYwu42FG7gI//6CLc/e7ssfxIAWmse2/MYq59azede+RylF0oDlq8vwWPMkDFMHDYRgMbWxs4Z6jNnws9+BvPm0VhwjLEXIKURMhNGWp3qra1w/jyUlFj/5s2zrpfAERBhNUlQ9I8rM680D+FtZdv4wGTngW324GHfr6M39ofF4arALM3+2rHXWPP0GjPT/cUjL7LhUxu4auxVAcl/IPrJxp/wQN4D5vj1E6+z87M7Pa5h9qSstoz6ZquZKTUhlfSkdI/fu3T8UgpqCgBrifZF4xZZJ9qbsL5/6REG7YKZlTC+JckKFoMGWfM4li+3RlVJ53hASc1DdGN/8G4t2+p0rqqhij2n9wAQraJZNmGZx/lOSJnAoOhBAFQ0VHDu0jm/ylnfXM89r95jAgdYKwJ/9pXPyqZTPjpcdZgfb/yx02tltWV8Y/03/M67a62j10l8NvZNxrpuDlVzqYZ3GvJ5bSr8cmkUKX97Gh57DP70J/jOd2D1agkcfUCCh+jmyjFXmvTW0q1OCxmuO7kOjTXz/IoxVzA0fqjH+UZHRTuNuPK39vHXPX+lvK682+sHqw7y6rFXXbxD9ObBLQ+a+Tt2T+x/ghPnTviVty8jrTrckH0DUcp6XG0r2+Y0p2Nj8UbzOzl/9HyvfieF7yR4iG7GDx1Pdqq1cGFDS4PTnI5/HfqXSd+QfYPXeU9L61yOwt9dBdfuWmvSD3/gYb696Nvm+C97/uJX3gNRXVMdT+Z37q636a5NXD/pegA0mr/s9u//qdOyJGnulyXpanjicK4ee7UpyxvH3zDn7L+f3tSEhX8keIhulFKsnrLaHL9y9BUALjRe4I0TnX+0t824zeu87WsZ+VPzOFR1yHS6J8QkcOecO/nsZZ8159cXrKehucHn/AeiV469YmqZM9NncvXYq/ni5V805/916F+9rnfmji/DdO0+OPmDJv3Pg/8ErE54++/ksiwJHv1FgodwySl4HHsFh3bwwpEXzBDdeaPmMXn4ZK/ztT807A8Tbz176FmT/sDkD5Acl8yk1EnMSJsBWKNy1p1c19PbhQv2voTbZtyGUoqVk1YyOG4wACdrTrL3zF6f8tZaO31Z8CV4fGTGR0z6zRNvUnS+iP0V+83GZUmxSR5NWBWBIcFDuHTNuGsYFm9NoiqtLeX146/z2+2/Nedvn3m7T/kGqubx3OHnTPoj0zsfKmty1pj0S0df8jn/gUZrzTuF75jjjibJ+Jh4bsq5ybxuD9reqGiooKaxBoDBcYPJHOz9Xm4Th010akZ7ZOcj/HHnH8351TmrSYhN8Kl8wnsSPIRLsdGx3DX3LnO8+qnV5ltnQkwC/zHvP3zKd/LwyUQra+e44gvFPjUtVdRXmEUbY6NiuXHKjeac/UFnfxgK9w5VHTLLewyLH2b2Dwf40LQPmfTbhW/7nH8Hb0da2X1u/udM+uebf84jux5xeU70PQkeokdfvfKrJMYmdnv9P6/8z15XQ+1JXHSc6YwHnJbn9tS7he+a9FVjr3JaimJ+xnySYpMAa4hpyYUSn8o50Lxd0BkUrs261mlr2GUTlqGwHvY7y3f6tKilL5MDXbkp5yanwNZh0dhF0mTVzyR4iB6NHTqWh254yOm1K8dcyfeXfN+vfP0dcWUPHl1nuMdExTgNNd5cstmHEg489oUul2ctdzo3LGEYl42+DLAWINxYvNHr/AMVPKKjovnHzf8gJT7FvDY8YTiP3vSoz7UZ4RsJHsKtu+fdzcZPb+SbV3+T3636He/e+a7f7cr+9nu8W9QZPJZPXN7t/DXjrjHpTSWbvM5/ILIv62Jmb9vYJ+n50hwYqOAB1gKbez+3lx8u/SEPLHmAPZ/b4zR/SPSPsFmeRCn1V+CDQKXWWhan6UeLxy9m8fjFvV/oIX9GXJ2qPWWWqUiISWBhZvfNfBaN7Xz4bS4NfM2jqbWJp/OfpqKhgjU5a8gZkRPwz7DTWrO+YD3vn3qfRWMXBXw4anldudk1MjE20eXDfdmEZfxyyy8B3wJyIIMHwPiU8fwg9wd+5yN8FzbBA/gb8HvgH0Euh/CTPzWPbWXbTHph5kLiouO6XXPlmCtRKDSa/Mp8GlsbiY+J973ANpdaLrHi/1awpXQLAA9seIBXPvaKV2t8eevbb3/bPLgBHljyAD9a9qOA5b/jVOd2wpeNvoyYqO6PBfuSNfsq9nGx5aLL/jBXqhqqzBaxibGJjBs6zs8Si1AQNs1WWuuNgH+LIYmQYG9iOHHuhJk74gl78LD3bdgNHjTYdMq36TYOVgZuBd8f5v3QBA6w1tL6xPOfoLbJ9b7a/lp/cr1T4AD48cYf8+/ifwfsM+x70S/McL0ta0p8ign6rY7WHvd6ccXerzVtxDSzzIgIb+FU8+iVUuoe4B6AtLQ08vLyglugPlRfXx/W9zdy0Egqmipo02088eYTZCVlOZ3v6f7eOviWSSefT+7x/0FGdAbHOQ7A0+89Td3oOr/LXNNc4zTXpUPVxSq+9vTXuGP8HR7l483P7r7d97l+/cX7+PWcX3uUR2/eyu/8f5p0IanHsk2ImcBhrEDwxMYnaBvrevHJrvf3cvnLJp3alhrWv7cQ/n97gRJRwUNrvRZYC5CTk6Nzc3ODW6A+lJeXRzjf37xT83jzxJsADM4aTO70XKfzru6vua2Z45uPm+PPrPpMj3tVr4xeyXvvWiOIGoc2BuT/1f9u/l+aHE2A1bzz5cu/zN0v3w3A+pr1PPLJR5yGuPbE05/d3jN7Ofye9bCOi45jw6c2sOSxJbTpNvac38OY2WOchj37qmxXmUnfsfwOpgyf4vK644OP88ar1lIglXGVPd5D1/t7/o3nTXrZzGXkLnb9vnAR7n97gSL1RxEU9lVVPe332F+x36y9NCFlQo+BA3CaC7DnzB7fCtnF/+3/P5P+ysKv8PFZH2d4gjXfpeRCScA3ovpn/j9N+sPTP8zVY6922lvFft5X1RerzeTA+Jh4Jg2b1OO1Tqstl231eJ2rQHeWi9AgwUMEhX2uh6cjrraWdu4tctUY95s92YPHvop9OLTDuwJ2UXS+yOy7Hh8Tz63Tb2VQzCBumXqLueaVY6/49Rld2fO7fYa1HIx9WZiOxQH9Yd9LfnradLc1p+lp0806V2fqz3g8AdO+5fCM9Bk+llSEmrAJHkqpp4CtQI5Sqkwp5dv6GCIk+DLiatup3jvLO4xOHm12qqtvrjfDe31lXwJ82YRlZlb7B6d0rvQayD1ECmsKzarB8THxZj7LTTk3kRBjzbM5UHnA7z027MFjVvost9dGR0U7DY22D17oSWVDpdl7IzE20WwnK8Jf2AQPrfXHtNajtdaxWusxWmvZsCGM2WseR88e9WjnP09GWnVQSjnVPnxdDbbDa8dfM2l709HyicvN7ogHKg9QfL7Yr89x9XnXZl1rhsUmxyU7TYy0z7b3hT142PeY74n9/7snweNAha3WkTZDRlpFEPlJiqBITUhlZJK1NWhjayNF54vcXl/ZUGlqD4OiB7lc36iruSM7r+nYOtcXzW3NTg9pe/BIjktm6YTONZXsy3z4w77BUddNt+xLsvgbPOxNSr3VPMC5ubDrFsWByF+EDwkeImjsnae9rXFl7++4bPRlLicHdjVn1ByTzq/Kd3Ole7tP7+ZS6yXAWha8a9PL4nGds+8DsZaW1tppZvyS8UuczttnmG8o2uDzBk1aa69rHleMucKkd5/e7bRFsSv2mseskRI8IokEDxE03vR72L/ldmxH2hv7N137Q8xb9uU47OtmdQj0ciiF5wvNCKghg4aYDa46zB45m9SEVMCqkdlHM3mjrLbMTG5MiU8hY3BGr+8ZkTiCyanWJmAtjhZ2n97t9nqpeUQuCR4iaOw1j/2V+91eaw8evY206pAzIscstVF4vpD65nofStkleIztHjwWZi40e5QcrDpIzaUanz6ng732ctWYq7qNgIpSUU7Lj3vSfORK1we7p6vS2pcqsdcIu3Joh+n0B6l5RBoJHiJonOZiuOmTaGlrcVp/yf7wcicuOs5pwpsvy5R0bUJyteJsUlyS0734+jDvYF/+xF6rsbsis7P5yNf5Jd42WXW4ekxnzW9L2ZYeryuoKeBiy0UA0pPSzeg3ERkkeIigmTNqjtlk6HD1YfOg6WpfxT7T5zB+6HiPmlc62JtK7A9LT504d4Lqi9WAtcNeT0t/22tD3qz75MruM51NQT2NKrMPmQ1E8PCmSalrzaOnPhen/g5psoo4EjxE0CTHJZuHsUM7zNayXTlNDvSw1tHB/o3a3kzjqV2nOwPBwsyFPQ417dgsCZwf/t5qdbQ6/X/oaVTZ/Iz5JvDmV+b7tJ2v/f+HNzWPGWkzzGTB0/Wne5wsaO8PmT1yttflE6FNgocIKqeHbg+dr/amEU/7Ozr4W/PYWb7TpBdkLOjxOvt9+DMs+PjZ42YEU+bgTNKS0lxeN2TQEDNXpk23eb0ES6uj1WmQgjfBIzoq2mnUlb2ZzW77qe0mfXnG5V6VT4Q+CR4iqOwPXVfNPVprp4eTpyOtOgSy5jF/9Pwer5ueNt0MHy6+UMzZi2e9/ixwnszY21wWf5quTp47SVObtchj5uBMhiUM8+r99n4PVyPMHNrhVCZ7sBGRQYKHCCr7t3lXna8FNQWmWSQpNok5I+d0u8adrGFZZna2fakMTzi0wymgzc/oOXjERsc61XJ8ndHuVfDI8D14+Npk1cE+ZHlD0YZu54+dPcaFpgsApCWmkZWS1e0aEd4keIigujzjcvON/Uj1ESrqK5zOv13wtkkvnbCU2OhYr/KPUlFO8yS8GXF14twJ6pqtfUDSEtMYO2Ss2+s9aYLrzd6KvSbdlzUPXzvLOywat8j83A5VHaK8rtzp/PayziarK8Zc4fEwYBE+JHiIoEqITXAadvrvEucd8t4pfMekV2St8OkzfG266lrr6O0BOG/UPJP2pdNca+3UX9Jb8Jg1cpZ5gBeeL/SqqczXYbodEmMTnYYRd10mxf5ztP98ReSQ4CGCzr78xsbijSbd5mhzeiitmOhb8PC109yps3x0z53lHfztND9Tf8bs9Z0cl9zrCrRx0XFOzXj2/pne+NtsBbA8q3OBxvUF601aa202+gJrYUcReSR4iKCzB491J9eZeQPvFb/H2UvWt+lRyaN8fsj5XPM47Vl/R4fZI2ebobzHzh7zeka7vb/Dnpc79k58T+eXXGq5ZJZyVyifN2i6btJ1Jv3K0VfMXvSFDYWcqjsFWHNj7M1rInJI8BBBd824a8z+GEfPHmVfxT4Ans5/2lzz4Wkf9rnd3L4sRn5lvkcLCTq0w6nfwt1Iqw4JsQlm3opGe72ellNnuW1FYHfsAw52nt7p5spOh6sPm82xslOzSYhN8LiMdpdnXM74oeMBqGmsYd3JdQBsP9fZ33HdpOvMEjEisoRN8FBKrVJKHVVKnVBK3R/s8ojASYxNZE3OGnP81IGnaHG08Nzh58xrH5v1MZ/zH5k00mwXW99cT/GF3vfcOH72uOksT09KZ8yQMR59lr0ZqSMIesqbzvIO9hqRpzWPfWc6y+XP5D2llNPOhk/lPwVAXlWeea3rcvIicoRF8FBKRQMPAzcA04GPKaVkM+QIYn8IPX7gcV49/SrnLp0DYOyQsb1u/uSOUqpb7aM3Xed3eFrrsQcPb4fr2h/qngaPGWkzzGZUxReKzVIq7thnsPs789v+c/vXwX/xzMFnOFZ/DLD2Xbkp5ya/8hehKyyCB7AQOKG1LtBaNwNPA2t6eY8IIysnrTSbQ5XXlfO7E78z5750+Zf83oFuZpqt38OD5iT7QozuZpZ31XXvdE81NDdw7Kz10I1SUR7378RGxzrtW+JJ7cO+grG382a6mjNyjpm42eJo4bZnbzPnbpt5m1k6XkSecAkemUCp7bis/TURIeKi43hg6QPdXh8zZAxfvPyLfudvfxh7sjGUvf/Am6U17A/yAxUHPNpeF6yOfI3VFzN1xFSv+iHs/TH2EWKuaK0D1mwFVq3uZ9f+rNvrcdFx/NeS//IrbxHaIqonSyl1D3APQFpaGnl5ecEtUB+qr6+PuPubqqeyPH0571RaczuSopP41sRvsWurf6vUArRcaDHpbQXb3P6/a9Nt7CzrfAg3FTWRd7rn67saFjuMmpYaGloaePLNJxmb6Dy50NXP7uXyl016tBrt1c82uTbZpN868BaLHK6XcQc423TWjGBLjE6kcG8hxcr/fdc/k/UZHi18FIAoovha9tco219GGWV+5x1qIvFvzxfhEjxOAfa/wDHtrznRWq8F1gLk5OTo3NzcfilcMOTl5RGJ97csdxkbizfy5rY3+c/V/xmwPSDmNc7j3r33AlB6qZRFixf1OFv9YOVBGjdaixNmDM7gw9d/2KvPurzscjPyKH58PLkzcp3Ou/rZPf1q58iy62dfT+4i5/PuDDszjF8e+yUARc1Fbn8v3jrxFmyz0nMz5nLtssDMwcglly+f+TL7KvahTik++YFPBiTfUBSpf3veCpdmqx3AZKVUllIqDrgdeLmX94gwpJRi6YSlXD/q+oBuHjQ0fijjho4DrLb54+eO93jtjvLO/g5fVoP1ZcSVN2tadTU9bTrxMfEAlNaWul2/y16e2emBXSZ9zqg53Dnnzm41LRGZwiJ4aK1bgS8DbwGHgWe01t5vCycGNKfJgm46zT1dhr0n3o64anO0OY2AsvebeCI2OtZ5prmbTvNAjrQSA1tYBA8ArfXrWuspWutJWuufBrs8Ivx4uuqtv8HD2xFXR88eNTslZgzO8KnG5TTT3M0yJfZ9PyR4CH+ETfAQwl/2QGDfqMiuua3ZKbD4EjxyRuSYuRdltWW9Lljo7Ux2V+zltDe72dU21ZoNoKJVtNfNY0LYSfAQA4Z9jaWd5TtdDqPdVb7LbJI0cdhERiSO8PpzYqJimJHeuQx8b7UPe/CwL67oDfu9bSnd4nIJlh2ndpjhwDPTZ5IUl+TTZwkBEjzEADJ2yFhGJY8CoK65jiPVR7pdY19KfPG4xT5/ln1tKvu8ClcCETympU0zE/KqL1Zz9OzRbtc47ewny6QLP0nwEAOGUsrpoemq6SpQwcPe6e2u5uHQDqd+CF+DR5SKctrd79/F/+52jf1+ZVtY4S8JHmJAsQePzSXOe287tMPpNfvD2Fv20U/24NDVyXMnqW2qBazdCjMH+75wwjVjO8u7qXST0zmHdrC1bKs5lpqH8JcEDzGg2PcOebvwbae+gX1n9lHTWANYD/Ipw6f4/DnzRs9DYS2mmF+ZT0Nzg8vrujZZ+bNd6+LxnTWldwvfdbq3AxUHzPyP4QnDmZY2zefPEQIkeIgBZmHmQoYMGgJAyYUSsxghwCvHXjHplZNW+vUgHzJoiHlAO7Sjx+Gzgejv6LAgYwEp8SmANcrL3lzWMeMdrD02/F1oUgj5DRIDSmx0rNO2qPaHqj14fHDKB/3+LKf+lTLXQ4PfL+/sxPY3eMRExTjtn/HK0c77WVfQeZ8rJ67063OEAAkeYgC6bmLn9qmvHn8VsJaB75gcGBMVw6rsVX5/Tm+d881tzU5B5aoxV/n9maunrDbpl49ZK/hcaLzg1IFu3z5WCF9J8BADzo2TbzTptwve5nTdaR7f/7h5bfG4xab5xx/2EU1by7Z2m3ux+/RuM7M8KyWLzCH+7zKwKnuV2fZ1Z/lODlcd5rnDz5m5K3NGzvF4V0Qh3JHgIQac8SnjTce5Qzt4cMuD/P7935vzd865MyCfMzN9pulfKa8r77YY46aSzhFR9s5ufwxLGOa0e98vt/yS32z7jTm+Y/YdAfkcISR4iAHp3oX3mvSvt/2a0lprr7H0pHQ+OuOjAfmMmKgYcifkmuN3Ct5xOm+fU2IfZusv+709tvcxDlRai0AmxSZx19y7AvY5YmCT4CEGpFum3uJy3aofLv0hibGJAfucFVkrTPrtwrdNurG10SmY2IcQ+yt3Qq5Tx3mHb1z9DYYnDg/Y54iBTYKHGJCio6J5+tanmTRsknnt8/M/z+cXfD6gn7NiYmfweLfwXVraWky6ocWa+5Gdmu3XnBJX/nbz35wWPrx12q18b/H3AvoZYmALl50EhQi4SamTOPSlQ2wu2UzG4AxyRuQE/DOmjpjK2CFjKa0t5Xzjed448QZDGMJLR14y16zJWePXnBJX0pPS2fHZHew4tYOE2ATmjJwT8M8QA5vUPMSAFhcdx7KsZX0SOMBaT+sTsz5hjv+29280O5p54cgL5rWbp97cJ58dExXDVWOvYu6ouRI4RMCFfPBQSn1EKXVQKeVQSnm/uYIQQfbpuZ826VeOvcITJU9QdbEKgDFDxgRkfocQ/S3kgweQD3wI2Bjsggjhi5wROWaRxVZHK/8o/oc598UFXyQ6KjpYRRPCZyEfPLTWh7XW3TcnECKM/M/y/+n22pghY/jKFV8JQmmE8F9EdZgrpe4B7mk/bFJK5QezPH1sBFAd7EL0oUi+vxFAdRllJH8tOdhl6QuR/LODyL8/jzoAQyJ4KKXeBka5OPU9rfVLLl53SWu9FljbnudOrXXE9pHI/YWvSL43kPsLd0qpnZ5cFxLBQ2u9overhBBChIqQ7/MQQggRekI+eCilblFKlQFXAa8ppd7y8K1r+7BYoUDuL3xF8r2B3F+48+j+VNdlooUQQojehHzNQwghROiR4CGEEMJrER08lFL/rZTar5Taq5Rap5TKCHaZAkUp9Uul1JH2+3tBKZUS7DIFUqQuS6OUWqWUOqqUOqGUuj/Y5QkkpdRflVKVkTq/Sik1Vim1QSl1qP13875glylQlFLxSqn3lVL72u/tR72+J5L7PJRSQ7TWte3prwDTtdaBXXM7SJRSK4F3tdatSqlfAGitvx3kYgWMUmoa4AAeAb6htfZo7HkoU0pFA8eA64AyYAfwMa31oaAWLECUUkuAeuAfWuuZwS5PoCmlRgOjtda7lVKDgV3AzZHw81PWyplJWut6pVQssAm4T2u9raf3RHTNoyNwtEsCIiZSaq3Xaa1b2w+3ARG1MXWELkuzEDihtS7QWjcDTwNrglymgNFabwTOBbscfUVrfVprvbs9XQccBvzfeD4EaEt9+2Fs+z+3z8uIDh4ASqmfKqVKgU8ADwS7PH3kbuCNYBdC9CoTKLUdlxEhD5+BRik1AZgHbA9yUQJGKRWtlNoLVALrtdZu7y3sg4dS6m2lVL6Lf2sAtNbf01qPBZ4Avhzc0nqnt3trv+Z7QCvW/YUVT+5PiFCjlEoGngO+2qV1I6xprdu01nOxWjEWKqXcNj2GxPIk/vBiaZMngNeBH/RhcQKqt3tTSn0a+CCwXIdh59UAXJbmFDDWdjym/TURJtr7A54DntBaPx/s8vQFrfV5pdQGYBXWlhguhX3Nwx2l1GTb4RrgSLDKEmhKqVXAt4CbtNYXg10e4ZEdwGSlVJZSKg64HXg5yGUSHmrvVP4LcFhr/etglyeQlFJpHSM2lVIJWIM63D4vI3201XNYyws7gGLg81rriPimp5Q6AQwCzra/tC1SRpKBtSwN8BCQBpwH9mqtrw9qoQJAKfUB4DdANPBXrfVPg1uiwFFKPQXkYi1ZXgH8QGv9l6AWKoCUUtcA/wYOYD1TAL6rtX49eKUKDKXUbODvWL+XUcAzWusfu31PJAcPIYQQfSOim62EEEL0DQkeQgghvCbBQwghhNckeAghhPCaBA8hhBBek+AhhBDCaxI8hBBCeE2ChxBCCK9J8BBCCOE1CR5C9LH2XSy1UurWLq8rpdTf2s/9PFjlE8IXsjyJEH1MKTUH2A0cBWZprdvaX/8V8DVgrdb6c0EsohBek5qHEH1Ma70P+D9gGvBJAKXUd7ECxzPAF4JXOiF8IzUPIfqBUmos1v7lZ4BfYa0Y/BbWkvrNwSybEL6Q4CFEP1FK/Q9wf/vhFuA62YtFhCtpthKi/1TZ0v8hgUOEMwkeQvQDpdTHgQexmq0A7gticYTwmwQPIfpY++6Bf8PaD3o21qirzyilcoJZLiH8IcFDiD7UvnXps0AZcL3Wugr4PhAD/CKYZRPCH9JhLkQfUUrNBfKAS8A1WuuTtnM7gAXAEq31v4NSQCH8IDUPIfqAUiobeBPQWDWOk10u+U77f3/ZrwUTIkCk5iGEEMJrUvMQQgjhNQkeQgghvCbBQwghhNckeAghhPCaBA8hhBBek+AhhBDCaxI8hBBCeE2ChxBCCK9J8BBCCOG1/w9YuH0J/PHzdQAAAABJRU5ErkJggg==\n"}}]}}, "69c18280c0f94278a5b81ed7c1f3e096": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c7ae54e413904f1f94b80d865fc9b0e7": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_d07ee3aab37447fe85d45343d13d3edd", "IPY_MODEL_544243476b534a548a2f326efe8e8ee5"], "layout": "IPY_MODEL_69c18280c0f94278a5b81ed7c1f3e096"}}, "fec0e25e3f0844ec85c79b096602b45a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "292b8aac5d764f7284b9d000c072027e": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "d07ee3aab37447fe85d45343d13d3edd": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_fec0e25e3f0844ec85c79b096602b45a", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_292b8aac5d764f7284b9d000c072027e", "value": 1}}, "7459c61c6be44b5aa786b41096e17ceb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "544243476b534a548a2f326efe8e8ee5": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_7459c61c6be44b5aa786b41096e17ceb", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>