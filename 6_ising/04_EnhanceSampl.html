
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Dynamics in phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.855 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.35897436,  0.25641026,  1.07692308,  0.82051282,  1.33333333,
         2.30769231,  4.46153846,  7.84615385, 15.38461538, 17.43589744]),
 array([0.66  , 0.6795, 0.699 , 0.7185, 0.738 , 0.7575, 0.777 , 0.7965,
        0.816 , 0.8355, 0.855 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "3aa576276c3140df9dc0b04a36468806"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.00043952362061504735
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "3dfb530d63b6413fa4371d967e2e92d8"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f8c0fe94850&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "fef7924c43b44ca995464462fdb3ef90"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"53bad3b2ead4404cb35b4e275539ac13": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3aa576276c3140df9dc0b04a36468806": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_b904bad70adf42b4a64d6128e3b521a4", "IPY_MODEL_63657c0278664f2bb3d65154c4795094"], "layout": "IPY_MODEL_53bad3b2ead4404cb35b4e275539ac13"}}, "52f621dc4ba746d99aec604493576017": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f70fb1519ddc4db88a2a6dc8143366c1": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "b904bad70adf42b4a64d6128e3b521a4": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_52f621dc4ba746d99aec604493576017", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_f70fb1519ddc4db88a2a6dc8143366c1", "value": 1}}, "6981540780cb445981f5668fde7b234a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "63657c0278664f2bb3d65154c4795094": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_6981540780cb445981f5668fde7b234a", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "6728ad92d2ef402ebc01a3906077626e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3dfb530d63b6413fa4371d967e2e92d8": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_6f7e0c5f34e641c7b3092e632f47e593", "IPY_MODEL_904537399c14468390ac88728e994238"], "layout": "IPY_MODEL_6728ad92d2ef402ebc01a3906077626e"}}, "156e38db7ac345d7aab393875c03bd9e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "544ffb88a30a4aa09d3ee46e3528fa01": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "6f7e0c5f34e641c7b3092e632f47e593": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_156e38db7ac345d7aab393875c03bd9e", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_544ffb88a30a4aa09d3ee46e3528fa01", "value": 1}}, "b5fcec94971e4d20944c3b14997347f4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "904537399c14468390ac88728e994238": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_b5fcec94971e4d20944c3b14997347f4", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "13f99d8dffb748ddb196025fa938e1af": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fef7924c43b44ca995464462fdb3ef90": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_e9dc7ea04f0d4aafaef72f7724a76e51", "IPY_MODEL_d45d0fd32c024a8eaa53c40dbf9d68f2"], "layout": "IPY_MODEL_13f99d8dffb748ddb196025fa938e1af"}}, "5cd154f55e02474997b033de5d507d15": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8ed240a388af459b9b3c8b6d0f76299c": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "e9dc7ea04f0d4aafaef72f7724a76e51": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_5cd154f55e02474997b033de5d507d15", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_8ed240a388af459b9b3c8b6d0f76299c", "value": 1}}, "4be48862d34244dba8ae45d62d62fa7a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d45d0fd32c024a8eaa53c40dbf9d68f2": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_4be48862d34244dba8ae45d62d62fa7a", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>