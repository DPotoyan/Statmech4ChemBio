
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/02_Legendre.html">
     Legendre transform
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/ensemble_overview.html">
     Overview of ensembles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Gases
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/photons_phonons.html">
     Photons and Phonons
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/landauer.html">
     Information erasure and Landauer’s principle
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.35897436,  0.76923077,  0.71794872,  0.92307692,  2.05128205,
         3.43589744,  5.64102564,  7.74358974, 13.28205128, 16.35897436]),
 array([0.705 , 0.7245, 0.744 , 0.7635, 0.783 , 0.8025, 0.822 , 0.8415,
        0.861 , 0.8805, 0.9   ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "7ad715d0db92495d9f6104f216f803d9"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.0002651004432207306
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "737af3f8dcc24f34826e435af36b32df"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fd3dc4a6410&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "2b692b3dfc974116ba8cffa888b702bd"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"18c99f7d74424eb29d91877aec1bb104": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7ad715d0db92495d9f6104f216f803d9": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_21a32e806f254788a1655e953b6c3d54", "IPY_MODEL_413c12854458477990682fe1070837f9"], "layout": "IPY_MODEL_18c99f7d74424eb29d91877aec1bb104"}}, "69a1c2dc84444e3daefe0be0654e24d5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "278012970f1d4fe4bd69353471e4d75a": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "21a32e806f254788a1655e953b6c3d54": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_69a1c2dc84444e3daefe0be0654e24d5", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_278012970f1d4fe4bd69353471e4d75a", "value": 1}}, "b40e87a1a1954199b04330354a6ecd93": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "413c12854458477990682fe1070837f9": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_b40e87a1a1954199b04330354a6ecd93", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "d99774f07c094292ada37f2031273e01": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "737af3f8dcc24f34826e435af36b32df": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_b3c2f447c3fd45149208743c38620547", "IPY_MODEL_5798f61179814780b8ceed3faa953855"], "layout": "IPY_MODEL_d99774f07c094292ada37f2031273e01"}}, "40389714100e4b11aa37fedaada1a7e9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "467008c933874f23864cb17535534af4": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "b3c2f447c3fd45149208743c38620547": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_40389714100e4b11aa37fedaada1a7e9", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_467008c933874f23864cb17535534af4", "value": 1}}, "09f658ecaad344c3b97490fc1be0f136": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5798f61179814780b8ceed3faa953855": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_09f658ecaad344c3b97490fc1be0f136", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "d6a828869b1a4afc9ac3140c2057a754": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2b692b3dfc974116ba8cffa888b702bd": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_f58332d692d945458c1d38e2e823e21b", "IPY_MODEL_aa4c2b3cb75048d586522232299a486d"], "layout": "IPY_MODEL_d6a828869b1a4afc9ac3140c2057a754"}}, "59df9071b89a4b698d3c819094f9622a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fd9753e13fbf46ebbb0465f4982c7481": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "f58332d692d945458c1d38e2e823e21b": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_59df9071b89a4b698d3c819094f9622a", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_fd9753e13fbf46ebbb0465f4982c7481", "value": 1}}, "28960ca9751a4d4693cbb1f82868a1fa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "aa4c2b3cb75048d586522232299a486d": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_28960ca9751a4d4693cbb1f82868a1fa", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>