
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.885 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.30769231,  0.56410256,  0.87179487,  1.02564103,  1.53846154,
         2.61538462,  5.48717949,  8.20512821, 13.12820513, 17.53846154]),
 array([0.69  , 0.7095, 0.729 , 0.7485, 0.768 , 0.7875, 0.807 , 0.8265,
        0.846 , 0.8655, 0.885 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "23c946255f894050901ba7ddb4b9cbba"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.00025428894672560023
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "fa56c4fda0e846acaf98dd0bff517728"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fb2608306d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "65534cb7c4b8438ba26fc696e31895bd"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"8745731678cb413abab4b98a47793fc7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "23c946255f894050901ba7ddb4b9cbba": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_88e689f917a74d9abc4992980b5b4f76", "IPY_MODEL_0f16b83d42fc4846adc9b6b0f169c205"], "layout": "IPY_MODEL_8745731678cb413abab4b98a47793fc7"}}, "135406c9ed0847ce81ea9cf6b636aa8b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1e2b52a1db2b4428a74d6e894ef8eaea": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "88e689f917a74d9abc4992980b5b4f76": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_135406c9ed0847ce81ea9cf6b636aa8b", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_1e2b52a1db2b4428a74d6e894ef8eaea", "value": 1}}, "c16df45b8b7a456589df20c36478f0e8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0f16b83d42fc4846adc9b6b0f169c205": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_c16df45b8b7a456589df20c36478f0e8", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "3442e21ed9224169bebb5422f9ed337d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fa56c4fda0e846acaf98dd0bff517728": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_90c3b7c782934a3fadf9f29c270656c4", "IPY_MODEL_842d8ddfc6834f0db55b5b39a0529bcf"], "layout": "IPY_MODEL_3442e21ed9224169bebb5422f9ed337d"}}, "a2d30d147c404d6ca3940599f84cf225": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7dcf0f30f14c456cbf05eedabfa26716": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "90c3b7c782934a3fadf9f29c270656c4": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_a2d30d147c404d6ca3940599f84cf225", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_7dcf0f30f14c456cbf05eedabfa26716", "value": 1}}, "bce748803301456da92ebcffe3767688": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "842d8ddfc6834f0db55b5b39a0529bcf": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_bce748803301456da92ebcffe3767688", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "d5212728455b4ffdb459940c25eb25f2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "65534cb7c4b8438ba26fc696e31895bd": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_a239f7a95b7f4e6c991a27a527973fe3", "IPY_MODEL_4d074c8cc4e84bc49a0a1ed20edb0893"], "layout": "IPY_MODEL_d5212728455b4ffdb459940c25eb25f2"}}, "a584bd0861e94c0e83906937d7b258f5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dd512c3cc15e415ca718f2b35b7fe8ec": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "a239f7a95b7f4e6c991a27a527973fe3": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_a584bd0861e94c0e83906937d7b258f5", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_dd512c3cc15e415ca718f2b35b7fe8ec", "value": 1}}, "18c1ca6e8756410fb87fd0d1523b60ce": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4d074c8cc4e84bc49a0a1ed20edb0893": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_18c1ca6e8756410fb87fd0d1523b60ce", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>