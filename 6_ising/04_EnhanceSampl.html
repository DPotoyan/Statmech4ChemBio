
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B2: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.885 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.1025641 ,  0.15384615,  0.51282051,  0.71794872,  1.28205128,
         2.05128205,  5.02564103,  8.56410256, 15.38461538, 17.48717949]),
 array([0.69  , 0.7095, 0.729 , 0.7485, 0.768 , 0.7875, 0.807 , 0.8265,
        0.846 , 0.8655, 0.885 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "e16efd2c81364487a58bc6c8d274bd62"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  8.636920815927393e-05
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "363c365d2f544cb68dcdbb7d8dd5bf85"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f7f6f1b2450&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "34ace85f7f1e49838f66681fb642d2b6"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"8d06281b2d7f4ac6a463b17448b179aa": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e16efd2c81364487a58bc6c8d274bd62": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_cbf1601557cc48da9189d39b900561f9", "IPY_MODEL_1b796b6b0abc4771965eb3c6b2070b77"], "layout": "IPY_MODEL_8d06281b2d7f4ac6a463b17448b179aa"}}, "adf0cd78bcee4e2692a36c5db2fb052b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3a92850cd914469db839e3cad44644bb": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "cbf1601557cc48da9189d39b900561f9": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_adf0cd78bcee4e2692a36c5db2fb052b", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_3a92850cd914469db839e3cad44644bb", "value": 1}}, "d2f0e263797849bfb725f231b68d5c68": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1b796b6b0abc4771965eb3c6b2070b77": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_d2f0e263797849bfb725f231b68d5c68", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "f1ca3c0733cf4b9099cac4d57f133217": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "363c365d2f544cb68dcdbb7d8dd5bf85": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_6878306116d14dd7adaca8e4524021b3", "IPY_MODEL_c0d9fcd1b2cf446c9a65a0505e598f9f"], "layout": "IPY_MODEL_f1ca3c0733cf4b9099cac4d57f133217"}}, "46efafb02b0e4e6988ef4ef249aa6cf8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4010a7f229f043f58cc02bb385f11c59": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "6878306116d14dd7adaca8e4524021b3": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_46efafb02b0e4e6988ef4ef249aa6cf8", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_4010a7f229f043f58cc02bb385f11c59", "value": 1}}, "734b7b850efd4ba69116806e8cd34163": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c0d9fcd1b2cf446c9a65a0505e598f9f": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_734b7b850efd4ba69116806e8cd34163", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "2f49676308ba4df29ac030031d2864f0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "34ace85f7f1e49838f66681fb642d2b6": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_f9312f6ea3ef4e9388b32164128a47b1", "IPY_MODEL_b7732bef98db4441886a3b1094c9f8fa"], "layout": "IPY_MODEL_2f49676308ba4df29ac030031d2864f0"}}, "38aec7422bbb43309b2f56aa3eb4e8e5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dcf36574a9bf49a795fc03da00c5f519": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "f9312f6ea3ef4e9388b32164128a47b1": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_38aec7422bbb43309b2f56aa3eb4e8e5", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_dcf36574a9bf49a795fc03da00c5f519", "value": 1}}, "90c7659aa09b42f184b641f52c7baee8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b7732bef98db4441886a3b1094c9f8fa": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_90c7659aa09b42f184b641f52c7baee8", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>