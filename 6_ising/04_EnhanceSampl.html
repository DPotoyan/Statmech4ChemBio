
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B2: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.95 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.15384615,  0.51282051,  0.76923077,  1.58974359,  1.84615385,
         3.69230769,  7.33333333, 10.92307692, 14.76923077,  9.69230769]),
 array([0.755 , 0.7745, 0.794 , 0.8135, 0.833 , 0.8525, 0.872 , 0.8915,
        0.911 , 0.9305, 0.95  ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "57be44bac8dd4c269f0b36933365b210"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.000410540081461443
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "01dd6fa3791c489fb9e84fe16e657266"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fe969e18fd0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "226aea9691d24b678d3cdb5bc9e4c2d7"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"6781eef946354db68aae13547acccd20": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "57be44bac8dd4c269f0b36933365b210": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_450fe0a2853943668a59eb513ef581ad", "IPY_MODEL_4f9ad8b5e9be4e7c9ca615538252c282"], "layout": "IPY_MODEL_6781eef946354db68aae13547acccd20"}}, "f2e47ea054c84af1b628afa305dc30b4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "384a68ae745642e3981d6b225a83a1d7": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "450fe0a2853943668a59eb513ef581ad": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_f2e47ea054c84af1b628afa305dc30b4", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_384a68ae745642e3981d6b225a83a1d7", "value": 1}}, "38cba36a51db497dab6f405239ddf3fb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4f9ad8b5e9be4e7c9ca615538252c282": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_38cba36a51db497dab6f405239ddf3fb", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "91b937ff10ee48b49d9cef6266cf6155": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "01dd6fa3791c489fb9e84fe16e657266": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_053c90f8f2644a2297d6cdbce29c0883", "IPY_MODEL_94e3e8541c43471aa2c089f396e2fe42"], "layout": "IPY_MODEL_91b937ff10ee48b49d9cef6266cf6155"}}, "6f4c36108d3242cc823152e343b2d8d4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3af236e638314311a7e4a8e374e63124": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "053c90f8f2644a2297d6cdbce29c0883": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_6f4c36108d3242cc823152e343b2d8d4", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_3af236e638314311a7e4a8e374e63124", "value": 1}}, "a0a6fbf4dadc44eaba50e6684be2da07": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "94e3e8541c43471aa2c089f396e2fe42": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_a0a6fbf4dadc44eaba50e6684be2da07", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "13f3bb50e45b46d287dbc67cb3edfae6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "226aea9691d24b678d3cdb5bc9e4c2d7": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_980eea66c774428c8185fb030d70f8e9", "IPY_MODEL_ed96e7e8e568412490f0dbaf04dcc052"], "layout": "IPY_MODEL_13f3bb50e45b46d287dbc67cb3edfae6"}}, "f8c1aa57f35e41df97f83aadbd7fe360": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "69324747f4a8480cbbc1c012c428560e": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "980eea66c774428c8185fb030d70f8e9": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_f8c1aa57f35e41df97f83aadbd7fe360", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_69324747f4a8480cbbc1c012c428560e", "value": 1}}, "af71b426ea8f45f698f7d61418eb6ea5": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ed96e7e8e568412490f0dbaf04dcc052": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_af71b426ea8f45f698f7d61418eb6ea5", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>