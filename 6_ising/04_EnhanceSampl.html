
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.905 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.36842105,  0.36842105,  0.73684211,  0.89473684,  1.21052632,
         2.73684211,  5.15789474,  8.42105263, 15.57894737, 17.15789474]),
 array([0.715, 0.734, 0.753, 0.772, 0.791, 0.81 , 0.829, 0.848, 0.867,
        0.886, 0.905]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "b1e631bdd84e4cfc88decd02bfd61e6d"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0002441963915595151
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "68bd6f047b1346439e243ffed9b5111b"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f7319fa7190&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "9cdf4a550e1f44a8a676a5bc43938695"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"28d1aba612df4753881ff27053f3cfd2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b1e631bdd84e4cfc88decd02bfd61e6d": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_551467118ab64101928deb464d363989", "IPY_MODEL_320b7dfd3bea41d3968b2e7efcaa465f"], "layout": "IPY_MODEL_28d1aba612df4753881ff27053f3cfd2"}}, "3aec96a6f9e9456399db3795f2536c26": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6964584f9e934eacaff484a6c7144b93": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "551467118ab64101928deb464d363989": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_3aec96a6f9e9456399db3795f2536c26", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_6964584f9e934eacaff484a6c7144b93", "value": 1}}, "9c5e548c776144afbe3ecd6f541837e4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "320b7dfd3bea41d3968b2e7efcaa465f": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_9c5e548c776144afbe3ecd6f541837e4", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "6d9ebdbcf1af4f21a2113b6a6acd9118": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "68bd6f047b1346439e243ffed9b5111b": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_a1162ff7460b432e978c500dde6dee56", "IPY_MODEL_b5e3423f2b964415b71b1eaf6a4c4a99"], "layout": "IPY_MODEL_6d9ebdbcf1af4f21a2113b6a6acd9118"}}, "702c98080dae487b8235064e8a5985a1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "84cd06cbd09d4410a6bcf92e7d734e34": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "a1162ff7460b432e978c500dde6dee56": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_702c98080dae487b8235064e8a5985a1", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_84cd06cbd09d4410a6bcf92e7d734e34", "value": 1}}, "e0a45cb852fe44909217796c2c4e74a6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b5e3423f2b964415b71b1eaf6a4c4a99": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_e0a45cb852fe44909217796c2c4e74a6", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "iVBORw0KGgoAAAANSUhEUgAAAY8AAAETCAYAAADOPorfAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAABHk0lEQVR4nO3dd3hU15n48e9RQxVEkQCJJproxWBcMCBMMY6DseMkdhzHib0JqY6zqU6ym7abbLJx8kviOFkTJ05xi+NeYhtsIxOKMR0EAgQICUkgIVAH1Tm/P650dEcajaZJU/R+noeHc+feufdcaXTfOV1prRFCCCG8ERXsDAghhAg/EjyEEEJ4TYKHEEIIr0nwEEII4TUJHkIIIbwmwUMIIYTXwiZ4KKX+XSl1WCmVp5R6SikVH+w8CSHEQBUWwUMplQl8GViotZ4FRAN3BDdXQggxcIVF8GgXAyQopWKARKAsyPkRQogBKybYGfCE1rpUKfUgUAxcBjZqrTd2PU4ptR5YD0ACC1LSUhgSO4SSSyUd+8lKyiJGub/t6pZqKhorABgcO5hR8aMCeTsB4XA4iIoKp9jvnUi+v0i+N5D7C4aT9Sdp020AZCVnEati3R5f01JDeWM5ANFR0UxInEDxpWIc2kFbWVul1jqtt2uqcJieRCk1FHgOuB2oBv4BPKu1frzH92QozWedX/v8ws/zu5t+1+v1ck/nsvwvywFYmLGQXZ/Z5WvW+0xubi45OTnBzkafieT7i+R7A7m//nbh0gVG/HwEAImxidR9u44o5T64XW65zOSHJlNW56IC5wfs0Vov7O26oRU+e7YSKNRan9datwDPA9d6c4KUuBS+fd23PTp2RtoMkz5y/ggO7fDmUkII0W/yK/NNOnt4dq+BAyAhNoGfrvipX9cNl+BRDFytlEpUSilgBZDv7g0xUTFO6cfWPcbYIWM9ulh6UjojEq1IfqnlEsU1xb7mWwgh+lT++c5H4fS06R6/7645d/Hp+Z92em3t1LUevz9c2jx2KqWeBfYCrcA+YIO794xPHM/dOXdT31zPHbPu4IrRV3h1zRlpM9hStAWwSh8TUif4lHchhOhL9pLH9BGeBw+lFBvWbmDlxJVsO7ONuSPncvfcu4m7M86j94dF8ADQWn8f+L6nx0eraL637Hs+X2/a8GkmeBRcKIApPp9KCCH6jK/BA6wAcvus27l91u1eXzdcqq363eRhk036xMUTQcyJEEL0zF5tNW3EtH67rgSPHjgFjyoJHkKI0NPQ3EBRTRFg1bZMGd5/VSQSPHpg/yVIyUMIEYrsz6aJQycSF+1Ze0UgSPDowcShE026sKqQlraWIOZGCCG6O1V1yqT7s9QBEjx6lBibSGZKJgBtus0UDYUQIlScrDpp0hNTJ7o5MvAkeLghVVdCiFBmL3nYa0v6gwQPNyYP7Ww0L7hQEMScCCFEdxI8QpR01xVChDIJHiHKqdpKuusKIUJIm6ON09WnzXbW0Kx+vb4EDzek5CGECFWldaW0OKxeoOlJ6STHJffr9SV4uDFp6CSTPlV1ilZHaxBzI4QQnYJZZQUSPNxKiktiVLK1EFSro5WS2pIg50gIISz24GH/ottfJHj0wv5LOXnxpJsjhRCi/9ifR1LyCEGThtmCR5UEDyFEaDhVLdVWIc0+atNeTBRCiGCSNg8PKKWylVL7bf9qlVJf6Y9rS8lDCBGKgh08wmIxKK31MWAegFIqGigFXuiPa0ubhxAi1NQ21VJ5qRKAuOg4MlIy+j0PYVHy6GIFcFJr3S8zFdoj+smqk2it++OyQgjRo8KqQpPOSs0iSvX/ozwcg8cdwFP9dbH0pHSSYpMAK9pfvHyxvy4thBAuBbvKCsKk2qqDUioOuBn4dg/71wPrAdLS0sjNzQ3IdUfGjeRUi/XLeuatZ5g+2Lt1gvtCfX19wO4vFEXy/UXyvYHcX3/YdGaTScdfig9KfsIqeAA3Anu11uWudmqtNwAbALKzs3VOTk5ALjqnfA6njlrBY+jEoeTMCsx5/ZGbm0ug7i8URfL9RfK9gdxff3jmtWegvfCxZNYScq7p//yEW7XVx+jHKqsO0mguhAgloVBtFTbBQymVBKwCnu/vazsFD+muK4QIslAIHmFTbaW1bgCGB+Pa9l+ODBQUQgRTsKdi7xA2JY9gkoGCQohQEeyp2DtI8PDA+CHjTT/q0tpSGlsbg5wjIcRAFQpVViDBwyOx0bGMGzIOAI12KjIKIUR/kuARZqTHlRAiFDhNxZ4qwSPkSY8rIUQosD9/7O2x/U2Ch4ekx5UQIhQ4BY8grCDYQYKHh6THlRAiFNirraTkEQakzUMIEWwXL1+kqrEKgISYBEYnjw5aXiR4eMhebVVYXYhDO4KYGyHEQNS11KGUClpeJHh4aEj8EIYnWAPcG1sbOVt3Nsg5EkIMNKHS3gESPLwi7R5CiGByKnlI8Agf0uNKCBFModJNFyR4eEUazYUQwXTi4gmTnjxschBzIsHDKzJQUAgRTNLmEaYCUW216eQmrv3jtcz63Swe3P4gWutAZU8IEaIuXr7IPS/dw9SHpvLhZz5McU2x1+e43HKZsroyAKJVtJlvL1jCZj2PUOBvg/lbp97ixidupE23AfCNTd+grqmOHy7/YcDyKIQILS1tLax5fA27ynYBUHCxgF1lu9j32X0MSxjm8XnsX1jHp44nNjo24Hn1RtiUPJRSqUqpZ5VSR5VS+Uqpa/o7DxkpGQyKHgRA5aVKaptqPX5vY2sj9750rwkcHX6y9ScUXCgIaD6FEKHj/3b/nwkcHYprivnWpm95dZ5jF46Z9NThUwOSN3+ETfAAfg28obWeBswF8vs7A1EqymnVLm+qrv6w5w+cqT0DQEpcCpkpmQC0Olr51Xu/Cmg+hRChoc3Rxi92/MJsz0ibYdJ/OfAXSmtLPT7X0cqjJj1t+LTAZNAPYRE8lFJDgKXAHwG01s1a6+pg5MWXHldaa36/+/dm+7+v/2/+eutfzfYTh56gqbUpcJkUQoSEzac3U1RTBMDwhOHs/sxuFo9dDECLo4Vf7/y1x+dyCh4jgh88wqXNIws4DzymlJoL7AHub1/X3FBKrQfWA6SlpZGbmxvwjAy6NMik39j9BsMrel9WPa8mj/xKq6CUEJ3AlPopqEuKUfGjONd4jpqmGn750i+5ZrjnNXH19fV9cn+hIpLvL5LvDeT+7H59vDM4LBu2jJ3bdnLj4BvZxjYAHnn/EVZHryYmqvdH8a7CzqqvyyWXya33LA99JVyCRwxwBXCf1nqnUurXwAPAf9oP0lpvADYAZGdn65ycnIBn5GjyUZ4vfR6AxpRGPLnG4y8/btIfn/NxblxxIwB3tdzFgzseBOBc4jmPztUhNzfXq+PDTSTfXyTfG8j92d1z4B6Tvn/V/Swdv5SleimPnHmEM7VnqG2tpWVsCyunrHR7Hq01pTs6q7g+tvJjjEwe6VP+AyUsqq2AEqBEa72zfftZrGDS72amzTTpvIq8Xo9vc7Tx0rGXzPY98zs/TCsndn5g3jn9ToByKIQIBYVVhWbJ6qTYJK4ZY9UsRKkobp95uznuqbynej3X2fqz1DXXAZAan0p6UnrgM+ylsAgeWutzwBmlVHb7SyuAI8HIy8z0zuBxtPIobY42N0fD9jPbqbxUCcDo5NFcPeZqs2/xuMWmuJpXkcf5hvN9kGMhRDBsPr3ZpK8bd51T19o7Zt1h0i8efbHXNs/88539g6aNmBbU2XQ7hEXwaHcf8IRS6iAwD/hJMDIxLGEYo5JHAVb32956XNlLHWunriVKdf7Ik+OSuSrzKrOdezo3sJkVQgSNPXhcn3W9074rRl9hOt/UNdfxduHbbs91qOKQSc8YMcPNkf0nbIKH1nq/1nqh1nqO1voWrXVVsPIyK32WSR8+f7jH47TWTsFj3bR13Y5ZPmG5SW8t3hqgHAohgs3+95wzIcdpn1KKW6fdarZfyH/B7bn2n9tv0nNHzQ1I/vwVNsEjlHja7pFfmW8mMkuKTer27QPgqjGdJY+95/YGMJdCiGC5ePmiae+Ii45j3qh53Y65dXpn8Hjp2Etuq8APlB8waVfnCgYJHj6YnT7bpPee7fmB/9LRzlLHmslriI+J73bMFaM72/33nd0nKxQKEQH2nd1n0rPTZxMXHdftmKvHXG2qwM9fOs/2M9tdnqu5rZnDFZ01HHNGzglwbn0jwcMHV2ZeadJdpx2wc6qyyu5eZQVWI/rIJKvLXUNLA8cvHA9QLoUQwbLn7B6Ttn9BtItSUU7PhReOuq66Olp5lBZHCwDjh4wnNT41cBn1gwQPH8xIm0FCTAIAJbUlnKs/1+2YsroydpZaPYujVTQ3Tb3J5bmUUizIWGC23ZVkhBDhwf53vGD0gh6Pc2r3OPqCy1m27aWYUKmyAgkePomJinH6NrGrtHvpw15ltXT8UrezZ14xqvNce8r29HicECI82INHTyUPgOVZyxkyaAgAp6tPO7VtdLBXZ7k7V3+T4OGjKzPcV13Zi6D2bxeuzB8936Tzzvc+8FAIEboutVwyHWWiVBSzR87u8di46DinWonn85/vdsy/iv9l0kvGLQlgTv0jwcNHizIXmbT9lwtQdbnKqY/3LdNucXsue+8te8OYECL8HK08isaqfpo8bLLLjjJ2Xauu7CovVZp58WKjYp16ZwZbuMxtFXLs/ba3Fm+lrqmOlEEpALxW8BqtjlYAFmYsZOyQsW7PNWnYJGKjYmlxtFBaV0pNYw1D4of0Wd6FEAFWXg47d8LhwyTv3cSfCqApBpKmRMO4l+Gqq2Ck67mo1kxew6DoQTS1NZFXkceJiyfM+uT2sSILMhaQGJvYL7fjCSl5+Gh0ymjTeNXqaHUaIWqfq6a3Kiuw2lCyR2Sb7Y5vGkKIEFdVBQ8/DA88AC++COXllMY1UTQEKhNhYlOS9foDD1jHVXUf25wcl8zqSavNtn3A4NunOp8rS8ct7cs78ZoEDz/cOPlGk3694HUAiqqLTBpwmgDNHfsiMUfOB2XaLiGEN/Ly4Dvfgf37Ydw4619qKuVNF0BBaxSkjBxrvT52rHXcd75jva8L+5fMZ448g9a62wwVqyat6oeb8pwEDz+smbzGpJ/Lf46m1ib+sPcPpr5z1cRVTuueu2Nv95DgIUSIy8uDX/wCkpIgMxNsExXaJzg1s99GRVnHJSVZ7+sSQG7OvpnYKGvixN1lu9lStIV3i941q4+mxqeybPyyPr4p70jw8MPisYsZN2QcABcuX+Bn237GQ+8/ZPZ/dsFnPT6XveThbr4sIURwxdTVWVVQw4dDcrLTvlZHKxcbLwKgsFYPdJKcbL2vSxXW8MThfHLuJ832D979AQ9uf9Bs3znrTqdZeUOBBA8/REdF84WFXzDb38/9PrVNtQBkD892ORFiT+zLSsoocyFCV/rbb0Nra7fAAVZPy45xfkPih7h+4CcnQ0sLPPmk08sPXPeAmXU793QurxW8BoBC8fkrPx/YmwgACR5+uu+q+5iQOsHpNYXi4Q887NHSkh3sa6Ofrj5Nc1tzoLIohAiU8nJSjh6FjAyXuy9evmjS3UoddpmZsGuX1Uur3aRhk7j/qvu7HXrv/HudZvIOFRI8/JQYm8irH3vVdK1Lik3i0ZsfZcXEFV6dJyE2gbGDrS69Du2gsKow4HkVQvhp506r/aKHxZjswcPdrBIoZZ3n/fedXv7pyp9yz7zO1UbXZa/joRsf6vrukBA24zyUUqeBOqANaNVaLwxujjrNTJ9J/hfzOV19mlHJo0iO616c9cSU4VNMA1nBxQKn7rtCiBBw+DBtiT2PtfA4eAAMHmw1nK9da16Ki47jT+v+xI+v/zEaTUaK6xJOKAib4NFuuda6MtiZcCUmKsaUPnw1ZdgU3im01jIvuFAQiGwJIQKpqIi2hIQed3sVPJKToajI5a7RKaN9yl5/kmqrEDJl2BSTLrgowUOIkNPYiI7q+bF54fIFk+41eERHQ5P7tctDWTiVPDSwUSmlgUe01hu6HqCUWg+sB0hLSyM3N7d/c+inpsrOD9L7J953m//6+vqwuz9vRPL9RfK9QWTf35SLF2lJSOD06dPd9rXpNmoaawCrm25tRS0NqqHHc6m2NmJqaigI059VOAWP67TWpUqpdGCTUuqo1nqL/YD2gLIBIDs7W+fk5AQhm74bVTmK7x7+LgCVuhJ3+c/NzXW7P9xF8v1F8r1BhN/fjh2U7NnDmAkTuu2qvFSJbq+FGhw/mElZvQwQrq6GGTPIDNOfVdhUW2mtS9v/rwBeABa5f0f4mTh0ounnXVxTTGNrY5BzJIRwMnMm0ZcuudzlVXsHQG0tzAq9LrieCovgoZRKUkqldKSB1UDELXwRFx3H+CHjAdBoTl48GeQcCSGcXHUVOBzWvy6cgkd8L8Gj4xyLwvc7cFgED2AksFUpdQB4H3hNa/1GkPPUJ6YMl0ZzIULWyJHUTZsGZ8922+U0QDDRzQBBgLIyuPLKHqdpDwdhETy01qe01nPb/83UWv842HnqK049rqS7rhAhp2LFCoiJgfp6p9c9rraqr4fYWLjzzr7KYr8Ii+AxkNiDR8dSlkKI0NGakgJf/CJcuOAUQDwKHvX11vu++EUYOrSvs9qnJHiEGPtAwxNVEjyECEmzZsHXvgYNDVBSQltbK9WN1Wb30PgugcHhgJIS6/ivfS2sG8o7hFNX3QHBqc1Dqq2ECF2zZsFPfgJPPkn91rfJrNbUDQKVnExsVIw18259vdWryuGw2jjuvDPsSxwdJHiEmAmpE4hSUTi0gzO1Z7jccpmE2J6nQxBCBNHQofDFL7L7iqG88JsXmFUB17alQHExDBoE48fDihVWr6owbhx3RYJHiOnorltYbc2qW1hd6LRQlBAi9ByJusBr0+C1afDp+Tdx881/CHaW+py0eYQgqboSIrzYO7f4O0FquJDgEYImD7U1mkuPKyFCnr1ziwQPETROPa4keAgR8uw1BBI8RNDIKHMhwkero9W0UYK1nOxAIMEjBEnJQ4jwUVxTTKujFYDRyaN9Xkk03EjwCEFZqVlOs+s2tYbvgjFCRLqB2FgOEjxC0qCYQYwbMg6wZtc9VXUqyDkSQvTE3t4xUKqsQIJHyJKqKyHCg71dcuqwqUHMSf+S4BGiZIJEIcLD8QvHTdre2SXSSfAIUfaShz89ro5fOM4Nj99Axi8yuOPZOzjfcD4Q2RMirO04s4PFf1pM5i8zue+f93GpxfXqgJ5wKnkMHzglj7CankQpFQ3sBkq11h8Mdn76UiCqrSoaKsj5cw5n662Fa/5++O+cqjrFtnu3ERsdG5B8ChFu8s/ns/rx1dQ3W9Op/3bXbympK+H5jz6PUsqrc7W0tVBY1dlNVxrM3VBKrVJK/a9S6j2lVJlSqlkpVaOUKlBK/UMp9XmlVGZfZBa4H8jvo3OHlEBUW33rrW+ZwNFhV9kuHt37qF95EyKcfW3j10zg6PDi0Rd58eiLXp+rsLqQNt0GwJjBY0iMTQxEFsOCR8FDKZWolHpAKVUIvAF8HVgEpAIVQCswEbgNeBgoVEo9p5S6JlAZVUqNAW4CBsSTL2toFgrrW1BRTRHNbc1evb+ouoi/Hvir2b5i9BUm/Ysdv8Chu6/BLESkK7hQwOsnXgdAoZg3ap7Z919b/sun83Wwf+EbCHqttlJK3Qv8FzAaOAr8ENgG7NJa19qOU0A2cDVwA7AOuEUp9SzwDa11sZ95/RXwTSDFTV7XA+sB0tLSyM3N9fOSwZU+KJ3ypnIc2sHTbz7NuMRxZl99fb3b+/vL6b+YADE/dT4/nvRjPlzxYRraGjhZdZKHXnqIualz+/oWfNbb/YWzSL43CO37+8vpv5j0NcOv4ZsTv8lHKz5Ks6OZfef28YdX/sCUFPdBwH5/r5e8bl5PbkoO2fvuC560eTwKvAj8j9Z6V08Haa01VnA5CvxZKTUY+CTwAPAp4Ee+ZlIp9UGgQmu9RymV4yYPG4ANANnZ2Tonp8dDw8Ks4lmUF5YDMGzyMHKm5ph9ubm59HR/Du3gU/s/ZbYfWPkAa2au4a7Ld/HInkcAKE0q5f6c+/sq635zd3/hLpLvDUL3/rTWfC7vc2b7/uX3s27mOj5a/1EeP/g4AAejD/KZnM+4PY/9/p557Rnz+rJZy8i5Nifg+Q5VnlRbLdRaf8hd4HBFa12rtX4ImAQ809vxvVgM3KyUOg08DVyvlHrcz3OGPF8bzbcVb6Oopgiw1lJel70OgA9O7exj0FF0F2KgOHL+CMcuHAMgOS7Z/D3cO+9ec8yTeU+aqUY8MVB7WoEHwUNrvdefC2itG7XWR/08x7e11mO01hOAO4B3tNZ3+XPOcOBr8LAHhtum38agmEEALJ+wnLjoOADyKvI4U3MmQDkVIvS9W/SuSa+etNo0bi+bsIwxg8cAcPHyRbaf2e7xOZ3aPAbQGA/wrbfVT/oiI6I7ewOcN2M93jz5pkmvmbzGpJPiksiZkOPyOCEinT14LBu/zKSjVBQfnNJZKn/52Msena+xtZHimmJzjolDJwYop+HBl0GCDyilfhfwnHhIa50b6WM8OtiLwfnnPeuhXNFQwd6zVmExWkWzImuF03779nsl7wUgl0KEPq01W4q2mO2l45c67b85+2aTfuX4Kx6d81jlMTQasCYz7SjVDxS+BI+/Ap9TSj2plHLZ4K6UWqyU8rzsJ1yaPGwysVHWYL4ztWeobart5R2w6eQmk756zNUMiR/itP+qzKtMemfpzgDlVIjQduLiCc7VnwMgNT6V2emznfYvz1pOUmwSYM3K4Ek18eHzh016ZvrMAOY2PHgdPLTWnwL+H1bbw0tKqfiOfUqpKUqp54EtwFWuzyA8FRsd63XpY+OpjSZ9w6Qbuu1fkLHATPd+uOIwdU11AcipEKHNXspePHYx0VHRTvvjY+K5Put6s/3mid6rdI+cP2LSM9MkeHhEa/014D+AG4GNSqmpSqmHgTzgFmAPsDpQmRzIZqTNMGn7Nx1XtNZsPGkLHpO7B4/kuGRmpc+yjkezu2x3gHIqROjad26fSS/MWOjyGPuXLU/aA+1/j/a/04HC54kRtdY/Ae4DrsOaMuRzwCngI1rrRVrrtwOTxYHN/o3mcIX74HGw/KApmg9LGMaC0QtcHidVV2Kg6WgHBJg/ar7LY+xftt4pfKfXWR3sf49S8vCQstwNfLXjJeAccJ3W+rlAZU4416X2VvKwf1taNXFVt6J5B/s3r/3n9vuXQSFCnEM7nEoe9ql67CYPm2x6TDW0NLCteFuP52xsbeRk1UnA6mk1bcS0AOY4PPjSVfdW4BDwGNaUJT8FvgaMAt5SSqUHNIcDnP0bzaGKQ26PtQcPV+0dHeaMnOPxOYUId4VVhaazyfCE4WZMhyueVl3ln8830/9MHDqRhNiEAOU2fPhS8ngOmIbV62qq1vo7Wuv/B3wCmAFsU0pNCFwWB7Ypw6eQEGN9MMvqyiivL3d5XENzA1uLt5rt1ZN6bnLqaPMAq7uhrJEuIpm91DF/9Hy30657Gjz2nN1j0nNHhu4ccX3Jl+CxCbhCa32P1rqk40Wt9ZPArUAGsFUpNfAqAftATFSM08yf9g+tXe7pXFNHOyt9FpmDe54VPzku2RTP23Qb+ZUDYpZ7MUDZe0X19qC/Put6YqKsEQj7z+03bYhd7Snr/DvsqQE+0vnSVfcGrfXBHvb9E2tG3WTgXVfHCO/ZG7576h3l1MvKTZVVB6eqq3KpuhKR62hl5+xIvbVNpAxKYfHYxWbb/ndlt/ts599hTx1TIl3Al6HVWm8FcoCWQJ97oLJ/s+mp5OFpe0cH+yCpg+UuvwsIERE6JkMEyB6e3evxvVVdNTuaOXDugNlekCHBwyWllNctQVrr/VhdeH0+h+hk/3C6Knmcrj5t/kASYhJYMn5Jr+e0B4/eenEJEa601hy/cNxsZ4/wIHjYuuxuPLmx28JphQ2FtDis78ZZqVkMSxgWoNyGF09KHoVKqfuVUoO8ObHW+qRSaq5S6iWslQeFj6aNmGamTiirK+NU1Smn/faJ3HIm5BAfE09vpqdNN2n7NzMhIklZXZlZcjY1PpW0xLRe3zNv1DxzXOWlSqcxIgCHajqreQdqewd4FjzeBH4JnFVK/V4ptdxdSUIpNbF9HfMdwF5gLrA5MNkdmGKiYpwmcnvr1FtO+1869pJJd6zd0ZvJwyabZW4LqwppbG0MQE6FCC1dq6zc9bTqEKWinHordp2qZE9VZ9WxfUqTgcaT9Tw+ibW07G6sJV7fAmqUUgeUUm8opZ5SSr2glNqilCoHCrDWMc8Cvgtkt7eDCD+smrjKpO3Bo+pyFe+e7uybsDZ7rUfni4+JJ2toFmBNU+LNeiFChItjlbbg4UGVVQf7Ugb2do+Wthb2V+832ysnrvQvg2HMkzaPbwJ1WuvVWOM7fg4cxBrTsRq4HWu98o42jueBO4GxWuufaq1lEEEA2D+kbxe+bephnz3yLG26DYArM64kIyXD43PaGw/tPVKEiBT2kse04Z6PAreXPLad2UZJrTUqYWfpThodVil9QuoEJg2dFKCchh9Pqq1+CnwUQGtdgDWyfBEwBMgGrgXmA5la65Fa649orZ/WWgest5VSKl4p9X57aeewUuqHgTp3uJiVPouRSSMBa7WzgzVWD6kNezeYY+6cfadX57R3W5TgISKR/XPtTckjPSmd5ROWA9b0Jo/tewyAF4++aI5ZkbXCo2qwSOVJ8GgB7Ot2HAG+o7W+pLUu0Fq/p7U+oLU+2zdZBKAJuF5rPReYB6xRSl3dh9cLOUopPjT9Q2b79XOvs6dsj+l9NSh6EJ+Y8wmvzmkPHtJoLiKRt9107dYvWG/Sj+57lIbmBp449IR57bbpt/mfwTDmSfAowypZdFAevi9gtKW+fTO2/Z/uzzyEgk/O/aRJbyzfyMq/dVZl3TbjNoYnDvfqfFJtJSLZ5ZbLFFUXAVYj+ORhk716/63TbmVE4ggAimuKyfxlphlxPjp5NKsmrXL39ojnciXALl4BvqSUeg2rPQOC8OBWSkVjrRMyGXhYa91tLnGl1HqsRn3S0tLIzc3t1zz2hzlD5pgqq+rGagCiiGLloJVe3+/F5osmfaT8CJs3bw6ZYnh9fX1E/v4gsu8NQuf+TtWfMsvEjho0ih1bd3h9jg+N/BAbCq2q4ZqmGvP6Lem3sHXLwO4HpLR2HweUUinAk8BNWEFDYVVl5WN1xd0L7AP2a60b+jS3Vn5SgReA+7TWeT0dl52drY8di7yqmLyKPBb9YRGXWy+b1/5z6X/yo+U/8vpcWmuG/e8wE4RKv1rqVYN7X8rNzSUnJyfY2egTkXxvEDr39+yRZ/nIPz4CwI2Tb+SfH/+n1+doam1i2Z+XOa17MyV5CofuP8SgGK+GvoUNpdQerXWvA1h6LXloreuAtUqpbGAF8FugGpgCzAE+hRVUtFKqACuQ7AX2aq3f8fUG3OSnWim1GViDtXLhgDIrfRa5n8rlvufuQydo7ppzF/ctus+ncymlyB6ebf4wjlYeDZngIYS/nLrpetne0WFQzCBe//jr/Mc7/8G/iv/F1WOu5qb4myI2cHjDk2orALTWx4BjSqnfYo3j+G+s7rpX2P7NxeqBdQdWQHG9GpGXlFJpQEt74EgAVgE/C8S5w9GizEX8bM7PAvLtLntEZ/A4VnlsQA96EpHFqbHci55WXQ1NGMrDNz1stkOhSi4UeBw8bD4MlGmtHVjf/POw1vYAQCk1FViAcyO7v0YDf2lv94gCntFavxrA8w9Y9m9k0uNKRBJvZtMV3vM6eGitn+9l/3HgOPCUr5lycc6DBDYYiXb24GGfQE6IcKa19qubruhdv3a5FaHHXpyXkoeIFOUN5Wbp2ZS4FEYljwpyjiKPBI8BbtLQSWaCxNPVp2VJWhERus5pFSpd0COJBI8BLiE2gfGp4wFrGoaTVSf9PmdLWwsHyw9y4dIFv88lBo6TF09yquoUvQ0f8IRUWfU9CR7CudG80r+qqyPnjzDt4WnM/b+5jP7FaH793q/9zZ6IcI2tjXzo7x9i8kOTmfSbSdzy91u43HK59ze6EYhuusI9CR4iYD2uLrVcYu1Ta81iVS2OFr7y5lfYdHKT33kUketbm77FC0dfMNsvH3uZ+9+4369zBqqbruiZBA/B1OFTTdqfHle/eu9X3VY5BPjGpm8EpCpCRJ5TVad4eNfD3V5/dO+jHCw/6PN5nWbTlZJHn5DgIQLS46q5rZnf7PyN2f5Rzo9IiLEWnDxQfoAtRVv8y6SISL/b9TuzHk3OhBxumnITYC1Q9vtdv/fpnE2tTRRWFwKgUEwZPiUwmRVOJHiIgLR5vF7wOuUN5QBkpmTywHUPOM0C/PjBx/3LpIg4bY42pynOv3HtN/jm4m+a7SfznuRSyyWvz3uy6qRZLG3ckHEkxib6n1nRjQQPQebgTFNKuHD5gk+9pJ7Nf9ak7557N7HRsXxibuf6Iq8WvCpVV8LJ3rN7zRTn6UnprJ60miXjljBlmFVSqG2q5bkjz3l9Xl+XnhXekeAhiFJRfrV7NLU28fKxl832R2ZYM5lelXkVwxKGAXCu/hx5FQNuHkvhxsaTG016zeQ1xETFoJTinnn3mNdfOvaS1+eVbrr9Q4KHAPxr93in8B0zmnfi0InMGzUPgOioaKe11+0PCyE2nur8PKye2Llm+Lpp6zqPObmR5rZmr84rwaN/SPAQgH/tHu8Uds68vy57ndNoXvtD4c2Tb/qRQxFJ6prq2H5mu9m2f8mYPmI6E1InWMc117GteJtX55Zqq/4hwUMAXbrrXvSu2iq3KNeku07pbl+qc/uZ7bQ52nzLoIgoO0t30upoBWDOyDmMTB5p9iml+MDkD5jtfxZ4voiT1lq66fYTCR4C8L3kUdtUy96zewGrW+R1465z2j9uyDizwFRDSwP5lfkByK0Id++Xvm/S1465ttv+NZPXmPTm05s9Pm95QzlVjVWANSHimMFj/MilcEeChwCci/cnLp7wuISwtXir6RY5b9Q8UuNTux2zKHORSdsfGmLgsn8O7J+PDkvGLzETdu47t4+axppux7hy5PwRk56RNkMmROxDYRE8lFJjlVKblVJHlFKHlVL+zV0guhk8aLCZtrqprYnimmKP3vfu6XdNetn4ZS6PWZQhwUN00lo7rQnuKnikxqeajhcO7WDbGc/aPezBY3radP8yKtwKi+ABtAJf01rPAK4GvqiUmhHkPEUce7uHpz2u3i3qDB45E3JcHiMlD2FXWldqxnckxyX3uMqf/cuI/UuKO04ljxHyiOhLYRE8tNZntdZ729N1QD6QGdxcRR5v2z3qmurYXbYbsNo7loxf4vK4hRkLTfpg+UEaWxv9zKkIZx2fGYAFoxcQHRXt8rhlE2zBo8iH4JEmwaMv+bKGeVAppSZgLUm708W+9cB6gLS0tIheqL6+vj7g9xdT3flx2HxoM3Mb57o9/v2L75t5ibKSsji4s+eJ7DLiMyhrLKNNt/H4G48zOXmy23P3xf2Fiki+N+j9/l4tetWkR7SO6PFY1dLZXrGrdBevv/06CdEJbq99oOyASdeerCW3rOd8+CrSf3+eCqvgoZRKBp4DvqK1ru26X2u9AdgAkJ2drXNycvo3g/0oNzeXQN9f/fF6fn/KmoyuOra61/NvfLtzkNdNM29ye/zCcwvNKPT4cfHkzHF/7r64v1ARyfcGvd/fo88/atKr568mZ0HPx84+MZtDFYdw4CB6QjQ5k3o+tvJSJdXvVgOQEJPA7WtuJ0oFvnIl0n9/ngqLaisApVQsVuB4Qmv9fLDzE4nmjJxj0gfLD/Y6F1Xu6VyT7qm9o8Ps9Nkmfaj8kE/5E5HBqVF7hPtGbW/aPfLPd3YDn542vU8Ch+gUFj9dZfW3+yOQr7X+ZbDzE6nGDh7LkEFDAKhqrKK0rrTHYxuaG9hVtstsLx2/1O25Z6XPMum88zLH1UDl0A6nQXy9tUvY2z22FLuf1l/aO/pXWAQPYDHwCeB6pdT+9n8f6O1NwjtKqW6lj57sKNlhRgjPTJvJiMQRbs8tJQ8BUFRdxOVWa4nZ9KR0hicOd3v8knGdnTDeL33f7fK0hyo6P1e9lWiE/8IieGitt2qtldZ6jtZ6Xvs/z+csEB6zB48D5w70eJw3VVZgdQOOjYoF4EztGY8HfYnI4m3pYGTySNOVt7mtmfdK3uvx2I6ZDgDmj5rvRy6FJ8IieIj+M3dkZw+rgxU9lzzsXSd7GhxoFxsd69SfX6ZnH5h8GYdh/3z1tCJlq6OV/ef2m+0rRl/hWwaFxyR4CCf2kseesj0uj7nUcslpsF9v7R0dZo/srLqS4DEwHan0vl3C/vnqabzH0cqjpjosMyXTaaJF0TckeAgnc0fNNdVLBRcLXK4quOPMDrPGwrQR0zz+Q52V1tlobq+fFgOHL43a9uCxo2QHTa1N3Y6xV1ktyFjgRw6FpyR4CCfxMfHMH91ZX2yfg6jDplObTPr6Cdd3298Te4+rw+cP+5jD7jYXbuYj//gIdzx7h0x/EgBaax7b9xhrn1rLZ1/5LGdqzgTsvL4EjzGDxzBx6EQAGlsbnUaod7CXkq8YJVVW/UGCh+jm6syrTdpVA6U9eNjX6+iN/WFh75Pvj9eOv8aqv63i2SPP8vfDf2fpY0vZcWZHQM49UP33lv/m3pfv5dXjr7Jh7wau/dO1lNeX+33ektoS6pvrARiWMIz0pHSP32tv93A1RfvWM1tN2j4djug7EjxEN9eMvcakd5Q4P4jPN5xn39l9AESraJZPWO7xeSekTmBQ9CDAWnfh4uWLfuWzvrme9a+uN1OkgDUj8Gde+YwsOuWj/PP5/GjLj5xeK6kt4eubvu73uf2ZLt2+yFjXxaGqLleZz2SUiuq2pozoGxI8RDdXj+kseew4s8NpIsONJzeisUaeXzXmKobED/H4vNFR0U49rvwtffxp358oqyvr9vrh84d59firLt4hevPg9gfN+B27Jw4+wYmLJ/w6tz8z3t44+UYzYvy9kveoaKgw+7YUbTGfyQWjF3j1mRS+k+Ahuhk/ZDyTh1kTFza0NDiN6fjHkX+Y9I2Tb/T63PY1FvxdVXDDng0m/fAHHuZbi79ltv+4749+nXsgqmuq48m8J8321nu2csOkGwDQaP6417+fqT9rbQxPHM61Y681eXm94HWzz/759KYkLPwjwUN0o5Ri7dS1ZvuVY68AUNNYw+snOv9ob595u9fnto/89afkceT8EdPonhCTwN1z7+YzV3zG7N90ahMNzQ0+n38geuX4K6aUOSt9FteOvZYvXPkFs/8fR/7R63xn7vjSTdfug1M+aNJ/P/x3wGqEt38ml2dJ8OgvEjyES07B4/grOLSDF46+YLrozh81nynDp3h9XvtDw/4w8dazR5416Q9M+QDJcclMGjaJmWkzAatXzsaTG3t6u3DB3pZw+8zbUUqxetJqUuJSADhZddJpIJ43tNZOXxZ8CR4fmfkRk37jxBucrj7NwfKDZuGypNgkjwasisCQ4CFcum7cdQyNHwpY04n8s+Cf/Hrnr83+O2bd4dN5A1XyeC7/OZP+yIzOh8q67HUm/dKxl3w+/0CjtebtwrfNdkeVZHxMPDdn32xetwdtb5Q3lFPVWAVASlwKmSner+U2cehEp2q0R3Y/wu93/97sX5u9loRY9+t9iMCR4CFcio2O5Z5595jttU+tNd86E2IS+Lf5/+bTeacMn0K0slaOK6op8qlqqby+3EzaGBsVy01TbzL77A86+8NQuHfk/BGzNOzQ+KFm/XCAD03/kEm/VfiWz+fv4G1PK7vPLvisSf902095ZM8jLveJvifBQ/ToK1d/hcTYxG6v//vV/97rbKg9iYuOM43xgNP03J56p/Adk75m7DUkxyWb7QUZC0iKTQKsLqbFNcU+5XOgeetUZ1C4Put6p6Vhl09YjsJ62O8u2+3TpJaBmi795uybnQJbh8VjF0uVVT+T4CF6NHbIWB668SGn164eczX/sfQ//Dqvvz2u7MGj6wj3mKgYp67G24q3+ZDDgcc+Z9SKrBVO+4YmDDUTDTq0o8fJCd0JVPCIjormr7f8ldT4VPPa8IThPHrzoz6XZoRvJHgIt+6dfy9bPrWFb1z7DX6z5je8c/c7ftcr+9vu8c7pzuCxYuKKbvvtg8S2Fm/ttl90Z5/WZfG4xd322wfp+VIdGMiFmmaPnM3+z+7nB8t+wPeWfo99n93nNH5I9I+wWcNcKfUn4INAhdZ6Vm/Hi8BZMn4JS8Yv6f1AD/nT46q0tpRTVacAq+1lUeaibscsHtv58Nt2JvAlj6bWJp7Oe5ryhnLWZa8je0R2wK9hp7Vm06lNvF/6PovHLg54d9SyujKzamRibKLLh/vyCcv5+fafA74F5ECv8jc+dTzfz/m+3+cRvgub4AH8Gfgt8Ncg50P4yZ+Sh32urUWZi4iLjut2zNVjrkah0GjyKvJobG0kPibe9wzbXG65zMq/rWT7me0AfG/z93jlY694NceXt7711rfMgxvge0u/xw+X/zBg599V2rmc8BWjryAmqvtjwT5lzYHyA1xqueSyPcyV8w3nOX/pPGAFp3FDxvmZYxEKwqbaSmu9BfBvMiQREuxVDCcunjBjRzxhDx72tg27lEEpplG+TbdxuCJwM/j+IPcHJnCANZfWx5//OLVNtQG7ht2mk5ucAgfAj7b8iH8V/Stg17CvRb8oo3tJDiA1PtUE/VZHa49rvbhib9eaPmK6mWZEhLdwKnn0Sim1HlgPkJaWRm5ubnAz1Ifq6+vD+v5GDhpJeVM5bbqNJ954gqykLKf9Pd3fm4ffNOnk6uQefwYZ0RkUUADA0+8+Td3oOr/zXNVc5TTWpcP5S+f56tNf5a7xd3l0Hm9+d/fvvd/16y/ezy/n/tKjc/TmzbzOn2lSTVKPeZsQM4F8rEDwxJYnaBvrevLJrvf3ctnLJj2sbVhYf24h/P/2AiWigofWegOwASA7O1vn5OQEN0N9KDc3l3C+v/ml83njxBsApGSlkDMjx2m/q/trbmumYFuB2f70mk8zKnmUy/Ovjl7Nu+9YPYgahzQG5Gf1v9v+lyaHtRDRFaOv4EtXfol7X74XgE1Vm3jkE484dXHtiae/u/3n9pP/rvWwjouOY/MnN7P0saW06Tb2Ve9jzJwxTt2efVWyp8Sk71pxF1OHT3V5XEFKAa+/ak0FUhFX0eM9dL2/519/3qSXz1pOzhLX7wsX4f63FyhSfhRBYZ9V1dN2j4PlB83cSxNSJ/QYOACnsQD7zu3zLZNd/O3g30z6y4u+zJ2z72R4gjXepbimOOALUf097+8m/eEZH+basdfygSkfcLnfV5WXKs3gwPiYeCYNndTjsU6zLZfs8Hieq0A3lovQIMFDBIV9rIenPa7sizxdM+YaN0c6B48D5QdwaId3GezidPVps+56fEw8t824jUExg7h12q3mmFeOv+LXNbqyn++OmdZ0MPZpYTomB/SHfS35GWkz3JacZqTNMPNcnas/5/EATPuSwzPTZ/qYUxFqwiZ4KKWeAnYA2UqpEqWUb/NjiJDgS4+r90p7byzvMDp5tFmprr653nTv9ZV9CvDlE5abUe0fnNo502sg1xAprCo0swbHx8Sb8Sw3Z99MQow1zuZQxSG/19iwB4/Z6bPdHhsdFe3UNdrVKpNdVTRUmLU3EmMTzXKyIvyFTfDQWn9Maz1aax2rtR6jtZYFG8KYveRx7MIxj1b+86SnVQellFPpw9fZYDu8VvCaSdurjlZMXGFWRzxUcYii6iK/ruPqetdnXW+6xSbHJTsNjLSPtveFPXjY15jvif3n7knwOFRuK3WkzZSeVhFEfpMiKIYlDGNk0kjAmj79dPVpt8dXNFSY0sOg6EEu5zfqat7IzmM6lin1RXNbs9ND2h48kuOSWTahc04l+zQf/rAvcNR10S37lCz+Bg97lVJvJQ9wri7sukRxIM4vwocEDxE09sbT3ua4srd3XDH6CpeDA7uaO2quSeedz3NzpHt7z+7lcutlwJoWvGvVy5JxnaPvAzGXltbaaWT80vFLnfbbR5hvPr3Z5wWatNZelzyuGnOVSe89u9dpiWJX7CWP2SMleEQSCR4iaLxp97B/y+1YjrQ39m+69oeYt+zTcdjnzeoQ6OlQCqsLTQ+owYMGmwWuOswZOYdhCcMAq0Rm783kjZLaEjO4MTU+lYyUjF7fMyJxBFOGWYuAtTha2Ht2r9vjpeQRuSR4iKCxlzwOVhx0e6w9ePTW06pD9ohsM9VGYXUh9c31PuSyS/AY2z14LMpcZNYoOXz+MFWXq3y6Tgd76eWaMdd06wEVpaKcph/3pPrIla4Pdk9npbVPVWIvEXbl0A7T6A9S8og0EjxE0DiNxXDTJtHS1uI0/5L94eVOXHSc04A3X6Yp6VqF5GrG2aS4JKd78fVh3sE+/Ym9VGN3VWZn9ZGv40u8rbLqcO2YzpLf9pLtPR53quoUl1ouAZCelG56v4nIIMFDBM3cUXPNIkP5lfnmQdPVgfIDps1h/JDxHlWvdLBXldgflp46cfEElZcqAWuFvZ6m/raXhryZ98mVvec6q4J66lVm7zIbiODhTZVS15JHT20uTu0dUmUVcSR4iKBJjks2D2OHdpilZbtyGhzoYamjg/0btb2axlN7znYGgkWZi3rsatqxWBI4P/y91epodfo59NSrbEHGAhN48yryfFrO1/7z8KbkMTNtphkseLb+bI+DBe3tIXNGzvE6fyK0SfAQQeX00O2h8dVeNeJpe0cHf0seu8t2m/TCjIU9Hme/D3+6BRdcKDA9mDJTMklLSnN53OBBg81YmTbd5vUULK2OVqdOCt4Ej+ioaKdeV/ZqNrudpTtN+sqMK73Knwh9EjxEUNkfuq6qe7TWTg8nT3tadQhkyWPB6AU9HjcjbYbpPlxUU8SFSxe8vhY4D2bsbSyLP1VXJy+epKnNmuQxMyWToQlDvXq/vd3DVQ8zh3Y45ckebERkkOAhgsr+bd5V4+upqlOmWiQpNom5I+d2O8adrKFZZnS2faoMTzi0wymgLcjoOXjERsc6lXJ8HdHuVfDI8D14+Fpl1cHeZXnz6c3d9h+/cJyaphoA0hLTyErN6naMCG8SPERQXZlxpfnGfrTyKOX15U773zr1lkkvm7CM2OhYr84fpaKcxkl40+PqxMUT1DVb64CkJaYxdvBYt8d7UgXXm/3l+026L0sevjaWd1g8brH5vR05f4SyujKn/TtLOqusrhpzlcfdgEX4kOAhgiohNsGp2+m/ip1XyHu78G2TXpm10qdr+Fp11bXU0dsDcP6o+SbtS6O51tqpvaS34DF75GzzAC+sLvSqqszXbrodEmMTnboRd50mxf57tP9+ReSQ4CGCzj79xpaiLSbd5mhzeiitnOhb8PC10dypsXx0z43lHfxtND9Xf86s9Z0cl9zrDLRx0XFO1Xj29pne+FttBbAiq3OCxk2nNpm01tos9AXWxI4i8kjwEEFnDx4bT2404wbeLXqXC5etb9Ojkkf5/JDzueRx1rP2jg5zRs4xXXmPXzju9Yh2e3uH/Vzu2BvxPR1fcrnlspnKXaF8XqBp1aRVJv3KsVfMWvSFDYWU1pUC1tgYe/WaiBwSPETQXTfuOrM+xrELxzhQfgCAp/OeNsd8ePqHfa43t0+LkVeR59FEgg7tcGq3cNfTqkNCbIIZt6LRXs+n5dRYbpsR2B17h4PdZ3e7ObJTfmW+WRxr8rDJJMQmeJxHuyszrmT8kPEAVDVWsfHkRgB2Xuxs71g1aZWZIkZElrAJHkqpNUqpY0qpE0qpB4KdHxE4ibGJrMteZ7afOvQULY4Wnst/zrz2sdkf8/n8I5NGmuVi65vrKarpfc2NggsFprE8PSmdMYPHeHQtezVSRxD0lDeN5R3sJSJPSx4HznXmy5/Be0opp5UNn8p7CoDc87nmta7TyYvIERbBQykVDTwM3AjMAD6mlJLFkCOI/SH0+KHHefXsq1y8fBGAsYPH9rr4kztKqW6lj950Hd/haanHHjy87a5rf6h7Gjxmps00i1EV1RSZqVTcsY9g93fkt/339o/D/+CZw89wvP44YK27cnP2zX6dX4SusAgewCLghNb6lNa6GXgaWNfLe0QYWT1ptVkcqqyujN+c+I3Z98Urv+j3CnSz0mztHh5UJ9knYnQ3sryrrmune6qhuYHjF6yHbpSK8rh9JzY61mndEk9KH/YZjL0dN9PV3JFzzcDNFkcLtz97u9l3+6zbzdTxIvKES/DIBM7YtkvaXxMRIi46ju8t+16318cMHsMXrvyC3+e3P4w9WRjK3n7gzdQa9gf5ofJDHi2vC1ZDvsZqi5k2YppX7RD29hh7DzFXtNYBq7YCq1T3k+t/0u31uOg4/nPpf/p1bhHaIqolSym1HlgPkJaWRm5ubnAz1Ifq6+sj7v6m6WmsSF/B2xXW2I6k6CS+OfGb7Nnh3yy1AC01LSb93qn33P7s2nQbu0s6H8JNp5vIPdvz8V0NjR1KVUsVDS0NPPnGk4xNdB5c6Op393LZyyY9Wo326nebXJts0m8eepPFDtfTuANcaLpgerAlRidSuL+QIuX/uuufzvo0jxY+CkAUUXx18lcpOVhCCSV+nzvUROLfni/CJXiUAva/wDHtrznRWm8ANgBkZ2frnJycfslcMOTm5hKJ97c8Zzlbirbwxntv8O9r/z1ga0DMb5zPffvvA+DM5TMsXrK4x9HqhysO07jFmpwwIyWDD9/wYa+udWXJlabnUfz4eHJm5jjtd/W7e/rVzp5lN8y5gZzFzvvdGXpuKD8//nMATjefdvu5ePPEm/CelZ6XMY/rlwdmDEYOOXzp3Jc4UH4AVar4xAc+EZDzhqJI/dvzVrhUW+0CpiilspRSccAdwMu9vEeEIaUUyyYs44ZRNwR08aAh8UMYN2QcYNXNF1ws6PHYXWWd7R2+zAbrS48rb+a06mpG2gziY+IBOFN7xu38Xfb8zEkP7DTpc0fN5e65d3craYnIFBbBQ2vdCnwJeBPIB57RWnu/LJwY0JwGC7ppNPd0GvaeeNvjqs3R5tQDyt5u4onY6FjnkeZuGs0D2dNKDGxhETwAtNb/1FpP1VpP0lr/ONj5EeHH01lv/Q0e3va4OnbhmFkpMSMlw6cSl9NIczfTlNjX/ZDgIfwRNsFDCH/ZA4F9oSK75rZmp8DiS/DIHpFtxl6U1Jb0OmGhtyPZXbHn017tZlfbVGsWgIpW0V5XjwlhJ8FDDBj2OZZ2l+122Y12T9kes0jSxKETGZE4wuvrxETFMDO9cxr43kof9uBhn1zRG/Z7235mu8spWHaV7jLdgWelzyIpLsmnawkBEjzEADJ28FhGJY8CoK65jqOVR7sdY59KfMm4JT5fyz43lX1chSuBCB7T06abAXmVlyo5duFYt2OcVvaTadKFnyR4iAFDKeX00HRVdRWo4GFv9HZX8nBoh1M7hK/BI0pFOa3u96+if3U7xn6/siys8JcEDzGg2IPHtmLntbcd2uH0mv1h7C177yd7cOjq5MWT1DbVAtZqhZkpvk+ccN3YzvxuPbPVaZ9DO9hRssNsS8lD+EuChxhQ7GuHvFX4llPbwIFzB6hqrAKsB/nU4VN9vs780fNRWJMp5lXk0dDc4PK4rlVW/izXumR8Z0npncJ3nO7tUPkhM/5jeMJwpqdN9/k6QoAEDzHALMpcxOBBgwEorik2kxECvHL8FZNePWm1Xw/ywYMGmwe0Qzt67D4biPaODgszFpIanwpYvbzs1WUdI97BWmPD34kmhZBPkBhQYqNjnZZFtT9U7cHjg1M/6Pe1nNpXSlx3DX6/rLMR29/gERMV47R+xivHOu9n46nO+1w9cbVf1xECJHiIAWjVxM7lU18teBWwpoHvGBwYExXDmslr/L5Ob43zzW3NTkHlmjHX+H3NtVPXmvTLx60ZfGoaa5wa0O3LxwrhKwkeYsC5acpNJv3Wqbc4W3eWxw8+bl5bMm6Jqf7xh71H046SHd3GXuw9u9eMLM9KzSJzsP+rDKyZvMYs+7q7bDf55/N5Lv85M3Zl7si5Hq+KKIQ7EjzEgDM+dbxpOHdoBw9uf5Dfvv9bs//uuXcH5Dqz0meZ9pWyurJukzFuLe7sEWVv7PbH0IShTqv3/Xz7z/nVe78y23fNuSsg1xFCgocYkO5bdJ9J//K9X3Km1lprLD0pnY/O/GhArhETFUPOhByz/fapt53228eU2LvZ+st+b4/tf4xDFdYkkEmxSdwz756AXUcMbBI8xIB067RbXc5b9YNlPyAxNjFg11mZtdKk3yp8y6QbWxudgom9C7G/cibkODWcd/j6tV9neOLwgF1HDGwSPMSAFB0VzdO3Pc2koZPMa59b8Dk+t/BzAb3OyomdweOdwndoaWsx6YYWa+zH5GGT/RpT4sqfb/mz08SHt02/je8u+W5AryEGtnBZSVCIgJs0bBJHvniEbcXbyEjJIHtEdsCvMW3ENMYOHsuZ2jNUN1bz+onXGcxgXjr6kjlmXfY6v8aUuJKelM6uz+xiV+kuEmITmDtybsCvIQY2KXmIAS0uOo7lWcv7JHCANZ/Wx2d/3Gz/ef+faXY088LRF8xrt0y7pU+uHRMVwzVjr2HeqHkSOETAhXzwUEp9RCl1WCnlUEp5v7iCEEH2qXmfMulXjr/CE8VPcP7SeQDGDB4TkPEdQvS3kA8eQB7wIWBLsDMihC+yR2SbSRZbHa38teivZt8XFn6B6KjoYGVNCJ+FfPDQWudrrbsvTiBEGPmfFf/T7bUxg8fw5au+HITcCOG/iGowV0qtB9a3bzYppfKCmZ8+NgKoDHYm+lAk398IoLKEEpK/mhzsvPSFSP7dQeTfn0cNgCERPJRSbwGjXOz6rtb6JRevu6S13gBsaD/nbq11xLaRyP2Fr0i+N5D7C3dKqd2eHBcSwUNrvbL3o4QQQoSKkG/zEEIIEXpCPngopW5VSpUA1wCvKaXe9PCtG/owW6FA7i98RfK9gdxfuPPo/lTXaaKFEEKI3oR8yUMIIUTokeAhhBDCaxEdPJRS/6WUOqiU2q+U2qiUygh2ngJFKfVzpdTR9vt7QSmVGuw8BVKkTkujlFqjlDqmlDqhlHog2PkJJKXUn5RSFZE6vkopNVYptVkpdaT9s3l/sPMUKEqpeKXU+0qpA+339sNe3xPJbR5KqcFa69r29JeBGVrrwM65HSRKqdXAO1rrVqXUzwC01t8KcrYCRik1HXAAjwBf11p71Pc8lCmlooHjwCqgBNgFfExrfSSoGQsQpdRSoB74q9Z6VrDzE2hKqdHAaK31XqVUCrAHuCUSfn/KmjkzSWtdr5SKBbYC92ut3+vpPRFd8ugIHO2SgIiJlFrrjVrr1vbN94CIWpg6QqelWQSc0Fqf0lo3A08D64Kcp4DRWm8BLgY7H31Fa31Wa723PV0H5AP+LzwfArSlvn0ztv2f2+dlRAcPAKXUj5VSZ4CPA98Ldn76yL3A68HOhOhVJnDGtl1ChDx8Bhql1ARgPrAzyFkJGKVUtFJqP1ABbNJau723sA8eSqm3lFJ5Lv6tA9Baf1drPRZ4AvhScHPrnd7urf2Y7wKtWPcXVjy5PyFCjVIqGXgO+EqX2o2wprVu01rPw6rFWKSUclv1GBLTk/jDi6lNngD+CXy/D7MTUL3dm1LqU8AHgRU6DBuvBuC0NKXAWNv2mPbXRJhobw94DnhCa/18sPPTF7TW1UqpzcAarCUxXAr7koc7Sqkpts11wNFg5SXQlFJrgG8CN2utLwU7P8Iju4ApSqkspVQccAfwcpDzJDzU3qj8RyBfa/3LYOcnkJRSaR09NpVSCVidOtw+LyO9t9VzWNMLO4Ai4HNa64j4pqeUOgEMAi60v/RepPQkA2taGuAhIA2oBvZrrW8IaqYCQCn1AeBXQDTwJ631j4Obo8BRSj0F5GBNWV4OfF9r/cegZiqAlFLXAf8CDmE9UwC+o7X+Z/ByFRhKqTnAX7A+l1HAM1rrH7l9TyQHDyGEEH0joquthBBC9A0JHkIIIbwmwUMIIYTXJHgIIYTwmgQPIYQQXpPgIYQQwmsSPIQQQnhNgocQQgivSfAQQgjhNQkeQvSx9lUstVLqti6vK6XUn9v3/TRY+RPCFzI9iRB9TCk1F9gLHANma63b2l//BfBVYIPW+rNBzKIQXpOShxB9TGt9APgbMB34BIBS6jtYgeMZ4PPBy50QvpGShxD9QCk1Fmv98nPAL7BmDH4Ta0r95mDmTQhfSPAQop8opf4HeKB9czuwStZiEeFKqq2E6D/nbel/k8AhwpkEDyH6gVLqTuBBrGorgPuDmB0h/CbBQ4g+1r564J+x1oOeg9Xr6tNKqexg5ksIf0jwEKIPtS9d+ixQAtygtT4P/AcQA/wsmHkTwh/SYC5EH1FKzQNygcvAdVrrk7Z9u4CFwFKt9b+CkkEh/CAlDyH6gFJqMvAGoLFKHCe7HPLt9v9/3q8ZEyJApOQhhBDCa1LyEEII4TUJHkIIIbwmwUMIIYTXJHgIIYTwmgQPIYQQXpPgIYQQwmsSPIQQQnhNgocQQgivSfAQQgjhtf8P+7WCK1yZfwEAAAAASUVORK5CYII=\n"}}]}}, "e26e7177c2984dfba5313c64a7685d12": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "9cdf4a550e1f44a8a676a5bc43938695": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_f2d36bc637cb41ce850c561e148f4cba", "IPY_MODEL_4e7b10664b2442c4b5cbb9a6284234ed"], "layout": "IPY_MODEL_e26e7177c2984dfba5313c64a7685d12"}}, "11660fd761724d258ca05ab523e2e31f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f56294fd1144404f98fcac3e593b8204": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "f2d36bc637cb41ce850c561e148f4cba": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_11660fd761724d258ca05ab523e2e31f", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_f56294fd1144404f98fcac3e593b8204", "value": 1}}, "c03e9fcdd0b04beabbf2291659f21a2b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4e7b10664b2442c4b5cbb9a6284234ed": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_c03e9fcdd0b04beabbf2291659f21a2b", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>