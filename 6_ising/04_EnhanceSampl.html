
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Preface
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Why Python?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B2: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.905 0.81
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.26315789,  0.47368421,  0.89473684,  0.94736842,  1.31578947,
         3.05263158,  5.63157895,  8.63157895, 14.47368421, 16.94736842]),
 array([0.715, 0.734, 0.753, 0.772, 0.791, 0.81 , 0.829, 0.848, 0.867,
        0.886, 0.905]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "0a5078a7a7a14d5fb09a9da58e64eb46"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.00020904739405852113
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "aa40511cff004a1ab7a79b1ff3ee2df0"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f1058e084d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "f0e4d7f50f664022b79ef5af06483dcc"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"1566c32c91e94c179663e2453c0a4ee1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0a5078a7a7a14d5fb09a9da58e64eb46": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_7e924e96715245d0b9bcd839090a6a1e", "IPY_MODEL_b65fe6138af64bdf9b1a0fecbefbaa04"], "layout": "IPY_MODEL_1566c32c91e94c179663e2453c0a4ee1"}}, "720177ba1d00433194f34aa854f1bfef": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "42210f14ed744b919181c415db0cbe93": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "7e924e96715245d0b9bcd839090a6a1e": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_720177ba1d00433194f34aa854f1bfef", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_42210f14ed744b919181c415db0cbe93", "value": 1}}, "8bba41e606ff42f6a928de6f9693dc76": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b65fe6138af64bdf9b1a0fecbefbaa04": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_8bba41e606ff42f6a928de6f9693dc76", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "385dd9c34497413e88e1172df17aab4b": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "aa40511cff004a1ab7a79b1ff3ee2df0": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_245c9c82992d4a3e8357f84256314b63", "IPY_MODEL_a7fefa7b1d1244889af209c9457a1586"], "layout": "IPY_MODEL_385dd9c34497413e88e1172df17aab4b"}}, "bf585c192198420b9c30f7ba8d6dcf6e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "686abf15d29a4f4a98546440b5b6fd8b": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "245c9c82992d4a3e8357f84256314b63": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_bf585c192198420b9c30f7ba8d6dcf6e", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_686abf15d29a4f4a98546440b5b6fd8b", "value": 1}}, "81442fa6b9eb4358819acfe1936b24c9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "a7fefa7b1d1244889af209c9457a1586": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_81442fa6b9eb4358819acfe1936b24c9", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "b7d426a5af604fc49b88a73ba5565150": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f0e4d7f50f664022b79ef5af06483dcc": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_cfd97950b1f74b9fa03ddc4499ffaf57", "IPY_MODEL_839b132800db439382c1a69bcac276d4"], "layout": "IPY_MODEL_b7d426a5af604fc49b88a73ba5565150"}}, "032f6473cb0146a98123a7aae9244684": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fa90c61fa2d74674a9f41666da4ac382": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "cfd97950b1f74b9fa03ddc4499ffaf57": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_032f6473cb0146a98123a7aae9244684", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_fa90c61fa2d74674a9f41666da4ac382", "value": 1}}, "e8433ca3eb01418d9975832782a1b4b4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "839b132800db439382c1a69bcac276d4": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_e8433ca3eb01418d9975832782a1b4b4", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Davit Potoyan<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>