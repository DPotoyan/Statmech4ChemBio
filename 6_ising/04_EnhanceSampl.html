
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids and introduction to Molecular Dynamics" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix A: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix B: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/applications.html">
     Applications
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/classical_systems.html">
     Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids and introduction to Molecular Dynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.94 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.25641026,  0.61538462,  0.66666667,  1.17948718,  1.94871795,
         3.38461538,  4.97435897,  9.33333333, 14.41025641, 14.51282051]),
 array([0.745 , 0.7645, 0.784 , 0.8035, 0.823 , 0.8425, 0.862 , 0.8815,
        0.901 , 0.9205, 0.94  ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "1f59227e1cdf41499188debf7e12203e"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  0.000551422007119502
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "788dffb09e2c4c1594e2d78240e1a9c8"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f53ec63a8d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "09ecabdcdd9441b8a049429525f0ebbc"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"62506d56516848e3909eeae611b7df24": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1f59227e1cdf41499188debf7e12203e": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_1c5b679a69aa466693abed72b0102160", "IPY_MODEL_138a4cfb889d44e6965a40128fd86dd2"], "layout": "IPY_MODEL_62506d56516848e3909eeae611b7df24"}}, "1c0f7bb2a72d40e1ba07296fe4671f25": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6634fc25b49e43608ded6f44fc9410f2": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "1c5b679a69aa466693abed72b0102160": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_1c0f7bb2a72d40e1ba07296fe4671f25", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_6634fc25b49e43608ded6f44fc9410f2", "value": 1}}, "d300251557c147ba98e05078d84f13da": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "138a4cfb889d44e6965a40128fd86dd2": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_d300251557c147ba98e05078d84f13da", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "f53c807a8200491891fac4363bf37ad7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "788dffb09e2c4c1594e2d78240e1a9c8": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_d8337bf48d2d49668c397ed590eb317b", "IPY_MODEL_d90b5ecf626c4b82b6593e96c09a6f96"], "layout": "IPY_MODEL_f53c807a8200491891fac4363bf37ad7"}}, "a6c3b864e5aa4679a0eaed0cf07f313f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "10eaab9ee2d0485db4c7f64ce1a21701": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "d8337bf48d2d49668c397ed590eb317b": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_a6c3b864e5aa4679a0eaed0cf07f313f", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_10eaab9ee2d0485db4c7f64ce1a21701", "value": 1}}, "07f77dfa5e8044959d46d1a06a6eaa0e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d90b5ecf626c4b82b6593e96c09a6f96": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_07f77dfa5e8044959d46d1a06a6eaa0e", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "19dc8abfe4404800a430a4ba7b074e3f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "09ecabdcdd9441b8a049429525f0ebbc": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_2b134ad518894acc81506199f556fc7b", "IPY_MODEL_093516dfbd3f43a2b582c460618011ef"], "layout": "IPY_MODEL_19dc8abfe4404800a430a4ba7b074e3f"}}, "a186b74c4d92475287ec39e6be62a3e4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "86cfc3b7a5244dffafd6888dca9a600d": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "2b134ad518894acc81506199f556fc7b": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_a186b74c4d92475287ec39e6be62a3e4", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_86cfc3b7a5244dffafd6888dca9a600d", "value": 1}}, "0cd736918ea8436bafd93e2f4259ed45": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "093516dfbd3f43a2b582c460618011ef": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_0cd736918ea8436bafd93e2f4259ed45", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids and introduction to Molecular Dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>