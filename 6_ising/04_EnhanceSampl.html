
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/02_Legendre.html">
     Legendre transform
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/ensemble_overview.html">
     Overview of ensembles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Gases
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/photons_phonons.html">
     Photons and Phonons
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/landauer.html">
     Information erasure and Landauer’s principle
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-in-a-nutshell">
     Simulated annealing in a nutshell
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#challanges">
       Challanges
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-in-a-nutshell">
     Simulated annealing in a nutshell
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#challanges">
       Challanges
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d_umbrella</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span> 
                <span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                <span class="n">U_k</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">U_m</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="n">n_steps</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> 
                <span class="n">out_freq</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                <span class="n">wall</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Metropolis Monte Carlo simulator of 2D Ising model with harmonic potentials for umbrella sampling</span>
<span class="sd">    ---</span>
<span class="sd">    spins:    (int, int), 2D numpy array</span>
<span class="sd">    T, J, B:  (floats), corresponding to temperature, coupling and field variables</span>
<span class="sd">    n_steps:  (int), simulation steeps</span>
<span class="sd">    out_freq: (int), How often to compute and save data</span>
<span class="sd">    U_k, U_m: (floats), spring constant and minima defining harmonic potential U_k*(M-U_m)**2</span>
<span class="sd">    wall: can alos resrict sampling by imposing walls with infinitely high energies</span>
<span class="sd">    ---</span>
<span class="sd">    Returns:</span>
<span class="sd">    E/N: per-spin energy over n steps  </span>
<span class="sd">    M/N: per-spin magnetization over n steps </span>
<span class="sd">    S:   2D spin configurations over n steps </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="c1">#### Initialize simulation</span>
    <span class="n">N</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    <span class="n">n</span>   <span class="o">=</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span>
    
    <span class="n">M_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    <span class="n">E_t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> 
            <span class="n">z</span>    <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i,(j+1)%N] + spins[i,(j-1)%N]
            <span class="n">E_t</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="n">z</span>

    <span class="c1">#### Run MC Simulation</span>
    <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
        
        <span class="c1"># Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Neighbours of spin i,j</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 

        <span class="c1">#Change in Energy of the lattice</span>
        <span class="n">dE</span>    <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="n">U_k</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">M_t</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="n">U_m</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">M_t</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="n">U_m</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>

        <span class="c1"># Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">():</span>
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            <span class="n">E_t</span>        <span class="o">+=</span> <span class="n">dE</span> 
            <span class="n">M_t</span>        <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>

        <span class="c1"># Save Thermo data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
            <span class="n">E</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
            <span class="n">S</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_US</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;N steps&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$E$&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;N steps&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$m$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;$\langle m \rangle=$</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">1000</span><span class="p">:])</span><span class="si">:</span><span class="s1">.02f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$P(m)$&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Vary umbrella potential from 0 to 1000. Study how Tc affects the U_k and U_m </span>

<span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d_umbrella</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span> 
                <span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                <span class="n">U_k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">U_m</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> 
                <span class="n">n_steps</span><span class="o">=</span><span class="mi">2000000</span><span class="p">,</span> 
                <span class="n">out_freq</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plot_US</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">E</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_13_0.png" src="../_images/04_EnhanceSampl_13_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Is a widely used Monte Carlo technique used for <strong>numerical optimization</strong> In chemical and biological applications simulated annealing is used for finding global minima of a complex multidimensional energy functions&gt;</p>
<p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p>
<div class="section" id="simulated-annealing-in-a-nutshell">
<h3>Simulated annealing in a nutshell<a class="headerlink" href="#simulated-annealing-in-a-nutshell" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Sample with metropolis algorithm where the acceptance probability takes the form <span class="math notranslate nohighlight">\(min (1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For finding maximum simply change the sign: <span class="math notranslate nohighlight">\(min (1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
<li><p><strong>“Slow cooling” is the main idea of simulated annealing</strong></p></li>
</ul>
</div>
<div class="section" id="id2">
<h3><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_19_0.png" src="../_images/04_EnhanceSampl_19_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.0007687799119882599
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_23_1.png" src="../_images/04_EnhanceSampl_23_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "71f3fa511f1e4315a56a4db521398fad"}
</script></div>
</div>
</div>
<div class="section" id="challanges">
<h4>Challanges<a class="headerlink" href="#challanges" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.</p></li>
</ul>
</li>
<li><p><strong>Parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.</p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+PT ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>    
    
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="c1">#T[i], T[j] = T[j], T[i]</span>
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">T</span><span class="p">]</span>
    
    <span class="c1"># Exchange attemps</span>
    <span class="k">for</span> <span class="n">swap_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> 
    
        <span class="n">configs</span>  <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    
        <span class="c1">#mcmc in between exchange attemp</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)):</span> 
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>        <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c1"># magnetic field</span>

<span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span>   <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span>  <span class="o">=</span> <span class="mi">10000</span>
<span class="n">out_freq</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">E2</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="n">E3</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fd49cca7d50&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_33_1.png" src="../_images/04_EnhanceSampl_33_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "8eb2c9b019b74df0bcafa7a91b2cdc2a"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhance the sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancement of sampling with respect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"e2d2c1276f5242af9eb66c71c0d3cfe8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "71f3fa511f1e4315a56a4db521398fad": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_2226ed9070c945339542bad937267b2a", "IPY_MODEL_6e361e30a1cb48d5a9a1c9b4c365f835"], "layout": "IPY_MODEL_e2d2c1276f5242af9eb66c71c0d3cfe8"}}, "1c0c9cd97422432ab2b1411605769369": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fc5d77482c6d43f8ba559fa1bfe3bba2": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "2226ed9070c945339542bad937267b2a": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_1c0c9cd97422432ab2b1411605769369", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_fc5d77482c6d43f8ba559fa1bfe3bba2", "value": 1}}, "dccba89dbf7b4f1bbbd76a5b3dd4aae8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6e361e30a1cb48d5a9a1c9b4c365f835": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_dccba89dbf7b4f1bbbd76a5b3dd4aae8", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "05f6d2580e6c42a4a6c706fc7f4a8522": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8eb2c9b019b74df0bcafa7a91b2cdc2a": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_231af7b1813145c4a95eb17a02f5df6c", "IPY_MODEL_0767271c69864e4bb4034bc02a3c4c29"], "layout": "IPY_MODEL_05f6d2580e6c42a4a6c706fc7f4a8522"}}, "b930895f0c0849fc85cfe933735e2c99": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "20817eeba9b24197a9be5350ed9d8599": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "231af7b1813145c4a95eb17a02f5df6c": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_b930895f0c0849fc85cfe933735e2c99", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_20817eeba9b24197a9be5350ed9d8599", "value": 1}}, "a61689e9612c484d97ee372e2c0c9b27": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0767271c69864e4bb4034bc02a3c4c29": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_a61689e9612c484d97ee372e2c0c9b27", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>