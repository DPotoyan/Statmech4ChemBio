
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fluids" href="../7_fluids/intro.html" />
    <link rel="prev" title="Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/02_Legendre.html">
     Legendre transform
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_ensembles/intro.html">
   Ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/nvt.html">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_ensembles/ensemble_overview.html">
     Overview of ensembles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Gases
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/photons_phonons.html">
     Photons and Phonons
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/landauer.html">
     Information erasure and Landauer’s principle
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Phase transitions
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC.html">
     Ising models and Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/md_lj.html">
     Molecular Dynamics simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/6_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/6_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-in-a-nutshell">
     Simulated annealing in a nutshell
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#challanges">
       Challanges
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Non-boltzman (enhanced) sampling ideas</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-in-a-nutshell">
     Simulated annealing in a nutshell
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#challanges">
       Challanges
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="non-boltzman-enhanced-sampling-ideas">
<h1>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d_umbrella</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span> 
                <span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                <span class="n">U_k</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">U_m</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="n">n_steps</span><span class="o">=</span><span class="mi">20000</span><span class="p">,</span> 
                <span class="n">out_freq</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                <span class="n">wall</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Metropolis Monte Carlo simulator of 2D Ising model with harmonic potentials for umbrella sampling</span>
<span class="sd">    ---</span>
<span class="sd">    spins:    (int, int), 2D numpy array</span>
<span class="sd">    T, J, B:  (floats), corresponding to temperature, coupling and field variables</span>
<span class="sd">    n_steps:  (int), simulation steeps</span>
<span class="sd">    out_freq: (int), How often to compute and save data</span>
<span class="sd">    U_k, U_m: (floats), spring constant and minima defining harmonic potential U_k*(M-U_m)**2</span>
<span class="sd">    wall: can alos resrict sampling by imposing walls with infinitely high energies</span>
<span class="sd">    ---</span>
<span class="sd">    Returns:</span>
<span class="sd">    E/N: per-spin energy over n steps  </span>
<span class="sd">    M/N: per-spin magnetization over n steps </span>
<span class="sd">    S:   2D spin configurations over n steps </span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="c1">#### Initialize simulation</span>
    <span class="n">N</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    <span class="n">n</span>   <span class="o">=</span> <span class="n">N</span><span class="o">**</span><span class="mi">2</span>
    
    <span class="n">M_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    <span class="n">E_t</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span> 
            <span class="n">z</span>    <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i,(j+1)%N] + spins[i,(j-1)%N]
            <span class="n">E_t</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="n">z</span>

    <span class="c1">#### Run MC Simulation</span>
    <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
        
        <span class="c1"># Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Neighbours of spin i,j</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 

        <span class="c1">#Change in Energy of the lattice</span>
        <span class="n">dE</span>    <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="n">U_k</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">M_t</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="n">U_m</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="p">(</span> <span class="n">M_t</span><span class="o">/</span><span class="n">n</span> <span class="o">-</span> <span class="n">U_m</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>

        <span class="c1"># Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">():</span>
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            <span class="n">E_t</span>        <span class="o">+=</span> <span class="n">dE</span> 
            <span class="n">M_t</span>        <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>

        <span class="c1"># Save Thermo data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">M</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
            <span class="n">E</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="o">/</span><span class="n">n</span><span class="p">)</span>
            <span class="n">S</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_US</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>  <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;N steps&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$E$&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;N steps&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$m$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;$\langle m \rangle=$</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">1000</span><span class="p">:])</span><span class="si">:</span><span class="s1">.02f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$P(m)$&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Vary umbrella potential from 0 to 1000. Study how Tc affects the U_k and U_m </span>

<span class="n">S</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d_umbrella</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)),</span> 
                <span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                <span class="n">U_k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">U_m</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> 
                <span class="n">n_steps</span><span class="o">=</span><span class="mi">2000000</span><span class="p">,</span> 
                <span class="n">out_freq</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plot_US</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">E</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_13_0.png" src="../_images/04_EnhanceSampl_13_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Is a widely used Monte Carlo technique used for <strong>numerical optimization</strong> In chemical and biological applications simulated annealing is used for finding global minima of a complex multidimensional energy functions&gt;</p>
<p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p>
<div class="section" id="simulated-annealing-in-a-nutshell">
<h3>Simulated annealing in a nutshell<a class="headerlink" href="#simulated-annealing-in-a-nutshell" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Sample with metropolis algorithm where the acceptance probability takes the form <span class="math notranslate nohighlight">\(min (1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For finding maximum simply change the sign: <span class="math notranslate nohighlight">\(min (1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
<li><p><strong>“Slow cooling” is the main idea of simulated annealing</strong></p></li>
</ul>
</div>
<div class="section" id="id2">
<h3><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_19_0.png" src="../_images/04_EnhanceSampl_19_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  7.383882612363771e-05
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_23_1.png" src="../_images/04_EnhanceSampl_23_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "05f3b8d3b3d8404eb4c42391f47ad57e"}
</script></div>
</div>
</div>
<div class="section" id="challanges">
<h4>Challanges<a class="headerlink" href="#challanges" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.</p></li>
</ul>
</li>
<li><p><strong>Parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.</p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+PT ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>    
    
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="c1">#T[i], T[j] = T[j], T[i]</span>
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">T</span><span class="p">]</span>
    
    <span class="c1"># Exchange attemps</span>
    <span class="k">for</span> <span class="n">swap_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> 
    
        <span class="n">configs</span>  <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    
        <span class="c1">#mcmc in between exchange attemp</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)):</span> 
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>        <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c1"># magnetic field</span>

<span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span>   <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span>  <span class="o">=</span> <span class="mi">10000</span>
<span class="n">out_freq</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">E2</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="n">E3</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f1fa147c7d0&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_33_1.png" src="../_images/04_EnhanceSampl_33_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "d0cf8fd00966443783693ec79b3e2381"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhance the sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancement of sampling with respect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"f13fab3bd64540088099602b02e3e84f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "05f3b8d3b3d8404eb4c42391f47ad57e": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_fbea82aa79eb47c0b34130373a4ff628", "IPY_MODEL_150ca479d8e94cbeb26ab084790557dd"], "layout": "IPY_MODEL_f13fab3bd64540088099602b02e3e84f"}}, "b639cc46e75a481185625bd39d8cb6bd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b8385047b7d04e278bf7b4e7985a82e8": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "fbea82aa79eb47c0b34130373a4ff628": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_b639cc46e75a481185625bd39d8cb6bd", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_b8385047b7d04e278bf7b4e7985a82e8", "value": 1}}, "81b4ac40b3214653adf727a7a00a2a83": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "150ca479d8e94cbeb26ab084790557dd": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_81b4ac40b3214653adf727a7a00a2a83", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "0a6a0db72bde494d8884379faced8e8f": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d0cf8fd00966443783693ec79b3e2381": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_4c855b8ed28d4bc197bf28d72a0f2f6c", "IPY_MODEL_02e799dca0ad4fc0bfecbf047df56016"], "layout": "IPY_MODEL_0a6a0db72bde494d8884379faced8e8f"}}, "daf4ca057cad48bc8136fbae9a219170": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "deef29b971a0437a9734711c55198ae6": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "4c855b8ed28d4bc197bf28d72a0f2f6c": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_daf4ca057cad48bc8136fbae9a219170", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_deef29b971a0437a9734711c55198ae6", "value": 1}}, "65762f77a8864491b721130f0e7aaae7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "02e799dca0ad4fc0bfecbf047df56016": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_65762f77a8864491b721130f0e7aaae7", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./6_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Mean Field Theory</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../7_fluids/intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fluids</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>