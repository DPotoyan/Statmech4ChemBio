
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1. NVE &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Statistical ensembles" href="../03_ensembles.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../00_python.html">
   A. Python refresher
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../00_python/intro2py.html">
     1. Why Python?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_python/intro2numpy.html">
     2. NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_python/intro2viz.html">
     3. Plotting with Matplotlib
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../01_stats.html">
   B. Probability and randomness
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../01_stats/01_SetsCounting.html">
     1. Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_stats/02_RandVar.html">
     2. Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_stats/04_MC.html">
     3. “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_stats/05_InverseTransform.html">
     4. The Inverse Transform of RVs
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../02_thermo.html">
   Thermodynamics refresher
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../02_thermo/01_Thermo.html">
     1. Review of the main principles of thermodynamics.
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="../03_ensembles.html">
   Statistical ensembles
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     1. NVE
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/03_ensembles/01_NVE.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/03_ensembles/01_NVE.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/03_ensembles/01_NVE.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#core-ideas-of-statistical-mechanics-counting-states-boltzman-s-equation-and-ensembles">
   1.1. Core ideas of statistical mechanics: counting states, Boltzman’s equation and ensembles.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lessons-from-thermodynamics">
     1.1.1. Lessons from thermodynamics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#micro-vs-macrostates-in-qm">
     1.1.2. Micro vs macrostates in QM
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#spins">
       1.1.2.1. Spins
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#harmonic-oscilaltors">
       1.1.2.2. Harmonic oscilaltors
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#particles-in-a-box">
       1.1.2.3. Particles in a box
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#micro-vs-macrostates-in-cm">
     1.1.3. Micro vs macrostates in CM.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#density-of-states">
     1.1.4. Density of States
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#watch-out-for-n-the-indistingushability-of-particles">
     1.1.5. Watch out for N! The indistingushability of particles
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#microcanonical-ensemble-and-equal-a-priori-probabilities-postulate">
     1.1.6. Microcanonical Ensemble and “equal a priori probabilities” postulate.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nve-example-1-a-three-spin-state">
     1.1.7. NVE Example-1: A three spin state
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nve-example-2-monoatomic-ideal-gas">
     1.1.8. NVE Example-2: Monoatomic ideal gas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#volume-of-an-energy-sphere-in-n-dimesnional-phase-space">
     1.1.9. Volume of an energy sphere in N dimesnional phase space
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#density-of-states-of-an-ideal-gas">
     1.1.10. Density of states of an ideal gas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#thermal-mechanical-and-chemical-equilibrium-in-nve">
     1.1.11. Thermal, Mechanical and chemical equilibrium in NVE
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#equations-of-state-for-ideal-gas">
     1.1.12. Equations of state for ideal gas
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#phase-space-liuville-s-theorem-and-ergoicity-ideas">
   1.2. Phase Space, Liuville’s Theorem and Ergoicity ideas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#continuity-equation-and-liuville-s-theorem">
     1.2.1. Continuity equation and Liuville’s theorem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#liuville-theorem-illustrated">
     1.2.2. Liuville theorem illustrated
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hamiltonian-conservative-dynamics-in-phase-space">
     1.2.3. Hamiltonian, conservative dynamics in phase space
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="nve">
<h1><span class="section-number">1. </span>NVE<a class="headerlink" href="#nve" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;

<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">widgets</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sci</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="core-ideas-of-statistical-mechanics-counting-states-boltzman-s-equation-and-ensembles">
<h2><span class="section-number">1.1. </span>Core ideas of statistical mechanics: counting states, Boltzman’s equation and ensembles.<a class="headerlink" href="#core-ideas-of-statistical-mechanics-counting-states-boltzman-s-equation-and-ensembles" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Equilibirum statistical physics reconciles macroscopic properties of matter in equilibirum states <strong>(Thermodynamics)</strong> with the microspic dynamics of consitutent atoms/molecules <strong>(Probabilistic descirption of mechanics).</strong></p>
</div></blockquote>
<blockquote>
<div><p>Equilibrium statistical mechanics shows the molecular basis of thermodynamics but is not a replacement for Thermodynamics! Thermodynamics is after all an exact phenomoneological theory agnostic to molecular reality. Equilibrium statistical mechanics, instead provides microspic basis and computational tools which lack in tthermodynamics for calculating substance specific quantities e.g heat capcities, free energies for various polymers, solutions, crystals, gases, etc.</p>
</div></blockquote>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\boxed{S = k_B log \Omega}\)</span> Wherer <span class="math notranslate nohighlight">\(S\)</span> is entropy, <span class="math notranslate nohighlight">\(k_B\)</span> a constant (Boltzmann’s) and <span class="math notranslate nohighlight">\(\Omega\)</span> number of micro-states consistent with a macrostate of the system is the fundmental bridge between thermodynamics and microscopic dynamics.</p>
</div></blockquote>
<div class="section" id="lessons-from-thermodynamics">
<h3><span class="section-number">1.1.1. </span>Lessons from thermodynamics<a class="headerlink" href="#lessons-from-thermodynamics" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Isolated systems eventually come to a terminal state of <strong>equilibrium.</strong>  System stays in equilibrium “forver” untill pertrubed from the outside.</p></li>
<li><p>A few macrosocpic variables are sufficient for describing equilibirum, e.g (E,N,V,)</p></li>
</ul>
</div>
<div class="section" id="micro-vs-macrostates-in-qm">
<h3><span class="section-number">1.1.2. </span>Micro vs macrostates in QM<a class="headerlink" href="#micro-vs-macrostates-in-qm" title="Permalink to this headline">¶</a></h3>
<div class="section" id="spins">
<h4><span class="section-number">1.1.2.1. </span>Spins<a class="headerlink" href="#spins" title="Permalink to this headline">¶</a></h4>
<ol class="simple">
<li><p>Consider a spin-1 particle with spin <span class="math notranslate nohighlight">\(|\uparrow \rangle\)</span> and <span class="math notranslate nohighlight">\(|\downarrow\rangle\)</span>, hence this is a two state system. <br>For an electron we have the magnetic moment <span class="math notranslate nohighlight">\(\mu = eh/2mc\)</span>, energy <span class="math notranslate nohighlight">\(E = −2\mu\)</span> Hmz and spin <span class="math notranslate nohighlight">\(m_z = \pm 1/2\)</span>. H is the external magnetic field.</p></li>
<li><p>Now consider N non-interacting spin-1 particles. Now the system has <span class="math notranslate nohighlight">\(2N\)</span> possible states. The 2 energy of the system is then given as <span class="math notranslate nohighlight">\(E = \sum^N_i  E_i\)</span></p></li>
</ol>
<blockquote>
<div><p>The question boils down to partitioning N_1 up and N_2 down indistinguishable spin states. <span class="math notranslate nohighlight">\(N_1+N_2=N\)</span> and <span class="math notranslate nohighlight">\(E = -\mu H N_1 -\mu H N_2\)</span></p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[\boxed{\Omega (E,N)=\frac{N!}{N_1! N_2!} = \frac{N!}{\Big[\frac{1}{2}(N-E/H\mu)\Big]! \Big[\frac{1}{2}(N+E/H\mu)\Big]!}}\]</div>
<p>compare this expression to solution of proble for partitioning gas molecules intwo let and right container. For ranomg walk after N states. Notice any patterns :)</p>
</div>
<div class="section" id="harmonic-oscilaltors">
<h4><span class="section-number">1.1.2.2. </span>Harmonic oscilaltors<a class="headerlink" href="#harmonic-oscilaltors" title="Permalink to this headline">¶</a></h4>
<ol class="simple">
<li><p>1D harmonic oscillator <span class="math notranslate nohighlight">\(E_n = \hbar \omega (n+1/2)\)</span> with <span class="math notranslate nohighlight">\(n = 0, 1, 2, ...\)</span> This system has infinitely many but still countable number of states.</p></li>
<li><p>Now consider  N harmonic oscillators. This can describe N atoms in a crystal, each vibrating around its mechanical equilibrium state independet of each other(“Einstein model”). Although these are infinitely many states in this system they can be counted easily.</p></li>
</ol>
<blockquote>
<div><p>The question boils down to finding how many states correspond to <span class="math notranslate nohighlight">\(n_1+n_2+...n_N = M\)</span>. In other words what is the degeneracy of the state correspodning to the total quantum number M?</p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[E(n_1,n_2,...n_N) = \sum^N_{i=1} \hbar \omega \Big(n_i+\frac{1}{2}\Big) = \sum^N_{i=1} n_i +\frac{N}{2}\hbar \omega
\]</div>
<p>The question is answered by partitioning M quanta of energy among N oscillators.  This is slightly different from previous example. The partitioning is analogus to putting M ideantical balls into N identical boxes.</p>
<div class="math notranslate nohighlight">
\[\boxed{\Omega(E,N) = \frac{(N+M-1)!}{M!(N-1)!} = \frac{(E/\hbar\omega+N/2-1)!}{(E/\hbar\omega-N/2)!(N-1)!}}\]</div>
</div>
<div class="section" id="particles-in-a-box">
<h4><span class="section-number">1.1.2.3. </span>Particles in a box<a class="headerlink" href="#particles-in-a-box" title="Permalink to this headline">¶</a></h4>
<ol class="simple">
<li><p>A 1 particle in a box. <span class="math notranslate nohighlight">\(E_n = \frac{\hbar^2 \pi^2}{2mL^2}(n^2_x+n^2_y+n^2_z)\)</span>.</p></li>
<li><p>Now consider N particles in a box. How many states can system have?</p></li>
</ol>
<blockquote>
<div><p>The question boils down to determining degeneracy of states with total quanta <span class="math notranslate nohighlight">\(n_1+n_2+...+n_{3N}\)</span></p>
</div></blockquote>
</div>
</div>
<div class="section" id="micro-vs-macrostates-in-cm">
<h3><span class="section-number">1.1.3. </span>Micro vs macrostates in CM.<a class="headerlink" href="#micro-vs-macrostates-in-cm" title="Permalink to this headline">¶</a></h3>
<p>In Quantum mechanics count the number of states is natural and easy due to discrete aspect of description.
<br>
The question now is how to deal with the classical systems which adopt continuus description. We clarify this issue using the 1D harmonic oscillator.</p>
<div class="math notranslate nohighlight">
\[E=(N+1/2)\hbar\omega\]</div>
<ul class="simple">
<li><p>For a single harmonic oscillator in  the number of states correpsonding to E is obtained simply as:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[N_E \approx \frac{E}{\hbar \omega} \]</div>
<div class="math notranslate nohighlight">
\[H(p,q) = \frac{p^2}{2m}+ \frac{m\omega^2 q^2}{2} = E\]</div>
<ul class="simple">
<li><p>In CM, not having discrete count of states we are forced to somehow quantify the “volume” of states occupied by the harmonic oscillator at E as a measure of number of states</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\Big[\frac{p}{(2mE)^{1/2}}\Big]^2 + \Big[\frac{q}{(2E/m\omega)^{1/2}}\Big]^2 = 1\]</div>
<br>
<div class="math notranslate nohighlight">
\[V = \pi  \cdot (2mE)^{1/2} \cdot (2E/m\omega)^{1/2} =\frac{2\pi E}{\omega}\]</div>
<p>We see that we are missing a factor of h! Otherwise expression is identical to QM expression. Hence we divide the number of states in CM by h.</p>
<div class="math notranslate nohighlight">
\[N_E = \frac{V}{h}\]</div>
<p>Writing more generally for 3N degrees of freedom</p>
<div class="math notranslate nohighlight">
\[\boxed{N_E = \frac{1}{h^{3N}}\int_{H(p^N,q^N)\leq E} dp^N dq^N}\]</div>
</div>
<div class="section" id="density-of-states">
<h3><span class="section-number">1.1.4. </span>Density of States<a class="headerlink" href="#density-of-states" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\Omega(E) =\frac{d N(E)}{d E}\]</div>
<p>We will show that for macroscopic system it is convenient to work with denisty of states because number of states in outer thin shell <span class="math notranslate nohighlight">\(\Delta E\)</span> is an excellent approximation to total number of states</p>
<div class="math notranslate nohighlight">
\[N(E)\sim \Omega(E)\Delta E\]</div>
<div class="math notranslate nohighlight">
\[\boxed{N_E = \frac{1}{h^{3N}}\int dp^N dq^N \theta(H(p^N,q^N) -E)} \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\Omega(E) = \frac{1}{h^{3N}}\int dp^N dq^N \delta(H(p^N,q^N) -E)}\]</div>
<br>
<blockquote>
<div><p>Where <span class="math notranslate nohighlight">\(\theta(x-a)\)</span> is a step function (Heviside function) derivative of which gives rise to delta function <span class="math notranslate nohighlight">\(\delta(x) =\frac{d}{dx}\theta(x-a)\)</span></p>
</div></blockquote>
</div>
<div class="section" id="watch-out-for-n-the-indistingushability-of-particles">
<h3><span class="section-number">1.1.5. </span>Watch out for N! The indistingushability of particles<a class="headerlink" href="#watch-out-for-n-the-indistingushability-of-particles" title="Permalink to this headline">¶</a></h3>
<p>Since we are using classical mechanics where all particles can be distingushed and labeled, we need to correct for this artifact if we want to study large N collection of identical atoms and molecules:</p>
<div class="math notranslate nohighlight">
\[\boxed{\Omega(E) = \frac{1}{N! h^{3N}}\int_{p^N,q^N} dp^N dq^N \delta(H(p,q) -E)}\]</div>
</div>
<div class="section" id="microcanonical-ensemble-and-equal-a-priori-probabilities-postulate">
<h3><span class="section-number">1.1.6. </span>Microcanonical Ensemble and “equal a priori probabilities” postulate.<a class="headerlink" href="#microcanonical-ensemble-and-equal-a-priori-probabilities-postulate" title="Permalink to this headline">¶</a></h3>
<p>Each state from the NVE=const ensemble is sampled with equal probabilities:</p>
<div class="math notranslate nohighlight">
\[\boxed{P(E) = \frac{1}{\Omega(E)}=const}\]</div>
</div>
<div class="section" id="nve-example-1-a-three-spin-state">
<h3><span class="section-number">1.1.7. </span>NVE Example-1: A three spin state<a class="headerlink" href="#nve-example-1-a-three-spin-state" title="Permalink to this headline">¶</a></h3>
<p>3 spin state can adopt many different states with different energies.</p>
<p>If we know the total energy is <span class="math notranslate nohighlight">\(E = -\mu H\)</span> Then we have microcanonican ensemble with three states</p>
<div class="math notranslate nohighlight">
\[N(E) = \{++-, +-+, -++, \}\]</div>
<div class="math notranslate nohighlight">
\[P(E) = \frac{1}{N(E)} = \frac{1}{3}\]</div>
</div>
<div class="section" id="nve-example-2-monoatomic-ideal-gas">
<h3><span class="section-number">1.1.8. </span>NVE Example-2: Monoatomic ideal gas<a class="headerlink" href="#nve-example-2-monoatomic-ideal-gas" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[H(p,q) =\frac{p^2}{2m} = E\]</div>
<div class="math notranslate nohighlight">
\[{\Omega(E) = \frac{1}{N! h^{3N}}\int_{p^N,q^N} dp^N dq^N \delta(H(p,q) -E) =\frac{V^N}{N! h^{3N}} \int dp^N \delta(p^2/2m -E)}\]</div>
<div class="math notranslate nohighlight">
\[ \Omega(E) = \frac{V^N}{N! h^{3N}} V(R, \delta R)\]</div>
<p>Where <span class="math notranslate nohighlight">\(V(R,\delta R)\)</span> is a volume of a spherical shell with radius <span class="math notranslate nohighlight">\(R = (2mE)^{1/2}\)</span> and thicness <span class="math notranslate nohighlight">\(\delta R = 1/2 (2m/E)^{1/2} \delta E\)</span></p>
</div>
<div class="section" id="volume-of-an-energy-sphere-in-n-dimesnional-phase-space">
<h3><span class="section-number">1.1.9. </span>Volume of an energy sphere in N dimesnional phase space<a class="headerlink" href="#volume-of-an-energy-sphere-in-n-dimesnional-phase-space" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[V(R) = \frac{\pi^{D/2}}{(D/2)!} R^D\]</div>
<p>For <span class="math notranslate nohighlight">\(D\rightarrow \infty\)</span> we discover that most of the volume of the sphere is concentrated at its surface!
<br></p>
<div class="math notranslate nohighlight">
\[V(R, \delta R) = V(R) -V(R-\delta R) = C [R^D - (R-\delta R)^D] = CR^D [1-(1- (\delta R/R)^D)] \rightarrow CR^D\]</div>
<p>Hence</p>
<div class="math notranslate nohighlight">
\[\boxed{V(R,\delta R)= V(R)} \]</div>
</div>
<div class="section" id="density-of-states-of-an-ideal-gas">
<h3><span class="section-number">1.1.10. </span>Density of states of an ideal gas<a class="headerlink" href="#density-of-states-of-an-ideal-gas" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\boxed{\Omega(E) = \frac{V^N}{h^{3N} N!} \cdot \frac{(2m\pi E)^{3N/2}}{(3N/2)!}}\]</div>
<br>
<div class="math notranslate nohighlight">
\[ S = log \Omega(E) = k_B N \cdot  \Big [ log \Big(\frac{V}{N \lambda^3}\Big) + \frac{5}{2}\Big]\]</div>
<ul class="simple">
<li><p>Note linear dependence on N. Entropy is an extensive quantity!</p></li>
<li><p>exponent 3/2 reflexts that each particle has 3 degrees of freedom</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda = \Big(\frac{3h^2 N}{4\pi m E}\Big)^{1/2}\)</span> thermal de Broglie wavelength.</p></li>
<li><p>This result know as “Sackur Tetrode equation” was known long before statistical mechanics.</p></li>
</ul>
</div>
<div class="section" id="thermal-mechanical-and-chemical-equilibrium-in-nve">
<h3><span class="section-number">1.1.11. </span>Thermal, Mechanical and chemical equilibrium in NVE<a class="headerlink" href="#thermal-mechanical-and-chemical-equilibrium-in-nve" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\Omega = \Omega_1 \Omega_2\]</div>
<div class="math notranslate nohighlight">
\[log \Omega(E) = log \Omega_1(E_1) + log \Omega_2(E-E_1)\]</div>
</div>
<div class="section" id="equations-of-state-for-ideal-gas">
<h3><span class="section-number">1.1.12. </span>Equations of state for ideal gas<a class="headerlink" href="#equations-of-state-for-ideal-gas" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\frac{1}{T} = \frac{\partial S}{\partial E} = \frac{3}{2}k_B \frac{N}{E}\]</div>
<br>
<div class="math notranslate nohighlight">
\[\frac{p}{T} =  \frac{\partial S}{\partial V} = k_B N \frac{1}{V}\]</div>
<br>
<div class="math notranslate nohighlight">
\[\frac{\mu}{T} = -\frac{\partial S}{\partial N} = k_B T \cdot log \frac{N}{V} \lambda^3\]</div>
</div>
</div>
<div class="section" id="phase-space-liuville-s-theorem-and-ergoicity-ideas">
<h2><span class="section-number">1.2. </span>Phase Space, Liuville’s Theorem and Ergoicity ideas<a class="headerlink" href="#phase-space-liuville-s-theorem-and-ergoicity-ideas" title="Permalink to this headline">¶</a></h2>
<p>Conservative systems are govenred by Hamilton’s equation of motion. That is changes in position and momenta stay on the surface: <span class="math notranslate nohighlight">\(H(p,q)=E\)</span></p>
<div class="math notranslate nohighlight">
\[\dot{q} = \frac{\partial H}{\partial p}\]</div>
<div class="math notranslate nohighlight">
\[\dot{p} = -\frac{\partial H}{\partial q}\]</div>
<p>To see how ensemble N body mechanical conervative system evoleves we are introducing probability distribution of classical trajecotires in phase space</p>
<div class="math notranslate nohighlight">
\[\rho(p,q,t)dq dp \]</div>
<div class="section" id="continuity-equation-and-liuville-s-theorem">
<h3><span class="section-number">1.2.1. </span>Continuity equation and Liuville’s theorem<a class="headerlink" href="#continuity-equation-and-liuville-s-theorem" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\frac{\partial \rho(p,q,t)}{\partial t} = -\nabla J = - \nabla(\rho \vec{v})\]</div>
<p>Where flux <span class="math notranslate nohighlight">\(J= \rho \vec{v}\)</span> is defined in terms of the velcotiy of points in phase space <span class="math notranslate nohighlight">\(v = (\dot{q},\dot{p})\)</span>. Combinging the continuity expression combined with Hamilton’s equation of motion:</p>
<div class="math notranslate nohighlight">
\[\dot{p_i} = -\partial_{q_i} H \,\,\,\,\ \dot{q_i} = \partial_{p_i} H\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial \rho(p,q,t)}{\partial t} + \sum_i \Big [ \frac{\partial \rho}{\partial q_i}\dot{q_i}+\frac{\partial \rho}{\partial p_i} \dot{p_i} \Big] + \rho \sum_i \Big [ \frac{\partial \dot{q_i}}{\partial q_i}+  \frac{\partial \dot{p_i}}{\partial p_i}  \Big]=0\]</div>
<p>Where the last term is zero one we plug Hamilton’s equation. We thus arrive at a crucial conclusion that the space volume is preserved during conservative dynamics</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \rho(p,q,t)}{\partial t} + \sum_i \Big [ \frac{\partial \rho}{\partial q_i}\dot{q_i}+\frac{\partial \rho}{\partial p_i} \dot{p_i} \Big]=\frac{d \rho}{ dt} = 0\]</div>
<p>Furthermore we see that the time dependence of phase space probability density vanishes if it is a function of hamiltonian <span class="math notranslate nohighlight">\(\rho = f(H)\)</span></p>
<div class="math notranslate nohighlight">
\[\frac{\partial \rho}{\partial t} = \sum_i \Big [ \frac{\partial \rho}{\partial q_i}\cdot{q_i}+\frac{\partial \rho}{\partial p_i}\cdot{p_i} \Big] = -\{H,\rho \}\]</div>
</div>
<div class="section" id="liuville-theorem-illustrated">
<h3><span class="section-number">1.2.2. </span>Liuville theorem illustrated<a class="headerlink" href="#liuville-theorem-illustrated" title="Permalink to this headline">¶</a></h3>
<p>According to Liuvile’s theorem small phase space area element under time evolution gets deform but preserves the volume. For example, assume the initial distribution is a rectangle in phase space (x , v)</p>
<div class="math notranslate nohighlight">
\[{x 0 − d x ≤ x ≤ x 0 + d x}\]</div>
<div class="math notranslate nohighlight">
\[ {v 0 − d v ≤ v ≤ v 0 + d v } \]</div>
<p>As time progresses this rectangle will deform, but its area will not change (assuming <span class="math notranslate nohighlight">\(d x\)</span>  and <span class="math notranslate nohighlight">\(d v\)</span>  are sufficiently small which ensure energy conservation)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Polygon</span> <span class="c1"># for making rectangles from four points</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span>             <span class="c1"># acceleration</span>
<span class="n">x0</span><span class="p">,</span> <span class="n">v0</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>    <span class="c1"># center of initial phase space element</span>
<span class="n">dx</span><span class="p">,</span> <span class="n">dv</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span>  <span class="c1"># (half of) width of initial phase space element</span>

<span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(((</span><span class="n">x0</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span><span class="n">v0</span><span class="o">-</span><span class="n">dv</span><span class="p">),(</span><span class="n">x0</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span><span class="n">v0</span><span class="o">+</span><span class="n">dv</span><span class="p">),(</span><span class="n">x0</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">v0</span><span class="o">+</span><span class="n">dv</span><span class="p">),(</span><span class="n">x0</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">v0</span><span class="o">-</span><span class="n">dv</span><span class="p">)))</span>     <span class="c1"># initial phase space element</span>

<span class="k">def</span> <span class="nf">propagate</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;Propagates a phase space patch p0 for time t.&quot;&quot;&quot;</span>
    
    <span class="n">x0</span><span class="p">,</span> <span class="n">v0</span> <span class="o">=</span> <span class="n">p0</span><span class="o">.</span><span class="n">T</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">v0</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">t</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>


<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    
    <span class="n">p</span> <span class="o">=</span> <span class="n">propagate</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>  

    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">Polygon</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;t=</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Position x&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Velocity v&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">5.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.5, 3.5)
</pre></div>
</div>
<img alt="../_images/01_NVE_36_1.png" src="../_images/01_NVE_36_1.png" />
</div>
</div>
</div>
<div class="section" id="hamiltonian-conservative-dynamics-in-phase-space">
<h3><span class="section-number">1.2.3. </span>Hamiltonian, conservative dynamics in phase space<a class="headerlink" href="#hamiltonian-conservative-dynamics-in-phase-space" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[H(p,q) = \frac{p^2}{2}+\frac{q^2}{2}\]</div>
<div class="math notranslate nohighlight">
\[\dot{q} = \frac{\partial H}{\partial p} = p\]</div>
<div class="math notranslate nohighlight">
\[\dot{p} = -\frac{\partial H}{\partial q} = -q\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># range of x and y grid</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># make a grid of x and y values, Y = dot X</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>

<span class="n">H</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Y</span><span class="o">*</span><span class="n">Y</span> <span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">X</span><span class="o">*</span><span class="n">X</span>   <span class="c1">#here is the Hamiltonian</span>

<span class="c1">#cs = plt.contour(X,Y,H,20,cmap=&#39;inferno&#39;)</span>
<span class="c1">#plt.clabel(cs,inline=1,fontsize=10)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;dq/dt&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">1.1</span><span class="o">*</span><span class="n">xmax</span><span class="p">,</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="o">*</span><span class="n">ymax</span><span class="p">,</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">ymax</span><span class="p">])</span>

<span class="c1"># Hamilton&#39;s equations define a vector field U,V</span>
<span class="n">U</span> <span class="o">=</span>   <span class="n">Y</span>
<span class="n">V</span> <span class="o">=</span> <span class="o">-</span> <span class="n">X</span>

<span class="n">Q</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/01_NVE_39_0.png" src="../_images/01_NVE_39_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># range of x and y grid</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">2.0</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># make a grid of x and y values, Y = dot X</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>

<span class="n">epsilon</span><span class="o">=</span><span class="mf">0.3</span>

<span class="n">H</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Y</span><span class="o">*</span><span class="n">Y</span>  <span class="o">-</span> <span class="n">epsilon</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>    <span class="c1">#here is the Hamiltonian</span>

<span class="c1"># Hamilton&#39;s equations define a vector field U,V</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">Y</span>
<span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="n">epsilon</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1">#cs =plt.contour(X,Y,H,10,cmap=&#39;inferno&#39;)</span>
<span class="c1">#plt.clabel(cs,inline=1,fontsize=10)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;dx/dt&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="n">xmax</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="n">ymax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>



<span class="n">Q</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># plot the vector field </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/01_NVE_40_0.png" src="../_images/01_NVE_40_0.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./03_ensembles"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../03_ensembles.html" title="previous page">Statistical ensembles</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Davit Potoyan<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>