
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NVE &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../00_python.html">
   A. Python refresher
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../00_python/intro2py.html">
     1. Why Python?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_python/intro2numpy.html">
     2. NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_python/intro2viz.html">
     3. Plotting
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../01_stats.html">
   B. Probability and randomness
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../01_stats/01_SetsCounting.html">
     1. Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_stats/02_RandVar.html">
     2. Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_stats/03_MC.html">
     3. “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_stats/04_LimitTheorems.html">
     4. Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_stats/05_InverseTransform.html">
     5. Appendix B2: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../02_thermo.html">
   C. Thermodynamics refresher
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../02_thermo/01_Thermo.html">
     1. Review of thermodynamics principles
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../03_ensembles.html">
   D. Statistical ensembles
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="02_NVT.html">
     1. NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_NPT.html">
     2. NPT
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../04_entropy.html">
   E. Entropy and Information
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../04_entropy/01_InformationEnt.html">
     1. What is Information?
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../05_ising.html">
   F. Phase transitions and Ising models
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../05_ising/01_MCMC_Ising.html">
     1. Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_ising/02_ising_analytic.html">
     2. Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_ising/02_ising_analytic.html#a-bit-of-history-ising-model-and-phase-transitions">
     3. A. bit of history: Ising model and phase transitions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_ising/02_ising_analytic.html#homework-7">
     4. Homework-7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_ising/03_EnhanceSampl.html">
     5. Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/03_ensembles/01_NVE (potoyan-mbp2017.chem.iastate.edu's conflicted copy 2021-03-19).ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/03_ensembles/01_NVE (potoyan-mbp2017.chem.iastate.edu's conflicted copy 2021-03-19).ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/03_ensembles/01_NVE (potoyan-mbp2017.chem.iastate.edu's conflicted copy 2021-03-19).ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-the-relationship-between-statmech-and-thermo">
   What is the relationship between StatMech and Thermo?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#boltzmann-s-equation-a-bridge-from-probabilistic-microscopic-world-to-the-thermodynamic-world-of-macro-meso-systems">
     Boltzmann’s equation: “A bridge from probabilistic microscopic world to the thermodynamic world of macro(meso) systems”
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lessons-we-learned-from-thermodynamics-that-can-now-be-understood-in-new-light">
     Lessons we learned from thermodynamics that can now be understood in new light
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-quantify-the-micro-states-omega-for-an-isolated-system">
   How to quantify the micro states
   <span class="math notranslate nohighlight">
    \(\Omega\)
   </span>
   for an isolated system?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#microstates-in-qm">
     Microstates in QM
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#a-collection-of-up-down-spins">
       A collection of up/down spins
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-collection-of-harmonic-oscilaltors">
     A collection of harmonic oscilaltors
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-collection-of-particles-in-a-box">
     A collection of particles in a box
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#microstates-in-quasi-classical-mechanics">
     Microstates in (Quasi)Classical Mechanics.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#density-of-states-is-more-convenient-to-use-than-number-of-states">
     Density of States is more convenient to use than number of states
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#watch-out-for-n-the-indistingushability-of-the-particles-has-consequences-for-thermodynamics">
     Watch out for N! The indistingushability of the particles has consequences for thermodynamics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#microcanonical-ensemble-and-equal-a-priori-probabilities-postulate">
     Microcanonical Ensemble and “equal a priori probabilities” postulate.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#examples-of-using-nve-ensemble-to-derive-fundmental-equation">
   Examples of using NVE ensemble to derive fundmental equation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1-a-three-spin-state">
     Example-1: A three spin state
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2-monoatomic-ideal-gas">
     Example-2: Monoatomic ideal gas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classical-density-of-states-of-an-ideal-gas">
     Classical density of states of an ideal gas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quantum-density-of-states-of-an-ideal-gas">
     Quantum density of states of an ideal gas
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#thermal-mechanical-and-chemical-equilibrium">
   Thermal, Mechanical and chemical equilibrium
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#equations-of-state-for-ideal-gas">
     Equations of state for ideal gas
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#phase-space-liuville-s-theorem-and-ergoicity-ideas">
   Phase Space, Liuville’s Theorem and Ergoicity ideas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#continuity-equation-and-liuville-s-theorem">
     Continuity equation and Liuville’s theorem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#liuville-theorem-illustrated">
     Liuville theorem illustrated
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hamiltonian-conservative-dynamics-in-phase-space">
     Hamiltonian, conservative dynamics in phase space
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     Problems
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#problem-1">
       Problem-1
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#problem-2-2d-spin-lattice">
         Problem-2: 2D Spin lattice
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-3-shottky-defects-in-nve-computing-number-of-states-via-lattice-models">
     Problem-3: Shottky defects in NVE: Computing number of states via lattice models
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#problem-4-lattice-gas">
       Problem-4: Lattice gas
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#problem-5-entropic-origin-of-polymer-elasticity">
       Problem-5: Entropic origin of polymer elasticity
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="nve">
<h1>NVE<a class="headerlink" href="#nve" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-is-the-relationship-between-statmech-and-thermo">
<h2>What is the relationship between StatMech and Thermo?<a class="headerlink" href="#what-is-the-relationship-between-statmech-and-thermo" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Equilibirum statistical physics reconciles macroscopic properties of matter in equilibirum states <strong>(Thermodynamics)</strong> with the microspic dynamics of consitutent atoms/molecules <strong>(Probabilistic descirption of mechanics).</strong></p></li>
<li><p>Equilibrium statistical mechanics shows the molecular basis of thermodynamics giving us tools to calculate substance specific thermodynamic quantities from the first principles, such as heat capcities, free energy differences. These quanties serve as an input for thermodynamics becasue thermodynamics makes no refernce of microscopic world.</p></li>
</ul>
<blockquote>
<div><p>When learning statistical mechanics It is important to not have any illlusion about the role and value of thermodynamics and certainly not think that statistical mechanics is replacing thermodynamics! After all statistical mechanics is constructed for making a link between probabilistic world of micrrosopic particles and the deterministic world of thermodynamics. Within its domain of applicability (large systems, so called thermodynamic limit) Thermodynamics rules as an undipsuted theory agnostic to molecular realities which has never been defeated by any experiment to date. Statistical mechanical predictions obey the rules of thermodynamics and often thermodynamic arguments (second law, linear scaling of extensive quantities, Gibbs-duhem) is used to validate statistical mechanics claims.</p>
</div></blockquote>
<div class="section" id="boltzmann-s-equation-a-bridge-from-probabilistic-microscopic-world-to-the-thermodynamic-world-of-macro-meso-systems">
<h3>Boltzmann’s equation: “A bridge from probabilistic microscopic world to the thermodynamic world of macro(meso) systems”<a class="headerlink" href="#boltzmann-s-equation-a-bridge-from-probabilistic-microscopic-world-to-the-thermodynamic-world-of-macro-meso-systems" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\boxed{S = k_B log \Omega}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S\)</span> is the entropy of an isolated system (for now, as we are in the NVE). Yes it is the very same entropy that appears in thermdoynamic relations (Carno engines, irreversibility and all that)!</p></li>
<li><p><span class="math notranslate nohighlight">\(k_B\)</span> a constant (Boltzmann’s)</p></li>
<li><p><span class="math notranslate nohighlight">\(\Omega\)</span> quantifies number of micro-states <strong>consistent with a macrostate of our system</strong>. For instance number of states that in their totallity still have macroparameters <span class="math notranslate nohighlight">\(N, V, E\)</span></p></li>
</ul>
</div>
<div class="section" id="lessons-we-learned-from-thermodynamics-that-can-now-be-understood-in-new-light">
<h3>Lessons we learned from thermodynamics that can now be understood in new light<a class="headerlink" href="#lessons-we-learned-from-thermodynamics-that-can-now-be-understood-in-new-light" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Isolated systems eventually come to a terminal state of <strong>equilibrium.</strong>  System stays in equilibrium “forver” untill pertrubed from the outside.</p></li>
</ol>
<ul class="simple">
<li><p>A few macrosocpic variables are sufficient for describing equilibirum, e.g <span class="math notranslate nohighlight">\((E,N,V)\)</span></p></li>
<li><p>An extensive thermodynamic variable called entropy <span class="math notranslate nohighlight">\(S(E, N, V)\)</span> exists which is a globally concave funcion and predicts thermodynamic equilibrium as a state with vanishing entropy variation <span class="math notranslate nohighlight">\(\delta S=0\)</span></p></li>
<li><p>Thermodynamic space is structured into adiabats corresponding to <span class="math notranslate nohighlight">\(S=const\)</span> planes that do not intersect. Leaving the adiabatic plane is posisble only through heat exchange (cooling or heating)!</p></li>
</ul>
</div>
</div>
<div class="section" id="how-to-quantify-the-micro-states-omega-for-an-isolated-system">
<h2>How to quantify the micro states <span class="math notranslate nohighlight">\(\Omega\)</span>  for an isolated system?<a class="headerlink" href="#how-to-quantify-the-micro-states-omega-for-an-isolated-system" title="Permalink to this headline">¶</a></h2>
<div class="section" id="microstates-in-qm">
<h3>Microstates in QM<a class="headerlink" href="#microstates-in-qm" title="Permalink to this headline">¶</a></h3>
<div class="section" id="a-collection-of-up-down-spins">
<h4>A collection of up/down spins<a class="headerlink" href="#a-collection-of-up-down-spins" title="Permalink to this headline">¶</a></h4>
<ol class="simple">
<li><p>Consider a spin-1 particle with spin <span class="math notranslate nohighlight">\(|\uparrow \rangle\)</span> and <span class="math notranslate nohighlight">\(|\downarrow\rangle\)</span>, hence this is a two state system.</p></li>
</ol>
<blockquote>
<div><p>For an electron we have the magnetic moment <span class="math notranslate nohighlight">\(\mu = eh/2mc\)</span>, energy <span class="math notranslate nohighlight">\(E = −2\mu H\)</span> Hmz and spin <span class="math notranslate nohighlight">\(m_z = \pm 1/2\)</span>. Where <span class="math notranslate nohighlight">\(H\)</span> is the external magnetic field.</p>
</div></blockquote>
<ol class="simple">
<li><p>Now consider N non-interacting spin-1 particles. Now the system has <span class="math notranslate nohighlight">\(2N\)</span> possible states. The 2 energy of the system is then given as <span class="math notranslate nohighlight">\(E = \sum^N_i  E_i\)</span></p></li>
</ol>
<blockquote>
<div><p>The question boils down to partitioning <span class="math notranslate nohighlight">\(N_1\)</span> up and <span class="math notranslate nohighlight">\(N_2\)</span> down indistinguishable spin states. <span class="math notranslate nohighlight">\(N_1+N_2=N\)</span> and <span class="math notranslate nohighlight">\(E = -\mu H N_1 -\mu H N_2\)</span></p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[\boxed{\Omega (E,N)=\frac{N!}{N_1! N_2!} = \frac{N!}{\Big[\frac{1}{2}(N-E/H\mu)\Big]! \Big[\frac{1}{2}(N+E/H\mu)\Big]!}}\]</div>
<blockquote>
<div><p>Compare this expression to an expression for partitioning gas molecules into left and right regions of a container. Or to a porblme of random walk after N states. Notice any patterns :)</p>
</div></blockquote>
</div>
</div>
<div class="section" id="a-collection-of-harmonic-oscilaltors">
<h3>A collection of harmonic oscilaltors<a class="headerlink" href="#a-collection-of-harmonic-oscilaltors" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>1D harmonic oscillator <span class="math notranslate nohighlight">\(E_n = \hbar \omega (n+1/2)\)</span> with <span class="math notranslate nohighlight">\(n = 0, 1, 2, ...\)</span> This system has infinitely many but still countable number of states.</p></li>
<li><p>Now consider  N harmonic oscillators. This can describe N atoms in a crystal, each vibrating around its mechanical equilibrium state independet of each other(“Einstein model”). Although these are infinitely many states in this system they can be counted easily.</p></li>
</ol>
<blockquote>
<div><p>The question boils down to finding how many states correspond to <span class="math notranslate nohighlight">\(n_1+n_2+...n_N = M\)</span>. In other words what is the degeneracy of the state correspodning to the total quantum number M?</p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[E(n_1,n_2,...n_N) = \sum^N_{i=1} \hbar \omega \Big(n_i+\frac{1}{2}\Big) = \sum^N_{i=1} n_i +\frac{N}{2}\hbar \omega
\]</div>
<p>The question is answered by partitioning M quanta of energy among N oscillators.  This is slightly different from previous example. The partitioning is analogus to putting M ideantical balls into N identical boxes.</p>
<div class="math notranslate nohighlight">
\[\boxed{\Omega(E,N) = \frac{(N+M-1)!}{M!(N-1)!} = \frac{(E/\hbar\omega+N/2-1)!}{(E/\hbar\omega-N/2)!(N-1)!}}\]</div>
</div>
<div class="section" id="a-collection-of-particles-in-a-box">
<h3>A collection of particles in a box<a class="headerlink" href="#a-collection-of-particles-in-a-box" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>A 1 particle in a box. <span class="math notranslate nohighlight">\(E_n = \frac{\hbar^2 \pi^2}{2mL^2}(n^2_x+n^2_y+n^2_z)\)</span>.</p></li>
<li><p>Now consider N particles in a box. How many states can system have?</p></li>
</ol>
<blockquote>
<div><p>The question boils down to determining degeneracy of states with total quanta <span class="math notranslate nohighlight">\(n_1+n_2+...+n_{3N}\)</span>.</p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[\sum_{E=const} 1 = \int_{E=const} dn\]</div>
</div>
<div class="section" id="microstates-in-quasi-classical-mechanics">
<h3>Microstates in (Quasi)Classical Mechanics.<a class="headerlink" href="#microstates-in-quasi-classical-mechanics" title="Permalink to this headline">¶</a></h3>
<p>In Quantum mechanics we simply count the number of states which is natural and easy due to discretness of energy levels.<br />
The question now is how to deal with the classical systems which have continuous energy functions?
We clarify this issue using the example of 1D harmonic oscillator with an objective to find an expression coinciding with QM description.</p>
<div class="math notranslate nohighlight">
\[E=\Big(N+\frac{1}{2}\Big)\hbar\omega\]</div>
<ul class="simple">
<li><p>For a single harmonic oscillator in  the number of states correpsonding to E is obtained simply as:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[N_E \approx \frac{E}{\hbar \omega} \]</div>
<div class="math notranslate nohighlight">
\[H(p,q) = \frac{p^2}{2m}+ \frac{m\omega^2 q^2}{2} = E\]</div>
<p>In CM, not having discrete count of states we are forced to somehow quantify the “volume” of states occupied by the harmonic oscillator at E as a measure of number of states</p>
<div class="math notranslate nohighlight">
\[\Big[\frac{p}{(2mE)^{1/2}}\Big]^2 + \Big[\frac{q}{(2E/m\omega)^{1/2}}\Big]^2 = 1\]</div>
<div class="math notranslate nohighlight">
\[V = \pi  \cdot (2mE)^{1/2} \cdot (2E/m\omega)^{1/2} =\frac{2\pi E}{\omega}\]</div>
<p>We see that we are missing an important factor of <span class="math notranslate nohighlight">\(h\)</span> which does not exist in CM! Otherwise the expression is identical to QM expression. Hence weintroduce a rule to divide the number of states in CM by <span class="math notranslate nohighlight">\(h\)</span></p>
<div class="math notranslate nohighlight">
\[N_E = \frac{V}{h}\]</div>
<p>Generalizing the epxression for a collection of objects with 3N degrees of freedom we obtain:</p>
<div class="math notranslate nohighlight">
\[\boxed{N_E = \frac{1}{h^{3N}}\int_{H(p^N,q^N)\leq E} dp^N dq^N}\]</div>
</div>
<div class="section" id="density-of-states-is-more-convenient-to-use-than-number-of-states">
<h3>Density of States is more convenient to use than number of states<a class="headerlink" href="#density-of-states-is-more-convenient-to-use-than-number-of-states" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\Omega(E) =\frac{d N(E)}{d E}\]</div>
<p>We will show that for macroscopic system it is convenient to work with denisty of states because number of states in outer thin shell <span class="math notranslate nohighlight">\(\Delta E\)</span> is an excellent approximation to total number of states</p>
<div class="math notranslate nohighlight">
\[N(E)\sim \Omega(E)\Delta E\]</div>
<div class="math notranslate nohighlight">
\[\boxed{N_E = \frac{1}{h^{3N}}\int dp^N dq^N \theta(H(p^N,q^N) -E)} \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\Omega(E) = \frac{1}{h^{3N}}\int dp^N dq^N \delta(H(p^N,q^N) -E)}\]</div>
<br>
<blockquote>
<div><p>Where <span class="math notranslate nohighlight">\(\theta(x-a)\)</span> is a step function (Heviside function) derivative of which gives rise to delta function <span class="math notranslate nohighlight">\(\delta(x) =\frac{d}{dx}\theta(x-a)\)</span></p>
</div></blockquote>
</div>
<div class="section" id="watch-out-for-n-the-indistingushability-of-the-particles-has-consequences-for-thermodynamics">
<h3>Watch out for N! The indistingushability of the particles has consequences for thermodynamics<a class="headerlink" href="#watch-out-for-n-the-indistingushability-of-the-particles-has-consequences-for-thermodynamics" title="Permalink to this headline">¶</a></h3>
<p>Since we are using classical mechanics where all particles can be distingushed and labeled, we need to correct for this artifact if we want to study large N collection of identical atoms and molecules:</p>
<div class="math notranslate nohighlight">
\[\boxed{\Omega(E) = \frac{1}{N! h^{3N}}\int_{p^N,q^N} dp^N dq^N \delta(H(p,q) -E)}\]</div>
</div>
<div class="section" id="microcanonical-ensemble-and-equal-a-priori-probabilities-postulate">
<h3>Microcanonical Ensemble and “equal a priori probabilities” postulate.<a class="headerlink" href="#microcanonical-ensemble-and-equal-a-priori-probabilities-postulate" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\boxed{P(E) = \frac{1}{\Omega(E)}=const}\]</div>
<ul class="simple">
<li><p>Each state in the <span class="math notranslate nohighlight">\(NVE\)</span> ensemble is sampled with equal probabilities. Why? Becasue no microstate has any more priviledged status than the other.</p></li>
<li><p>The task of quantifying probabilities in the thermodynamic processes under <span class="math notranslate nohighlight">\(NVE\)</span> conditions reduces to quantifying changes in the number(density) of states.</p></li>
</ul>
</div>
</div>
<div class="section" id="examples-of-using-nve-ensemble-to-derive-fundmental-equation">
<h2>Examples of using NVE ensemble to derive fundmental equation<a class="headerlink" href="#examples-of-using-nve-ensemble-to-derive-fundmental-equation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-1-a-three-spin-state">
<h3>Example-1: A three spin state<a class="headerlink" href="#example-1-a-three-spin-state" title="Permalink to this headline">¶</a></h3>
<p>3 spin state can adopt many different states with different energies.</p>
<p>If we know the total energy is <span class="math notranslate nohighlight">\(E = -\mu H\)</span> Then we have microcanonican ensemble with three states</p>
<div class="math notranslate nohighlight">
\[N(E) = \{++-, +-+, -++, \}\]</div>
<div class="math notranslate nohighlight">
\[P(E) = \frac{1}{N(E)} = \frac{1}{3}\]</div>
<div class="math notranslate nohighlight">
\[S(E=-3\mu H) = k_B log 3\]</div>
<blockquote>
<div><p>Can you write down entropy for other energy values?</p>
</div></blockquote>
</div>
<div class="section" id="example-2-monoatomic-ideal-gas">
<h3>Example-2: Monoatomic ideal gas<a class="headerlink" href="#example-2-monoatomic-ideal-gas" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[H(p,q) =\frac{p^2}{2m} = E\]</div>
<div class="math notranslate nohighlight">
\[{\Omega(E) = \frac{1}{N! h^{3N}}\int_{p^N,q^N} dp^N dq^N \delta(H(p,q) -E) =\frac{V^N}{N! h^{3N}} \int dp^N \delta(p^2/2m -E)}\]</div>
<div class="math notranslate nohighlight">
\[ \Omega(E) = \frac{V^N}{N! h^{3N}} V(R, \delta R)\]</div>
<p>Where <span class="math notranslate nohighlight">\(V(R,\delta R)\)</span> is a volume of a spherical shell with radius <span class="math notranslate nohighlight">\(R = (2mE)^{1/2}\)</span> and thickness <span class="math notranslate nohighlight">\(\delta R = 1/2 (2m/E)^{1/2} \delta E\)</span></p>
<p><strong>Volume of a sphere in N dimesnional space</strong></p>
<div class="math notranslate nohighlight">
\[V(R) = \frac{\pi^{D/2}}{(D/2)!} R^D\]</div>
<p>For <span class="math notranslate nohighlight">\(D\rightarrow \infty\)</span> we discover that most of the volume of the sphere is concentrated at its surface!
<br></p>
<div class="math notranslate nohighlight">
\[V(R, \delta R) = V(R) -V(R-\delta R) = C [R^D - (R-\delta R)^D] = CR^D [1-(1- (\delta R/R)^D)] \rightarrow CR^D\]</div>
<p>Hence</p>
<div class="math notranslate nohighlight">
\[\boxed{V(R,\delta R)= V(R)} \]</div>
</div>
<div class="section" id="classical-density-of-states-of-an-ideal-gas">
<h3>Classical density of states of an ideal gas<a class="headerlink" href="#classical-density-of-states-of-an-ideal-gas" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\boxed{\Omega(E) = \frac{V^N}{h^{3N} N!} \cdot \frac{(2m\pi E)^{3N/2}}{(3N/2)!}}\]</div>
<div class="math notranslate nohighlight">
\[\boxed{ S = log \Omega(E) = k_B N \cdot  \Big [ log \Big(\frac{V}{N \lambda^3}\Big) + \frac{5}{2}\Big]}\]</div>
<ul class="simple">
<li><p>Note linear dependence on N. Entropy is an extensive quantity!</p></li>
<li><p>exponent 3/2 reflexts that each particle has 3 degrees of freedom</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda = \Big(\frac{3h^2 N}{4\pi m E}\Big)^{1/2}\)</span> thermal de Broglie wavelength.</p></li>
<li><p>This result know as “Sackur Tetrode equation” was known long before statistical mechanics.</p></li>
</ul>
</div>
<div class="section" id="quantum-density-of-states-of-an-ideal-gas">
<h3>Quantum density of states of an ideal gas<a class="headerlink" href="#quantum-density-of-states-of-an-ideal-gas" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[E({\bf n}) = \frac{h^2}{8mL^2} {\bf n^2}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\({\bf n} = \sum^{i=N}_{i=1} n_i^2\)</span>. A sum over all total quantum number of N 3D particles in a box</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\Omega(N,V, E) = \int_{E(n)=E} dn = \frac{C_{3N-1}}{2^{3N}} \int \delta \Big(\frac{(8mE)^{1/2}L}{h}-{\bf n}  \Big) d {\bf n} \approx \frac{V^N E^{3N/2}}{h^{3N}}\]</div>
</div>
</div>
<div class="section" id="thermal-mechanical-and-chemical-equilibrium">
<h2>Thermal, Mechanical and chemical equilibrium<a class="headerlink" href="#thermal-mechanical-and-chemical-equilibrium" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[\Omega(E) = \sum_{E_1} \Omega_1(E_1) \Omega_2 (E-E_1)\]</div>
<div class="math notranslate nohighlight">
\[log \Omega(E) = log \Omega_1(E_1) + log \Omega_2(E-E_1)\]</div>
<p>Recall that for ideal gas we have <span class="math notranslate nohighlight">\(\Omega(E) = C V^N E^{3/2 N}\)</span>. And now consider a probability <span class="math notranslate nohighlight">\(P(E_1) = \Omega_1(E_1) \Omega_2 (E-E_1)\)</span> for a one particular energy partitioning among systems with <span class="math notranslate nohighlight">\(E_1\)</span> going to first subsystem and <span class="math notranslate nohighlight">\(E-E_1\)</span> to second.</p>
<div class="math notranslate nohighlight">
\[\frac{\partial logP(E_1)}{\partial E_1} \Big |_{E_1=U_1}= \frac{3}{2}\frac{N_1}{E_1} - \frac{3}{2}\frac{N_2}{E_2} = 0\]</div>
<p>Using definition of entropy we get the most probable value of energy <span class="math notranslate nohighlight">\((U_1)\)</span> corresponding to the equilibirum state
$<span class="math notranslate nohighlight">\(\frac{1}{k_B T} = \frac{3}{2}\frac{N_1}{U_1} = \frac{3}{2}\frac{N_2}{U_2}\)</span>$</p>
<div class="section" id="equations-of-state-for-ideal-gas">
<h3>Equations of state for ideal gas<a class="headerlink" href="#equations-of-state-for-ideal-gas" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\frac{1}{T} = \frac{\partial S}{\partial E} = \frac{3}{2}k_B \frac{N}{E}\]</div>
<br>
<div class="math notranslate nohighlight">
\[\frac{p}{T} =  \frac{\partial S}{\partial V} = k_B N \frac{1}{V}\]</div>
<br>
<div class="math notranslate nohighlight">
\[\frac{\mu}{T} = -\frac{\partial S}{\partial N} = k_B T \cdot log \frac{N}{V} \lambda^3\]</div>
</div>
</div>
<div class="section" id="phase-space-liuville-s-theorem-and-ergoicity-ideas">
<h2>Phase Space, Liuville’s Theorem and Ergoicity ideas<a class="headerlink" href="#phase-space-liuville-s-theorem-and-ergoicity-ideas" title="Permalink to this headline">¶</a></h2>
<p>Conservative systems are govenred by Hamilton’s equation of motion. That is changes in position and momenta stay on the surface: <span class="math notranslate nohighlight">\(H(p,q)=E\)</span></p>
<div class="math notranslate nohighlight">
\[\dot{q} = \frac{\partial H}{\partial p}\]</div>
<div class="math notranslate nohighlight">
\[\dot{p} = -\frac{\partial H}{\partial q}\]</div>
<p>To see how ensemble N body mechanical conervative system evoleves we are introducing probability distribution of classical trajecotires in phase space</p>
<div class="math notranslate nohighlight">
\[\rho(p,q,t)dq dp \]</div>
<div class="section" id="continuity-equation-and-liuville-s-theorem">
<h3>Continuity equation and Liuville’s theorem<a class="headerlink" href="#continuity-equation-and-liuville-s-theorem" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\frac{\partial \rho(p,q,t)}{\partial t} = -\nabla J = - \nabla(\rho \vec{v})\]</div>
<p>Where flux <span class="math notranslate nohighlight">\(J= \rho \vec{v}\)</span> is defined in terms of the velcotiy of points in phase space <span class="math notranslate nohighlight">\(v = (\dot{q},\dot{p})\)</span>. Combinging the continuity expression combined with Hamilton’s equation of motion:</p>
<div class="math notranslate nohighlight">
\[\dot{p_i} = -\partial_{q_i} H \,\,\,\,\ \dot{q_i} = \partial_{p_i} H\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial \rho(p,q,t)}{\partial t} + \sum_i \Big [ \frac{\partial \rho}{\partial q_i}\dot{q_i}+\frac{\partial \rho}{\partial p_i} \dot{p_i} \Big] + \rho \sum_i \Big [ \frac{\partial \dot{q_i}}{\partial q_i}+  \frac{\partial \dot{p_i}}{\partial p_i}  \Big]=0\]</div>
<p>Where the last term is zero one we plug Hamilton’s equation. We thus arrive at a crucial conclusion that the space volume is preserved during conservative dynamics</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \rho(p,q,t)}{\partial t} + \sum_i \Big [ \frac{\partial \rho}{\partial q_i}\dot{q_i}+\frac{\partial \rho}{\partial p_i} \dot{p_i} \Big]=\frac{d \rho}{ dt} = 0\]</div>
<p>Furthermore we see that the time dependence of phase space probability density vanishes if it is a function of hamiltonian <span class="math notranslate nohighlight">\(\rho = f(H)\)</span></p>
<div class="math notranslate nohighlight">
\[\frac{\partial \rho}{\partial t} = \sum_i \Big [ \frac{\partial \rho}{\partial q_i}\cdot{q_i}+\frac{\partial \rho}{\partial p_i}\cdot{p_i} \Big] = -\{H,\rho \}\]</div>
</div>
<div class="section" id="liuville-theorem-illustrated">
<h3>Liuville theorem illustrated<a class="headerlink" href="#liuville-theorem-illustrated" title="Permalink to this headline">¶</a></h3>
<p>According to Liuvile’s theorem small phase space area element under time evolution gets deform but preserves the volume. For example, assume the initial distribution is a rectangle in phase space (x , v)</p>
<div class="math notranslate nohighlight">
\[{x 0 − d x ≤ x ≤ x 0 + d x}\]</div>
<div class="math notranslate nohighlight">
\[ {v 0 − d v ≤ v ≤ v 0 + d v } \]</div>
<p>As time progresses this rectangle will deform, but its area will not change (assuming <span class="math notranslate nohighlight">\(d x\)</span>  and <span class="math notranslate nohighlight">\(d v\)</span>  are sufficiently small which ensure energy conservation)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sci</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Polygon</span> <span class="c1"># for making rectangles from four points</span>

<span class="n">a</span> <span class="o">=</span> <span class="mf">1.0</span>             <span class="c1"># acceleration</span>
<span class="n">x0</span><span class="p">,</span> <span class="n">v0</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>    <span class="c1"># center of initial phase space element</span>
<span class="n">dx</span><span class="p">,</span> <span class="n">dv</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span>  <span class="c1"># (half of) width of initial phase space element</span>

<span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(((</span><span class="n">x0</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span><span class="n">v0</span><span class="o">-</span><span class="n">dv</span><span class="p">),(</span><span class="n">x0</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span><span class="n">v0</span><span class="o">+</span><span class="n">dv</span><span class="p">),(</span><span class="n">x0</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">v0</span><span class="o">+</span><span class="n">dv</span><span class="p">),(</span><span class="n">x0</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">v0</span><span class="o">-</span><span class="n">dv</span><span class="p">)))</span>     <span class="c1"># initial phase space element</span>

<span class="k">def</span> <span class="nf">propagate</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;Propagates a phase space patch p0 for time t.&quot;&quot;&quot;</span>
    
    <span class="n">x0</span><span class="p">,</span> <span class="n">v0</span> <span class="o">=</span> <span class="n">p0</span><span class="o">.</span><span class="n">T</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">v0</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">t</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>


<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    
    <span class="n">p</span> <span class="o">=</span> <span class="n">propagate</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>  

    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">Polygon</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;t=</span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Position x&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Velocity v&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">5.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.5, 3.5)
</pre></div>
</div>
<img alt="../_images/01_NVE (potoyan-mbp2017.chem.iastate.edu's conflicted copy 2021-03-19)_48_1.png" src="../_images/01_NVE (potoyan-mbp2017.chem.iastate.edu's conflicted copy 2021-03-19)_48_1.png" />
</div>
</div>
</div>
<div class="section" id="hamiltonian-conservative-dynamics-in-phase-space">
<h3>Hamiltonian, conservative dynamics in phase space<a class="headerlink" href="#hamiltonian-conservative-dynamics-in-phase-space" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[H(p,q) = \frac{p^2}{2}+\frac{q^2}{2}\]</div>
<div class="math notranslate nohighlight">
\[\dot{q} = \frac{\partial H}{\partial p} = p\]</div>
<div class="math notranslate nohighlight">
\[\dot{p} = -\frac{\partial H}{\partial q} = -q\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># range of x and y grid</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># make a grid of x and y values, Y = dot X</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>

<span class="n">H</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Y</span><span class="o">*</span><span class="n">Y</span> <span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">X</span><span class="o">*</span><span class="n">X</span>   <span class="c1">#here is the Hamiltonian</span>

<span class="c1">#cs = plt.contour(X,Y,H,20,cmap=&#39;inferno&#39;)</span>
<span class="c1">#plt.clabel(cs,inline=1,fontsize=10)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;dq/dt&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">1.1</span><span class="o">*</span><span class="n">xmax</span><span class="p">,</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="o">*</span><span class="n">ymax</span><span class="p">,</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">ymax</span><span class="p">])</span>

<span class="c1"># Hamilton&#39;s equations define a vector field U,V</span>
<span class="n">U</span> <span class="o">=</span>   <span class="n">Y</span>
<span class="n">V</span> <span class="o">=</span> <span class="o">-</span> <span class="n">X</span>

<span class="n">Q</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/01_NVE (potoyan-mbp2017.chem.iastate.edu's conflicted copy 2021-03-19)_51_0.png" src="../_images/01_NVE (potoyan-mbp2017.chem.iastate.edu's conflicted copy 2021-03-19)_51_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># range of x and y grid</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">2.0</span>
<span class="n">ymax</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># make a grid of x and y values, Y = dot X</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>

<span class="n">epsilon</span><span class="o">=</span><span class="mf">0.3</span>

<span class="n">H</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Y</span><span class="o">*</span><span class="n">Y</span>  <span class="o">-</span> <span class="n">epsilon</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>    <span class="c1">#here is the Hamiltonian</span>

<span class="c1"># Hamilton&#39;s equations define a vector field U,V</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">Y</span>
<span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="n">epsilon</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1">#cs =plt.contour(X,Y,H,10,cmap=&#39;inferno&#39;)</span>
<span class="c1">#plt.clabel(cs,inline=1,fontsize=10)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;dx/dt&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="n">xmax</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="o">-</span><span class="n">ymax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>



<span class="n">Q</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># plot the vector field </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/01_NVE (potoyan-mbp2017.chem.iastate.edu's conflicted copy 2021-03-19)_52_0.png" src="../_images/01_NVE (potoyan-mbp2017.chem.iastate.edu's conflicted copy 2021-03-19)_52_0.png" />
</div>
</div>
</div>
<div class="section" id="problems">
<h3>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<div class="section" id="problem-1">
<h4>Problem-1<a class="headerlink" href="#problem-1" title="Permalink to this headline">¶</a></h4>
<p>Write a python code to quantify the number of states of particle in a box at energy <span class="math notranslate nohighlight">\(E = C(n^2_x +n^2_y+n^2_z)\)</span> where C is a constant which you can set  to 1. You can do this by generating three integer numbers satisfying <span class="math notranslate nohighlight">\(n^2_x +n^2_y+n^2_z &lt; E\)</span>.</p>
<ul class="simple">
<li><p>Try differnet energy values, <span class="math notranslate nohighlight">\(E = 10, 20, 50, 100\)</span></p></li>
<li><p>Can you think of some Monte Carlo ideas to estimate number of states?</p></li>
</ul>
<div class="section" id="problem-2-2d-spin-lattice">
<h5>Problem-2: 2D Spin lattice<a class="headerlink" href="#problem-2-2d-spin-lattice" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><p>Generate  16 by 16 lattice with spin up and down states. This can be done by using</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span>
</pre></div>
</div>
<p>Visualize the lattice via plt.imshow(latttice)</p>
<ul class="simple">
<li><p>Write a function to compute the total energy by using <span class="math notranslate nohighlight">\(E_{ij} = -\sum_{ij} s_i s_j\)</span> where the summation runs only between nearest neighbours of the lattice. E.g each spin has only four neighbours to interact with.</p></li>
<li><p>Generate 1000 states by randomly flipping spins in batches of 1,2,4,8. E.g pick random spins and flip the sign. Plot the distribution of energies that results. Comment on the number of states as a function of energy.</p></li>
<li><p>What is the probability of observing each configuration? What are the total number of states? Can you comment on efficiency of estimating total energy via random sampling.</p></li>
<li><p>Enforce periodic boundary conditions, e.g allow each spin at the endge to interact with spin on the other side. E.g spin at <span class="math notranslate nohighlight">\((5,16)\)</span> now can interact with spin at (5,1). Can you comment on the contribution of energy that results from inclduing the surface spins?</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="problem-3-shottky-defects-in-nve-computing-number-of-states-via-lattice-models">
<h3>Problem-3: Shottky defects in NVE: Computing number of states via lattice models<a class="headerlink" href="#problem-3-shottky-defects-in-nve-computing-number-of-states-via-lattice-models" title="Permalink to this headline">¶</a></h3>
<p>Schotky defects are vacancies in a lattice of atoms. Creating a single vacancy costs an energy. Consider NVE ensemble of lattice with n vacacnies(defects) in an N-lattice model of solid material. The total energy is solely a function of defects in this model <span class="math notranslate nohighlight">\(E=n\epsilon\)</span></p>
<ul class="simple">
<li><p>Write down number of states in NVE ensemble and compute the entropy via Boltzman formula. Plot number of states as a function of energy. You can use log of number of states for plotting.</p></li>
<li><p>Compute how the temperature would affect the fraction of vacancies on the lattice. Plot fraction of vacancies as a function of temperature.</p></li>
<li><p>How would the total energy depend on temperature <span class="math notranslate nohighlight">\(T\)</span>. Derive expression for the high temeprature limit (<span class="math notranslate nohighlight">\(\frac{\epsilon}{k_b T} \gg 1\)</span>).</p></li>
<li><p>Plot total energy as a function of temperature E(T)</p></li>
</ul>
<div class="section" id="problem-4-lattice-gas">
<h4>Problem-4: Lattice gas<a class="headerlink" href="#problem-4-lattice-gas" title="Permalink to this headline">¶</a></h4>
<p>Consider a lattice gas of N particles distributed among V cells (with <span class="math notranslate nohighlight">\(N\geq V\)</span>). Suppose that each cell may be either empty or occupied by a single particle. The number of microscopic states of this syste will be given by:</p>
<div class="math notranslate nohighlight">
\[\Omega (N, V) = \frac{V!}{N! (V-N)!}\]</div>
<ul class="simple">
<li><p>Obtain an expression for the entropy per particle <span class="math notranslate nohighlight">\(s(v)=\frac{1}{N} \cdot S(N,V)\)</span> where <span class="math notranslate nohighlight">\(v=\frac{V}{N}\)</span>.</p></li>
<li><p>From this simple fundamental equation, obtain an expression of equation of state <span class="math notranslate nohighlight">\(p/T\)</span>. - Write an expansion of <span class="math notranslate nohighlight">\(p/T\)</span> in terms of density <span class="math notranslate nohighlight">\(1/v\)</span>. Show that the first term gives Boyle law of ideal gases.</p></li>
<li><p>Sketch a graph of <span class="math notranslate nohighlight">\(\mu/T\)</span>, where <span class="math notranslate nohighlight">\(\mu(\rho)\)</span> is a chemical potential as a function of density. Comment on <span class="math notranslate nohighlight">\(\rho\rightarrow 0\)</span> and <span class="math notranslate nohighlight">\(\rho\rightarrow 1\)</span> limits</p></li>
</ul>
</div>
<div class="section" id="problem-5-entropic-origin-of-polymer-elasticity">
<h4>Problem-5: Entropic origin of polymer elasticity<a class="headerlink" href="#problem-5-entropic-origin-of-polymer-elasticity" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>Solve the problem 3.3 from the book.</p>
</div></blockquote>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./03_ensembles"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Davit Potoyan<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>