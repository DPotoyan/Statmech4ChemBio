Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
mu_q_better = 0
sigma_q_better = 1.2
def q_better(x):
    return (1/(sigma_q_better * np.sqrt(2*np.pi))) * np.exp(-0.5 * ((x - mu_q_better)/sigma_q_better)**2)

# Recalculate convergence with better proposal
better_importance_estimates = []

for N in sample_sizes:
    y_samples = np.random.normal(mu_q_better, sigma_q_better, N)
    weights = p(y_samples) / q_better(y_samples)
    importance_f = h(y_samples) * weights
    better_importance_estimates.append(np.mean(importance_f))

# Plot updated convergence comparison
fig, ax = plt.subplots(figsize=(10, 6))

ax.plot(sample_sizes, uniform_estimates, label='Uniform Sampling', marker='o', alpha=0.6)
ax.plot(sample_sizes, importance_estimates, label='Importance Sampling (poor q)', marker='s', alpha=0.6)
ax.plot(sample_sizes, better_importance_estimates, label='Importance Sampling (better q)', marker='^', alpha=0.9)
ax.axhline(true_value, color='black', linestyle='--', label='True Value')

ax.set_xscale('log')
ax.set_title('Convergence Comparison with Better-Aligned Proposal')
ax.set_xlabel('Number of Samples (log scale)')
ax.set_ylabel('Estimated Integral')
ax.legend()
ax.grid(True)

plt.tight_layout()
plt.show()

------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mNameError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[11], line 9[0m
[1;32m      6[0m [38;5;66;03m# Recalculate convergence with better proposal[39;00m
[1;32m      7[0m better_importance_estimates [38;5;241m=[39m []
[0;32m----> 9[0m [38;5;28;01mfor[39;00m N [38;5;129;01min[39;00m [43msample_sizes[49m:
[1;32m     10[0m     y_samples [38;5;241m=[39m np[38;5;241m.[39mrandom[38;5;241m.[39mnormal(mu_q_better, sigma_q_better, N)
[1;32m     11[0m     weights [38;5;241m=[39m p(y_samples) [38;5;241m/[39m q_better(y_samples)

[0;31mNameError[0m: name 'sample_sizes' is not defined

