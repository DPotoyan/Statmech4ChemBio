
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4. Non-boltzman (enhanced) sampling ideas &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. Introduction to statistical mechanics of fluids" href="05_Intro2Fluids.html" />
    <link rel="prev" title="3. Mean Field Theory" href="03_MeanField.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../00_python.html">
   A. Python refresher
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_python/intro2py.html">
     1. Why Python?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_python/intro2numpy.html">
     2. NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_python/intro2viz.html">
     3. Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01_stats.html">
   B. Probability and randomness
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_stats/01_SetsCounting.html">
     1. Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_stats/02_RandVar.html">
     2. Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_stats/03_MC.html">
     3. “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_stats/04_LimitTheorems.html">
     4. Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01_stats/05_InverseTransform.html">
     5. Appendix B2: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02_thermo.html">
   C. Thermodynamics refresher
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02_thermo/01_Thermo.html">
     1. Review of thermodynamics principles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03_ensembles.html">
   D. Statistical ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_ensembles/01_NVE.html">
     1. NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_ensembles/02_NVT.html">
     2. NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_ensembles/03_NPT.html">
     3. NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_ensembles/04_Applications.html">
     4. Applications
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_ensembles/05_Phase_space_dynamics.html">
     5. NVE
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04_ideal_systems.html">
   E. Ideal Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_ideal_systems/01_Classical.html">
     1. Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_ideal_systems/02_Quantum.html">
     2. Quantum non-interacting systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_ideal_systems/03_Photons_Phonons.html">
     3. Photons and Phonons
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../05_entropy.html">
   F. Entropy and Information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../05_entropy/01_InformationEnt.html">
     1. What is Information?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../06_ising.html">
   G. Phase transitions and Ising models
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="01_MCMC_Ising.html">
     1. Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_ising_analytic.html">
     2. Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MeanField.html">
     3. Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     4. Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="05_Intro2Fluids.html">
     5. Introduction to statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="06_MC_LJ.html">
     6. Monte Carlo simulations of Lennard-Jones fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/06_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/06_ising/04_EnhanceSampl.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/06_ising/04_EnhanceSampl.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#boltzman-exponent-factorization-to-the-rescue">
   4.1. Boltzman exponent factorization to the rescue!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umbrella-sampling">
   4.2. Umbrella Sampling
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connection-between-biased-and-unbiased-simulations">
     4.2.1. Connection between biased and unbiased simulations:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     4.2.2. Connection between biased and unbiased simulations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   4.3. Simulated annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
     4.3.1. Finding energy minima of any thermal  system
     <span class="math notranslate nohighlight">
      \(\leftrightarrow\)
     </span>
     finding minimum of any abstract function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slow-cooling-is-the-main-idea-of-simulated-annealing">
     4.3.2. “Slow cooling” is the main idea of simulated annealing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cooling-schedules">
     4.3.3. Cooling schedules
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
     4.3.4.
     <strong>
      Example:
     </strong>
     find global minimum of the function via simulated annealing:
     <span class="math notranslate nohighlight">
      \(f(x) = x^2 -\cos (4\pi x)\)
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#search-for-global-minima-of-f-x-using-simulated-annealing">
       4.3.4.1. Search for global minima of
       <span class="math notranslate nohighlight">
        \(f(x)\)
       </span>
       using simulated annealing
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
       4.3.4.2. Lessons learened In this example: for finding minimum of a continuous function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
     4.3.5. Simulated annealing applied to MCMC sampling of 2D Ising model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering">
     4.3.6. Parallel tempering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
     4.3.7. How to choose Temperature distributions for replica exchange MCMC
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parallel-tempering-simulation">
     4.3.8. parallel tempering simulation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problems">
     4.3.9. Problems
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="non-boltzman-enhanced-sampling-ideas">
<h1><span class="section-number">4. </span>Non-boltzman (enhanced) sampling ideas<a class="headerlink" href="#non-boltzman-enhanced-sampling-ideas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">rand</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">randint</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">uniform</span> 

<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Suppse we have a system in NVT ensemble described by energy function <span class="math notranslate nohighlight">\(E_{\nu}\)</span>  which makes it hard to sample via straight MCMC.
We can introduce a bias in the energy function <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> with an objective to accelerate the sampling and eliminate the energetic barriers present with the original system.</p>
<div class="math notranslate nohighlight">
\[E^0_{\nu} = E_{\nu} - \Delta E\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E_{\nu}\)</span>   Energy function of an unbiased system</p></li>
<li><p><span class="math notranslate nohighlight">\(E^0_{\nu}\)</span> Energy function of a biased system.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta E_{\nu}\)</span> bias term.</p></li>
</ul>
<div class="section" id="boltzman-exponent-factorization-to-the-rescue">
<h2><span class="section-number">4.1. </span>Boltzman exponent factorization to the rescue!<a class="headerlink" href="#boltzman-exponent-factorization-to-the-rescue" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[Z = \sum_{\nu} e^{-\beta E_{\nu}}  = \frac{Z_0}{Z_0} \sum_{\nu} e^{-\beta E^0_{\nu}} e^{-\beta \Delta E_{\nu}} = Z_0 \langle e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
<div class="math notranslate nohighlight">
\[\boxed{\frac{Z}{Z_0} = e^{-\beta(F-F_0)} = \langle e^{-\beta \Delta E_{\nu}} \rangle_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\langle ... \rangle_0\)</span> indicates canonical average with <span class="math notranslate nohighlight">\(E^0_{\nu}\)</span>.</p>
<p>Any observable of interest can now be expressed in terms of ensemble average conducted with biased energy function <span class="math notranslate nohighlight">\(E_0\)</span></p>
<div class="math notranslate nohighlight">
\[\langle G\rangle = \frac{1}{Z}\sum_{\nu} G_{\nu}e^{-\beta E_{\nu}}  = \frac{Z_0}{Z} \langle G_{\nu} e^{-\beta \Delta E_{\nu}} \rangle_0 \]</div>
</div>
<div class="section" id="umbrella-sampling">
<h2><span class="section-number">4.2. </span>Umbrella Sampling<a class="headerlink" href="#umbrella-sampling" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[E_{\nu} =  E^0_{\nu}+ W_{\nu}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \approx 0\)</span> in the interesting regions
<br><br></p></li>
<li><p>Where <span class="math notranslate nohighlight">\(W_{\nu} \gg 0\)</span> outside of interesting regions
<br><br></p></li>
<li><p>Read more about US in <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/wcms.66?casa_token=KxOXA8oqPO4AAAAA%3AR78Iv0cMhe3NaCNe86T0AnQBJ57euERM3h20FTeSRcM9wOzEHIJq-6FD7J4_kZHg4UZ1RKuGm_OoCPw">J Kastner; WIREs Comp Mol Sci (2011)</a></p></li>
</ul>
<p><img alt="" src="../_images/umbrella-1.png" /></p>
<div class="section" id="connection-between-biased-and-unbiased-simulations">
<h3><span class="section-number">4.2.1. </span>Connection between biased and unbiased simulations:<a class="headerlink" href="#connection-between-biased-and-unbiased-simulations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Free energy as a function of order parameter defined as log of partial sum of parition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(m) = \sum_{\nu}e^{-\beta E(s_{\nu})}\cdot \delta(M(s_{\nu})-m)  = e^{-\beta F(m)}\]</div>
<ul class="simple">
<li><p>Histogram of order parameter in the simulatons as a ratio of partial and full partition functions</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(m) = \frac{Z(m)}{Z} = \langle \delta(M(s)-m) \rangle = e^{-\beta(F(m)-F)}\]</div>
<ul class="simple">
<li><p>Free eenergy computed as a histogram of order parameter</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(m) =  -\frac{1}{\beta}log\, Z(m) = -\frac{1}{\beta}log\, p(m) +const\]</div>
</div>
<div class="section" id="id1">
<h3><span class="section-number">4.2.2. </span>Connection between biased and unbiased simulations<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[p_0(m) = \langle \delta(M(s)-m) \rangle_0 =e^{-\beta w(m)} \frac{\sum_{\nu} \delta(M(s_{\nu})-m) e^{-\beta E_{\nu}}}{Z_0} =    \frac{e^{-\beta w(m)} p(m)}{Z_0/Z}\]</div>
<div class="math notranslate nohighlight">
\[F(m) = F^0(m) - w(m)+C\]</div>
<p>For simulation with multiple windows <span class="math notranslate nohighlight">\(w_i\)</span> there is an undetermined constant which is optimized to obtain smooth free energy profile and reduce the statistical noise</p>
<div class="math notranslate nohighlight">
\[F_i(m) = F_i^0(m) - w_i(m)+C_i\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Ising2D python code optimized for speed</span>

<span class="kn">import</span> <span class="nn">numpy</span>  <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">njit</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Computes thermodynamic variables given the spin lattice&#39;&#39;&#39;</span>
  
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="n">E</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
                
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="c1">#Magnetization</span>
    <span class="n">M</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="c1">#Energy</span>
    <span class="n">E</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">M</span>

    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="n">E</span>  

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])):</span>

    <span class="c1">#Initialize data arrays</span>
    <span class="n">Magn</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">traj</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N] 
        <span class="n">dE</span>     <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>  

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="n">umbrella</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="p">):</span>

            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 
            
        <span class="c1">#Compute and store data</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">M_t</span><span class="p">,</span> <span class="n">E_t</span> <span class="o">=</span> <span class="n">compute_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
            
            <span class="n">Magn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">M_t</span><span class="p">)</span>
            <span class="n">Ener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_t</span><span class="p">)</span>
            <span class="n">traj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">traj</span><span class="p">,</span> <span class="n">Ener</span><span class="p">,</span> <span class="n">Magn</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="" src="../_images/umbrealla-2.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate lattice size needed by calculating difference in magnetization caused by a spin flip 2/N**2</span>
<span class="n">traj</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)),</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.94 0.805
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_13_1.png" src="../_images/04_EnhanceSampl_13_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">umb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">])</span> 

<span class="n">traj2</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="n">M2</span> <span class="o">=</span> <span class="n">run_ising2d</span><span class="p">(</span><span class="n">spins</span><span class="o">=</span><span class="n">traj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">umbrella</span> <span class="o">=</span> <span class="n">umb</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.16666667,  0.5       ,  0.22222222,  1.94444444,  1.72222222,
         3.77777778,  8.44444444,  9.16666667, 14.72222222, 14.88888889]),
 array([0.76 , 0.778, 0.796, 0.814, 0.832, 0.85 , 0.868, 0.886, 0.904,
        0.922, 0.94 ]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_15_1.png" src="../_images/04_EnhanceSampl_15_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">traj</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "3c7294590e37469885836dc2dd0d5052"}
</script></div>
</div>
</div>
</div>
<div class="section" id="simulated-annealing">
<h2><span class="section-number">4.3. </span>Simulated annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">¶</a></h2>
<p>Monte Carlo technique for the <strong>numerical optimization</strong> of functions</p>
<ol class="simple">
<li><p>Original paper: <a class="reference external" href="http://science.sciencemag.org/content/220/4598/671.long">S. Kirkpatrick, C. D. Gelatt, Jr., M. P. Vecchi, Science 220, 671-680 (1983)</a></p></li>
<li><p>Remember: it is difficult to find the <strong>global</strong> extremum of a function</p></li>
<li><p>Idea: Monte Carlo search of the function domain</p></li>
</ol>
<div class="section" id="finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function">
<h3><span class="section-number">4.3.1. </span>Finding energy minima of any thermal  system <span class="math notranslate nohighlight">\(\leftrightarrow\)</span> finding minimum of any abstract function<a class="headerlink" href="#finding-energy-minima-of-any-thermal-system-leftrightarrow-finding-minimum-of-any-abstract-function" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Introduce (artificial) temperature parameter <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Metropolis algorithm with acceptance probability min<span class="math notranslate nohighlight">\((1, e^{-\Delta f/T})\)</span></p></li>
<li><p>Here <span class="math notranslate nohighlight">\(f\)</span> can be any function we want to minimize (not only energy)</p></li>
<li><p>For maximum simply change the sign: min<span class="math notranslate nohighlight">\((1, e^{+\Delta f/T})\)</span></p></li>
<li><p>Slowly reduce the temperature</p></li>
</ul>
</div>
<div class="section" id="slow-cooling-is-the-main-idea-of-simulated-annealing">
<h3><span class="section-number">4.3.2. </span>“Slow cooling” is the main idea of simulated annealing<a class="headerlink" href="#slow-cooling-is-the-main-idea-of-simulated-annealing" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>very high <span class="math notranslate nohighlight">\(T\)</span></p></th>
<th class="head"><p>very low <span class="math notranslate nohighlight">\(T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>almost all updates are accepted</p></td>
<td><p>only updates that decrease the energy are accepted</p></td>
</tr>
<tr class="row-odd"><td><p>random configurations/explore entire space</p></td>
<td><p>descend towards minimum</p></td>
</tr>
<tr class="row-even"><td><p>high energy</p></td>
<td><p>low energy but might get stuck in local minimum</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>if we slowly cool from high <span class="math notranslate nohighlight">\(T\)</span> to low <span class="math notranslate nohighlight">\(T\)</span> we will explore the entire space until we converge to the (hopefully) global minimum</p></li>
<li><p>success is not guaranteed, but the methods works very well with good cooling schemes</p></li>
<li><p>Inspiration: annealing in metallurgy.</p></li>
<li><p>This is a great method to tackle <strong>NP-hard</strong> optimization problems, such as the traveling salesman!</p></li>
</ul>
</div>
<div class="section" id="cooling-schedules">
<h3><span class="section-number">4.3.3. </span>Cooling schedules<a class="headerlink" href="#cooling-schedules" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>slow cooling is essential: otherwise the system will “freeze” into a local minimum</p></li>
<li><p>but too slow cooling is inefficient…</p></li>
<li><p>initial temperature should be high enough so that the system is essentially random and equilibrates quickly</p></li>
<li><p>final temperature should be small enough so that we are essentially in the ground state (system no longer changes)</p></li>
<li><p>exponential <strong>cooling schedule</strong> is commonly used</p>
<div class="math notranslate nohighlight">
\[\boxed{T(t)=T_0e^{-t/\tau}}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the Monte Carlo time and the constant <span class="math notranslate nohighlight">\(\tau\)</span> needs to be determined (usually empirically)</p>
</li>
<li><p>alternative cooling schedules:</p>
<p>linear: <span class="math notranslate nohighlight">\(T(t)=T_0 - t/\tau\)</span> (also widely used)</p>
<p>logarithmic: <span class="math notranslate nohighlight">\(T(t) = c/\log(1+t/\tau)\)</span></p>
</li>
</ul>
</div>
<div class="section" id="example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x">
<h3><span class="section-number">4.3.4. </span><strong>Example:</strong> find global minimum of the function via simulated annealing: <span class="math notranslate nohighlight">\(f(x) = x^2 -\cos (4\pi x)\)</span><a class="headerlink" href="#example-find-global-minimum-of-the-function-via-simulated-annealing-f-x-x-2-cos-4-pi-x" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> 
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$f(x)$&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/04_EnhanceSampl_22_0.png" src="../_images/04_EnhanceSampl_22_0.png" />
</div>
</div>
<div class="section" id="search-for-global-minima-of-f-x-using-simulated-annealing">
<h4><span class="section-number">4.3.4.1. </span>Search for global minima of <span class="math notranslate nohighlight">\(f(x)\)</span> using simulated annealing<a class="headerlink" href="#search-for-global-minima-of-f-x-using-simulated-annealing" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Making a new move by incremening a normal distributed step</span>
<span class="sd">    We are exploring function diffusivefly, e.g doing random walk!</span>
<span class="sd">    T: temp</span>
<span class="sd">    mean, sigma: parameters of random walk</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">xnew</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
    <span class="n">delta_f</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">xnew</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
   
    <span class="k">if</span> <span class="n">delta_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">delta_f</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">xnew</span>
        
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Function for educing T after every MC step. </span>
<span class="sd">    </span>
<span class="sd">    cool_t: cooling time tau for exponential schedule </span>
<span class="sd">    Alternatively we could reduce every N steps.&#39;&#39;&#39;</span>
    
    <span class="k">return</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cool_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sim_anneal</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">T_min</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">cool_t</span><span class="o">=</span><span class="mf">1e4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Simulated annealing search for min of function:</span>
<span class="sd">    </span>
<span class="sd">    T=T0:        starting temperature</span>
<span class="sd">    T_min:       minimal temp reaching which sim should stop</span>
<span class="sd">    cool_t:      colling pace/time</span>
<span class="sd">    x=x0:        starting position </span>
<span class="sd">    mean, sigma: parameters for diffusive exploration of x&#39;&#39;&#39;</span>
    
    <span class="n">xlog</span>   <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">T</span> <span class="o">&gt;</span> <span class="n">T_min</span><span class="p">:</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
   
        <span class="n">xlog</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">xlog</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlog</span> <span class="o">=</span> <span class="n">sim_anneal</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlog</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MC time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Final search result for the global minimum: &#39;</span><span class="p">,</span> <span class="n">xlog</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final search result for the global minimum:  -0.001425221774717463
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_26_1.png" src="../_images/04_EnhanceSampl_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">viz_anneal</span><span class="p">(</span><span class="n">t_sim</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">T</span>           <span class="o">=</span> <span class="mi">4</span>
    <span class="n">x</span>           <span class="o">=</span> <span class="mi">2</span>
    <span class="n">cool_t</span>      <span class="o">=</span> <span class="mf">1e4</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t_sim</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">MCupdate</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
        <span class="n">T</span> <span class="o">=</span> <span class="n">cool</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">cool_t</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$f(x)$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "c29a8b70a1924adda589c94caf562b1a"}
</script></div>
</div>
</div>
<div class="section" id="lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function">
<h4><span class="section-number">4.3.4.2. </span>Lessons learened In this example: for finding minimum of a continuous function<a class="headerlink" href="#lessons-learened-in-this-example-for-finding-minimum-of-a-continuous-function" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>always slightly above true minimum if <span class="math notranslate nohighlight">\(T&gt;0\)</span></p></li>
<li><p>best combined with a steepest descent method</p></li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model">
<h3><span class="section-number">4.3.5. </span>Simulated annealing applied to MCMC sampling of 2D Ising model<a class="headerlink" href="#simulated-annealing-applied-to-mcmc-sampling-of-2d-ising-model" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="mf">10.0</span>    <span class="c1"># initial temperature</span>
<span class="n">tempmin</span> <span class="o">=</span> <span class="mf">1e-4</span>        <span class="c1"># minimal temperature (stop annealing when this is reached)</span>
<span class="n">cooltime</span> <span class="o">=</span> <span class="mf">1e4</span>        <span class="c1"># cooling time tau for exponential schedule</span>

<span class="c1"># how long it will take to cool to minimal temperature in MC steps</span>
<span class="n">MCtime</span> <span class="o">=</span> <span class="o">-</span><span class="n">cooltime</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">tempmin</span><span class="o">/</span><span class="n">temperature</span><span class="p">)</span>

<span class="c1"># after every MC step we reduce the temperature</span>
<span class="k">def</span> <span class="nf">cool</span><span class="p">(</span><span class="n">temperature</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">temperature</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">cooltime</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="parallel-tempering">
<h3><span class="section-number">4.3.6. </span>Parallel tempering<a class="headerlink" href="#parallel-tempering" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Simulated annealing is not guaranteed to find the global extremum</strong></p>
<ul class="simple">
<li><p>Unless you cool infinitely slowly.</p></li>
<li><p>Usually need to repeat search multiple times using independent simulations.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Automating and generalizing sim annealing: parallel tempering (aka Replica Exchange MCMC)</strong></p>
<ul class="simple">
<li><p>Simulate several copies of the system in parallel</p></li>
<li><p>Each copy is at a different constant temperature <span class="math notranslate nohighlight">\(T\)</span></p></li>
<li><p>Usual Metropolis updates for each copy</p></li>
<li><p>Every certain number of steps attempt to exchange copies at neighboring temperatures</p></li>
<li><p>Exchange acceptance probability is min(1, <span class="math notranslate nohighlight">\(e^{-\Delta f\Delta\beta}\)</span>)</p></li>
<li><p>If temperature difference small enough, the energy histograms of the copies will overlap and exhcanges will happen often.
<br><br></p></li>
</ul>
</li>
<li><p><strong>Advantages of replica exchange:</strong></p>
<ul class="simple">
<li><p>Exchanges allow to explore different extrema</p></li>
<li><p>More successful for complex functions/energy landscapes. Random walk in temperature space!</p></li>
<li><p>Detailed balance is maintained! (regular simulated annealing breaks detailed balance)</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="how-to-choose-temperature-distributions-for-replica-exchange-mcmc">
<h3><span class="section-number">4.3.7. </span>How to choose Temperature distributions for replica exchange MCMC<a class="headerlink" href="#how-to-choose-temperature-distributions-for-replica-exchange-mcmc" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>A dense temperature grid increases the exchange acceptance rates</p></li>
<li><p>But dense T grid takes longer to simulate and more steps are needed to move from one temperature to another</p></li>
<li><p>There are many options, often trial and error is needed</p>
<ul>
<li><p>exchange acceptance probability should be between about 20% and 80%</p></li>
<li><p>exchange acceptance probability should be approximately temperature-independent</p></li>
<li><p>commonly used: geometric progression for <span class="math notranslate nohighlight">\(N\)</span> temperatures <span class="math notranslate nohighlight">\(T_n\)</span> between and including <span class="math notranslate nohighlight">\(T_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(T_{\rm max}\)</span> (ensures more steps around <span class="math notranslate nohighlight">\(T_{\rm min}\)</span>)</p>
<div class="math notranslate nohighlight">
\[T_n = T_{\rm min}\left(\frac{T_{\rm max}}{T_{\rm min}}\right)^{\frac{n-1}{N-1}}\]</div>
</li>
</ul>
</li>
<li><p>make sure to spend enough time before swapping to achieve equilibrium!</p></li>
</ul>
</div>
<div class="section" id="parallel-tempering-simulation">
<h3><span class="section-number">4.3.8. </span>parallel tempering simulation<a class="headerlink" href="#parallel-tempering-simulation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">######## Ising 2D+US ###########</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">mcmc</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;mcmc takes spin configuration and samples with given N,J,B,T </span>
<span class="sd">    for n_steps outputing results every out_freq&#39;&#39;&#39;</span>

    <span class="n">confs</span> <span class="o">=</span> <span class="p">[]</span> 
    
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>

        <span class="c1">#Pick random spin</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">randint</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

        <span class="c1">#Compute energy change</span>
        <span class="n">z</span>  <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] + spins[i, (j+1)%N] + spins[i, (j-1)%N]
        <span class="n">dE</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span>

        <span class="c1">#Metropolis condition</span>
        <span class="k">if</span> <span class="n">dE</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">dE</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
            
            <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span> 

        <span class="c1">#Store the spin configuration</span>
        <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="n">out_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            
            <span class="n">confs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spins</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        
    <span class="k">return</span> <span class="n">confs</span>

<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getM</span><span class="p">(</span><span class="n">spins</span><span class="p">):</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span>


<span class="nd">@njit</span>
<span class="k">def</span> <span class="nf">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>    
    
    <span class="n">E</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>   
            
            <span class="n">z</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>, j] + spins[(i-1)%N, j] +spins[i,(j+1)%N] +  spins[i,(j-1)%N]
            
            <span class="n">E</span> <span class="o">+=</span> <span class="o">-</span><span class="n">J</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># Since we overcounted interactions 4 times divide by 4.</span>

    <span class="k">return</span> <span class="n">E</span> <span class="o">-</span> <span class="n">B</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">spins</span><span class="p">)</span> <span class="c1">#Field contribution added</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;Randomly pick two adjacent replicas and attempt an exchange&#39;&#39;&#39;</span>
    
    <span class="n">i</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">N_repl</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">j</span>       <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="n">deltaBeta</span>      <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">T</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    
    <span class="n">deltaEnergy</span>    <span class="o">=</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">getE</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">deltaBeta</span><span class="o">*</span><span class="n">deltaEnergy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">rand</span><span class="p">():</span>
        
        <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">configs</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">n_exch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">out_freq</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    
    <span class="n">N_repl</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">configs</span>    <span class="o">=</span> <span class="p">[[</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">)]</span>
    
    
    <span class="k">for</span> <span class="n">exch_attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_exch</span><span class="p">):</span> <span class="c1">#Exchange attemps</span>
    
        <span class="n">configs</span> <span class="o">=</span> <span class="n">temper</span><span class="p">(</span><span class="n">configs</span><span class="p">,</span> <span class="n">N_repl</span><span class="p">)</span>
    
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_repl</span><span class="p">):</span> <span class="c1">#mcmc in between exchange attemps</span>
    
            <span class="n">configs_new</span> <span class="o">=</span> <span class="n">mcmc</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
            <span class="n">configs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">configs_new</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">configs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>       <span class="c1"># size of lattice in each direction</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">1</span>       <span class="c1"># interaction parameter</span>
<span class="n">B</span> <span class="o">=</span> <span class="mi">0</span>       <span class="c1"># magnetic field</span>

<span class="n">T</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.0008</span><span class="p">,</span> <span class="mf">0.0007</span><span class="p">,</span> <span class="mf">0.00016</span><span class="p">,</span> <span class="mf">0.00010</span><span class="p">]</span>

<span class="n">n_exch</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_steps</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">out_freq</span><span class="o">=</span><span class="mi">100</span>

<span class="n">configs</span> <span class="o">=</span> <span class="n">pt_mcmc</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">n_exch</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">,</span> <span class="n">out_freq</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E1</span> <span class="o">=</span> <span class="p">[</span><span class="n">getE</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">spins</span> <span class="ow">in</span> <span class="n">configs</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fc15b450b10&gt;]
</pre></div>
</div>
<img alt="../_images/04_EnhanceSampl_36_1.png" src="../_images/04_EnhanceSampl_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">999</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">configs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "51a96a8d0524404aba22aa206ffa1e91"}
</script></div>
</div>
</div>
<div class="section" id="problems">
<h3><span class="section-number">4.3.9. </span>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Umbrella Sampliing</strong></p></li>
</ol>
<p>Use umbrealla sampling to obtain free energy profile as a function of magnetization below <span class="math notranslate nohighlight">\(T_c\)</span> at <span class="math notranslate nohighlight">\(T_c\)</span> and above <span class="math notranslate nohighlight">\(T_c\)</span>. E.g <span class="math notranslate nohighlight">\(T=2, 2.5, 3\)</span> Consider using the inputs from adjecent umbrella simulations. E.g input for umbrella 4 can come from umbrella 3 to speed up simulations.</p>
<ol class="simple">
<li><p><strong>Simulated Annealing</strong></p></li>
</ol>
<p>Complete the simulated annealing part of the code for finding minimum energy in Ising models. Test your code with field on and off.</p>
<ol class="simple">
<li><p><strong>Parallel Tempering</strong></p></li>
</ol>
<p>Use parallell tempering to enhanced sampling at <span class="math notranslate nohighlight">\(T =1\)</span> by coupling 8 replicas with <span class="math notranslate nohighlight">\(T&gt;1\)</span>. Find the optimal T spacing between replicas, Calculate histograms of magnetization to show enhancment of sampling with repsect to constant T MCMC.</p>
</div>
</div>
</div>


<script type="application/vnd.jupyter.widget-state+json">
{"state": {"778ae119bd7045598cf0315555ba1a2e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3c7294590e37469885836dc2dd0d5052": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_1fbcb5407ada478e9c392fd806d47a0a", "IPY_MODEL_cb91e4056fa64dde9230f6135ad79721"], "layout": "IPY_MODEL_778ae119bd7045598cf0315555ba1a2e"}}, "0598dd1dd92e4b61a23791e40bf8793d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "1c26cb8e407b4608b0d1cefdf83ac719": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "1fbcb5407ada478e9c392fd806d47a0a": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_0598dd1dd92e4b61a23791e40bf8793d", "max": 10, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_1c26cb8e407b4608b0d1cefdf83ac719", "value": 1}}, "148151960fdd44f0a9e67a443855a496": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "cb91e4056fa64dde9230f6135ad79721": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_148151960fdd44f0a9e67a443855a496", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "8bad8b8e13eb443a928a79b088a191d1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "c29a8b70a1924adda589c94caf562b1a": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_12b2be333bbf4d3fa3c6cd2a59f6b698", "IPY_MODEL_d13895238c554a028632529cfaa6d07b"], "layout": "IPY_MODEL_8bad8b8e13eb443a928a79b088a191d1"}}, "691632c913b0429594e6bf14c847f3dc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5eb9118a335a483eb08278b1f11889f1": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "12b2be333bbf4d3fa3c6cd2a59f6b698": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "t_sim", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_691632c913b0429594e6bf14c847f3dc", "max": 1000, "min": 1, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_5eb9118a335a483eb08278b1f11889f1", "value": 1}}, "b00475b8c6914cc2822e6ae0ccbb3d19": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "d13895238c554a028632529cfaa6d07b": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_b00475b8c6914cc2822e6ae0ccbb3d19", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 432x288 with 1 Axes>", "image/png": "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\n"}}]}}, "6a447bac103d4aea8d7809ccdfe8f807": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "51a96a8d0524404aba22aa206ffa1e91": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_52379cc4d0c94a03abd1967b9c6bd98f", "IPY_MODEL_4da6466872b044da903476eea4ee2880"], "layout": "IPY_MODEL_6a447bac103d4aea8d7809ccdfe8f807"}}, "47eeeed03b7544b2abc2242c12d36ca2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "25cfb58d9b044395a73bebc864fba45d": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "52379cc4d0c94a03abd1967b9c6bd98f": {"model_name": "IntSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "IntSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "IntSliderView", "continuous_update": true, "description": "i", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_47eeeed03b7544b2abc2242c12d36ca2", "max": 999, "min": 0, "orientation": "horizontal", "readout": true, "readout_format": "d", "step": 1, "style": "IPY_MODEL_25cfb58d9b044395a73bebc864fba45d", "value": 1}}, "f96009d81d8e412083f7dcd52671bf3e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4da6466872b044da903476eea4ee2880": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_f96009d81d8e412083f7dcd52671bf3e", "msg_id": "", "outputs": [{"output_type": "display_data", "metadata": {"needs_background": "light"}, "data": {"text/plain": "<Figure size 576x576 with 1 Axes>", "image/png": "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\n"}}]}}}, "version_major": 2, "version_minor": 0}
</script>


    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./06_ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="03_MeanField.html" title="previous page"><span class="section-number">3. </span>Mean Field Theory</a>
    <a class='right-next' id="next-link" href="05_Intro2Fluids.html" title="next page"><span class="section-number">5. </span>Introduction to statistical mechanics of fluids</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Davit Potoyan<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  None
  </body>
</html>