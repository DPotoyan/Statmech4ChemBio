
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5. Appendix B2: The Inverse Transform of RVs &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="C. Thermodynamics refresher" href="../02_thermo.html" />
    <link rel="prev" title="4. Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems" href="04_LimitTheorems.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../00_python.html">
   A. Python refresher
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../00_python/intro2py.html">
     1. Why Python?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_python/intro2numpy.html">
     2. NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../00_python/intro2viz.html">
     3. Plotting
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="../01_stats.html">
   B. Probability and randomness
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="01_SetsCounting.html">
     1. Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_RandVar.html">
     2. Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="03_MC.html">
     3. “Monte Carlo and the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="04_LimitTheorems.html">
     4. Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     5. Appendix B2: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../02_thermo.html">
   C. Thermodynamics refresher
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../02_thermo/01_Thermo.html">
     1. Review of thermodynamics principles
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../03_ensembles.html">
   D. Statistical ensembles
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../03_ensembles/01_NVE.html">
     1. NVE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_ensembles/02_NVT.html">
     2. NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_ensembles/03_NPT.html">
     3. NPT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03_ensembles/04_Applications.html">
     4. Applications
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../04_ideal_systems.html">
   E. Ideal Systems
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../04_ideal_systems/01_Classical.html">
     1. Classical gases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04_ideal_systems/02_Quantum.html">
     2. Quantum
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../05_entropy.html">
   F. Entropy and Information
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../05_entropy/01_InformationEnt.html">
     1. What is Information?
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../06_ising.html">
   G. Phase transitions and Ising models
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../06_ising/01_MCMC_Ising.html">
     1. Ising models and Metropolis-Hastings algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06_ising/02_ising_analytic.html">
     2. Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06_ising/02_ising_analytic.html#a-bit-of-history-ising-model-and-phase-transitions">
     3. A. bit of history: Ising model and phase transitions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06_ising/02_ising_analytic.html#homework-7">
     4. Homework-7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06_ising/03_EnhanceSampl.html">
     5. Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/01_stats/05_InverseTransform.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/01_stats/05_InverseTransform.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/01_stats/05_InverseTransform.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-idea">
   5.1. The idea
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-drawing-from-the-exponential-distribution">
     5.1.1. Example: Drawing from the exponential distribution.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#let-us-formalize-this-procedure">
     5.1.2. Let us formalize this procedure:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#box-muller-algorithm">
     5.1.3. Box-Muller algorithm
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="appendix-b2-the-inverse-transform-of-rvs">
<h1><span class="section-number">5. </span>Appendix B2: The Inverse Transform of RVs<a class="headerlink" href="#appendix-b2-the-inverse-transform-of-rvs" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-idea">
<h2><span class="section-number">5.1. </span>The idea<a class="headerlink" href="#the-idea" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Inverse_transform_sampling">Inverse transform sampling</a> is a basic method for <a class="reference external" href="https://en.wikipedia.org/wiki/Pseudo-random_number_sampling">pseudo-random number sampling</a>, i.e. for generating sample numbers at random from any probability distribution given its cumulative distribution function. That is, by drawing from a uniform distribution, we make it possible to draw from the other distribution in question.</p>
<p>Let’s start by defining uniform distribution <span class="math notranslate nohighlight">\(U(0,1)\)</span> which geneerates random numbers <span class="math notranslate nohighlight">\(Z\sim U(0,1)\)</span> falling on <span class="math notranslate nohighlight">\([0,1]\)</span> range. Now let’s look for a way of transforming random number <span class="math notranslate nohighlight">\(Z\)</span> with <span class="math notranslate nohighlight">\(p(z)=\frac{1}{1-0}\)</span> unifrom pdf into a function <span class="math notranslate nohighlight">\(X(Z)\)</span> where x is distributed according to some pdf <span class="math notranslate nohighlight">\(p(x)\)</span>. The probability to find <span class="math notranslate nohighlight">\(x\)</span> between <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(x+dx\)</span> is equal to:</p>
<div class="math notranslate nohighlight">
\[p(x)dx = p(z)dz = dz\]</div>
<p>This relation is simply transform of variables. Now the key point to realize is that integrals from over <span class="math notranslate nohighlight">\([-\infty, x(z)]\)</span> for X and <span class="math notranslate nohighlight">\([0, z]\)</span> for Z are equal (these are comulative distribution functions (CDF).</p>
<div class="math notranslate nohighlight">
\[
\int_{-\infty}^{x(z)} p(x') dx' = \int_0^z dz'= z
\]</div>
<p>Thus if we can (i) integrate expression on the left analytically and (ii) solve for <span class="math notranslate nohighlight">\(x\)</span> then we are done!
For most of the pdf at least one of the two is not possible. Below is a typical example where both (i) and (ii) states are easily done.</p>
<div class="section" id="example-drawing-from-the-exponential-distribution">
<h3><span class="section-number">5.1.1. </span>Example: Drawing from the exponential distribution.<a class="headerlink" href="#example-drawing-from-the-exponential-distribution" title="Permalink to this headline">¶</a></h3>
<p>For example, lets assume we would like
to generate random numbers that follow the exponential distribution
$<span class="math notranslate nohighlight">\(p(x) = \frac{1}{\lambda} e^{-x/\lambda}\)</span>$</p>
<p>for <span class="math notranslate nohighlight">\(x\ge0\)</span> and <span class="math notranslate nohighlight">\(f(x)=0\)</span> otherwise. Following the recipe from the above we have</p>
<div class="math notranslate nohighlight">
\[u = \int_{0}^{x} \frac{1}{\lambda} e^{-x'/\lambda} dx'  = 1- e^{-x/\lambda} \]</div>
<p>Solving for <span class="math notranslate nohighlight">\(x\)</span> we get</p>
<div class="math notranslate nohighlight">
\[x = - \lambda \ln (1-u) \]</div>
</div>
<div class="section" id="let-us-formalize-this-procedure">
<h3><span class="section-number">5.1.2. </span>Let us formalize this procedure:<a class="headerlink" href="#let-us-formalize-this-procedure" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p><strong>Get a uniform sample <span class="math notranslate nohighlight">\(u\)</span> from <span class="math notranslate nohighlight">\(U(0,1)\)</span></strong></p></li>
<li><p><strong>Solve for <span class="math notranslate nohighlight">\(x\)</span> yielding a new equation <span class="math notranslate nohighlight">\(x=F^{-1}(u)\)</span> where <span class="math notranslate nohighlight">\(F\)</span> is the CDF of the distribution we desire.</strong></p></li>
<li><p><strong>Repeat.</strong></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># probability distribution we&#39;re trying to calculate</span>
<span class="n">p</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># CDF of p</span>
<span class="n">CDF</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># invert the CDF</span>
<span class="n">invCDF</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">r</span><span class="p">)</span>

<span class="c1"># domain limits</span>
<span class="n">xmin</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># the lower limit of our domain</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mi">6</span> <span class="c1"># the upper limit of our domain</span>

<span class="c1"># range limits</span>
<span class="n">rmin</span> <span class="o">=</span> <span class="n">CDF</span><span class="p">(</span><span class="n">xmin</span><span class="p">)</span>
<span class="n">rmax</span> <span class="o">=</span> <span class="n">CDF</span><span class="p">(</span><span class="n">xmax</span><span class="p">)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># the total of samples we wish to generate</span>

<span class="c1"># generate uniform samples in our range then invert the CDF</span>
<span class="c1"># to get samples of our target distribution</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">rmin</span><span class="p">,</span> <span class="n">rmax</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">invCDF</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>

<span class="c1"># get the histogram info</span>
<span class="n">hinfo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># plot the histogram</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;Samples&#39;</span><span class="p">);</span>

<span class="c1"># plot our (normalized) function</span>
<span class="n">xvals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">hinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">p</span><span class="p">(</span><span class="n">xvals</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">u</span><span class="s1">&#39;p(x)&#39;</span><span class="p">)</span>

<span class="c1"># turn on the legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7efd159f4bd0&gt;
</pre></div>
</div>
<img alt="../_images/05_InverseTransform_3_1.png" src="../_images/05_InverseTransform_3_1.png" />
</div>
</div>
</div>
<div class="section" id="box-muller-algorithm">
<h3><span class="section-number">5.1.3. </span><a class="reference external" href="https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform">Box-Muller algorithm</a><a class="headerlink" href="#box-muller-algorithm" title="Permalink to this headline">¶</a></h3>
<p>In many cases the integral to calculate the CDF may not be easy to calculate analytically
and we need to come with clever algorithms. For example
there is no closed form formula for the integral of the normal distribution
<span class="math notranslate nohighlight">\( I=\frac{1}{2\pi} \int_{-\infty}^{x} e^{-x'^2/2}dx' \)</span>.</p>
<p>The <strong>Box Muller method</strong> is a brilliant trick to overcome this by producing two independent standard normals
from two independent uniforms.</p>
<p>The idea is this. Consider the  product of two independent normals N(0,1):</p>
<div class="math notranslate nohighlight">
\[ X \sim N(0,1), Y \sim N(0,1) \implies X,Y \sim N(0,1)N(0,1)\]</div>
<p>The pdf then is:</p>
<div class="math notranslate nohighlight">
\[f_{XY}(x,y)  =  \frac{1}{\sqrt{2\pi}} e^{-x^2/2} \times \frac{1}{\sqrt{2\pi}} e^{-y^2/2} = \frac{1}{2\pi} \times e^{-r^2/2}\]</div>
<p>where <span class="math notranslate nohighlight">\(r^2 = x^2 + y^2\)</span>.</p>
<p>If you think of this in terms of polar co-ordinates <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Theta \sim U(0, 2\pi) \\   S = R^2 \sim Exp(1/2)\end{split}\]</div>
<p>From the inverse method for the exponential above:</p>
<div class="math notranslate nohighlight">
\[ s = r^2 = -2 ln(1-u) \]</div>
<p>where u is a sample from <span class="math notranslate nohighlight">\(U \sim U(0,1)\)</span>. Now if <span class="math notranslate nohighlight">\(U \sim U(0,1)\)</span>, then <span class="math notranslate nohighlight">\(1-U \sim U(0,1)\)</span>.</p>
<p>Thus  we can write:</p>
<div class="math notranslate nohighlight">
\[\begin{split}r = \sqrt{-2\,ln(u_1)} \\ \\ \theta = 2\pi\, u_2\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(u_1\)</span> and <span class="math notranslate nohighlight">\(u_2\)</span> are both drawn from a <span class="math notranslate nohighlight">\(U(0,1)\)</span>. Now we can use:</p>
<div class="math notranslate nohighlight">
\[x = r\,cos\theta, y = r\,sin\theta\]</div>
<p>to generate samples for the normally distributed random variables <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">u1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">u2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="n">r_squared</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">u1</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r_squared</span><span class="p">)</span>

<span class="n">theta</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">u2</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;scatter&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/seaborn/_decorators.py:43: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  FutureWarning
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.JointGrid at 0x7efd2e8c0e90&gt;
</pre></div>
</div>
<img alt="../_images/05_InverseTransform_5_2.png" src="../_images/05_InverseTransform_5_2.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./01_stats"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="04_LimitTheorems.html" title="previous page"><span class="section-number">4. </span>Appendix B1: Probability distirbutions functions (PDFs) and Limit theorems</a>
    <a class='right-next' id="next-link" href="../02_thermo.html" title="next page">C. Thermodynamics refresher</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Davit Potoyan<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>