

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>NVT &#8212; Statistical Mechanics for Chemistry and Biology</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '3_ensembles/nvt';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="muPT" href="npt.html" />
    <link rel="prev" title="NVE" href="nve.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.jpg" class="logo__image only-light" alt="Statistical Mechanics for Chemistry and Biology - Home"/>
    <script>document.write(`<img src="../_static/logo.jpg" class="logo__image only-dark" alt="Statistical Mechanics for Chemistry and Biology - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    About
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../0_python/intro.html">Python</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../0_python/intro2py.html">Python3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../0_python/intro2numpy.html">NumPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../0_python/intro2viz.html">Plotting</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_stats/intro.html">Stats</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_stats/01_SetsCounting.html">Probability theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_stats/02_RandVar.html">Random walk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_stats/03_Diffusion.html">Diffusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_stats/04_Entropy.html">Entropy</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2_thermo/intro.html">Thermodynamics</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2_thermo/01_Thermo.html">Review of thermodynamics principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2_thermo/02_Legendre.html">Legendre transform</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Ensembles</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ensemble_overview.html">Overview of ensembles</a></li>
<li class="toctree-l2"><a class="reference internal" href="phase_space.html">Phase Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="nve.html">NVE</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">NVT</a></li>
<li class="toctree-l2"><a class="reference internal" href="npt.html">muPT</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4_ideal_systems/intro.html">Gases</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../4_ideal_systems/quantum_systems.html">Quantum non-interacting systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4_ideal_systems/photons_phonons.html">Photons and Phonons</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../6_ising/intro.html">Phase transitions</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../6_ising/00_MC.html">Monte Carlo and “the power of randomness”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6_ising/01_MCMC.html">Ising models and Metropolis algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6_ising/02_phase_tranistions.html">Phase transitions through the lense of Ising models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6_ising/03_MeanField.html">Mean Field Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../6_ising/03_vdw.html">Mean Field theory of interacting fluids</a></li>





<li class="toctree-l2"><a class="reference internal" href="../6_ising/04_analytic.html">Analytic solutions to 1D Ising model</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../7_fluids/intro.html">Fluids</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../7_fluids/Intro2Fluids.html">Statistical mechanics of fluids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../7_fluids/mc_lj.html">MC simulations of fluids</a></li>

<li class="toctree-l2"><a class="reference internal" href="../7_fluids/Intro2MD.html">Molecular Dynamics</a></li>

<li class="toctree-l2"><a class="reference internal" href="../7_fluids/md_lj.html">MD simulations of fluids</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../8_kinetics/intro.html">Kinetics</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../8_kinetics/langevin.html">Langevin equation and Brownian motion</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Labs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../labs/lab1/intro.html">Numpy lab</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab1/sinc_function.html">Numpy Lab: Sinc Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab1/linear_functions.html">Numpy Lab: Linear Functions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../labs/lab2/intro.html">Random variable lab</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab2/polymer-conf.html">Conformations of Random Polymer Chains</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../labs/lab4/intro.html">Application of ensembles</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab4/nvt_application.html">Free energy and protein folding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab4/TwoState.html">Two-state system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab4/mass_action.html">Mass action law</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../labs/lab5/intro.html">Simulating Ising models</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab5/torch_ising.html">Ising-2D simulations using ML libraries</a></li>



<li class="toctree-l2"><a class="reference internal" href="../labs/lab5/Wolf.html">Other Methods for sampling Ising models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab5/enhance-sampling.html">Non-boltzman (enhanced) sampling ideas</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../labs/lab6/intro.html">Simulating Fluids</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab6/openmm_double_well.html">Double Well potential using OpenMM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab6/openmm_lj_chain.html">Simulating toy polymers using openMM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab6/openmm_ethane.html">Simulating Ethane</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab6/openmm_villin.html">Simulating solvated protein</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/3_ensembles/nvt.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/3_ensembles/nvt.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/3_ensembles/nvt.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>NVT</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#beta-and-kt-energy"><span class="math notranslate nohighlight">\(\beta\)</span> and kT (energy)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#micro-vs-macro-states">Micro vs macro states</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermodynamic-limit-and-partition-functions">Thermodynamic limit and partition functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-z-via-classical-mechanics">Computing Z via classical mechanics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fluctuation-response-theorem-and-ensemble-equivalence">Fluctuation-response theorem and ensemble equivalence</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-power-and-utility-of-nvt-the-non-interacting-system">The power and utility of NVT: The non-interacting system</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-a-two-state-model-in-nve-vs-nvt-ensemble">Example-1: A two-state model in NVE vs NVT ensemble</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-ideal-gas-classical">Example-2: Ideal gas (classical)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-ideal-paramagnet-of-spin-1-2">Example-3 Ideal paramagnet of spin 1/2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-interacting-molecules">Non-interacting molecules</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#translational-degrees-of-freedom-particle-in-a-box">Translational degrees of freedom: particle in a box</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rotatational-degrees-of-freedom-rigid-rotor-model">Rotatational degrees of freedom: Rigid rotor model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vibrational-degrees-of-freedom-harmonic-oscillator-model">Vibrational degrees of freedom: Harmonic oscillator model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partition-function-for-a-molecular-gas">Partition function for a molecular gas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equipartion-theorem">Equipartion theorem</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems">Problems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-1-elementary-derivation-of-boltzmanns-distirbution">Problem-1 Elementary derivation of Boltzmann’s distirbution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-2-three-level-system">Problem-2 Three level system</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-3-spins-on-a-lattice">Problem-3 Spins on a lattice</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-4-2d-diploes-on-a-lattice">Problem-4 2D diploes on a lattice</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-5-a-typical-spin-problem">Problem-5 A typical spin problem</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="nvt">
<h1>NVT<a class="headerlink" href="#nvt" title="Permalink to this heading">#</a></h1>
<div class="admonition-what-you-need-to-know admonition">
<p class="admonition-title">What you need to know</p>
<ul class="simple">
<li><p><strong>In NVT, ensemble</strong> each microstates of the system has different energies because the system can exchange energy with an environment to maintain <span class="math notranslate nohighlight">\(T=const\)</span>.</p></li>
<li><p><strong>The Boltzmann distribution</strong> gives the probability of being in any particular macro or microstate in the NVT ensemble. Probability depends exponentially on energy, which shows that the system pays an exponentially high penalty for borrowing power from the environment to occupy excited states. As temperature increases, the price of more excited states is populated.</p></li>
<li><p><strong>Free energy captures</strong> the entropy-energy tradeoff, which shows which macrostates are more likely to occur at any given temperature!</p></li>
<li><p><strong>Legendre transform</strong> <span class="math notranslate nohighlight">\(F = U-TS\)</span> makes free energy the central object in thermodynamics of systems under <span class="math notranslate nohighlight">\(T=const\)</span>.   <span class="math notranslate nohighlight">\(\Delta F \leq 0\)</span> replaces <span class="math notranslate nohighlight">\(\Delta S \geq 0\)</span> as the condition for spontaneous process of the system.</p></li>
<li><p><strong>The partition function</strong> <span class="math notranslate nohighlight">\(Z\)</span> in the NVT ensemble is a Boltzman-weighted sum over microstates.</p></li>
<li><p><strong>Bridge equations in NVE and NVT.</strong> While in NVE entropy was linked directly with partition function <span class="math notranslate nohighlight">\(S=k_B log \Omega\)</span>, in NVT, it is free energy that is directly linked with partition function Z, <span class="math notranslate nohighlight">\(F=-k_BT logZ\)</span></p></li>
<li><p><strong>The Laplace transform</strong> connections partition functions of NVT and NVE <span class="math notranslate nohighlight">\(Z\)</span> and <span class="math notranslate nohighlight">\(\Omega\)</span>. This shows <strong>ensemble equivalence</strong>, e.g., thermodynamics quantities computed in either ensemble are the same!</p></li>
</ul>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title"><strong>An intuitive derivation of Boltzmann distribution</strong></p>
<p><strong>Probability of macrostates</strong></p>
<ul class="simple">
<li><p>Consider a system in contact with the thermal reservoir. The combined system is isolated, which means we can write down the NVE partition function as a sum over different ways of partitioning total energy between the system and the reservoir.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\Omega_{t}(E_t) = \sum_E \Omega(E) \Omega_r(E-E) \cdot\]</div>
<ul class="simple">
<li><p>The probability of being in any thermodynamic <strong>macrostate</strong>  described by energy <span class="math notranslate nohighlight">\(E\)</span> will be given by the ratio of one term over all possible partitionings of energy:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(E) = \frac{\Omega(E) \Omega_r(E_t-E) }{\sum_E \Omega(E) \Omega_r(E_t-E) }\]</div>
<p><strong>Reservoir is much larger than the system</strong></p>
<ul class="simple">
<li><p>We can take advantage of the fact that the system <span class="math notranslate nohighlight">\(E_t \sim E_r \ll E\)</span> is small compared to the reservoir. We can expand entropy in the exponent of partition function <span class="math notranslate nohighlight">\(\Omega_r = e^{S_r/k_B}\)</span> which is a smoothly varying function of energy:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[S_r(E_t-E)  \approx S_r(E_t)- \Big(\frac{\partial S_r}{\partial E}\Big) E =  S_r(E_t)- \frac{1}{T} E\]</div>
<ul class="simple">
<li><p>The constant reservoir term  ends up canceling out from the ratio!</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(E) = \frac{ \Omega(E)  e^{\frac{1}{k_B}S(E_t)} e^{-\beta E} }{\sum_E \Omega(E) e^{\frac{1}{k_B}S(E_t)}  e^{-\beta E}} = \frac{ \Omega(E)  e^{-\beta E} }{\sum_E \Omega(E)  e^{-\beta E}}\]</div>
<ul class="simple">
<li><p>We can also write down the probability of a single specific microstate <span class="math notranslate nohighlight">\(E=E_i\)</span> for which <span class="math notranslate nohighlight">\(\Omega(E_i)=1\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[p_i = \frac{ e^{-\beta E_i} }{\sum_i e^{-\beta E_i}}\]</div>
<p><strong>Connection with Thermodynamics</strong></p>
<ul class="simple">
<li><p>Let us now connect the entropy of the whole system to entropy in thermodynamics. Recall that in thermodynamics, entropy is an extensive quantity, meaning that total entropy should be expressed as the sum of entropies of system+reservoir. This is possible only if the sum of the <span class="math notranslate nohighlight">\(\Omega_t(E_t)\)</span> expression is sharply dominated by a single term that is centered on some (average) value of energy <span class="math notranslate nohighlight">\(U\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[S_t(E_t) = k_B log \sum_E \Omega(E) \Omega_r(E_t-E) \approx k_B log \Omega(U)+k_B log \Omega_r(E_t-U) = S(U) + S_r(E_t-U)\]</div>
<div class="math notranslate nohighlight">
\[Z = \sum_E \Omega(E) e^{-\beta E} \approx \Omega (U) e^{-\beta U} = e^{-\beta(U-TS)} = e^{-\beta F}\]</div>
<ul class="simple">
<li><p>We see that the reservoir’s contribution to the distribution of energy in the system is only through temperature!</p></li>
<li><p>We could also carry our similar derivation by expanding reservoir entropy around the average energy of the system  <span class="math notranslate nohighlight">\(U = \sum_i p_i E_i\)</span> by making use of the central limit theorem, which predicts small fluctuations around averages <span class="math notranslate nohighlight">\(U - E_i = \delta E_i \sim O(N^{1/2})\)</span></p></li>
</ul>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title"><strong>MaxEnt Derivation of the Boltzmann Distribution</strong></p>
<p>Utilizing the principle of maximum entropy (MaxEnt) with an internal energy constraint unveils an exponential relationship with <strong>microstate energies</strong> (E_i), manifesting as the Boltzmann distribution.</p>
<p>The Lagrangian is defined as:</p>
<div class="math notranslate nohighlight">
\[ L = -k_B \sum_{i} p_i \log p_i - \alpha \left( \sum_{i} p_i - 1 \right) - \beta \left( \sum_{i} p_i E_i - U \right)\]</div>
<p>Taking the derivative of <span class="math notranslate nohighlight">\(L\)</span> with respect to <span class="math notranslate nohighlight">\(p_j\)</span> and setting it to zero yields:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial L}{\partial p_j} = -k_B (\log p_j + 1) - \alpha - \beta E_j = 0\]</div>
<ul class="simple">
<li><p>This equation reveals that the microstate probability can be represented using two Lagrange multipliers. The normalization factor can absorb the first multiplier, leading to:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p_j = e^{-\frac{\alpha}{k_B} - 1} e^{-\frac{\beta E_j}{k_B}} \sim e^{-\beta E_j}\]</div>
<ul class="simple">
<li><p>Normalization (<span class="math notranslate nohighlight">\(\sum_j p_j = 1\)</span>) allows us to eliminate the Lagrange multiplier <span class="math notranslate nohighlight">\(\alpha\)</span>, resulting in the exponential Boltzmann distribution.</p></li>
</ul>
<p><strong>Boltzmann Distribution:</strong></p>
<div class="math notranslate nohighlight">
\[ p_j = \frac{e^{-\frac{\beta E_j}{k_B}}}{Z} \]</div>
<ul class="simple">
<li><p>The macrostate probability distribution with energy <span class="math notranslate nohighlight">\(E\)</span> and degeneracy <span class="math notranslate nohighlight">\(\Omega(E)\)</span> sums the probabilities of corresponding microstates:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(E) = \frac{\Omega (E) e^{-\beta E}}{\sum_E \Omega (E) e^{-\beta E}}\]</div>
<p><strong>Determining <span class="math notranslate nohighlight">\(\beta = \frac{1}{k_B T}\)</span>:</strong></p>
<ul class="simple">
<li><p>Inserting the Boltzmann distribution into the entropy equation, we find:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[S = -k_B \sum_i p_i \log \frac{e^{-\beta E_i}}{Z} = k_B \beta \sum_i p_i E_i + k_B \log Z \sum_i p_i = k_B \beta U + k_B \log Z\]</div>
<ul class="simple">
<li><p>Comparing the statistical mechanics expression for entropy change at constant temperature to the Gibbs relation from thermodynamics:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[dS = k_B \beta dU + k_B d \log Z\]</div>
<div class="math notranslate nohighlight">
\[dS = \frac{dU}{T} - \frac{dF}{T}\]</div>
<ul class="simple">
<li><p>From these relations, we deduce that:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\beta = \frac{1}{k_B T}\]</div>
<ul class="simple">
<li><p>And for the Helmholtz free energy <span class="math notranslate nohighlight">\(F\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F = -k_B T \log Z\]</div>
</div>
<section id="beta-and-kt-energy">
<h2><span class="math notranslate nohighlight">\(\beta\)</span> and kT (energy)<a class="headerlink" href="#beta-and-kt-energy" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(kT\)</span> (also written as <span class="math notranslate nohighlight">\(k_BT\)</span>) or its inverse <span class="math notranslate nohighlight">\(\beta =(k_BT)^{-1}\)</span> contain a product of the Boltzmann constant <span class="math notranslate nohighlight">\(k_B\)</span> and the temperature, T.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p_i \sim e^{-E_i/k_BT} = e^{-\beta E_i}\]</div>
<ul class="simple">
<li><p>This product is used as a scale factor for energy values in molecular-scale systems (sometimes it is used as a unit of energy), as the rates and frequencies of many processes and phenomena depend not on their energy alone but on the ratio of that energy and kT.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">k</span><span class="p">,</span> <span class="n">N_A</span>

<span class="n">T</span> <span class="o">=</span> <span class="mi">300</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;kT in J:&#39;</span><span class="p">,</span> <span class="n">k</span><span class="o">*</span><span class="n">T</span><span class="p">)</span> 

<span class="n">RT</span><span class="o">=</span><span class="n">N_A</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="mi">300</span> <span class="o">*</span><span class="mf">1e-3</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RT in kJ/mol:&#39;</span><span class="p">,</span> <span class="n">RT</span><span class="p">)</span> 

<span class="c1">#Compare to the energy of breaking oxygen bond </span>
<span class="n">E_breakO</span> <span class="o">=</span> <span class="mi">495</span> <span class="c1"># kj/mol</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Multiples of thermal energy to break oxygen molecule:&#39;</span><span class="p">,</span> <span class="n">E_breakO</span><span class="o">/</span><span class="n">RT</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>kT in J: 4.141947e-21
RT in kJ/mol: 2.494338785445972
Multiples of thermal energy to break oxygen molecule: 198.44938582049795
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">300</span>

<span class="n">RT</span><span class="o">=</span><span class="n">N_A</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">T</span> <span class="o">*</span><span class="mf">1e-3</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>



<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$E_i$&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;microstate index, i&#39;</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Omega(E_i)$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$E_i$&#39;</span><span class="p">)</span>

<span class="n">p_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">E</span><span class="o">/</span><span class="n">RT</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">E</span><span class="o">/</span><span class="n">RT</span><span class="p">))</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">p_i</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;RT=</span><span class="si">{</span><span class="n">RT</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$E_i$&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p_i$&#39;</span><span class="p">)</span>



<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/950a1764a9cbc4936625606d28285831d9e15d6b37da1d8c19b307d1984fdca5.png" src="../_images/950a1764a9cbc4936625606d28285831d9e15d6b37da1d8c19b307d1984fdca5.png" />
</div>
</div>
</section>
<section id="micro-vs-macro-states">
<h2>Micro vs macro states<a class="headerlink" href="#micro-vs-macro-states" title="Permalink to this heading">#</a></h2>
<p><strong>Microstates</strong></p>
<ul class="simple">
<li><p>In NVT ensemble microstates follow Boltzmann distribution</p></li>
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[p_1 = \frac{e^{-\beta E_1}}{Z} = \frac{e^{-\beta E_1}}{e^{-\beta F}}\]</div>
<ul class="simple">
<li><p>The relative population of microstates is dictated by the ratio of Boltzmann weights which depends on energy difference <span class="math notranslate nohighlight">\(\Delta E\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\boxed{\frac{p_2}{p_1} = e^{-\beta (E_2-E_1)}}\]</div>
<p><strong>Macrostates</strong></p>
<ul class="simple">
<li><p>Probability of macrostates with energy <span class="math notranslate nohighlight">\(E_A\)</span> is obtained by summing over all microstates with energy E_A or simply by multiplying by <span class="math notranslate nohighlight">\(\Omega_A\)</span>. The latter is related to entropy, which ends up turning the numerator into the free energy of a macrostate <span class="math notranslate nohighlight">\(A\)</span>: <span class="math notranslate nohighlight">\(F_A = E_A-TS_A\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[p_A =\frac{\Omega (E_A) e^{-\beta E_A}}{Z_A} = \frac{e^{-\beta F_A}}{e^{-\beta F}}\]</div>
<ul class="simple">
<li><p>The relative population of macrostates is dictated by the ratio of entropic term times Boltzmann weights which depends on free energy difference <span class="math notranslate nohighlight">\(\Delta F\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\boxed{\frac{p_B}{p_A} = e^{-\beta (F_B-F_A)}}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span> 

<span class="c1"># Compute probability to be in microstate 1 vs 2 at temperatures from kBT = 0.1 to 10</span>

<span class="c1"># Compute probability to be in state E=2 vs in state E=1 at different temperatures from kBT = 0.1 to 10</span>
</pre></div>
</div>
</div>
</div>
<section id="thermodynamic-limit-and-partition-functions">
<h3>Thermodynamic limit and partition functions<a class="headerlink" href="#thermodynamic-limit-and-partition-functions" title="Permalink to this heading">#</a></h3>
<p><strong>Partition functions</strong></p>
<ul class="simple">
<li><p>Recall that we counted microstates with equal weights <span class="math notranslate nohighlight">\(\Omega\)</span> in NVE. In other words, states were equipartitioned.</p></li>
<li><p>In NVT, states are weighted by exponential factors. In other words, low-energy states contribute more than high-energy states. The situation is more severe at low temperatures where only ground states contribute to thermodynamics.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\Omega = \sum_i w_i = \sum_i 1\]</div>
<div class="math notranslate nohighlight">
\[Z(\beta) = \sum_i w_i = \sum_i e^{-\beta E_i}\]</div>
<p><strong>Sum over microstates or macrostates</strong></p>
<ul class="simple">
<li><p>Partition function Z can be written down as a sum of microstates or macrostates. Since Energies of macrosystems vary smoothly we can also replace the sum as integral over energies</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(\beta, N, V) = \sum_i e^{-\beta E_i}= \sum_E \Omega (E) e^{-\beta E} = \int \Omega(E) e^{-\beta E}dE\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Omega(E)\sim e^N\)</span> rapidly increasing function with N because of limit theorems: e.g., the large deviation, central limit theorem, law of large numbers.</p></li>
<li><p><span class="math notranslate nohighlight">\(e^{-\beta E}\sim e^{-N}\)</span> rapidly decreasing function with N</p></li>
</ul>
<p><strong>Connection with Free energy</strong></p>
<ul class="simple">
<li><p>In the thermodynamic limit of a large number of particles and volumes, only the region of energy survives that guarantees a non-negligible contribution to the partition function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[{Z(\beta) = \int \Omega(E) e^{-\beta E}dE = \int e^{-\beta (E-T S(E))}dE }\]</div>
<div class="math notranslate nohighlight">
\[{Z(\beta) = \int e^{-\beta (E-TS)}dE \approx e^{min_E [-\beta(E-TS)]} = e^{-\beta(U-TS)} = e^{-\beta F}}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(U =\langle E \rangle\)</span> is the thermodynamic average energy, fluctuations around which are on the order of <span class="math notranslate nohighlight">\(O(N^{1/2})\)</span></p></li>
<li><p>It can be seen that <span class="math notranslate nohighlight">\(Z\)</span>, the partition function of NVT is <strong>Laplace Transform</strong> of the density of states of NVE.</p></li>
<li><p>The connection between energy and free energy <span class="math notranslate nohighlight">\(F= U -TS\)</span> is via <strong>Legendre Transform</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">N</span><span class="o">=</span><span class="mi">10</span>
<span class="n">kbT</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">omega</span>  <span class="o">=</span> <span class="n">E</span><span class="o">**</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">boltzf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">E</span><span class="o">/</span><span class="n">kbT</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\Omega(E)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">boltzf</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$exp(-E/k_B T)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">omega</span><span class="o">*</span><span class="n">boltzf</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\Omega(E) exp(-E/k_B T)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$E$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="computing-z-via-classical-mechanics">
<h2>Computing Z via classical mechanics<a class="headerlink" href="#computing-z-via-classical-mechanics" title="Permalink to this heading">#</a></h2>
<p><strong>Integrals over phase space</strong></p>
<ul class="simple">
<li><p>In quantum mechanics counting microsites is easy, we have discrete energies and  could simply sum over microstates to compute partition functions <span class="math notranslate nohighlight">\(Z=\sum_i e^{-\beta E_i}\)</span></p></li>
<li><p>Counting microstates in classical mechanics is done by discretizing phase space <span class="math notranslate nohighlight">\(\Gamma = (x^{3N}, p^{3N})\)</span> into small cubes of units <span class="math notranslate nohighlight">\(dx^Ndp^N\sim h^N\)</span>. In other words, we replace summation over quantum states with integral over phase space <span class="math notranslate nohighlight">\(\sum_i \rightarrow \int \frac{dpdx}{h}\)</span></p></li>
<li><p>Recall that we need to correct classical mechanics for “double counting” microstates if we have N indistinguishable “particles” with a factor of <span class="math notranslate nohighlight">\(N!\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\Omega(E) = \frac{1}{N! h^{3N}} \int_{\Gamma}  \delta \big( H(\Gamma)-E) d \Gamma\]</div>
<div class="math notranslate nohighlight">
\[Z(\beta) = \int_{E} \Omega(E) e^{-\beta E} dE  = \frac{1}{N! h^{3N}} \int_{\Gamma} \Bigg[\int_{E} d \Gamma \delta \big( H(\Gamma)-E) e^{-\beta E}dE \Bigg] d\Gamma\]</div>
<ul class="simple">
<li><p>We thus obtain an expression of partition function expressed as integral over phase-space. This expression will be useful for computing partition functions of atomic and molecular gasses with simple Hamiltonian functions.</p></li>
<li></li>
</ul>
<div class="math notranslate nohighlight">
\[\boxed{Z(\beta) = \frac{1}{N! h^{3N}} \int_{\Gamma} e^{-\beta H(\Gamma)} d\Gamma}\]</div>
</section>
<section id="fluctuation-response-theorem-and-ensemble-equivalence">
<h2>Fluctuation-response theorem and ensemble equivalence<a class="headerlink" href="#fluctuation-response-theorem-and-ensemble-equivalence" title="Permalink to this heading">#</a></h2>
<div class="tip dropdown admonition">
<p class="admonition-title"><strong>Deriving average and fluctuation expression for energy</strong></p>
<p><strong>Average Energy</strong></p>
<ul class="simple">
<li><p>Having determined probability distribution over microstates, we can calculate the mean value of energy, which corresponds to the energy in thermodynamics.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \langle E \rangle = \sum_{i} P_i E_i \]</div>
<ul class="simple">
<li><p>where <span class="math notranslate nohighlight">\(P_i = \frac{e^{-\beta E_i}}{Z}\)</span> is the probability of the system being in state <span class="math notranslate nohighlight">\(i\)</span>. Plugging the expression of <span class="math notranslate nohighlight">\(P_i\)</span> we get</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \langle E \rangle = \sum_{i} \frac{e^{-\beta E_i}}{Z} E_i = \frac{1}{Z} \sum_{i} E_i e^{-\beta E_i} = \frac{1}{Z} \frac{\partial}{\partial (-\beta)} \sum_{i} e^{-\beta E_i} =\frac{1}{Z} \frac{\partial}{\partial (-\beta)} Z =   - \frac{\partial log Z}{\partial \beta}\]</div>
<ul class="simple">
<li><p>We thus find that <span class="math notranslate nohighlight">\( \langle E \rangle\)</span> can be obtained by taking the derivative of <span class="math notranslate nohighlight">\(-\log Z\)</span> with respect to <span class="math notranslate nohighlight">\(\beta\)</span>:</p></li>
</ul>
<p><strong>Heat Capacity</strong></p>
<ul class="simple">
<li><p>The heat capacity at constant volume <span class="math notranslate nohighlight">\(C_V\)</span> is defined as the derivative of the average energy with respect to temperature:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ C_V = \left( \frac{\partial \langle E \rangle}{\partial T} \right)_V \]</div>
<ul class="simple">
<li><p>Using the chain rule, <span class="math notranslate nohighlight">\(C_V\)</span> can be expressed as:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ C_V = \frac{\partial \langle E \rangle}{\partial \beta} \frac{\partial \beta}{\partial T} \]</div>
<ul class="simple">
<li><p>Since <span class="math notranslate nohighlight">\(\beta = \frac{1}{k_B T}\)</span>, we have <span class="math notranslate nohighlight">\(\frac{\partial \beta}{\partial T} = -\frac{1}{k_B T^2}\)</span>. taking the derivative of <span class="math notranslate nohighlight">\(\langle E \rangle\)</span> with respect to <span class="math notranslate nohighlight">\(\beta\)</span> gives:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \frac{\partial \langle E \rangle}{\partial \beta} = \frac{\partial}{\partial \beta} \left( -\frac{1}{Z} \frac{\partial Z}{\partial \beta} \right) \]</div>
<ul class="simple">
<li><p>Simplifying this derivative and substituting <span class="math notranslate nohighlight">\(\frac{\partial \beta}{\partial T}\)</span> yields the heat capacity:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ C_V = -k_B \beta^2 \frac{\partial^2 \ln Z}{\partial \beta^2} \]</div>
</div>
<ul class="simple">
<li><p>Mean and fluctuation of energy are computed from partition function as first and second derivatives (see derivation above)</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\langle E \rangle = -\frac{\partial log Z}{\partial (\beta)}\]</div>
<ul class="simple">
<li><p>The relationship between fluctuations and heat capacity is known as <strong>fluctuation-response theorem</strong> in statistical mechanics</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\sigma^2_E = \frac{\partial^2 log Z}{\partial \beta^2}  = k_BT^2 C_v\]</div>
<ul class="simple">
<li><p>The fluctuations in energy are small relative to the mean. This shows that thermodynamic quantities computed in NVE and NVT should not differ in the thermodynamic limit of large systems! Thus, we are free to choose any convenient ensemble if we want to calculate, let’s say, temperature dependence on entropy.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{\sigma_E}{\langle E\rangle} = \frac{(k_BT^2 C_v)^{1/2}}{\langle E\rangle}\sim O(N^{-1/2})\]</div>
</section>
<section id="the-power-and-utility-of-nvt-the-non-interacting-system">
<h2>The power and utility of NVT: The non-interacting system<a class="headerlink" href="#the-power-and-utility-of-nvt-the-non-interacting-system" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>For the independent particle system, the energy of each particle enter the total energy of the system additively.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[E(\epsilon_1, \epsilon_2, ... \epsilon_N) = \epsilon_1+\epsilon_2+...\epsilon_N\]</div>
<ul class="simple">
<li><p>The exponential factor in the partition function allows decoupling particle contributions <span class="math notranslate nohighlight">\(e^{-\beta{(\epsilon_1+\epsilon_2)}} = e^{-\beta{\epsilon_1}}e^{-\beta{\epsilon_2}}\)</span>. This means that the partition function can be written as the product of the partition functions of individual particles!</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z = \sum^{n=N}_{n=0} e^{-\beta E_n} =  \Big (\sum^{i=1}_{i=0} e^{-\beta \epsilon_i} \Big)\Big (\sum^{i=1}_{i=0} e^{-\beta \epsilon_i} \Big)...\Big (\sum^{i=1}_{i=0} e^{-\beta \epsilon_i} \Big)= z_1 \cdot z_2 \cdot z_3 ... z_N\]</div>
<p><strong>Distinguishable states</strong>:</p>
<div class="math notranslate nohighlight">
\[Z = z_1 \cdot z_2 \cdot z_3 ... z_N\]</div>
<p><strong>Indistinguishable states</strong>:</p>
<div class="math notranslate nohighlight">
\[ Z = \frac{1}{N!}z^N \]</div>
<div class="tip admonition">
<p class="admonition-title"><strong>General strategy for using NVT for simple non-interacting systems</strong></p>
<ol class="arabic simple">
<li><p>Compute the <strong>single particle partition function</strong> <span class="math notranslate nohighlight">\(z= e^{-\beta \epsilon_1}+  e^{-\beta \epsilon_2}+ ...\)</span></p></li>
<li><p>To compute <strong>full partition function</strong>, raise z to the power of N and apply factorial in case of indistinguishable particles  <span class="math notranslate nohighlight">\(Z = \frac{1}{N!}z\)</span> or take product in case of distinguishable identical particles <span class="math notranslate nohighlight">\(z^N\)</span></p></li>
<li><p>Compute the <strong>free energy</strong> <span class="math notranslate nohighlight">\(F= - k_B T log Z\)</span></p></li>
<li><p>Take <strong>derivatives of free energy</strong> to get the thermodynamic quantities. E.g one is often interested in computing temperature dependence of <span class="math notranslate nohighlight">\(\mu(T), U(T), S(T)\)</span></p></li>
</ol>
</div>
<section id="example-1-a-two-state-model-in-nve-vs-nvt-ensemble">
<h3>Example-1: A two-state model in NVE vs NVT ensemble<a class="headerlink" href="#example-1-a-two-state-model-in-nve-vs-nvt-ensemble" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>NVE</strong>
Let us consider a simple two-level system where lower level <span class="math notranslate nohighlight">\(\epsilon_0 = 0\)</span> and upper level <span class="math notranslate nohighlight">\(\epsilon_1 =\epsilon\)</span>. We will now use <span class="math notranslate nohighlight">\(NVE\)</span> ensemble to obtain thermodynamic quantities <span class="math notranslate nohighlight">\((S, T, C_v)\)</span> and then obtain the same quantities with <span class="math notranslate nohighlight">\(NVT\)</span>.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[E = n\epsilon\]</div>
<div class="math notranslate nohighlight">
\[\Omega(E) = \frac{N!}{(N-n)! n!}\]</div>
<div class="math notranslate nohighlight">
\[S = k_B log \Omega(E) = N k_B \Big [- \frac{n}{N}log \frac{n}{N} - \frac{N-n}{N}log \frac{N-n}{N} \Big]\]</div>
<div class="math notranslate nohighlight">
\[\frac{1}{T} = \frac{\partial S(E)}{\partial E} =  \frac{k_B}{\epsilon}\frac{\partial log\Omega(n)}{\partial  n} = \frac{k_B}{\epsilon}log \frac{N-n}{N}\]</div>
<div class="math notranslate nohighlight">
\[\frac{n}{N} = \frac{1}{1+e^{\beta \epsilon}}\]</div>
<div class="math notranslate nohighlight">
\[E = n\epsilon = \frac{N\epsilon}{1+e^{\beta \epsilon}}\]</div>
<ul class="simple">
<li><p><strong>NVT</strong> Solving a two-state system in an NVT ensemble is much easier because the partition function decouples into single particle contributions.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z = \sum^{n=N}_{n=0} e^{-\beta E_n}  = (1+e^{-\beta \epsilon})^N\]</div>
<div class="math notranslate nohighlight">
\[F= -k_B T log Z = -k_BT N log(1+e^{-\beta \epsilon})\]</div>
<div class="math notranslate nohighlight">
\[\langle E \rangle  = \frac{\partial log Z}{\partial (-\beta)} =  \frac{N\epsilon}{1+e^{\beta \epsilon}}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">interact</span>

<span class="nd">@interact</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">E_two_sys</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">N</span>       <span class="o">=</span> <span class="mi">1</span>
    <span class="n">kbT</span>     <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="n">eps</span>
    <span class="n">E_eps</span>   <span class="o">=</span> <span class="n">N</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">kbT</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kbT</span><span class="p">,</span> <span class="n">E_eps</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$k_B T/\epsilon$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$E/\epsilon$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "447748be1ca247acb8f7d664e02ecebf", "version_major": 2, "version_minor": 0}</script></div>
</div>
</section>
<section id="example-2-ideal-gas-classical">
<h3>Example-2: Ideal gas (classical)<a class="headerlink" href="#example-2-ideal-gas-classical" title="Permalink to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[H(p^N, x^N) = K(p^N)  = \sum^{i=N}_{i=1}\frac{p^2_i}{2m}\]</div>
<div class="math notranslate nohighlight">
\[\boxed{Z(\beta) = \frac{1}{h^{N} N!} \int dp^N dx^N e^{-\beta H(p^N,x^N)}}\]</div>
<p><strong>Partition function for a single atom</strong></p>
<ul class="simple">
<li><p>Let us evaluate the partition function for a single particle in 3D:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(\beta) =  \Bigg [\frac{1}{h} \int_{L} dx \int^{+\infty}_{-\infty} dp e^{-\beta \frac{p^2}{2m}}  \Bigg ]^3 = V \Big [ \frac{2\pi m}{h \beta} \Big]^{3/2} = V n_Q\]</div>
<p><strong>On the validity of classical approximation</strong></p>
<ul class="simple">
<li><p>We wrote down the partition sum in terms of the volume of the container and a quantum density <span class="math notranslate nohighlight">\(n_Q\)</span></p></li>
<li><p>As long as interatomic distances are larger than De-Broglie thermal wavelength, classical approximation is good</p></li>
</ul>
<div class="math notranslate nohighlight">
\[n_Q = \Big [ \frac{m k_B T}{2 \hbar^2} \Big]^{3/2} = \frac{1}{\lambda^3_T}\]</div>
<div class="math notranslate nohighlight">
\[\lambda_T = \frac{h}{2mk_BT} \sim \frac{h}{m \bar{v}}\]</div>
<p><strong>Partition function for N atoms</strong></p>
<div class="math notranslate nohighlight">
\[Z = \frac{Z^N}{N!}  = \frac{(V n_Q)^N}{N!}\]</div>
<ul class="simple">
<li><p>Using the curdest version of Striling’s approximation <span class="math notranslate nohighlight">\(N!\approx N^N e^{-N}\)</span> and denoting <span class="math notranslate nohighlight">\(n = N/V\)</span> as the density we get</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z = \Big[ \frac{n_Q}{n}\Big]^N e^N\]</div>
<div class="math notranslate nohighlight">
\[F = -k_B T log Z = -N k_B T  log \Big( \frac{n_Q}{n} \Big) - Nk_BT\]</div>
<ul class="simple">
<li><p>We can also calculate entropy and other thermodynamic quantities and compare with expressions obtained in NVE</p></li>
</ul>
<div class="math notranslate nohighlight">
\[S = -\Big( \frac{\partial F}{\partial T}\Big)_{N,V} = Nk_B log \Big( \frac{n_Q}{n} \Big) + Nk_B + \frac{3}{2}Nk_B\]</div>
<p><strong>Entropy</strong>
$<span class="math notranslate nohighlight">\(S = Nk_B \Bigg[log \Big( \frac{n_Q}{n} \Big)+ \frac{5}{2} \Bigg]\)</span>$</p>
<p><strong>Mean energy</strong></p>
<div class="math notranslate nohighlight">
\[U = \frac{\partial log Z}{\partial (-\beta)} = \frac{3}{2}N k_B T\]</div>
<p><strong>Pressure and ideal gas law</strong>
$<span class="math notranslate nohighlight">\(p = -\frac{\partial F}{\partial V} =\frac{N k_B T}{V}\)</span>$</p>
<p><strong>Chemical potential</strong></p>
<div class="math notranslate nohighlight">
\[\mu = k_B T \cdot log  \Big(\frac{n}{n_Q(T)}\Big)\]</div>
</section>
<section id="example-3-ideal-paramagnet-of-spin-1-2">
<h3>Example-3 Ideal paramagnet of spin 1/2<a class="headerlink" href="#example-3-ideal-paramagnet-of-spin-1-2" title="Permalink to this heading">#</a></h3>
<p>Consider N independent spins in magnetic field <span class="math notranslate nohighlight">\(B\)</span>. Each <span class="math notranslate nohighlight">\(s_j = \pm 1\)</span> spin variable can assume two values that we refer to as up and down.</p>
<div class="math notranslate nohighlight">
\[E  = -\mu B \sum^{N}_j s_j \]</div>
<p><strong>Partition function of a single spin</strong></p>
<div class="math notranslate nohighlight">
\[Z_1 = \sum_{s_1} e^{\beta \mu B s_1} = e^{\beta \mu B} + e^{-\beta \mu B}  = 2 cosh(\beta \mu B)\]</div>
<p><strong>Partition function of N spins</strong></p>
<div class="math notranslate nohighlight">
\[Z =Z_1^N\]</div>
<p><strong>Free energy</strong></p>
<div class="math notranslate nohighlight">
\[ F(T, B) = - \beta^{-1} log Z = - N \beta^{-1} log \Big [ 2 cosh (\beta \mu B )  \Big ]\]</div>
<p><strong>Entropy</strong></p>
<div class="math notranslate nohighlight">
\[S = - \Big(\frac{\partial F}{\partial T} \Big)_B = k_B log \Big [ 2 cosh (\beta \mu H )  \Big ] - k_B (\beta \mu B)\cdot tanh (\beta \mu B)\]</div>
<p><strong>Magnetization</strong></p>
<p>Magnetization <span class="math notranslate nohighlight">\(M\)</span> (extensive quantity) or magnetization per particle <span class="math notranslate nohighlight">\(m=M/N\)</span> (intensive quantity) is given as another free energy derivative:</p>
<div class="math notranslate nohighlight">
\[M = - \Big(\frac{\partial F}{\partial B} \Big)_T = \mu tanh \Big(\beta \mu B \Big)\]</div>
<p><strong>Magnetizatic susceptibility</strong></p>
<p>In the context of paramagnet, we have another response function in the form of magnetic susceptibility.</p>
<div class="math notranslate nohighlight">
\[\chi(T, B) =  \Big(\frac{\partial m}{\partial B} \Big)_T = \mu^2 \beta B cosh^{-2} (\beta \mu B)\]</div>
<p>which leads to a well-known <strong>Curie Law</strong></p>
<div class="math notranslate nohighlight">
\[\chi(T, B=0) = \frac{\mu^2 }{k_B T}\]</div>
<p>Finally, as a consistency check we can combine entropy and free energy expressions to obtain internal energy:</p>
<div class="math notranslate nohighlight">
\[U = F+TS = -\mu B tanh(\beta \mu B)\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="k">for</span> <span class="n">beta</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">beta</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$m/\mu$&#39;</span><span class="p">)</span>    
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;B&#39;)
</pre></div>
</div>
<img alt="../_images/b1ebcc509ad7dc9fd2c1aeca647430adda3d5c6dd52979e668e91db7cf00fc1d.png" src="../_images/b1ebcc509ad7dc9fd2c1aeca647430adda3d5c6dd52979e668e91db7cf00fc1d.png" />
</div>
</div>
</section>
</section>
<section id="non-interacting-molecules">
<h2>Non-interacting molecules<a class="headerlink" href="#non-interacting-molecules" title="Permalink to this heading">#</a></h2>
<section id="translational-degrees-of-freedom-particle-in-a-box">
<h3>Translational degrees of freedom: particle in a box<a class="headerlink" href="#translational-degrees-of-freedom-particle-in-a-box" title="Permalink to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[E_{n_x, n_y, n_z} = \frac{\hbar^2 \pi^2}{2m L^2} \big(n^2_x+n^2_y+n^2_z \big)\]</div>
<div class="math notranslate nohighlight">
\[ Z \approx \Bigg [\int^{\infty}_0 dn e^{-\frac{\hbar^2 \pi^2}{2m k_B TL^2}n^2} \Bigg]^{3} = V \Bigg[\frac{m k_B T}{2\pi \hbar^2} \Bigg]^{3/2} =  V n_Q\]</div>
<ul class="simple">
<li><p>For <span class="math notranslate nohighlight">\(N\)</span> molecules in a box</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z= \frac{(V n_Q)^N}{N!}\]</div>
</section>
<section id="rotatational-degrees-of-freedom-rigid-rotor-model">
<h3>Rotatational degrees of freedom: Rigid rotor model<a class="headerlink" href="#rotatational-degrees-of-freedom-rigid-rotor-model" title="Permalink to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[E = \frac{\hbar^2}{2I} J (J+1) \]</div>
<div class="math notranslate nohighlight">
\[Z \approx \int^{J=\infty}_{J=0} (2J+1)e^{-\Big[\beta \frac{\hbar^2}{2I} J (J+1)\Big]}\approx \frac{T}{\theta_{rot}}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(\theta_{rot} = \frac{\hbar^2}{2 I_0 k_B}\)</span> is called rotational temperature.</p></li>
</ul>
</section>
<section id="vibrational-degrees-of-freedom-harmonic-oscillator-model">
<h3>Vibrational degrees of freedom: Harmonic oscillator model<a class="headerlink" href="#vibrational-degrees-of-freedom-harmonic-oscillator-model" title="Permalink to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[E_n = \hbar \omega (n+1/2)\]</div>
<div class="math notranslate nohighlight">
\[z = \sum^{n=+\infty}_{n=0} = e^{-\frac{1}{2}\beta \hbar \omega} (1 + e^{-\beta\hbar\omega}+e^{-2\beta\hbar\omega}+...) = \frac{e^{-\frac{1}{2}\beta \hbar \omega}}{1-e^{-\beta\hbar\omega}}\]</div>
<div class="math notranslate nohighlight">
\[Z = z^N\]</div>
<div class="math notranslate nohighlight">
\[E = \frac{\partial log Z}{\partial (-\beta)} = N\hbar \omega \Big(\frac{1}{2}+ \frac{1}{1+e^{\beta\hbar\omega}} \Big) \]</div>
<ul class="simple">
<li><p>When <span class="math notranslate nohighlight">\(T \rightarrow 0\)</span> we are left with zero point energies <span class="math notranslate nohighlight">\(E \rightarrow \frac{N \hbar \omega}{2}\)</span></p></li>
<li><p>When <span class="math notranslate nohighlight">\(T \rightarrow \infty\)</span> we get equipartion of energy! <span class="math notranslate nohighlight">\(E \rightarrow \frac{3}{2} N k_B T\)</span></p></li>
</ul>
</section>
<section id="partition-function-for-a-molecular-gas">
<h3>Partition function for a molecular gas<a class="headerlink" href="#partition-function-for-a-molecular-gas" title="Permalink to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[E = E_{transl}+E_{vib}+E_{rot}+E_{elec} \]</div>
<div class="math notranslate nohighlight">
\[Z = Z_{transl} Z_{vib} Z_{rot} Z_{elec} \]</div>
</section>
<section id="equipartion-theorem">
<h3>Equipartion theorem<a class="headerlink" href="#equipartion-theorem" title="Permalink to this heading">#</a></h3>
<p>Finally, we can also prove a powerful general result showing us that each degree of freedom that appears in Hamiltonian as a quadratic function, e.g., <span class="math notranslate nohighlight">\(kx^2\)</span>, contributes on average <span class="math notranslate nohighlight">\(\frac{1}{2}k_BT\)</span> of energy. Hence we can count degrees of freedom and write down average energy!</p>
<div class="math notranslate nohighlight">
\[U(x) = kx^2 \]</div>
<div class="math notranslate nohighlight">
\[\langle U \rangle = \int p(x) U(x) dx = \frac{\int kx^2 e^{-\beta kx^2}dx}{\int e^{-\beta kx^2}dx} = \frac{k_B T}{2}\]</div>
<ul class="simple">
<li><p>The answer is found quickly by identifying variance <span class="math notranslate nohighlight">\(\sigma^2\)</span> in gaussian function with zero mean <span class="math notranslate nohighlight">\(e^{\frac{-x^2}{2\sigma^2}}\)</span></p></li>
<li><p>Notice the spring constant does not figure in the average energy expression!</p></li>
</ul>
<p><strong>Example</strong> Calculate heat capacity of diatomic gas.</p>
</section>
</section>
<section id="problems">
<h2>Problems<a class="headerlink" href="#problems" title="Permalink to this heading">#</a></h2>
<section id="problem-1-elementary-derivation-of-boltzmanns-distirbution">
<h3>Problem-1 Elementary derivation of Boltzmann’s distirbution<a class="headerlink" href="#problem-1-elementary-derivation-of-boltzmanns-distirbution" title="Permalink to this heading">#</a></h3>
<p>Let us do an elementary derivation of Boltzman distribution showing that when a macroscopic system is in equilibrium and coupled to a heat bath at temperatere <span class="math notranslate nohighlight">\(T\)</span> we have a universal dependence of probability for finding system at different energies:</p>
<div class="math notranslate nohighlight">
\[\boxed{P(r')/P(r)=e^{-\beta (U(r)-U(r'))}}\]</div>
<p>The essence of the derivation is this. Consider a vertical column of gas somehre in the mountains.</p>
<ul class="simple">
<li><p>On one hand we have graviational force which acts on a column between <span class="math notranslate nohighlight">\(h, h+dh\)</span> with cross section <span class="math notranslate nohighlight">\(A\)</span>.</p></li>
<li><p>On the other hand we have pressure balance which thankfully keeps the molecules from dropping on the ground.</p></li>
<li><p>This means that we have a steady density of molecules at each distance <span class="math notranslate nohighlight">\(n(h)\)</span> for a fixed <span class="math notranslate nohighlight">\(T\)</span>. Write down this balance of forces (gravitational vs pressure ) and find show how density at <span class="math notranslate nohighlight">\(h\)</span>, <span class="math notranslate nohighlight">\(n(h)\)</span> is related to density at <span class="math notranslate nohighlight">\(h=0\)</span>, <span class="math notranslate nohighlight">\(n(0)\)</span>.</p></li>
</ul>
<blockquote>
<div><p>Tip: you may use <span class="math notranslate nohighlight">\(P=nkT\)</span> for pressure and <span class="math notranslate nohighlight">\(mgh\)</span> for the gravitational force)</p>
</div></blockquote>
</section>
<section id="problem-2-three-level-system">
<h3>Problem-2 Three level system<a class="headerlink" href="#problem-2-three-level-system" title="Permalink to this heading">#</a></h3>
<p>Consider a system of N classical and non-interacting particles in contact with a thermal reservoir at a temperature <span class="math notranslate nohighlight">\(T\)</span>. Each particle can have be in three states with energy <span class="math notranslate nohighlight">\(0\)</span>, <span class="math notranslate nohighlight">\(\epsilon\)</span> or <span class="math notranslate nohighlight">\(3\epsilon\)</span> where <span class="math notranslate nohighlight">\(\epsilon&gt;0\)</span>.</p>
<ul class="simple">
<li><p>Obtain an expression for <span class="math notranslate nohighlight">\(Z\)</span> then compute the average and fluctuation of energy.</p></li>
<li><p>Plot the heat capacity as a function of temperature <span class="math notranslate nohighlight">\(C_v(T)\)</span></p></li>
<li><p>Plot the average enegy as a function of temperature <span class="math notranslate nohighlight">\(U(T)\)</span></p></li>
<li><p>Plot the entropy as a function of temperature <span class="math notranslate nohighlight">\(S(T)\)</span>.</p></li>
</ul>
</section>
<section id="problem-3-spins-on-a-lattice">
<h3>Problem-3 Spins on a lattice<a class="headerlink" href="#problem-3-spins-on-a-lattice" title="Permalink to this heading">#</a></h3>
<p>Consider <span class="math notranslate nohighlight">\(N\)</span> lattice sites which have quantum spins <span class="math notranslate nohighlight">\(s=1\)</span> (not to be confused with entropy) with a mangnetic moment <span class="math notranslate nohighlight">\(\mu\)</span>. Spins are subject to a uniform mangeitc field in z direction <span class="math notranslate nohighlight">\(B=B_z\)</span> making the energy of each spin <span class="math notranslate nohighlight">\(-\mu B m \)</span> where <span class="math notranslate nohighlight">\(m\)</span> is the magnetic quantum number thattakes on three possible values <span class="math notranslate nohighlight">\(m=0, \pm 1\)</span>.</p>
<ul class="simple">
<li><p>Compute the entropy <span class="math notranslate nohighlight">\(S\)</span> and the mangeitzation of the system <span class="math notranslate nohighlight">\(M\)</span></p></li>
<li><p>Plot entropy as a function of temperatures and study the limit of low temperatures <span class="math notranslate nohighlight">\(S(T\rightarrow 0)\)</span></p></li>
</ul>
</section>
<section id="problem-4-2d-diploes-on-a-lattice">
<h3>Problem-4 2D diploes on a lattice<a class="headerlink" href="#problem-4-2d-diploes-on-a-lattice" title="Permalink to this heading">#</a></h3>
<p>Consider a 2D square lattice with <span class="math notranslate nohighlight">\(M\)</span> lattice points. On each point we have a mangeetic moment that can point in four possible directions: <span class="math notranslate nohighlight">\(+x, -x, +y, -y\)</span>. Along <span class="math notranslate nohighlight">\(y\)</span> axis, the dipole has the energy <span class="math notranslate nohighlight">\(\epsilon&gt;0\)</span> and along the x axis <span class="math notranslate nohighlight">\(\epsilon=0\)</span>.</p>
<p>Dipoles are not interacting with each other and we also ingnore kinetic energy of diplos since they are fixed at lattice positions.</p>
<ul class="simple">
<li><p>Write down parition function for this system <span class="math notranslate nohighlight">\(Z\)</span></p></li>
<li><p>Compute the average energy.</p></li>
<li><p>Compute entropy per dipole <span class="math notranslate nohighlight">\(s(T)\)</span>. Evaluate the difference <span class="math notranslate nohighlight">\(S(T=\infty)-S(T=0)\)</span>? Can you see a link with number of arrangements of dipols?</p></li>
<li><p>Compute microcanonical partition function <span class="math notranslate nohighlight">\(\Omega (N\epsilon)\)</span></p></li>
<li><p>Show that we get the same entropy expression by using <span class="math notranslate nohighlight">\(NVE\)</span> and <span class="math notranslate nohighlight">\(NVT\)</span> ensembles.</p></li>
</ul>
</section>
<section id="problem-5-a-typical-spin-problem">
<h3>Problem-5 A typical spin problem<a class="headerlink" href="#problem-5-a-typical-spin-problem" title="Permalink to this heading">#</a></h3>
<p>Due to a ligand field, the degeneracy of d-orbital of chromium ion <span class="math notranslate nohighlight">\(Cr^{3+}\)</span> is partially lifted. The spin part of the hamiltonian that lifts this degeneracy has the following form.</p>
<div class="math notranslate nohighlight">
\[H =  D \big(S_z^2 -S(S+1)/2 \big)\]</div>
<p>Where <span class="math notranslate nohighlight">\(D&gt;0\)</span> is some constant and <span class="math notranslate nohighlight">\(S=3/2\)</span> (the cation has an electronic term <span class="math notranslate nohighlight">\({F}^ 4_{3/2}\)</span></p>
<ul class="simple">
<li><p>Conceptual question: Why can we apply statisical mechanics to a “single” ion?</p></li>
<li><p>Obtain the occupation probability of each discrete energy level <span class="math notranslate nohighlight">\(P(E)\)</span>.</p></li>
<li><p>Calculate the entropy and the specific heat then show that heat capacity behaves as <span class="math notranslate nohighlight">\(T^{-2}\)</span> at high temperatures.</p></li>
<li><p>Supose heat capacity is <span class="math notranslate nohighlight">\(C=k_b \Big(\frac{T}{T_0} \Big)^2\)</span> with <span class="math notranslate nohighlight">\(T_0=0.18 K\)</span> at higher temperatures. Determine the energy spacing.</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./3_ensembles"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="nve.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">NVE</p>
      </div>
    </a>
    <a class="right-next"
       href="npt.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">muPT</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#beta-and-kt-energy"><span class="math notranslate nohighlight">\(\beta\)</span> and kT (energy)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#micro-vs-macro-states">Micro vs macro states</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermodynamic-limit-and-partition-functions">Thermodynamic limit and partition functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-z-via-classical-mechanics">Computing Z via classical mechanics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fluctuation-response-theorem-and-ensemble-equivalence">Fluctuation-response theorem and ensemble equivalence</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-power-and-utility-of-nvt-the-non-interacting-system">The power and utility of NVT: The non-interacting system</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-a-two-state-model-in-nve-vs-nvt-ensemble">Example-1: A two-state model in NVE vs NVT ensemble</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-ideal-gas-classical">Example-2: Ideal gas (classical)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-ideal-paramagnet-of-spin-1-2">Example-3 Ideal paramagnet of spin 1/2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-interacting-molecules">Non-interacting molecules</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#translational-degrees-of-freedom-particle-in-a-box">Translational degrees of freedom: particle in a box</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rotatational-degrees-of-freedom-rigid-rotor-model">Rotatational degrees of freedom: Rigid rotor model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vibrational-degrees-of-freedom-harmonic-oscillator-model">Vibrational degrees of freedom: Harmonic oscillator model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partition-function-for-a-molecular-gas">Partition function for a molecular gas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equipartion-theorem">Equipartion theorem</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems">Problems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-1-elementary-derivation-of-boltzmanns-distirbution">Problem-1 Elementary derivation of Boltzmann’s distirbution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-2-three-level-system">Problem-2 Three level system</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-3-spins-on-a-lattice">Problem-3 Spins on a lattice</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-4-2d-diploes-on-a-lattice">Problem-4 2D diploes on a lattice</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-5-a-typical-spin-problem">Problem-5 A typical spin problem</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Davit Potoyan
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>