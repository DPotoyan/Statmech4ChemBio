
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NVT &#8212; Statistical Mechanics for Chemistry and Biology</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="\(\mu V T\)" href="npt.html" />
    <link rel="prev" title="NVE" href="nve.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Statistical Mechanics for Chemistry and Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   About
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../0_python/intro.html">
   Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2py.html">
     Python3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2numpy.html">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../0_python/intro2viz.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_stats/intro.html">
   Stats
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/01_SetsCounting.html">
     Probability by counting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_RandVar.html">
     Random variable, stochastic process and simulation.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/02_Diffusion.html">
     Brownian motion and Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/03_MC.html">
     Monte Carlo and “the power of randomness”
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/RW_theory.html">
     Appendix A: Large N approximations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/04_LimitTheorems.html">
     Appendix B: Limit theorems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_stats/05_InverseTransform.html">
     Appendix C: The Inverse Transform of RVs
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../2_thermo/intro.html">
   Thermodynamics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/01_Thermo.html">
     Review of thermodynamics principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../2_thermo/02_Legendre.html">
     Legendre transform
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Ensembles
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="phase_space.html">
     Phase Space
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nve.html">
     NVE
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     NVT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="npt.html">
     <span class="math notranslate nohighlight">
      \(\mu V T\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ensemble_overview.html">
     Overview of ensembles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_ideal_systems/intro.html">
   Gases
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/quantum_systems.html">
     Quantum non-interacting systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_ideal_systems/photons_phonons.html">
     Photons and Phonons
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_entropy/intro.html">
   Entropy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/shannon.html">
     What is Information?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_entropy/landauer.html">
     Information erasure and Landauer’s principle
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../6_ising/intro.html">
   Phase transitions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_ising/01_MCMC.html">
     Ising models and Metropolis algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_ising/02_ising_analytic.html">
     Phase transitions through the lense of Ising models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_ising/03_MeanField.html">
     Mean Field Theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_ising/04_EnhanceSampl.html">
     Non-boltzman (enhanced) sampling ideas
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_fluids/intro.html">
   Fluids
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2Fluids.html">
     Statistical mechanics of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/mc_lj.html">
     MC simulations of fluids
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/Intro2MD.html">
     Molecular Dynamics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_fluids/md_lj.html">
     MD simulations of fluids
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/3_ensembles/nvt.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/3_ensembles/nvt.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/3_ensembles/nvt.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#going-from-an-isolated-system-e-const-to-a-system-coupled-to-thermostat-t-const">
   Going from an isolated system (E=const) to a system coupled to thermostat (T=const)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#probability-of-a-microstate">
   Probability of a microstate
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computing-z-via-classical-vs-quantum-mechanics">
   Computing Z via classical vs quantum mechanics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-closer-look-at-the-the-partiation-function-z">
   A closer look at the the partiation function Z
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-free-energy-is-a-central-quantity-in-the-nvt-ensemble">
   Why free energy is a central quantity in the NVT ensemble.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#logz-is-a-cumulant-generating-function">
   logZ is a  cumulant generating function!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-and-fluctuations-of-energy">
   Mean and fluctuations of Energy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#microscopic-origins-of-quasistatic-process-heat-work-and-entropy">
   Microscopic origins of quasistatic process, heat, work and entropy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-power-and-utility-of-nvt-the-non-interacting-system">
   The power and utility of NVT: The non-interacting system
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ensemble-equivalence">
   Ensemble equivalence
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1-a-two-state-model">
     Example-1: A two state model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parition-function-decouples-non-interacting-terms-in-energy">
     Parition function decouples non-interacting terms in energy!
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2-ideal-gas-classical">
     Example-2: Ideal gas (classical)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-3-ideal-paramagnet-of-spin-1-2">
     Example-3 Ideal paramagnet of spin 1/2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#non-interacting-atomic-and-molecular-gases">
   Non-interacting atomic and molecular gases
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#translational-degrees-of-freedom-particle-in-a-box">
     Translational degrees of freedom: particle in a box
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rotatational-degrees-of-freedom-rigid-rotor-model">
     Rotatational degrees of freedom: Rigid rotor model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vibrational-degrees-of-freedom-harmonic-oscillator-model">
     Vibrational degrees of freedom: Harmonic oscillator model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#partition-function-for-a-molecular-gas">
     Partition function for a molecular gas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#equipartion-theorem">
     Equipartion theorem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#entropy-of-mixing">
     Entropy of mixing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problems">
   Problems
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-1-elementary-derivation-of-boltzmanns-distirbution">
     Problem-1 Elementary derivation of Boltzmann’s distirbution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-2-three-level-system">
     Problem-2 Three level system
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-3-spins-on-a-lattice">
     Problem-3 Spins on a lattice
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-4-2d-diploes-on-a-lattice">
     Problem-4 2D diploes on a lattice
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-5-a-typical-spin-problem">
     Problem-5 A typical spin problem
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>NVT</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#going-from-an-isolated-system-e-const-to-a-system-coupled-to-thermostat-t-const">
   Going from an isolated system (E=const) to a system coupled to thermostat (T=const)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#probability-of-a-microstate">
   Probability of a microstate
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#computing-z-via-classical-vs-quantum-mechanics">
   Computing Z via classical vs quantum mechanics
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-closer-look-at-the-the-partiation-function-z">
   A closer look at the the partiation function Z
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-free-energy-is-a-central-quantity-in-the-nvt-ensemble">
   Why free energy is a central quantity in the NVT ensemble.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#logz-is-a-cumulant-generating-function">
   logZ is a  cumulant generating function!
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-and-fluctuations-of-energy">
   Mean and fluctuations of Energy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#microscopic-origins-of-quasistatic-process-heat-work-and-entropy">
   Microscopic origins of quasistatic process, heat, work and entropy
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-power-and-utility-of-nvt-the-non-interacting-system">
   The power and utility of NVT: The non-interacting system
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ensemble-equivalence">
   Ensemble equivalence
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1-a-two-state-model">
     Example-1: A two state model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parition-function-decouples-non-interacting-terms-in-energy">
     Parition function decouples non-interacting terms in energy!
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2-ideal-gas-classical">
     Example-2: Ideal gas (classical)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-3-ideal-paramagnet-of-spin-1-2">
     Example-3 Ideal paramagnet of spin 1/2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#non-interacting-atomic-and-molecular-gases">
   Non-interacting atomic and molecular gases
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#translational-degrees-of-freedom-particle-in-a-box">
     Translational degrees of freedom: particle in a box
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rotatational-degrees-of-freedom-rigid-rotor-model">
     Rotatational degrees of freedom: Rigid rotor model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vibrational-degrees-of-freedom-harmonic-oscillator-model">
     Vibrational degrees of freedom: Harmonic oscillator model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#partition-function-for-a-molecular-gas">
     Partition function for a molecular gas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#equipartion-theorem">
     Equipartion theorem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#entropy-of-mixing">
     Entropy of mixing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#problems">
   Problems
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-1-elementary-derivation-of-boltzmanns-distirbution">
     Problem-1 Elementary derivation of Boltzmann’s distirbution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-2-three-level-system">
     Problem-2 Three level system
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-3-spins-on-a-lattice">
     Problem-3 Spins on a lattice
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-4-2d-diploes-on-a-lattice">
     Problem-4 2D diploes on a lattice
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-5-a-typical-spin-problem">
     Problem-5 A typical spin problem
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="nvt">
<h1>NVT<a class="headerlink" href="#nvt" title="Permalink to this headline">¶</a></h1>
<div class="section" id="going-from-an-isolated-system-e-const-to-a-system-coupled-to-thermostat-t-const">
<h2>Going from an isolated system (E=const) to a system coupled to thermostat (T=const)<a class="headerlink" href="#going-from-an-isolated-system-e-const-to-a-system-coupled-to-thermostat-t-const" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Recall that NVE ensemble is the collection of all possible microscpoic configurations where <span class="math notranslate nohighlight">\(N\)</span>, <span class="math notranslate nohighlight">\(V\)</span>, <span class="math notranslate nohighlight">\(E\)</span> extensive variables are fixed. E.g system is completely insulated from external world.</p></li>
<li><p>In the NVT ensemble we lift the energy exchange constraint <span class="math notranslate nohighlight">\(E=const\)</span> by bringin system in contact with a <strong>heat bath or reservoir</strong> which maintains a constant temperature of the system.</p></li>
<li><p>I thermodynamics the swapping of <span class="math notranslate nohighlight">\(E\)</span> with <span class="math notranslate nohighlight">\(T\)</span> is accomplished via Legendtre transform <span class="math notranslate nohighlight">\(F = E-TS\)</span> which makes free energy as the function governing equilibrium states.</p></li>
<li><p>In the NVT ensemble the system <span class="math notranslate nohighlight">\(E_i\)</span> and resrovir <span class="math notranslate nohighlight">\(E_r\)</span> exchange energy and maintaint constant temperature <span class="math notranslate nohighlight">\(T\)</span>. The total energy of system+reservoir remains conserved: <span class="math notranslate nohighlight">\(E_t=E_r + E_i=const\)</span>.</p></li>
</ul>
</div>
<div class="section" id="probability-of-a-microstate">
<h2>Probability of a microstate<a class="headerlink" href="#probability-of-a-microstate" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>In <span class="math notranslate nohighlight">\(NVE\)</span> ensemble all configurations have same energy which makes probability distribution uniform <span class="math notranslate nohighlight">\(p_i = \frac{1}{\Omega}\)</span>.</p></li>
<li><p>In the <span class="math notranslate nohighlight">\(NVT\)</span> ensembe differeng configurations can have different energy. Hence we expect probabiltiy distribution to depent on energy.</p></li>
<li><p>Energies can be partitioned between system and reervoir in <span class="math notranslate nohighlight">\(\Omega_{t}(E_t)\)</span> number of ways</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\Omega_{t}(E_t) = \sum_i \Omega_r(E-E_i) \cdot \Omega(E_i)\]</div>
<ul class="simple">
<li><p>But we know from thermodynamics that the entropy of the system is additive. Therefore we see that this additivity emerges because the sumation is dominated by term where the system adopts average energy <span class="math notranslate nohighlight">\(U\)</span> which maximizes the entropy.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[S_t = k_B \sum_i \Omega_r(E-E_i) \cdot \Omega(E_i) \approx k_B  log \Omega_r(E-U) \Omega(U) = S_r(E_t-U) + S(U)\]</div>
<ul class="simple">
<li><p>Let us single out one micro-state <span class="math notranslate nohighlight">\(E_i\)</span> of our system <span class="math notranslate nohighlight">\(\Omega(E_i) =1\)</span> and see what would be its probability</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p_i = \frac{\# microstates\, with\, E_i}{\# microstates\, with\, any \, E_i} \]</div>
<div class="math notranslate nohighlight">
\[p_i = \frac{\Omega_r(E_{t}-E_i) \cdot 1}{\Omega_{t} (E_{t})} = \frac{e^{S_r(E_{t}-E_i)/k_B}}{e^{S_{t}(E)/k_B}}\]</div>
<ul class="simple">
<li><p>Since entropy is a smoothly varying function of energy we can expand it around <span class="math notranslate nohighlight">\(E_{tot}\)</span> as <span class="math notranslate nohighlight">\(E_i\)</span> is a much smaller quantity and see that probabiltiy depends on energy exponentially <span class="math notranslate nohighlight">\(p_i \sim e^{-E_i/k_B T}\)</span></p></li>
</ul>
<ul class="simple">
<li><p>However a more insightful derivation it when we make use of the fact that in equilibrium the fluctuatins in system’s energy around average <span class="math notranslate nohighlight">\(U = \sum_i p_i E_i\)</span> are relatively small <span class="math notranslate nohighlight">\(U - E_i = \delta E_i \sim O(N^{1/2})\)</span> thanks to the law of large numbers.</p></li>
<li><p>Hence we should really be making an expansion around the average energy <span class="math notranslate nohighlight">\(U\)</span></p></li>
</ul>
<p><strong>Entropy of the reservoir</strong></p>
<div class="math notranslate nohighlight">
\[S_r(E_{t}-E_i) = S_r(E_{t}-U + U-E_i) \approx S_r(E_{t}-U) +\Big( \frac{\partial S_r(E)}{\partial E}\Big) (U-E_i)\]</div>
<div class="math notranslate nohighlight">
\[S_r(E_{t}-E_i) =  S_r(E_{t}-U) +\frac{1}{T}(U-E_i)\]</div>
<p><strong>Entropy of the total system.</strong></p>
<div class="math notranslate nohighlight">
\[ S_{t}(E_{t}) = S_r(E_{t}-U)+S(U)\]</div>
<p><strong>Probability of a microstate</strong></p>
<div class="math notranslate nohighlight">
\[p_i =\frac{e^{{S_r(E_{t}-E_i)/k_B}}}{e^{{S_{t}(E_{t})/k_B}}}\]</div>
<div class="math notranslate nohighlight">
\[log\, p_i = S_r(E_{t}-E_i) - S_{t}(E_{t}) = \beta (U-E_i) - \frac{S(U)}{k_B} = -\beta E_i +\beta (U-TS)\]</div>
<p><strong>Heat bath’s contribution to the system’s distribution of energies comes through the temperature</strong></p>
<div class="math notranslate nohighlight">
\[{ p_i = \frac{e^{-\beta E_i}}{e^{-\beta F}} = \frac{e^{-\beta E_i}}{Z} }\]</div>
<p><strong>Boltzmann distribution</strong></p>
<div class="math notranslate nohighlight">
\[\boxed{p_i = \frac{e^{-\beta E_i}}{Z}}\]</div>
<p><strong>Partition function</strong></p>
<div class="math notranslate nohighlight">
\[\boxed{Z= \sum_i e^{-\beta E_i} }\]</div>
<p><strong>Free Energy</strong></p>
<div class="math notranslate nohighlight">
\[\boxed{Z = e^{-{\beta F}}}\]</div>
<div class="math notranslate nohighlight">
\[\boxed{F = -\beta^{-1} log Z}\]</div>
</div>
<div class="section" id="computing-z-via-classical-vs-quantum-mechanics">
<h2>Computing Z via classical vs quantum mechanics<a class="headerlink" href="#computing-z-via-classical-vs-quantum-mechanics" title="Permalink to this headline">¶</a></h2>
<p><strong>Quantum Mechanics</strong></p>
<ul class="simple">
<li><p>Counting in quantum emchanics requires knowing the solutions to Schrodinger equation <span class="math notranslate nohighlight">\(H |\psi_i\rangle = E_i | \psi_i\rangle\)</span> whcih are used for constructing parition function:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\boxed{Z(\beta) = \sum_i e^{-\beta E_i}}\]</div>
<ul class="simple">
<li><p>Given the huge degenerace for N “particle” thermodynamic systems the partion function can also be written as a sum over the energy values <span class="math notranslate nohighlight">\(E\)</span> instead of eigenvalues:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\boxed{Z(\beta) = \int \Omega(E) e^{-\beta E}dE}\]</div>
<p><strong>Classical Mechanics</strong></p>
<ul class="simple">
<li><p>Recall taht counting microstates in classical mechanics is done by discretizing phase space <span class="math notranslate nohighlight">\(\Gamma = (x^{3N}, p^{3N})\)</span> into the smallest possible quantum units <span class="math notranslate nohighlight">\(dxdp\sim h\)</span>. In other words we replace summation over quantum states with integral over phase space <span class="math notranslate nohighlight">\(\sum_i \rightarrow \int \frac{dpdx}{h}\)</span></p></li>
<li><p>Recall that we need to correct classical mechanics for “double counting” microstates if we have N indinstinguishable “particles” with a factor of <span class="math notranslate nohighlight">\(N!\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\Omega(E) = \frac{1}{N! h^{3N}} \int_{\Gamma}  \delta \big( H(\Gamma)-E) d \Gamma\]</div>
<div class="math notranslate nohighlight">
\[Z(\beta) = \int_{E} \Omega(E) e^{-\beta E} dE  = \frac{1}{N! h^{3N}} \int_{\Gamma} \Bigg[\int_{E} d \Gamma \delta \big( H(\Gamma)-E) e^{-\beta E}dE \Bigg] d\Gamma\]</div>
<div class="math notranslate nohighlight">
\[\boxed{Z(\beta) = \frac{1}{N! h^{3N}} \int_{\Gamma} e^{-\beta H(\Gamma)} d\Gamma}\]</div>
</div>
<div class="section" id="a-closer-look-at-the-the-partiation-function-z">
<h2>A closer look at the the partiation function Z<a class="headerlink" href="#a-closer-look-at-the-the-partiation-function-z" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[\boxed{Z(\beta) = \int \Omega(E) e^{-\beta E}dE = \int e^{-\beta (E-T S(E))}dE }\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Omega(E)\sim e^N\)</span> rapidly increasing function with N eacsue of limit theorems: e.g the large deviation, central limit theorem, law of large numbers.</p></li>
<li><p><span class="math notranslate nohighlight">\(e^{-\beta E}\sim e^{-N}\)</span> rapidly decreasing function with N</p></li>
<li><p>Thermodynamic limit <span class="math notranslate nohighlight">\(N, V\rightarrow \infty\)</span> and <span class="math notranslate nohighlight">\(N/V \rightarrow const\)</span> only the region of energy survivies hat guarantees non-negligible contribution</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\boxed{Z = \int e^{-\beta (E-TS)}dE \approx e^{min_E [-\beta(E-TS)]} = e^{-\beta(U-TS)} = e^{-\beta F}}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(U =\langle E \rangle\)</span> is the thermodynamic average energy, flucutatins around which are on order of <span class="math notranslate nohighlight">\(O(N^{1/2})\)</span></p></li>
<li><p>It can be seen that <span class="math notranslate nohighlight">\(Z\)</span>, the partition function of NVT is <strong>Laplace Transform</strong> of density of states of NVE. While connection between energy and free energy <span class="math notranslate nohighlight">\(F= E -TS\)</span> is via <strong>Legendre Transform</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">N</span><span class="o">=</span><span class="mi">10</span>
<span class="n">kbT</span> <span class="o">=</span> <span class="mf">2.5</span>

<span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">omega</span>  <span class="o">=</span> <span class="n">E</span><span class="o">**</span><span class="p">(</span><span class="mf">1.5</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
<span class="n">boltzf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">E</span><span class="o">/</span><span class="n">kbT</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\Omega(E)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">boltzf</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$exp(-E/k_B T)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">omega</span><span class="o">*</span><span class="n">boltzf</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\Omega(E) exp(-E/k_B T)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$E$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;$E$&#39;)
</pre></div>
</div>
<img alt="../_images/nvt_10_1.png" src="../_images/nvt_10_1.png" />
</div>
</div>
</div>
<div class="section" id="why-free-energy-is-a-central-quantity-in-the-nvt-ensemble">
<h2>Why free energy is a central quantity in the NVT ensemble.<a class="headerlink" href="#why-free-energy-is-a-central-quantity-in-the-nvt-ensemble" title="Permalink to this headline">¶</a></h2>
<p>As we have learned in Thermodynamics, after legendre transorm <span class="math notranslate nohighlight">\(NVE\rightarrow NVT\)</span> the entropy maximiziation (energy minimization) principle gets replaced by the free energy minimization prinicple.</p>
<p>Now we can show thatn indded the free energy governs probabilities of states in the NVT ensemble:</p>
<div class="math notranslate nohighlight">
\[p_1 =\frac{\Omega (E_1) e^{-\beta E_1}}{Z} = \frac{e^{-\beta F_1}}{e^{-\beta F}}\]</div>
<p>Often we re interested in relative probabilities of different states, e.g conformation A vs B of polymer:</p>
<div class="math notranslate nohighlight">
\[\frac{p_2}{p_1} = e^{-\beta (F_2-F_1)} \]</div>
</div>
<div class="section" id="logz-is-a-cumulant-generating-function">
<h2>logZ is a  cumulant generating function!<a class="headerlink" href="#logz-is-a-cumulant-generating-function" title="Permalink to this headline">¶</a></h2>
<p>The <span class="math notranslate nohighlight">\(logZ\)</span> besides being related to free energy also has some nice mathematical properites which allows us to extract average and fluctuations of energies by simply taking derivatives. To understand where these nice properties comes let us explore what cumulants and cumulat generating functions are:</p>
<ul class="simple">
<li><p><strong>Moment generation function <span class="math notranslate nohighlight">\(M(k)\)</span></strong></p></li>
</ul>
<div class="math notranslate nohighlight">
\[M(k) = \int p(x) e^{kx} dx = \langle e^{kx} \rangle\]</div>
<div class="math notranslate nohighlight">
\[M(k) = 1 +\langle x \rangle k + \frac{1}{2!} \langle x^2 \rangle k^2 + ...\]</div>
<ul class="simple">
<li><p><strong>Cumulant generation function <span class="math notranslate nohighlight">\(C(k)=log M(k)\)</span>:</strong></p></li>
</ul>
<div class="math notranslate nohighlight">
\[C(k) = log M(k) = log \langle e^{kx} \rangle\]</div>
<div class="math notranslate nohighlight">
\[\langle e^{kx} \rangle = e^{C(k)} = e^{[1 +\langle x \rangle k + \frac{1}{2!} \langle x^2 \rangle k^2 + ...]}= 1+\kappa_1 k^2 +\kappa_2 k^2 + ...\]</div>
<p>First two cumulants are mean and fluctuation!</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\kappa_1 = \langle x \rangle\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\kappa_2 = \langle (x-\langle x \rangle)^2 \rangle\)</span></p></li>
</ol>
</div>
<div class="section" id="mean-and-fluctuations-of-energy">
<h2>Mean and fluctuations of Energy<a class="headerlink" href="#mean-and-fluctuations-of-energy" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[\langle E \rangle = \frac{\partial log Z}{\partial (-\beta)}\]</div>
<div class="math notranslate nohighlight">
\[\sigma^2_E = \frac{\partial^2 log Z}{\partial \beta^2} = -\frac{\partial \langle E \rangle}{\partial \beta} = k_BT^2 C_v\]</div>
<div class="math notranslate nohighlight">
\[\frac{\sigma_E}{\langle E\rangle} = \frac{(k_BT^2 C_v)^{1/2}}{\langle E\rangle}\sim O(N^{-1/2})\]</div>
</div>
<div class="section" id="microscopic-origins-of-quasistatic-process-heat-work-and-entropy">
<h2>Microscopic origins of quasistatic process, heat, work and entropy<a class="headerlink" href="#microscopic-origins-of-quasistatic-process-heat-work-and-entropy" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[U = \langle E\rangle =\sum_i p_i E_i\]</div>
<div class="math notranslate nohighlight">
\[dU = \sum_i p_i dE_i + \sum_i E_i dp_i = \delta W +\delta Q\]</div>
<ul class="simple">
<li><p>From the expression we see that work is associated with deformation of energy levels with fixed population of states while entropy is associated with repopulation of states withfixed energy levels.</p></li>
<li><p>Plugging in the Boltzman distribution <span class="math notranslate nohighlight">\(E_i = -\beta^{-1}( logZ + logp_i)\)</span> we can recover the entropy exressed in terms of probability:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[dQ = -\beta^{-1} \sum_i \Big [ log(Z)+log(p_i) \Big ] dp_i\]</div>
<ul class="simple">
<li><p>Since probability is normalized <span class="math notranslate nohighlight">\(\sum_i dp_i = d \sum_i p_i = d\, 1 = 0\)</span> we lose a term with Z in and arrive at:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[dQ =  -\beta^{-1} \sum_i log(p_i) dp_i\]</div>
<div class="math notranslate nohighlight">
\[\frac{dQ}{T} = d \Big[ -k_B \sum_i log(p_i) p_i \Big] = dS\]</div>
<div class="math notranslate nohighlight">
\[\boxed{S = -k_B p_i log p_i}\]</div>
</div>
<div class="section" id="the-power-and-utility-of-nvt-the-non-interacting-system">
<h2>The power and utility of NVT: The non-interacting system<a class="headerlink" href="#the-power-and-utility-of-nvt-the-non-interacting-system" title="Permalink to this headline">¶</a></h2>
<p><strong>distinguishable states</strong>:</p>
<div class="math notranslate nohighlight">
\[Z = z^N\]</div>
<p><strong>indistinguishable states</strong>:</p>
<div class="math notranslate nohighlight">
\[ Z = \frac{1}{N!}z^N \]</div>
<p><strong>Strategy for using NVT</strong></p>
<ol class="simple">
<li><p>Compute the partition function of a single particle <span class="math notranslate nohighlight">\(z= e^{-\beta \epsilon_1}+  e^{-\beta \epsilon_2}+ ...\)</span></p></li>
<li><p>raise to the power of N and apply factorial in case of indistinguishable particles, <span class="math notranslate nohighlight">\(Z= \Big (e^{-\beta \epsilon_1}+  e^{-\beta \epsilon_2}+ ... \Big)^N\)</span></p></li>
<li><p>Compute the free energy <span class="math notranslate nohighlight">\(F= - N k_B T log z\)</span></p></li>
<li><p>Take derivatives of Z and/or free energy to get the thermodynamics.</p></li>
</ol>
</div>
<div class="section" id="ensemble-equivalence">
<h2>Ensemble equivalence<a class="headerlink" href="#ensemble-equivalence" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-1-a-two-state-model">
<h3>Example-1: A two state model<a class="headerlink" href="#example-1-a-two-state-model" title="Permalink to this headline">¶</a></h3>
<p>Let us consider simple two level system where lower level <span class="math notranslate nohighlight">\(\epsilon_0 = 0\)</span> and upper level <span class="math notranslate nohighlight">\(\epsilon_1 =\epsilon\)</span>. We will now use <span class="math notranslate nohighlight">\(NVE\)</span> ensemble to obtian thermodynamic quantities <span class="math notranslate nohighlight">\((S, T, C_v)\)</span> and then obtain same quantities with <span class="math notranslate nohighlight">\(NVT\)</span>.</p>
<div class="math notranslate nohighlight">
\[E = n\epsilon\]</div>
<div class="math notranslate nohighlight">
\[\Omega(E) = \frac{N!}{(N-n)! n!}\]</div>
<div class="math notranslate nohighlight">
\[S = k_B log \Omega(E) = N k_B \Big [- \frac{n}{N}log \frac{n}{N} - \frac{N-n}{N}log \frac{N-n}{N} \Big]\]</div>
<div class="math notranslate nohighlight">
\[\frac{1}{T} = \frac{\partial S(E)}{\partial E} =  \frac{k_B}{\epsilon}\frac{\partial log\Omega(n)}{\partial  n} = \frac{k_B}{\epsilon}log \frac{N-n}{N}\]</div>
<div class="math notranslate nohighlight">
\[\frac{n}{N} = \frac{1}{1+e^{\beta \epsilon}}\]</div>
<div class="math notranslate nohighlight">
\[E = n\epsilon = \frac{N\epsilon}{1+e^{\beta \epsilon}}\]</div>
</div>
<div class="section" id="parition-function-decouples-non-interacting-terms-in-energy">
<h3>Parition function decouples non-interacting terms in energy!<a class="headerlink" href="#parition-function-decouples-non-interacting-terms-in-energy" title="Permalink to this headline">¶</a></h3>
<br>
<div class="math notranslate nohighlight">
\[Z = \sum^{n=N}_{n=0} e^{-\beta E_n} =  \Big (\sum^{i=1}_{i=0} e^{-\beta \epsilon_i} \Big)\Big (\sum^{i=1}_{i=0} e^{-\beta \epsilon_i} \Big)...\Big (\sum^{i=1}_{i=0} e^{-\beta \epsilon_i} \Big) = (1+e^{-\beta \epsilon})^N\]</div>
<br>
<div class="math notranslate nohighlight">
\[F= -k_B T log Z = -k_BT N log(1+e^{-\beta \epsilon})\]</div>
<br>
<div class="math notranslate nohighlight">
\[\langle E \rangle  = \frac{\partial log Z}{\partial (-\beta)} =  \frac{N\epsilon}{1+e^{\beta \epsilon}}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span>

<span class="nd">@interact</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">E_two_sys</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    
    <span class="n">N</span>       <span class="o">=</span> <span class="mi">1</span>
    <span class="n">kbT</span>     <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span><span class="o">/</span><span class="n">eps</span>
    <span class="n">E_eps</span>   <span class="o">=</span> <span class="n">N</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">kbT</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kbT</span><span class="p">,</span> <span class="n">E_eps</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$k_B T/\epsilon$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$E/\epsilon$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "8040f43396594736874532e2274fb8d3", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<div class="section" id="example-2-ideal-gas-classical">
<h3>Example-2: Ideal gas (classical)<a class="headerlink" href="#example-2-ideal-gas-classical" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[H(p^N, x^N) = K(p^N)  = \sum^{i=N}_{i=1}\frac{p^2_i}{2m}\]</div>
<div class="math notranslate nohighlight">
\[\boxed{Z(\beta) = \frac{1}{h^{N} N!} \int dp^N dx^N e^{-\beta H(p^N,x^N)}}\]</div>
<ul class="simple">
<li><p>Let us evaluate the partion function for a single particle in 3D:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z(\beta) =  \Bigg [\frac{1}{h} \int_{L} dx \int^{+\infty}_{-\infty} dp e^{-\beta \frac{p^2}{2m}}  \Bigg ]^3 = V \Big [ \frac{2\pi m}{h \beta} \Big]^{3/2} = V n_Q\]</div>
<p>We wrote down the partion sum in terms of volume of container and a quantum density <span class="math notranslate nohighlight">\(n_Q\)</span> or De-Broglie thermal wavelength <span class="math notranslate nohighlight">\(\lambda_T\)</span></p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[n_Q = \Big [ \frac{m k_B T}{2 \hbar^2} \Big]^{3/2} = \frac{1}{\lambda^3_T}\]</div>
<div class="math notranslate nohighlight">
\[\lambda_T = \frac{h}{2mk_BT} \sim \frac{h}{m \bar{v}}\]</div>
</div></blockquote>
<ul class="simple">
<li><p>For the N particles we have:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z = \frac{Z^N}{N!}  = \frac{(V n_Q)^N}{N!}\]</div>
<ul class="simple">
<li><p>Using the curdest version of Striling’s approximation <span class="math notranslate nohighlight">\(N!\approx N^N e^{-N}\)</span> we get</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z = \Big[ \frac{n_Q}{n}\Big]^N e^N\]</div>
<p>Where <span class="math notranslate nohighlight">\(n = N/V\)</span> is the density</p>
<div class="math notranslate nohighlight">
\[F = -k_B T log Z = -N k_B T  log \Big( \frac{n_Q}{n} \Big) - Nk_BT\]</div>
<p>We can also calcularte entropy and compare the expression with the one obtained from microcanonical ensemble:</p>
<div class="math notranslate nohighlight">
\[S = -\Big( \frac{\partial F}{\partial T}\Big)_{N,V} = Nk_B log \Big( \frac{n_Q}{n} \Big) + Nk_B + \frac{3}{2}Nk_B\]</div>
<p>And unsurprisingly we get the same expression for entropy in the canonical ensmeble known as <strong>Sackur-Tetrode equation</strong>
$<span class="math notranslate nohighlight">\(S = Nk_B \Bigg[log \Big( \frac{n_Q}{n} \Big)+ \frac{5}{2} \Bigg]\)</span>$</p>
<p>Similarily other thermodynamic variables can be inferred by taking derivatives of free energy:</p>
<div class="math notranslate nohighlight">
\[\langle E \rangle = \frac{\partial log Z}{\partial (-\beta)} = \frac{3}{2}N k_B T\]</div>
<ul class="simple">
<li><p>Ideal gas equation of state is obtained by calculating pressure
$<span class="math notranslate nohighlight">\(p = -\frac{\partial F}{\partial V} =\frac{N k_B T}{V}\)</span>$</p></li>
<li><p>One more way of calculating entropy by using the definition of free energy
$<span class="math notranslate nohighlight">\(S = \frac{E-F}{T} = k_B N \cdot  \Big [ log \Big(\frac{V}{N \lambda^3}\Big) + \frac{5}{2}\Big]\)</span>$</p></li>
</ul>
</div>
<div class="section" id="example-3-ideal-paramagnet-of-spin-1-2">
<h3>Example-3 Ideal paramagnet of spin 1/2<a class="headerlink" href="#example-3-ideal-paramagnet-of-spin-1-2" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[E  = -\mu B \sum^{N}_j s_j \]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(s_j = \pm 1\)</span> spin variable can assume two values that we refer to as up and down.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z = \sum_{E} exp(-\beta E) = \sum_{s_1, s_2, ... s_N} exp \Big( \beta \mu B \sum^{N}_j s_j \Big) = \Big [ \sum_{s_1} exp \Big( \beta \mu B  s_1 \Big) \Big ]... \Big [ \sum_{s_N} exp \Big( \beta \mu B s_N \Big) \Big ]\]</div>
<p>Now it is easty to see that partion function factorizes</p>
<div class="math notranslate nohighlight">
\[Z =Z_1^N\]</div>
<div class="math notranslate nohighlight">
\[Z_1 = \sum_{s_1} exp(\beta \mu B s_1) = exp(\beta \mu B) + exp(-\beta \mu B)  = 2 cosh(\beta \mu B)\]</div>
<p><strong>Free energy as as function of temperature and magnetic field:</strong> Now we can establish a connection with thermodynamics by computing free energy function</p>
<div class="math notranslate nohighlight">
\[ F(T, H) = - \beta^{-1} log Z = - N \beta^{-1} log \Big [ 2 cosh (\beta \mu B )  \Big ]\]</div>
<p>The entropy is obtained by taking derivative with respect to temperature</p>
<div class="math notranslate nohighlight">
\[S = - \Big(\frac{\partial F}{\partial T} \Big)_H = k_B log \Big [ 2 cosh (\beta \mu H )  \Big ] - k_B (\beta \mu B)\cdot tanh (\beta \mu B)\]</div>
<p><strong>Magnetization</strong></p>
<p>Magnetization <span class="math notranslate nohighlight">\(M\)</span> (extensive quantity) or magnetization per particle <span class="math notranslate nohighlight">\(m=M/N\)</span> (intensive quantity) is given as another free energy derivative:</p>
<div class="math notranslate nohighlight">
\[M = - \Big(\frac{\partial F}{\partial B} \Big)_T = \mu tanh \Big(\beta \mu B \Big)\]</div>
<blockquote>
<div><p>Note that the same expression is obtained when computing average value of magnetization as expected <span class="math notranslate nohighlight">\(M = \langle \mu \sum_{s_j} \rangle\)</span></p>
</div></blockquote>
<p><strong>Magnetizatic susceptibility</strong></p>
<p>In the context of paramagnet we have another response function in the form of magnetic susceptibility</p>
<div class="math notranslate nohighlight">
\[\chi(T, B) =  \Big(\frac{\partial m}{\partial B} \Big)_T = \mu^2 \beta B cosh^{-2} (\beta \mu B)\]</div>
<p>which leads to a well known <strong>Curie Law</strong></p>
<div class="math notranslate nohighlight">
\[\chi(T, B=0) = \frac{\mu^2 }{k_B T}\]</div>
<p>Finally as a consitency check we can combine enetrpy and free energy expressions to obtain internal energy:</p>
<div class="math notranslate nohighlight">
\[U = F+TS = -\mu B tanh(\beta \mu B)\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">for</span> <span class="n">beta</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">beta</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$m/\mu$&#39;</span><span class="p">)</span>    
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;B&#39;)
</pre></div>
</div>
<img alt="../_images/nvt_26_1.png" src="../_images/nvt_26_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="non-interacting-atomic-and-molecular-gases">
<h2>Non-interacting atomic and molecular gases<a class="headerlink" href="#non-interacting-atomic-and-molecular-gases" title="Permalink to this headline">¶</a></h2>
<div class="section" id="translational-degrees-of-freedom-particle-in-a-box">
<h3>Translational degrees of freedom: particle in a box<a class="headerlink" href="#translational-degrees-of-freedom-particle-in-a-box" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[E_{n_x, n_y, n_z} = \frac{\hbar^2 \pi^2}{2m L^2} \big(n^2_x+n^2_y+n^2_z \big)\]</div>
<div class="math notranslate nohighlight">
\[ Z \approx \Bigg [\int^{\infty}_0 dn e^{-\frac{\hbar^2 \pi^2}{2m k_B TL^2}n^2} \Bigg]^{3} = V \Bigg[\frac{m k_B T}{2\pi \hbar^2} \Bigg]^{3/2} = V n_Q\]</div>
</div>
<div class="section" id="rotatational-degrees-of-freedom-rigid-rotor-model">
<h3>Rotatational degrees of freedom: Rigid rotor model<a class="headerlink" href="#rotatational-degrees-of-freedom-rigid-rotor-model" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[E = \frac{\hbar^2}{2I} J (J+1) \]</div>
<div class="math notranslate nohighlight">
\[Z \approx \int^{J=\infty}_{J=0} (2J+1)e^{-\Big[\beta \frac{\hbar^2}{2I} J (J+1)\Big]}\approx \frac{T}{\theta_{rot}}\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\(\theta_{rot} = \frac{\hbar^2}{2 I_0 k_B}\)</span> is called rotational temperature.</p></li>
</ul>
</div>
<div class="section" id="vibrational-degrees-of-freedom-harmonic-oscillator-model">
<h3>Vibrational degrees of freedom: Harmonic oscillator model<a class="headerlink" href="#vibrational-degrees-of-freedom-harmonic-oscillator-model" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[E_n = \hbar \omega (n+1/2)\]</div>
<div class="math notranslate nohighlight">
\[z = \sum^{n=+\infty}_{n=0} = e^{-\frac{1}{2}\beta \hbar \omega} (1 + e^{-\beta\hbar\omega}+e^{-2\beta\hbar\omega}+...) = \frac{e^{-\frac{1}{2}\beta \hbar \omega}}{1-e^{-\beta\hbar\omega}}\]</div>
<div class="math notranslate nohighlight">
\[Z = z^N\]</div>
<div class="math notranslate nohighlight">
\[E = \frac{\partial log Z}{\partial (-\beta)} = N\hbar \omega \Big(\frac{1}{2}+ \frac{1}{1+e^{\beta\hbar\omega}} \Big) \]</div>
<ul class="simple">
<li><p>When <span class="math notranslate nohighlight">\(T \rightarrow 0\)</span> we are left with zero point energies <span class="math notranslate nohighlight">\(E \rightarrow \frac{N \hbar \omega}{2}\)</span></p></li>
<li><p>When <span class="math notranslate nohighlight">\(T \rightarrow \infty\)</span> we get equipartion of energy! <span class="math notranslate nohighlight">\(E \rightarrow \frac{3}{2} N k_B T\)</span></p></li>
</ul>
</div>
<div class="section" id="partition-function-for-a-molecular-gas">
<h3>Partition function for a molecular gas<a class="headerlink" href="#partition-function-for-a-molecular-gas" title="Permalink to this headline">¶</a></h3>
<br>
<div class="math notranslate nohighlight">
\[E = E_{transl}+E_{vib}+E_{rot}+E_{elec} \]</div>
<br>
<div class="math notranslate nohighlight">
\[Z = Z_{transl} Z_{vib} Z_{rot} Z_{elec} \]</div>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\frac{1}{N!}\)</span> must go inside <span class="math notranslate nohighlight">\(Z_{tranls}\)</span> to account for indistinguishability</p>
</div></blockquote>
</div>
<div class="section" id="equipartion-theorem">
<h3>Equipartion theorem<a class="headerlink" href="#equipartion-theorem" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[U(x) = U(x_0) +U^{'}(x-x_0) +\frac{1}{2}U^{''}(x-x_0)^2 +...\]</div>
<div class="math notranslate nohighlight">
\[U_{harm}(x) = U(x_0) +  \frac{1}{2}U^{''}(x-x_0)^2 = U_0 + \frac{1}{2}\kappa (x-x_0)^2\]</div>
<div class="math notranslate nohighlight">
\[\langle U \rangle = \int p(x) U(x) dx = \frac{\int U(x) e^{-\beta U(x)}dx}{\int e^{-\beta U(x)}dx}\]</div>
<div class="math notranslate nohighlight">
\[U(x) = U_0 + \frac{k_B T}{2}\]</div>
<blockquote>
<div><p>Notice the spring constant does not figure in the average energy expression!</p>
</div></blockquote>
</div>
<div class="section" id="entropy-of-mixing">
<h3>Entropy of mixing<a class="headerlink" href="#entropy-of-mixing" title="Permalink to this headline">¶</a></h3>
<p>Consider box divided into two volumes <span class="math notranslate nohighlight">\(V\)</span> containing <span class="math notranslate nohighlight">\(N\)</span> number of atoms of a gas each. Let us computee the entropy of mixing when we lift the divider and allow particles to diffuse freely and mix with one another.</p>
<p><strong>Identical gas atoms A on both sides</strong></p>
<ul class="simple">
<li><p>The two halfs contains same gas atoms A. The entropy of initial state is twice the entropy of N particles in volume V of each side</p></li>
</ul>
<div class="math notranslate nohighlight">
\[S_i = 2 Nk_B \Bigg[log \Big( \frac{n_Q V}{N} \Big)+ \frac{5}{2} \Bigg]\]</div>
<ul class="simple">
<li><p>entropy of the final state is that of <span class="math notranslate nohighlight">\(2N\)</span> particles occupying <span class="math notranslate nohighlight">\(2V\)</span> volume
$<span class="math notranslate nohighlight">\(S_f = 2 Nk_B \Bigg[log \Big( \frac{n_Q 2V}{2N} \Big)+ \frac{5}{2} \Bigg]\)</span>$</p></li>
<li><p>As a result entropy difference is zero as one should expect since atoms of gas are indistinugioshable:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\Delta S = S_f - S_i = 0\]</div>
<p><strong>Different gas atoms A/B</strong></p>
<p>Two different gases will make additive contribution to entropy proprotional to <span class="math notranslate nohighlight">\(N\)</span> number of atoms.
$<span class="math notranslate nohighlight">\(S_i = Nk_B \Bigg[log \Big( \frac{n^A_Q V}{N} \Big)+ \frac{5}{2} \Bigg]+ Nk_B \Bigg[log \Big( \frac{n^B_Q V}{N} \Big)+ \frac{5}{2} \Bigg]\)</span>$</p>
<p>Final state enetropy is that of two non-interactiing ideal gases occupying volume <span class="math notranslate nohighlight">\(2V\)</span></p>
<div class="math notranslate nohighlight">
\[S_f = Nk_B \Bigg[log \Big( \frac{n^A_Q 2V}{N} \Big)+ \frac{5}{2} \Bigg]+ Nk_B \Bigg[log \Big( \frac{n^B_Q 2V}{N} \Big)+ \frac{5}{2} \Bigg]\]</div>
<div class="math notranslate nohighlight">
\[\Delta S = 2N k_B log 2\]</div>
</div>
</div>
<div class="section" id="problems">
<h2>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">¶</a></h2>
<div class="section" id="problem-1-elementary-derivation-of-boltzmanns-distirbution">
<h3>Problem-1 Elementary derivation of Boltzmann’s distirbution<a class="headerlink" href="#problem-1-elementary-derivation-of-boltzmanns-distirbution" title="Permalink to this headline">¶</a></h3>
<p>Let us do an elementary derivation of Boltzman distribution showing that when a macroscopic system is in equilibrium and coupled to a heat bath at temperatere <span class="math notranslate nohighlight">\(T\)</span> we have a universal dependence of probability for finding system at different energies:</p>
<div class="math notranslate nohighlight">
\[\boxed{P(r')/P(r)=e^{-\beta (U(r)-U(r'))}}\]</div>
<p>The essence of the derivation is this. Consider a vertical column of gas somehre in the mountains.</p>
<ul class="simple">
<li><p>On one hand we have graviational force which acts on a column between <span class="math notranslate nohighlight">\(h, h+dh\)</span> with cross section <span class="math notranslate nohighlight">\(A\)</span>.</p></li>
<li><p>On the other hand we have pressure balance which thankfully keeps the molecules from dropping on the ground.</p></li>
<li><p>This means that we have a steady density of molecules at each distance <span class="math notranslate nohighlight">\(n(h)\)</span> for a fixed <span class="math notranslate nohighlight">\(T\)</span>. Write down this balance of forces (gravitational vs pressure ) and find show how density at <span class="math notranslate nohighlight">\(h\)</span>, <span class="math notranslate nohighlight">\(n(h)\)</span> is related to density at <span class="math notranslate nohighlight">\(h=0\)</span>, <span class="math notranslate nohighlight">\(n(0)\)</span>.</p></li>
</ul>
<blockquote>
<div><p>Tip: you may use <span class="math notranslate nohighlight">\(P=nkT\)</span> for pressure and <span class="math notranslate nohighlight">\(mgh\)</span> for the gravitational force)</p>
</div></blockquote>
</div>
<div class="section" id="problem-2-three-level-system">
<h3>Problem-2 Three level system<a class="headerlink" href="#problem-2-three-level-system" title="Permalink to this headline">¶</a></h3>
<p>Consider a system of N classical and non-interacting particles in contact with a thermal reservoir at a temperature <span class="math notranslate nohighlight">\(T\)</span>. Each particle can have be in three states with energy <span class="math notranslate nohighlight">\(0\)</span>, <span class="math notranslate nohighlight">\(\epsilon\)</span> or <span class="math notranslate nohighlight">\(3\epsilon\)</span> where <span class="math notranslate nohighlight">\(\epsilon&gt;0\)</span>.</p>
<ul class="simple">
<li><p>Obtain an expression for <span class="math notranslate nohighlight">\(Z\)</span> then compute the average and fluctuation of energy.</p></li>
<li><p>Plot the heat capacity as a function of temperature <span class="math notranslate nohighlight">\(C_v(T)\)</span></p></li>
<li><p>Plot the average enegy as a function of temperature <span class="math notranslate nohighlight">\(U(T)\)</span></p></li>
<li><p>Plot the entropy as a function of temperature <span class="math notranslate nohighlight">\(S(T)\)</span>.</p></li>
</ul>
</div>
<div class="section" id="problem-3-spins-on-a-lattice">
<h3>Problem-3 Spins on a lattice<a class="headerlink" href="#problem-3-spins-on-a-lattice" title="Permalink to this headline">¶</a></h3>
<p>Consider <span class="math notranslate nohighlight">\(N\)</span> lattice sites which have quantum spins <span class="math notranslate nohighlight">\(s=1\)</span> (not to be confused with entropy) with a mangnetic moment <span class="math notranslate nohighlight">\(\mu\)</span>. Spins are subject to a uniform mangeitc field in z direction <span class="math notranslate nohighlight">\(B=B_z\)</span> making the energy of each spin <span class="math notranslate nohighlight">\(-\mu B m \)</span> where <span class="math notranslate nohighlight">\(m\)</span> is the magnetic quantum number thattakes on three possible values <span class="math notranslate nohighlight">\(m=0, \pm 1\)</span>.</p>
<ul class="simple">
<li><p>Compute the entropy <span class="math notranslate nohighlight">\(S\)</span> and the mangeitzation of the system <span class="math notranslate nohighlight">\(M\)</span></p></li>
<li><p>Plot entropy as a function of temperatures and study the limit of low temperatures <span class="math notranslate nohighlight">\(S(T\rightarrow 0)\)</span></p></li>
</ul>
</div>
<div class="section" id="problem-4-2d-diploes-on-a-lattice">
<h3>Problem-4 2D diploes on a lattice<a class="headerlink" href="#problem-4-2d-diploes-on-a-lattice" title="Permalink to this headline">¶</a></h3>
<p>Consider a 2D square lattice with <span class="math notranslate nohighlight">\(M\)</span> lattice points. On each point we have a mangeetic moment that can point in four possible directions: <span class="math notranslate nohighlight">\(+x, -x, +y, -y\)</span>. Along <span class="math notranslate nohighlight">\(y\)</span> axis, the dipole has the energy <span class="math notranslate nohighlight">\(\epsilon&gt;0\)</span> and along the x axis <span class="math notranslate nohighlight">\(\epsilon=0\)</span>.</p>
<p>Dipoles are not interacting with each other and we also ingnore kinetic energy of diplos since they are fixed at lattice positions.</p>
<ul class="simple">
<li><p>Write down parition function for this system <span class="math notranslate nohighlight">\(Z\)</span></p></li>
<li><p>Compute the average energy.</p></li>
<li><p>Compute entropy per dipole <span class="math notranslate nohighlight">\(s(T)\)</span>. Evaluate the difference <span class="math notranslate nohighlight">\(S(T=\infty)-S(T=0)\)</span>? Can you see a link with number of arrangements of dipols?</p></li>
<li><p>Compute microcanonical partition function <span class="math notranslate nohighlight">\(\Omega (N\epsilon)\)</span></p></li>
<li><p>Show that we get the same entropy expression by using <span class="math notranslate nohighlight">\(NVE\)</span> and <span class="math notranslate nohighlight">\(NVT\)</span> ensembles.</p></li>
</ul>
</div>
<div class="section" id="problem-5-a-typical-spin-problem">
<h3>Problem-5 A typical spin problem<a class="headerlink" href="#problem-5-a-typical-spin-problem" title="Permalink to this headline">¶</a></h3>
<p>Due to a ligand field, the degeneracy of d-orbital of chromium ion <span class="math notranslate nohighlight">\(Cr^{3+}\)</span> is partially lifted. The spin part of the hamiltonian that lifts this degeneracy has the following form.</p>
<div class="math notranslate nohighlight">
\[H =  D \big(S_z^2 -S(S+1)/2 \big)\]</div>
<p>Where <span class="math notranslate nohighlight">\(D&gt;0\)</span> is some constant and <span class="math notranslate nohighlight">\(S=3/2\)</span> (the cation has an electronic term <span class="math notranslate nohighlight">\({F}^ 4_{3/2}\)</span></p>
<ul class="simple">
<li><p>Conceptual question: Why can we apply statisical mechanics to a “single” ion?</p></li>
<li><p>Obtain the occupation probability of each discrete energy level <span class="math notranslate nohighlight">\(P(E)\)</span>.</p></li>
<li><p>Calculate the entropy and the specific heat then show that heat capacity behaves as <span class="math notranslate nohighlight">\(T^{-2}\)</span> at high temperatures.</p></li>
<li><p>Supose heat capacity is <span class="math notranslate nohighlight">\(C=k_b \Big(\frac{T}{T_0} \Big)^2\)</span> with <span class="math notranslate nohighlight">\(T_0=0.18 K\)</span> at higher temperatures. Determine the energy spacing.</p></li>
</ul>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./3_ensembles"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="nve.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">NVE</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="npt.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="math notranslate nohighlight">\(\mu V T\)</span></p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Davit Potoyan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>