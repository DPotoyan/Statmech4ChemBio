

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Intro to Statistical Ensembles &#8212; Statistical Mechanics for Chemistry and Biology</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '3_ensembles/nve';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Ensembles in phase-space" href="nvt.html" />
    <link rel="prev" title="Ensembles" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.jpg" class="logo__image only-light" alt="Statistical Mechanics for Chemistry and Biology - Home"/>
    <script>document.write(`<img src="../_static/logo.jpg" class="logo__image only-dark" alt="Statistical Mechanics for Chemistry and Biology - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    About
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../schedule.html">Schedule (Spring 2025)</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1_stats/intro.html">Stats</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1_stats/Probabilities_Counting.html">Probability theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_stats/Random_Variables.html">Random variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_stats/Diffusion.html">Diffusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../1_stats/Entropy.html">Entropy and Information</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2_thermo/intro.html">Thermodynamics</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2_thermo/01_Thermo.html">Review of thermodynamics principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../2_thermo/02_FreeEnergies.html">Thermodynamic Potentials</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="intro.html">Ensembles</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Intro to Statistical Ensembles</a></li>
<li class="toctree-l2"><a class="reference internal" href="nvt.html">Ensembles in phase-space</a></li>
<li class="toctree-l2"><a class="reference internal" href="npt.html">muPT</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4_ising/intro.html">Phase transitions</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../5_fluids/intro.html">Fluids</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../6_kinetics/intro.html">Kinetics</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../6_kinetics/langevin.html">Langevin equation and Brownian motion</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../labs/py-lab/intro.html">Python</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../labs/py-lab/intro2py.html">Python3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/py-lab/intro2numpy.html">NumPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/py-lab/intro2viz.html">Plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/py-lab/python_OOP_challenge.html">Tutorial: Building Python Classes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../labs/np-lab/intro.html">Numpy lab</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../labs/np-lab/np_prob.html">Numpy and Probabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/np-lab/sinc_function.html">Numpy Lab: Sinc Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/np-lab/linear_functions.html">Numpy Lab: Linear Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/np-lab/1d_gas_sim.html">Tutorial: Numpy simultions of 1D gas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/np-lab/2d_gas_sim.html">Tutorial: Numpy simultions of 2D gas</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../labs/rw-lab/intro.html">Random Walks</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../labs/rw-lab/rw_lab.html">Random walk simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/rw-lab/InverseTransform.html">The Inverse Transform of RVs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/rw-lab/change_rv_jax.html">Change of variables with automatic differentiation (autodiff)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/rw-lab/polymer-conf.html">Conformations of Random Polymer Chains</a></li>

<li class="toctree-l2"><a class="reference internal" href="../labs/rw-lab/langevin.html">Langevin Equation for Brownian Motion and Mean Square Displacement (MSD)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../labs/lab4/intro.html">Application of ensembles</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab4/nvt_application.html">Free energy and protein folding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab4/TwoState.html">Two-state system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab4/mass_action.html">Mass action law</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../labs/lab5/intro.html">Simulating Ising models</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab5/torch_ising.html">Ising-2D simulations using ML libraries</a></li>



<li class="toctree-l2"><a class="reference internal" href="../labs/lab5/Wolf.html">Other Methods for sampling Ising models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab5/enhance-sampling.html">Non-boltzman (enhanced) sampling ideas</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../labs/lab6/intro.html">Simulating Fluids</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab6/openmm_double_well.html">Double Well potential using OpenMM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab6/openmm_lj_chain.html">Simulating toy polymers using openMM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab6/openmm_ethane.html">Simulating Ethane</a></li>
<li class="toctree-l2"><a class="reference internal" href="../labs/lab6/openmm_villin.html">Simulating solvated protein</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/DPotoyan/Statmech4ChemBio/master?urlpath=lab/tree/3_ensembles/nve.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/DPotoyan/Statmech4ChemBio/blob/master/3_ensembles/nve.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/3_ensembles/nve.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Intro to Statistical Ensembles</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#microcanonical-ensemble-nve">Microcanonical Ensemble (NVE)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#microcanonical-partition-function-grows-exponentially-with-system-size">Microcanonical partition function grows exponentially with system size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applications-of-nve">Applications of NVE</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#particles-in-a-box">Particles in a box</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-state-system">Two state system</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-partitioning-in-an-isolated-system">Energy partitioning in an isolated system</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-fluctuations-are-gaussian">Energy fluctuations are Gaussian</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temperature-as-the-driver-of-energy-partitioning">Temperature as the driver of energy partitioning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-equilirbium-in-ideal-gasses">Thermal equilirbium in ideal gasses</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constant-temperature-ensemble-nvt">Constant temperature ensemble (NVT)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#canonical-distribution">Canonical distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#partition-functions-and-thermodynamic-limit">Partition Functions and Thermodynamic limit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-of-using-nvt">Examples of using NVT</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-state-partciles-nvt">Two-state partciles (NVT)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#free-energy-and-macrostate-probabilities">Free energy and macrostate probabilities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-fluctuations"><strong>Energy Fluctuations</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fluctuation-response-and-ensemble-equivalence">Fluctuation-response and ensemble equivalence</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-examples-of-using-statistical-ensembles">More Examples of using statistical Ensembles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems">Problems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shottky-defects">Shottky defects</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lattice-gas">Lattice gas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#polymer-elasticity">Polymer Elasticity</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="intro-to-statistical-ensembles">
<h1>Intro to Statistical Ensembles<a class="headerlink" href="#intro-to-statistical-ensembles" title="Permalink to this heading">#</a></h1>
<div class="admonition-what-you-will-learn admonition">
<p class="admonition-title"><strong>What you will learn</strong></p>
<ul class="simple">
<li><p><strong>Statistical Ensembles</strong>: Understanding the role of ensembles in statistical mechanics and how they describe macroscopic systems using probability distributions.</p></li>
<li><p><strong>Microcanonical Ensemble (NVE)</strong>: Definition, characteristics, and assumptions—fixed energy, volume, and particle number; statistical weight of microstates.</p></li>
<li><p><strong>Canonical Ensemble (NVT)</strong>: Definition and significance—fixed temperature, volume, and particle number; derivation of the Boltzmann factor.</p></li>
<li><p><strong>Equivalence of Ensembles</strong>: Conditions under which the microcanonical and canonical ensembles give equivalent thermodynamic predictions in the thermodynamic limit.</p></li>
<li><p><strong>Partition Function (<span class="math notranslate nohighlight">\(Z\)</span>)</strong>: Role of the partition function in statistical mechanics, its connection to thermodynamic properties (free energy, entropy, internal energy).</p></li>
<li><p><strong>Boltzmann Distribution</strong>: Probability of a system being in a given energy state at equilibrium, leading to macroscopic observables.</p></li>
<li><p><strong>Thermodynamic Connections</strong>: How ensemble averages link to macroscopic properties such as energy, entropy, and pressure.</p></li>
<li><p><strong>Fluctuations and Large System Limits</strong>: How energy fluctuations in the canonical ensemble become negligible for large systems, reinforcing ensemble equivalence.</p></li>
</ul>
</div>
<p><img alt="" src="../_images/ensembl.png" /></p>
<section id="microcanonical-ensemble-nve">
<h2>Microcanonical Ensemble (NVE)<a class="headerlink" href="#microcanonical-ensemble-nve" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>A collection of all possible microscopic arrangements consistend with an equilibrium thermodynamic state is called <strong>statistical ensemble</strong>.</p></li>
<li><p>Ensemble defines sample space over microstates over which we define micro and macro-state probabilities</p></li>
<li><p>Consider an isolated fluid system with <span class="math notranslate nohighlight">\(N=const\)</span>, <span class="math notranslate nohighlight">\(V=const\)</span> and <span class="math notranslate nohighlight">\(E=const\)</span>.  This is called a <strong>microcanonical ensemble</strong></p></li>
<li><p>In the absence of any physical constraints, no micro state is more probable than any other. This is known as “principle of equal a priory probability”.</p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/940d937a24d3868dd2a911055ef3bfdca04c59451b03db77100a8430f50c3af3.png" src="../_images/940d937a24d3868dd2a911055ef3bfdca04c59451b03db77100a8430f50c3af3.png" />
</div>
</div>
<div class="important admonition">
<p class="admonition-title"><strong>A priori equal probability of microstates with energy <span class="math notranslate nohighlight">\(E\)</span></strong></p>
<div class="math notranslate nohighlight">
\[p_i = \frac{1}{\Omega(N, V, E)}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(i=1,2,3,...\)</span> distinct configurations or microstates with energy <span class="math notranslate nohighlight">\(E\)</span></p></li>
</ul>
</div>
<ul class="simple">
<li><p>We can use postulate of equal mircro-state probabilities and plug into probabilisti expression of entropy to obtain a simple relationship between number of microstates and entropy:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[S = -k_B \sum_i p_i log p_i = -k_B \Omega \cdot  \frac{1}{\Omega} log \frac{1}{\Omega}\]</div>
<div class="important admonition">
<p class="admonition-title"><strong>Entropy in microcanonical ensemble (Boltzmann equation)</strong></p>
<div class="math notranslate nohighlight">
\[S = k_B log \Omega\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Omega\)</span> is the number of micro-states <strong>consistent with a macrostate of our system</strong>.</p></li>
<li><p><span class="math notranslate nohighlight">\(S(N, V, E)\)</span> is the entropy of an isolated system.</p></li>
<li><p><span class="math notranslate nohighlight">\(k_B =1.380649\cdot 10^{-23} J/K\)</span>,  Boltzmann’s constant</p></li>
</ul>
</div>
<p><strong>Simple example of NVE ensemble</strong></p>
<ul class="simple">
<li><p>Consider a system of three spins where <span class="math notranslate nohighlight">\(\uparrow\)</span> and <span class="math notranslate nohighlight">\(\downarrow\)</span> have the same energy <span class="math notranslate nohighlight">\(\epsilon\)</span>. We have microcanonical ensemble defined by <span class="math notranslate nohighlight">\(N=3\)</span> and <span class="math notranslate nohighlight">\(E=3\epsilon\)</span> thermodynamic variables.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\uparrow \uparrow \uparrow, \quad
\uparrow \uparrow \downarrow, \quad
\uparrow \downarrow \uparrow, \quad
\downarrow \uparrow \uparrow, \quad
\uparrow \downarrow \downarrow, \quad
\downarrow \uparrow \downarrow, \quad
\downarrow \downarrow \uparrow, \quad
\downarrow \downarrow \downarrow
\]</div>
<ul class="simple">
<li><p>There are <span class="math notranslate nohighlight">\(\Omega = 2^3\)</span> microstates with entropy being:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
S = k_B \log 2^3  = 3k_B log2
\]</div>
<ul class="simple">
<li><p>For N spins we see that <span class="math notranslate nohighlight">\(\Omega=2^N\)</span> and therefore entropy scales linearly with system size <span class="math notranslate nohighlight">\(N\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
S = Nk_B log2
\]</div>
</section>
<section id="microcanonical-partition-function-grows-exponentially-with-system-size">
<h2>Microcanonical partition function grows exponentially with system size<a class="headerlink" href="#microcanonical-partition-function-grows-exponentially-with-system-size" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/4228386939f691ea3911a11937f2e1ca7d170f7d4bdc1f52e7af2cbe3bdd6635.png" src="../_images/4228386939f691ea3911a11937f2e1ca7d170f7d4bdc1f52e7af2cbe3bdd6635.png" />
</div>
</div>
<ul class="simple">
<li><p>To estimate how the number of microstates behave as a function of system size <span class="math notranslate nohighlight">\(N\)</span> consider <strong><span class="math notranslate nohighlight">\( N \)</span> particles</strong> in a volume <strong><span class="math notranslate nohighlight">\( V \)</span></strong>, let the <strong>particle density</strong> be  <span class="math notranslate nohighlight">\(\rho = \frac{N}{V}\)</span></p></li>
<li><p>Dividing the system into <span class="math notranslate nohighlight">\( M \)</span> statistically independent subregions of volume <span class="math notranslate nohighlight">\( v = V/M \)</span>, with <span class="math notranslate nohighlight">\( \Omega_{\text{sub}}\)</span> microstates in each we get:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
N_{\text{sub}} = \rho v = \frac{N}{M}
\]</div>
<div class="math notranslate nohighlight">
\[M = \frac{N}{\rho v}\]</div>
<div class="math notranslate nohighlight">
\[
\Omega(E) = \left( \Omega_{\text{sub}} \right)^M = \left( \Omega^{1/\rho v}_{\text{sub}} \right)^N 
\]</div>
<ul class="simple">
<li><p>We find that number of mirostates grows exponentially with syste size <span class="math notranslate nohighlight">\(N\)</span>.  This implies a large deviation property: entropy <strong>scales extensively</strong> and grows <strong>monotonically</strong> with energy.</p></li>
</ul>
<div class="important admonition">
<p class="admonition-title"><strong>Large deviation propery of <span class="math notranslate nohighlight">\(\Omega\)</span></strong></p>
<div class="math notranslate nohighlight">
\[
\Omega(E) \sim e^{N s(E/N)}
\]</div>
<div class="math notranslate nohighlight">
\[
S(E) = k_B \log \Omega(E) \sim k_B N s(E/N)
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(s(E/N)\)</span> is an intensive quantity of entropy per-particle.</p></li>
<li><p><span class="math notranslate nohighlight">\(S(E)\)</span> is an extensive quantity of total entropy of N partice system.</p></li>
</ul>
</div>
</section>
<section id="applications-of-nve">
<h2>Applications of NVE<a class="headerlink" href="#applications-of-nve" title="Permalink to this heading">#</a></h2>
<section id="particles-in-a-box">
<h3>Particles in a box<a class="headerlink" href="#particles-in-a-box" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>For a single quantum particle in a cubical box of side <span class="math notranslate nohighlight">\( L \)</span>, the allowed energy levels are:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
E_{n_x, n_y, n_z} \sim (n_x^2 + n_y^2 + n_z^2)
\]</div>
<ul class="simple">
<li><p>Where <span class="math notranslate nohighlight">\( n_x, n_y, n_z \)</span> are <strong>positive integers</strong> (quantum numbers).</p></li>
<li><p>To determine the number of microstates with total energy <strong>at most</strong> <span class="math notranslate nohighlight">\( E \)</span>, we count the number of allowed quantum states <span class="math notranslate nohighlight">\( (n_x, n_y, n_z) \)</span> satisfying:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
n_x^2 + n_y^2 + n_z^2 \leq E
\]</div>
<ul class="simple">
<li><p>For large <span class="math notranslate nohighlight">\( E \)</span>, this corresponds to counting integer lattice points inside a sphere of radius:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
R = \sqrt{E}
\]</div>
<ul class="simple">
<li><p>Since the number of points inside a sphere scales approximately as the <strong>volume</strong> of the sphere, we get:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\Omega(E) \approx \frac{4}{3} \pi R^3  \propto E^{3/2}
\]</div>
<ul class="simple">
<li><p>Thus, for a <strong>single</strong> particle, the number of accessible microstates grows as:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\Omega(E) \sim E^{3/2}
\]</div>
<ul class="simple">
<li><p>For <strong><span class="math notranslate nohighlight">\( N \)</span> independent particles</strong>, each particle contributes an independent set of quantum numbers, meaning we now count lattice points in a <strong><span class="math notranslate nohighlight">\( 3N \)</span>-dimensional hypersphere</strong>.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\Omega(E) \sim E^{3N/2}
\]</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a combined figure</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># ---------------- Plot 1: Scaling of Microstates ----------------</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="n">N</span><span class="o">=</span><span class="mi">10</span>

<span class="n">Omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">**</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">Omega</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">3.5</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Energy E&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Omega(E) \sim E^{\frac</span><span class="si">{3N}{2}</span><span class="s2">}$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Scaling of $\Omega(E)$&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>  <span class="c1"># Logarithmic scale to better display the exponential growth</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># ---------------- Plot 2: Growth of Quantum States in 2D ----------------</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">n_max</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># Reduce max quantum number for clarity</span>
<span class="n">R_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
<span class="n">n_x_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">n_y_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">n_x</span> <span class="ow">in</span> <span class="n">n_x_values</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">n_y</span> <span class="ow">in</span> <span class="n">n_y_values</span><span class="p">:</span>
        <span class="n">energy</span> <span class="o">=</span> <span class="n">n_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n_y</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">if</span> <span class="n">energy</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">(</span><span class="n">R_values</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">n_x</span><span class="p">,</span> <span class="n">n_y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="k">for</span> <span class="n">R</span> <span class="ow">in</span> <span class="n">R_values</span><span class="p">:</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;R = </span><span class="si">{</span><span class="n">R</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$n_x$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$n_y$&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Quantum States Growth (2D)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_max</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_max</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># ---------------- Plot 3: 3D Representation of Quantum States ----------------</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">n_max_3d</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Reduce quantum number range for clarity</span>

<span class="c1"># Generate 3D quantum states</span>
<span class="n">n_z_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_max_3d</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n_x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_max_3d</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">n_y</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_max_3d</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">n_z</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_max_3d</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">energy</span> <span class="o">=</span> <span class="n">n_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n_y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n_z</span><span class="o">**</span><span class="mi">2</span>
            <span class="k">if</span> <span class="n">energy</span> <span class="o">&lt;=</span> <span class="nb">max</span><span class="p">(</span><span class="n">R_values</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">ax3</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">n_x</span><span class="p">,</span> <span class="n">n_y</span><span class="p">,</span> <span class="n">n_z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$n_x$&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$n_y$&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$n_z$&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Quantum States Growth (3D)&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>

<span class="c1"># Show the combined figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/f97f17881d9c56b2bc910d1a44ba1280ba625ef69e618075fb13655b6fe49766.png" src="../_images/f97f17881d9c56b2bc910d1a44ba1280ba625ef69e618075fb13655b6fe49766.png" />
</div>
</div>
</section>
<section id="two-state-system">
<h3>Two state system<a class="headerlink" href="#two-state-system" title="Permalink to this heading">#</a></h3>
<ul>
<li><p>Given <span class="math notranslate nohighlight">\(N\)</span> non-interacting spins where each spin can be up (<span class="math notranslate nohighlight">\(\uparrow\)</span>) with energy <span class="math notranslate nohighlight">\( \epsilon \)</span> or down (<span class="math notranslate nohighlight">\(\downarrow\)</span>) with energy <span class="math notranslate nohighlight">\( 0 \)</span>. The total energy is:</p>
<div class="math notranslate nohighlight">
\[
  E = n\epsilon
  \]</div>
</li>
<li><p>Determine fraction of excited states <span class="math notranslate nohighlight">\(f=\frac{n}{N} = \frac{E}{N\epsilon}\)</span> where <span class="math notranslate nohighlight">\(n\)</span> is number of up spins. Show how this fraciton changes with temperature</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
log\Omega(E, N) = log \Omega(N, n) = log \frac{N!}{n! (N-n)!} = \frac{N!}{(E/\epsilon)! (N-E/\epsilon)!}
\]</div>
<ul class="simple">
<li><p>Using Striling’s approximation <span class="math notranslate nohighlight">\(logN!=NlogN-N\)</span> we get:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
log\Omega(E, N)  \approx N \log N - \frac{E}{\epsilon} \log \frac{E}{\epsilon} - \bigg(N - \frac{E}{\epsilon}\bigg)  \log \bigg(N - \frac{E}{\epsilon}\bigg) 
\]</div>
<ul class="simple">
<li><p>We connect number of excited states to equilibrium temperature via thermodynamics</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{1}{T} = \frac{dS}{dE} = k_B \frac{d  log\Omega}{dE}\]</div>
<div class="math notranslate nohighlight">
\[
\frac{1}{k_BT} = - \frac{1}{\epsilon} \log \frac{E}{\epsilon} + \frac{1}{\epsilon} \log \bigg(N - \frac{E}{\epsilon}\bigg) 
\]</div>
<div class="math notranslate nohighlight">
\[
\frac{E}{\epsilon} = \bigg(N - \frac{E}{\epsilon}\bigg)  e^{-\frac{\epsilon}{k_B T} }
\]</div>
<ul class="simple">
<li><p>The fraction would therefore be:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
f = \frac{E}{N\epsilon} = \frac{1}{1 + e^{\frac{\epsilon}{k_B T} }}
\]</div>
<ul class="simple">
<li><p>This is the well-known Boltzmann factor result for a two-level system in thermal equilibrium.</p></li>
<li><p>This means that at high temperatures (<span class="math notranslate nohighlight">\( k_B T \gg \epsilon \)</span>), approximately half the particles are excited, while at low temperatures (<span class="math notranslate nohighlight">\( k_B T \ll \epsilon \)</span>), the fraction of excited particles is exponentially suppressed.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Create a figure with two subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Subplot 1: Growth of Ω(E) with Energy for Different Spin System Sizes</span>
<span class="n">N_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>  <span class="c1"># Different spin system sizes</span>

<span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">N_values</span><span class="p">:</span>
    <span class="n">energies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Possible energy levels</span>
    <span class="n">multiplicities</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">binom</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">energies</span><span class="p">)</span>  <span class="c1"># Compute binomial coefficient</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energies</span><span class="p">,</span> <span class="n">multiplicities</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="c1"># Plot settings for first subplot</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>  <span class="c1"># Use logarithmic scale to highlight exponential growth</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Total Energy $E$&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\Omega(E)$ (Number of Microstates)&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Growth of $\Omega(E)$ with Energy&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Subplot 2: Fraction of Particles in the Excited State vs. Temperature</span>
<span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Set energy scale to 1 for simplicity</span>
<span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Boltzmann constant set to 1 for simplicity</span>
<span class="n">T_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>  <span class="c1"># Different temperature values</span>

<span class="c1"># Define function for fraction of excited particles</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fraction_excited</span><span class="p">(</span><span class="n">beta_epsilon</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">beta_epsilon</span><span class="p">))</span>

<span class="c1"># Generate beta_epsilon values</span>
<span class="n">beta_epsilon_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Plot f for different temperatures</span>
<span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">T_values</span><span class="p">:</span>
    <span class="n">beta_epsilon</span> <span class="o">=</span> <span class="n">epsilon</span> <span class="o">/</span> <span class="p">(</span><span class="n">k_B</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">beta_epsilon_values</span>
    <span class="n">f_values</span> <span class="o">=</span> <span class="n">fraction_excited</span><span class="p">(</span><span class="n">beta_epsilon</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta_epsilon_values</span><span class="p">,</span> <span class="n">f_values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;T = </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Plot settings for second subplot</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\beta \epsilon$&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Fraction of Excited Particles $f$&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Fraction of Particles in the Excited State&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Adjust layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/d717ab920389c5a524342c670da909011367acd339cab018386d6d2ebddf97e3.png" src="../_images/d717ab920389c5a524342c670da909011367acd339cab018386d6d2ebddf97e3.png" />
</div>
</div>
</section>
<section id="energy-partitioning-in-an-isolated-system">
<h3>Energy partitioning in an isolated system<a class="headerlink" href="#energy-partitioning-in-an-isolated-system" title="Permalink to this heading">#</a></h3>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/a1f16057cfbfa8d42911735b14ed0f0d91aef3805b8487832db7ba1417e4c716.png" src="../_images/a1f16057cfbfa8d42911735b14ed0f0d91aef3805b8487832db7ba1417e4c716.png" />
</div>
</div>
<ul>
<li><p><span class="math notranslate nohighlight">\( \Omega(E) \)</span> is the <strong>number of microstates</strong> available to the system when it has energy <span class="math notranslate nohighlight">\( E \)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\( \Omega_r(E_t - E) \)</span> is the <strong>number of microstates</strong> available to the reservoir when the system has energy <span class="math notranslate nohighlight">\( E \)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\( \Omega_t(E_t) \)</span> is the <strong>total number of microstates</strong></p></li>
<li><p>Since reservoir and system can be considered statistically independent, the probability of finding system in a <strong>macrostate</strong> with energy <span class="math notranslate nohighlight">\(E\)</span> is:</p>
<div class="math notranslate nohighlight">
\[
  p(E) = \frac{\Omega(E) \Omega_r(E_t - E)}{\Omega_t(E_t)} 
  \]</div>
</li>
<li><p>This is a ration of all microstate where system gets <span class="math notranslate nohighlight">\(E\)</span> and reservoir <span class="math notranslate nohighlight">\(E_t-E\)</span> energies divided by total number of microstates. The latter given as sum of all possible partitionings of energy</p>
<div class="math notranslate nohighlight">
\[
  \Omega_t(E_t) = \sum_E \Omega(E) \Omega_r(E_t - E)
  \]</div>
</li>
<li><p>We can see that probability of macrostates is normalized <span class="math notranslate nohighlight">\(\sum_E P(E)=1\)</span>. The system is more likely to be in a macrostate <span class="math notranslate nohighlight">\( E \)</span> if there are more microstates that reaalize this partitioning.</p></li>
<li><p>To find the most likely partitioning of energy we seek to find maximum of <span class="math notranslate nohighlight">\(P(E)\)</span></p></li>
</ul>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/fb56bd226eda89c94a681c6a9e2e455f57c978edecb33b9b26ccf0653cb79d5e.png" src="../_images/fb56bd226eda89c94a681c6a9e2e455f57c978edecb33b9b26ccf0653cb79d5e.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Re-import necessary libraries since execution state was reset</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Define different system sizes</span>
<span class="n">system_sizes</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">)]</span>

<span class="c1"># Define total energy</span>
<span class="n">E_total</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># Create figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Loop over different system sizes and plot</span>
<span class="k">for</span> <span class="n">N1</span><span class="p">,</span> <span class="n">N2</span> <span class="ow">in</span> <span class="n">system_sizes</span><span class="p">:</span>
    <span class="c1"># Define energy range for system 1 (from 0 to E_total)</span>
    <span class="n">E1_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">E_total</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>  <span class="c1"># Avoid E=0 to prevent singularities</span>
    <span class="n">E2_values</span> <span class="o">=</span> <span class="n">E_total</span> <span class="o">-</span> <span class="n">E1_values</span>  <span class="c1"># Energy remaining for system 2</span>

    <span class="c1"># Compute microstates using Omega(E) ~ E^(3N/2)</span>
    <span class="n">Omega1</span> <span class="o">=</span> <span class="n">E1_values</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">N1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">Omega2</span> <span class="o">=</span> <span class="n">E2_values</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">N2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Compute total number of microstates (product of subsystems)</span>
    <span class="n">Omega_total</span> <span class="o">=</span> <span class="n">Omega1</span> <span class="o">*</span> <span class="n">Omega2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Omega1</span> <span class="o">*</span> <span class="n">Omega2</span><span class="p">)</span>  <span class="c1"># Normalize to get probability</span>

    <span class="c1"># Plot results</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E1_values</span><span class="p">,</span> <span class="n">Omega_total</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$N_1=</span><span class="si">{</span><span class="n">N1</span><span class="si">}</span><span class="s1">, N_2=</span><span class="si">{</span><span class="n">N2</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>

    <span class="c1"># Draw vertical line at the peak (mean energy E = U)</span>
    <span class="n">E_peak</span> <span class="o">=</span> <span class="n">E1_values</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">Omega_total</span><span class="p">)]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">E_peak</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Plot settings</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Energy given to System: $E_1$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$P(E_1)$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Probability Distribution of Energy Partitioning&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Show plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/5537f9797f532ab87552667b3d858d5f3e5141255e1afe5b4bf1e52f227b6da2.png" src="../_images/5537f9797f532ab87552667b3d858d5f3e5141255e1afe5b4bf1e52f227b6da2.png" />
</div>
</div>
</section>
<section id="energy-fluctuations-are-gaussian">
<h3>Energy fluctuations are Gaussian<a class="headerlink" href="#energy-fluctuations-are-gaussian" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Since system consits of sum of statistically independent blocks or particles we expect that a system in equilibrium with a heat bath at temperature <span class="math notranslate nohighlight">\(T\)</span> follows a Gaussian distribution around average energy <span class="math notranslate nohighlight">\(U\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[P(E)\approx e^{-\frac{(E-U)^2}{2\sigma^2_E}}\]</div>
</section>
<section id="temperature-as-the-driver-of-energy-partitioning">
<h3>Temperature as the driver of energy partitioning<a class="headerlink" href="#temperature-as-the-driver-of-energy-partitioning" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Which paritioning is most likely? For two systems exchanging energy we can write down probability of macrostate and find its maxima with respect to <span class="math notranslate nohighlight">\(E\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\frac{d }{dE}logP(E) = \frac{d }{dE} \bigg[ log\Omega_1(E)\Omega_2(E_{tot}-E) \bigg]= 0
\]</div>
<div class="math notranslate nohighlight">
\[\frac{d}{dE}logP(E) = \bigg[ \frac{d }{dE} log\Omega_1 - \frac{d}{dE}\Omega_2 \bigg]= 0\]</div>
<ul class="simple">
<li><p>Since <span class="math notranslate nohighlight">\(logP(E)\sim S(E)+S_r(E-E_t)\)</span> we note that <strong>Maximizing probability of a macrostate is the same as maximizing entropy of macrostate!</strong></p></li>
<li><p>We also come to appreacite that temperature or more precisely, inverse temperature <span class="math notranslate nohighlight">\(\beta\)</span>, quantifies growth of microstates with energy</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{d log\Omega}{dE}=\frac{1}{k_B}\frac{dS}{dE}=\frac{1}{k_BT}\]</div>
<div class="important admonition">
<p class="admonition-title"><strong>Inverse Temperature <span class="math notranslate nohighlight">\(\beta\)</span></strong>  </p>
<div class="math notranslate nohighlight">
\[\beta = \frac{1}{k_B T}\]</div>
</div>
</section>
<section id="thermal-equilirbium-in-ideal-gasses">
<h3>Thermal equilirbium in ideal gasses<a class="headerlink" href="#thermal-equilirbium-in-ideal-gasses" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>If we use <span class="math notranslate nohighlight">\(\Omega \sim E^{3/2N}\)</span> for non-interacting particles in a box:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{\partial log \Omega (E_1)}{\partial E_1} \Big |_{E_1=U_1}= \frac{3}{2}\frac{N_1}{U_1} - \frac{3}{2}\frac{N_2}{U_2} = 0\]</div>
<ul class="simple">
<li><p>Using definition of entropy we get the most probable value of energy <span class="math notranslate nohighlight">\((U_1)\)</span> corresponding to the equilibirum state</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{1}{k_B T} = \frac{3}{2}\frac{N_1}{U_1} = \frac{3}{2}\frac{N_2}{U_2}\]</div>
<ul class="simple">
<li><p>We arrive at the well known result from theory of gasses that each degree of freedom of particle gets <span class="math notranslate nohighlight">\(\frac{1}{2}k_BT\)</span> thermal energy</p></li>
</ul>
<div class="math notranslate nohighlight">
\[U=\frac{3}{2}Nk_BT\]</div>
</section>
</section>
<section id="constant-temperature-ensemble-nvt">
<h2>Constant temperature ensemble (NVT)<a class="headerlink" href="#constant-temperature-ensemble-nvt" title="Permalink to this heading">#</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/320234124970dda01bbe049cb524930d1cc26572ce04ebf024d71982303e1de0.png" src="../_images/320234124970dda01bbe049cb524930d1cc26572ce04ebf024d71982303e1de0.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title"><strong>MaxEnt approach to canonical distribution</strong></p>
<ul class="simple">
<li><p>We can use Maximizing Entropy principle to assing probabilities for an esnemble where we have a physical constraint placed on having fixed average energy <span class="math notranslate nohighlight">\(\langle E\rangle =U\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[J[p_i] = \sum -p_ilog p_i -\alpha \bigg(\sum_i-1 \bigg)-\beta \bigg(\sum_i p_i E_i -U \bigg)\]</div>
<div class="math notranslate nohighlight">
\[\delta J = 0 \rightarrow  -1 -logp_i -\alpha-\beta p_i=0\]</div>
<ul class="simple">
<li><p><strong>Probability of each microstate</strong> is now weighted by an exponential of microstate Energies:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p_i = \frac{e^{-\beta E_i}}{\sum_i e^{-\beta E_i}}\]</div>
<ul class="simple">
<li><p><strong>Probability of each macrostate</strong> containing <span class="math notranslate nohighlight">\(\Omega(E)\)</span> number of microstates would be:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[p(E) = \frac{\Omega(E)e^{-\beta E}}{\sum_E \Omega(E) e^{-\beta E}}\]</div>
<ul class="simple">
<li><p>By comparing with thermodynamics we can confirm that lagrange coefficinet is inverse temperature <span class="math notranslate nohighlight">\(\beta=\frac{1}{k_BT}\)</span></p></li>
</ul>
</div>
</section>
<section id="canonical-distribution">
<h2>Canonical distribution<a class="headerlink" href="#canonical-distribution" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>We can also see why exponential distribution emerges from microcanonical ensemble by using the fact that reservoir is <strong>much larger than the system</strong> <span class="math notranslate nohighlight">\( E \ll E_t \)</span>,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
p(E) = \frac{\Omega(E) \Omega_r(E_t - E)}{\Omega_t(E_t)} 
\]</div>
<ul>
<li><p>Since log of microstates (entropy) is a <strong>smooth function</strong> we can Taylor expension around <span class="math notranslate nohighlight">\(E_t\)</span></p>
<div class="math notranslate nohighlight">
\[log\Omega_r(E_t-E) \approx log\Omega_r(E_t)  - \bigg(\frac{\partial log \Omega_r}{\partial E} \bigg) E = const  - \beta E\]</div>
</li>
<li><p>Where the first factor is a constant independent of energy and <strong>reservoir influence is now described by temperature only!</strong> <span class="math notranslate nohighlight">\(\beta  = \frac{dlog\Omega}{dE}=\frac{1}{k_BT}\)</span></p></li>
<li><p>We find that number of microstates of a large reservoir decrease exponentially when the system borrows energy <span class="math notranslate nohighlight">\(E\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\Omega_r(E_t - E) \sim e^{- \beta E}
\]</div>
<div class="important admonition">
<p class="admonition-title"><strong>Boltzmann distribution (NVT)</strong></p>
<p><strong>Probability of a Macrostate</strong></p>
<div class="math notranslate nohighlight">
\[
p(E) = \frac{\Omega(E) e^{-\beta E}}{Z}
\]</div>
<p><strong>Probability of a Microstate</strong></p>
<div class="math notranslate nohighlight">
\[
p_i = \frac{e^{-\beta E_i}}{Z}
\]</div>
<p><strong>Partition Function</strong></p>
<div class="math notranslate nohighlight">
\[
  Z = \sum_E \Omega(E) e^{-\beta E} = \sum_i e^{-\beta E_i} 
\]</div>
</div>
</section>
<section id="partition-functions-and-thermodynamic-limit">
<h2>Partition Functions and Thermodynamic limit<a class="headerlink" href="#partition-functions-and-thermodynamic-limit" title="Permalink to this heading">#</a></h2>
<div class="math notranslate nohighlight">
\[Z =  \sum_E \Omega(E) e^{-\beta E} = \sum_E  e^{-\beta (E-TS)}\]</div>
<ul class="simple">
<li><p>The number of states <strong>grows exponentially</strong> with system size <span class="math notranslate nohighlight">\( N \)</span>, <span class="math notranslate nohighlight">\( \Omega(E) = e^{\frac{S}{k_B}} \sim e^{N}\)</span> while the Boltzmann factor <strong>decays exponentially</strong> with energy <span class="math notranslate nohighlight">\(e^{-\beta E} \sim e^{-N}\)</span></p></li>
<li><p>These competing exponential behaviors determine the <strong>dominant contribution</strong> to the partition function.</p></li>
<li><p>In the <strong>thermodynamic limit</strong> (large <span class="math notranslate nohighlight">\( N \)</span> and <span class="math notranslate nohighlight">\( V \)</span>), only energies that <strong>significantly contribute</strong> to <span class="math notranslate nohighlight">\( Z \)</span> survive.</p></li>
<li><p>This allows replacing sum or integral by a single term.</p></li>
</ul>
<div class="admonition-legendre-vs-laplace-transoforms admonition">
<p class="admonition-title"><strong>Legendre vs Laplace Transoforms</strong></p>
<div class="math notranslate nohighlight">
\[
Z =\int e^{-\beta (E-TS)}dE \approx e^{\min_E [-\beta (E - TS)]} = e^{-\beta(U - TS)} = e^{-\beta F}
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( U = \langle E \rangle \)</span> is the <strong>average energy</strong>, with fluctuations of order <span class="math notranslate nohighlight">\( O(N^{1/2}) \)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\( F = U - TS \)</span> is the <strong>Helmholtz free energy</strong>.</p></li>
</ul>
</div>
<ul class="simple">
<li><p>We find that <span class="math notranslate nohighlight">\(\Omega\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> are related by <strong>Laplace Tranform</strong> and energy <span class="math notranslate nohighlight">\(E\)</span> and free energy <span class="math notranslate nohighlight">\(F\)</span> via <strong>Legendre transform</strong></p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Define energy range</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Define parameters</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Inverse temperature (1/kT)</span>

<span class="c1"># Compute the Boltzmann factor</span>
<span class="n">Boltzmann_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">E</span><span class="p">)</span>

<span class="c1"># Increase the entropy prefactor to shift the peak to the right</span>
<span class="n">S_prefactor_new</span> <span class="o">=</span> <span class="mf">2.5</span>  <span class="c1"># Larger prefactor makes entropy increase faster</span>

<span class="c1"># Recalculate entropy and probability density</span>
<span class="n">S_new</span> <span class="o">=</span> <span class="n">S_prefactor_new</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">E</span><span class="p">)</span>
<span class="n">Probability_density_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">S_new</span><span class="p">)</span> <span class="o">*</span> <span class="n">Boltzmann_factor</span>

<span class="c1"># Create the updated plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot entropy (scaled for visualization)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">S_new</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">S_new</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Entropy $S(E)$ (scaled)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

<span class="c1"># Plot Boltzmann factor (scaled for visualization)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">Boltzmann_factor</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">Boltzmann_factor</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Boltzmann Factor $e^{-\beta E}$ (scaled)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

<span class="c1"># Plot updated probability density (product of both)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">Probability_density_new</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">Probability_density_new</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Probability Density $\Omega(E) e^{-\beta E}$&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

<span class="c1"># Highlight new peak region</span>
<span class="n">E_peak_new</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">Probability_density_new</span><span class="p">)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">E_peak_new</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;New Peak Region&quot;</span><span class="p">)</span>

<span class="c1"># Labels and title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Energy $E$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Scaled Functions&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Shifted Peak: Entropy Growth, Boltzmann Factor Decay, and Probability Density&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># Show plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/e9af104601dea02b51610f51d9cc351d067170b61f1823766d81c534df986d61.png" src="../_images/e9af104601dea02b51610f51d9cc351d067170b61f1823766d81c534df986d61.png" />
</div>
</div>
</section>
<section id="examples-of-using-nvt">
<h2>Examples of using NVT<a class="headerlink" href="#examples-of-using-nvt" title="Permalink to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title"><strong>non-interacting spins</strong></p>
<ul class="simple">
<li><p>Consider three spins where up and down orientations have equal energy <span class="math notranslate nohighlight">\(\epsilon\)</span>.</p></li>
<li><p>Show that sum over microstates and sum over macrostates leads to same expression of parition function.</p></li>
<li><p>Write down free energy for the system and identify entropic and energetic parts.</p></li>
</ul>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<strong>Solution</strong><div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text"><strong>Sum over macrostates</strong></p>
<div class="math notranslate nohighlight">
\[Z = \sum_E \Omega(E)e^{-\beta E} = 8e^{-3\beta\epsilon }\]</div>
<p class="sd-card-text"><strong>Sum over microstates</strong></p>
<div class="math notranslate nohighlight">
\[
Z = \sum_i e^{-\beta E_i}
\]</div>
<ul class="simple">
<li><p class="sd-card-text">Since each spin is independent, <span class="math notranslate nohighlight">\(E=E_1+E_2+E_3\)</span> the sum factorizes!</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
Z = \sum_{s_1} e^{-\beta E_1}   \sum_{s_2} e^{-\beta E_2}  \sum_{s_3} e^{-\beta E_3}
\]</div>
<ul class="simple">
<li><p class="sd-card-text">Each sum runs over the two possible spin orientations (<span class="math notranslate nohighlight">\(\uparrow\)</span>, <span class="math notranslate nohighlight">\(\downarrow\)</span>), both of which have the same energy <span class="math notranslate nohighlight">\( \epsilon \)</span>, so:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\sum_{s_i} e^{-\beta E_i} = e^{-\beta \epsilon} + e^{-\beta \epsilon} = 2 e^{-\beta \epsilon}
\]</div>
<ul class="simple">
<li><p class="sd-card-text">Thus, for three spins:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
Z = \left( 2 e^{-\beta \epsilon} \right)^3 = 8 e^{-\beta \epsilon}
\]</div>
<p class="sd-card-text"><strong>Free energy</strong></p>
<div class="math notranslate nohighlight">
\[F = -k_BTlogZ = -k_BT\epsilon log 8 + \epsilon\]</div>
</div>
</details></div>
<section id="two-state-partciles-nvt">
<h3>Two-state partciles (NVT)<a class="headerlink" href="#two-state-partciles-nvt" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Consider a simple two-level system where lower level has energy <span class="math notranslate nohighlight">\(0\)</span> and upper level <span class="math notranslate nohighlight">\(\epsilon\)</span>. Determine how the fraction of excited states <span class="math notranslate nohighlight">\(f=\frac{n}{N}\)</span> changes with temperature.</p></li>
<li><p>Solving a two-state particle system in an NVT ensemble is much easier because the partition function decouples into single particle contributions.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[Z = \sum^{n=N}_{n=0} e^{-\beta E_n}  = (1+e^{-\beta \epsilon})^N\]</div>
<div class="math notranslate nohighlight">
\[F= -k_B T log Z = -k_BT N log(1+e^{-\beta \epsilon})\]</div>
<div class="math notranslate nohighlight">
\[\langle E \rangle  = \frac{\partial log Z}{\partial (-\beta)} =  \frac{N\epsilon}{1+e^{\beta \epsilon}}\]</div>
<div class="math notranslate nohighlight">
\[f = \frac{E}{N\epsilon} = \frac{1}{1+e^{\beta \epsilon}}\]</div>
<ul class="simple">
<li><p>We obtained same expression we got when using NVE but it tooks us less number of steps!</p></li>
</ul>
</section>
</section>
<section id="free-energy-and-macrostate-probabilities">
<h2>Free energy and macrostate probabilities<a class="headerlink" href="#free-energy-and-macrostate-probabilities" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Microstates:</strong> The relative population of microstates is dictated by the ratio of Boltzmann weights which depends on energy difference <span class="math notranslate nohighlight">\(\Delta E\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[p_1 = \frac{e^{-\beta E_1}}{Z} = \frac{e^{-\beta E_1}}{e^{-\beta F}}\]</div>
<div class="math notranslate nohighlight">
\[{\frac{p_2}{p_1} = e^{-\beta (E_2-E_1)}}\]</div>
<ol class="arabic simple" start="2">
<li><p><strong>Macrostates:</strong> Probability of macrostates with energy <span class="math notranslate nohighlight">\(E_A\)</span> is obtained by summing over all microstates with energy E_A or simply by multiplying by <span class="math notranslate nohighlight">\(\Omega_A\)</span>. The latter is related to entropy, which ends up turning the numerator into the free energy of a macrostate <span class="math notranslate nohighlight">\(A\)</span>: <span class="math notranslate nohighlight">\(F_A = E_A-TS_A\)</span></p></li>
</ol>
<div class="math notranslate nohighlight">
\[p_A =\frac{\Omega (E_A) e^{-\beta E_A}}{Z_A} = \frac{e^{-\beta F_A}}{e^{-\beta F}}\]</div>
<ul class="simple">
<li><p>The relative population of macrostates is dictated by the ratio of entropic term times Boltzmann weights which depends on free energy difference <span class="math notranslate nohighlight">\(\Delta F\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[{\frac{p_B}{p_A} = e^{-\beta (F_B-F_A)}}\]</div>
<div class="note admonition">
<p class="admonition-title"><strong>Exercise</strong></p>
<ul class="simple">
<li><p>Consider state A has 3 energy levels <span class="math notranslate nohighlight">\(0, \epsilon, 2\epsilon\)</span> and state B has four energy levels with <span class="math notranslate nohighlight">\(0,  2\epsilon, 3\epsilon, 4\epsilon\)</span></p></li>
<li><p>For state B all excited states have degenercy of 10.</p></li>
<li><p>Compute how probability of state A vs B changes with temperature.</p></li>
</ul>
</div>
</section>
<section id="energy-fluctuations">
<h2><strong>Energy Fluctuations</strong><a class="headerlink" href="#energy-fluctuations" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>The probability of the system being in microstate  i  is given by the Boltzmann distribution:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
P_i = \frac{e^{-\beta E_i}}{Z}, \quad Z = \sum_i e^{-\beta E_i}
\]</div>
<div class="math notranslate nohighlight">
\[
\langle E \rangle = \sum_i P_i E_i = \frac{1}{Z} \sum_i E_i e^{-\beta E_i} 
\]</div>
<ul class="simple">
<li><p>The ensemble average energy can be related to the  derivative of log of partition function:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
 \langle E \rangle= -\frac{1}{Z} \frac{\partial Z}{\partial \beta} = -\frac{\partial \ln Z}{\partial \beta}
\]</div>
<div class="important admonition">
<p class="admonition-title"><strong>Moments of Energy in NVT ensemble</strong></p>
<div class="math notranslate nohighlight">
\[
\langle E\rangle  = -\frac{\partial \ln Z}{\partial \beta}
\]</div>
<div class="math notranslate nohighlight">
\[
  \sigma_E^2 = \langle E^2 \rangle - \langle E \rangle^2 = \frac{\partial^2 \ln Z}{\partial \beta^2}
\]</div>
</div>
</section>
<section id="fluctuation-response-and-ensemble-equivalence">
<h2>Fluctuation-response and ensemble equivalence<a class="headerlink" href="#fluctuation-response-and-ensemble-equivalence" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>We can now show that heat capaicty is related to energy fluctuations a result known as fluctuation-response theorem</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
C_V = \left( \frac{\partial \langle E \rangle}{\partial T} \right)_V = - k_B \beta^2 \frac{\partial^2 \ln Z}{\partial \beta^2}
\]</div>
<div class="important admonition">
<p class="admonition-title"><strong>Fluctuation-Response Theorem</strong></p>
<div class="math notranslate nohighlight">
\[\sigma_E^2 = k_B T^2 C_V \]</div>
</div>
<ul>
<li><p>The probability distribution of energy, <span class="math notranslate nohighlight">\(P(E)\)</span>, follows a <strong>Gaussian distribution</strong> in equilibrium:</p>
<div class="math notranslate nohighlight">
\[  
  P(E) \propto \exp\left(-\frac{(E - \langle E \rangle)^2}{2 k_B T^2 C_V} \right)
  \]</div>
</li>
<li><p>Relative energy fluctuations decrease with <span class="math notranslate nohighlight">\(N\)</span>. In the thermodynamic limit <span class="math notranslate nohighlight">\(N\rightarrow \infty \)</span>, fluctuations become negligible, justifying <strong>ensemble equivalence</strong>.</p>
<div class="math notranslate nohighlight">
\[
  \frac{\sigma_E}{\langle E \rangle} \sim \frac{C_V^{1/2}}{\langle E \rangle} \sim O(N^{-1/2})
  \]</div>
</li>
</ul>
</section>
<section id="more-examples-of-using-statistical-ensembles">
<h2>More Examples of using statistical Ensembles<a class="headerlink" href="#more-examples-of-using-statistical-ensembles" title="Permalink to this heading">#</a></h2>
<div class="note admonition">
<p class="admonition-title"><strong>Exercise: Random polymer chain</strong></p>
<ul class="simple">
<li><p>Consider 1D polymer where <span class="math notranslate nohighlight">\(N\)</span> monomers are randomly oriended with <span class="math notranslate nohighlight">\(+l\)</span> and <span class="math notranslate nohighlight">\(-l\)</span> orientation along the <span class="math notranslate nohighlight">\(x\)</span> axis.</p></li>
<li><p>Microcanonical ensmeble here is defined as all possible microstates given fixed value of end to end distance <span class="math notranslate nohighlight">\(X\)</span> of this polymer.</p></li>
<li><p>Compute entropy <span class="math notranslate nohighlight">\(S(X)\)</span> and argue that if polymer length is free to move most likely configuraiton would be where the polymer remains compact with nearly equal numbers of <span class="math notranslate nohighlight">\( +l \)</span> and <span class="math notranslate nohighlight">\( -l \)</span> orientations.</p></li>
</ul>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
<strong>Solution</strong><div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text">We consider a 1D polymer consisting of <span class="math notranslate nohighlight">\( N \)</span> monomers, where each monomer can be oriented either in the <span class="math notranslate nohighlight">\( +l \)</span> or <span class="math notranslate nohighlight">\( -l \)</span> direction along the <span class="math notranslate nohighlight">\( x \)</span>-axis. The total end-to-end distance of the polymer is given by:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
X = \sum_{i=1}^{N} s_i l
\]</div>
<ul class="simple">
<li><p class="sd-card-text">where <span class="math notranslate nohighlight">\( s_i = \pm 1 \)</span> represents the orientation of the <span class="math notranslate nohighlight">\( i \)</span>th monomer.</p></li>
</ul>
<p class="sd-card-text"><strong>Microcanonical Partition Function</strong></p>
<ul class="simple">
<li><p class="sd-card-text">The total number of microstates corresponding to a given end-to-end distance <span class="math notranslate nohighlight">\( X \)</span> is determined by the number of ways to distribute <span class="math notranslate nohighlight">\( N_+ \)</span> monomers in the <span class="math notranslate nohighlight">\( +l \)</span> direction and <span class="math notranslate nohighlight">\( N_- \)</span> monomers in the <span class="math notranslate nohighlight">\( -l \)</span> direction, such that:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
N_+ + N_- = N, \quad N_+ - N_- = \frac{X}{l}
\]</div>
<ul class="simple">
<li><p class="sd-card-text">Solving for <span class="math notranslate nohighlight">\( N_+ \)</span> and <span class="math notranslate nohighlight">\( N_- \)</span>,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
N_+ = \frac{N + X/l}{2}, \quad N_- = \frac{N - X/l}{2}
\]</div>
<ul class="simple">
<li><p class="sd-card-text">The number of microstates corresponding to a given <span class="math notranslate nohighlight">\( X \)</span> is given by the binomial coefficient:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\Omega(X) = \binom{N}{N_+} = \frac{N!}{N_+! N_-!}
\]</div>
<ul class="simple">
<li><p class="sd-card-text">For large <span class="math notranslate nohighlight">\( N \)</span>, we approximate using <strong>Stirling’s approximation</strong>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\ln \Omega(X) \approx N \ln N - N_+ \ln N_+ - N_- \ln N_-
\]</div>
<p class="sd-card-text"><strong>Entropy Calculation</strong></p>
<div class="math notranslate nohighlight">
\[
S(X) = k_B \ln \Omega(X)
\]</div>
<ul class="simple">
<li><p class="sd-card-text">Using Stirling’s approximation and expressing <span class="math notranslate nohighlight">\( N_+ \)</span> and <span class="math notranslate nohighlight">\( N_- \)</span> in terms of <span class="math notranslate nohighlight">\( X \)</span>,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
S(X) \approx k_B \left[ N \ln N - \frac{N+X/l}{2} \ln \frac{N+X/l}{2} - \frac{N-X/l}{2} \ln \frac{N-X/l}{2} \right]
\]</div>
<ul class="simple">
<li><p class="sd-card-text">To simplify, define the <strong>normalized displacement</strong> <span class="math notranslate nohighlight">\( x = X / (N l) \)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[
S(X) \approx k_B N \left[ \ln N - \frac{1+x}{2} \ln \frac{1+x}{2} - \frac{1-x}{2} \ln \frac{1-x}{2} \right]
\]</div>
<ul class="simple">
<li><p class="sd-card-text">For small <span class="math notranslate nohighlight">\(x\)</span>, we can approximate using a Taylor expansion:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
S(X) \approx k_B N \left[ \ln 2 - \frac{x^2}{2} \right]
\]</div>
<ul class="simple">
<li><p class="sd-card-text">Thus, the entropy has a <strong>maximum</strong> at <span class="math notranslate nohighlight">\(X = 0 \)</span>, meaning the most probable configuration is one where the polymer remains compact with nearly equal numbers of <span class="math notranslate nohighlight">\( +l \)</span> and <span class="math notranslate nohighlight">\( -l \)</span> orientations.</p></li>
<li><p class="sd-card-text">This shows a decrease in entropy as the polymer is more stretched (<span class="math notranslate nohighlight">\(|X|\)</span> increases), reflecting fewer accessible configurations.</p></li>
</ul>
</div>
</details></div>
</section>
<section id="problems">
<h2>Problems<a class="headerlink" href="#problems" title="Permalink to this heading">#</a></h2>
</section>
<section id="shottky-defects">
<h2>Shottky defects<a class="headerlink" href="#shottky-defects" title="Permalink to this heading">#</a></h2>
<p>Schotky defects are vacancies in a lattice of atoms. Creating a single vacancy costs an energy <span class="math notranslate nohighlight">\(\epsilon\)</span>.  Consider a lattice with <span class="math notranslate nohighlight">\(N\)</span> atoms and <span class="math notranslate nohighlight">\(n\)</span> vacacnies. In this model the total energy is solely a function of defects: <span class="math notranslate nohighlight">\(E=n\epsilon\)</span></p>
<ul class="simple">
<li><p>Write down number of states and compute the entropy via Boltzmann formula. Plot number of states as a function of energy. You can use log of number of states for plotting.</p></li>
<li><p>Compute how the temperature would affect the fraction of vacancies on the lattice. Plot fraction of vacancies as a function of temperature.</p></li>
<li><p>How would the total energy depend on temperature <span class="math notranslate nohighlight">\(T\)</span>. Derive expression for the high temeprature limit (<span class="math notranslate nohighlight">\(\frac{\epsilon}{k_b T} \gg 1\)</span>).</p></li>
<li><p>Plot total energy as a function of temperature E(T)</p></li>
</ul>
<section id="lattice-gas">
<h3>Lattice gas<a class="headerlink" href="#lattice-gas" title="Permalink to this heading">#</a></h3>
<p>Consider a lattice gas of N particles distributed among V cells (with <span class="math notranslate nohighlight">\(N\geq V\)</span>). Suppose that each cell may be either empty or occupied by a single particle. The number of microscopic states of this syste will be given by:</p>
<div class="math notranslate nohighlight">
\[\Omega (N, V) = \frac{V!}{N! (V-N)!}\]</div>
<ul class="simple">
<li><p>Obtain an expression for the entropy per particle <span class="math notranslate nohighlight">\(s(v)=\frac{1}{N} \cdot S(N,V)\)</span> where <span class="math notranslate nohighlight">\(v=\frac{V}{N}\)</span>.</p></li>
<li><p>From this simple fundamental equation, obtain an expression of equation of state <span class="math notranslate nohighlight">\(p/T\)</span>.</p></li>
<li><ul>
<li><p>Write an expansion of <span class="math notranslate nohighlight">\(p/T\)</span> in terms of density <span class="math notranslate nohighlight">\(1/v\)</span>. Show that the first term gives Boyle law of ideal gases.</p></li>
</ul>
</li>
<li><p>Sketch a graph of <span class="math notranslate nohighlight">\(\mu/T\)</span>, where <span class="math notranslate nohighlight">\(\mu(\rho)\)</span> is a chemical potential as a function of density. Comment on <span class="math notranslate nohighlight">\(\rho\rightarrow 0\)</span> and <span class="math notranslate nohighlight">\(\rho\rightarrow 1\)</span> limits.</p></li>
</ul>
</section>
</section>
<section id="polymer-elasticity">
<h2>Polymer Elasticity<a class="headerlink" href="#polymer-elasticity" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><p>Solve the problem 2.7  from the book.</p>
</div></blockquote>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "DPotoyan/Statmech4ChemBio",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./3_ensembles"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Ensembles</p>
      </div>
    </a>
    <a class="right-next"
       href="nvt.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ensembles in phase-space</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#microcanonical-ensemble-nve">Microcanonical Ensemble (NVE)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#microcanonical-partition-function-grows-exponentially-with-system-size">Microcanonical partition function grows exponentially with system size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#applications-of-nve">Applications of NVE</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#particles-in-a-box">Particles in a box</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-state-system">Two state system</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-partitioning-in-an-isolated-system">Energy partitioning in an isolated system</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-fluctuations-are-gaussian">Energy fluctuations are Gaussian</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temperature-as-the-driver-of-energy-partitioning">Temperature as the driver of energy partitioning</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#thermal-equilirbium-in-ideal-gasses">Thermal equilirbium in ideal gasses</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constant-temperature-ensemble-nvt">Constant temperature ensemble (NVT)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#canonical-distribution">Canonical distribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#partition-functions-and-thermodynamic-limit">Partition Functions and Thermodynamic limit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-of-using-nvt">Examples of using NVT</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-state-partciles-nvt">Two-state partciles (NVT)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#free-energy-and-macrostate-probabilities">Free energy and macrostate probabilities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#energy-fluctuations"><strong>Energy Fluctuations</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fluctuation-response-and-ensemble-equivalence">Fluctuation-response and ensemble equivalence</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#more-examples-of-using-statistical-ensembles">More Examples of using statistical Ensembles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems">Problems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shottky-defects">Shottky defects</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lattice-gas">Lattice gas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#polymer-elasticity">Polymer Elasticity</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Davit Potoyan
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>